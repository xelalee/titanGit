<!DOCTYPE html>
<html>
<head>
    <title>TitanWALL web manager</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="Pragma" content="no-cache"> 
    <meta http-equiv="Cache-Control" content="no-cache"> 
    <meta http-equiv="Expires" content="0"> 
<!--[if IE 8]>
    <meta http-equiv="X-UA-Compatible" content="IE=7">
<![endif]-->
<!-- css -->
    <link rel="stylesheet" type="text/css" href="css/reset.css" />
    <link rel="stylesheet" type="text/css" href="css/console.css" />
    <link rel="stylesheet" type="text/css" href="css/cssbutton-min.css" />
    <link rel="stylesheet" type="text/css" href="css/datatable-base.css" />
    <link rel="stylesheet" type="text/css" href="css/datatable-sort.css" />
    <link rel="stylesheet" type="text/css" href="css/panel.css" />
    <link rel="stylesheet" type="text/css" href="css/portalK.css" />
    <link rel="stylesheet" type="text/css" href="css/screen.css" /> 
    <link rel="stylesheet" type="text/css" href="css/widget-base.css" />
    <link rel="stylesheet" type="text/css" href="css/widget-stack.css" />
    <link rel="stylesheet" type="text/css" href="css/widget-modality.css" />
<!-- yui -->
    <script type="text/javascript" src="js/yui-min.js"></script>
    <script type="text/javascript" src="js/yuiCombo1.js"></script>
    <script type="text/javascript" src="js/yuiCombo2.js"></script>
    <script type="text/javascript" src="js/yuiCombo3.js"></script>
    <script type="text/javascript" src="js/yuiCombo4.js"></script>
    <script type="text/javascript" src="js/yuiCombo5.js"></script>
    <script type="text/javascript" src="js/yuiCombo6.js"></script>
    <script type="text/javascript" src="js/yuiCombo7.js"></script>
    <script type="text/javascript" src="js/yuiCombo8.js"></script>
    <script type="text/javascript" src="js/yuiCombo9.js"></script>
    <script type="text/javascript" src="js/widget-base-ie.js"></script> 
<!-- jquery -->
    <link rel="stylesheet" type="text/css" href="css/jquery-ui-1.9.2.custom.css" />
    <script type="text/javascript" src="js/jquery-1.8.3.js"></script>
    <script type="text/javascript" src="js/jquery.bgiframe.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.9.2.custom.js"></script>
<!-- custom js -->
    <script type="text/javascript" src="js/ipCalc.js"></script>

<!--    <script type="text/javascript" src="js/alertClass.js"></script> -->
<!--    <script type="text/javascript" src="js/btnClass.js"></script> -->
    <script type="text/javascript" src="js/checkerClass.js"></script> 
<!--    <script type="text/javascript" src="js/dashboardClass.js"></script> -->
<!--    <script type="text/javascript" src="js/reportsClass.js"></script> -->
<!--    <script type="text/javascript" src="js/interfaceClass.js"></script> -->
<!--    <script type="text/javascript" src="js/networkingClass.js"></script> -->
<!--    <script type="text/javascript" src="js/firewallClass.js"></script> -->
<!--    <script type="text/javascript" src="js/securityClass.js"></script> -->
<!--    <script type="text/javascript" src="js/usersClass.js"></script> -->
<!--    <script type="text/javascript" src="js/objectsClass.js"></script> -->
<!--    <script type="text/javascript" src="js/deviceClass.js"></script> -->

<!-- custom css -->
    <link rel="stylesheet" type="text/css" href="css/customCSSK.css" />

<!-- JS Start -->
<script type="text/javascript">
// force redirect to https 
if ('http:' === window.location.protocol)
    window.location = 'https:' + window.location.href.substr(5);

// fix ie's indexOf issue 
if (!Array.prototype.indexOf) {
    Array.prototype.indexOf = function (searchElement /*, fromIndex */ ) {
        "use strict";
        if (this == null) {
            throw new TypeError();
        }
        var t = Object(this);
        var len = t.length >>> 0;
        if (len === 0) {
            return -1;
        }
        var n = 0;
        if (arguments.length > 1) {
            n = Number(arguments[1]);
            if (n != n) { // shortcut for verifying if it's NaN
                n = 0;
            } else if (n != 0 && n != Infinity && n != -Infinity) {
                n = (n > 0 || -1) * Math.floor(Math.abs(n));
            }
        }
        if (n >= len) {
            return -1;
        }
        var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);
        for (; k < len; k++) {
            if (k in t && t[k] === searchElement) {
                return k;
            }
        }
        return -1;
    }
}

// fix older env,
if (!Object.keys) {
  Object.keys = (function () {
    var hasOwnProperty = Object.prototype.hasOwnProperty,
        hasDontEnumBug = !({toString: null}).propertyIsEnumerable('toString'),
        dontEnums = [
          'toString',
          'toLocaleString',
          'valueOf',
          'hasOwnProperty',
          'isPrototypeOf',
          'propertyIsEnumerable',
          'constructor'
        ],
        dontEnumsLength = dontEnums.length;

    return function (obj) {
      if (typeof obj !== 'object' && typeof obj !== 'function' || obj === null) throw new TypeError('Object.keys called on non-object');

      var result = [];

      for (var prop in obj) {
        if (hasOwnProperty.call(obj, prop)) result.push(prop);
      }

      if (hasDontEnumBug) {
        for (var i=0; i < dontEnumsLength; i++) {
          if (hasOwnProperty.call(obj, dontEnums[i])) result.push(dontEnums[i]);
        }
      }
      return result;
    };
  })();
}

// add plugin for object length calc
Object.size = function(obj) {
    var size = 0, key;
    for (key in obj)
    {
        if (obj.hasOwnProperty(key))
            size++;
    }
    return size;
}

// yui instance 
var gY = YUI({filter:"raw", defaultGraphicEngine: "canvas"}).use('anim', 'charts', 'charts-legend', 'console', 'cookie', 'datasource', 'datasource-get', 'datasource-io', 'datasource-jsonschema', 'datatable-base', 'datatable-sort', 'datatable-datasource', 'dd', 'dd-plugin', 'dump', 'event', 'get', 'io-base', 'io-upload-iframe', 'json', 'json-parse', 'json-stringify', 'node', 'panel', 'uploader', 'yui');

// define global vars 
var gLang = ['en', 'cn', 'tw']; // languages
var gRef  = {};
var gTmpl = {};
var gJson = {};
var gReg  = {};
var gBtn  = {};
var gMsg  = {};
var gErr  = {};
var gIf   = {};
var gHtml = {};

var gLogin = {};
var gData  = {};
var gOrig  = {};
var gError = {};
var gTerm  = {};
var gLimit = {};
var gCheck = {};
var gIssue = {};
var gCheckbox = {};
var gQuery = {};

var gMAC   = {};
var gCnt   = 0;
var gVar   = {};
var gObj   = {};
var gNode  = {};
var gNodelen = 0;
var gSelector = {};
var gCache   = {};
var gSet   = {};
var gGet   = {};
var gPop   = {};
var gSort  = {};
var gColumns = {};
var gHelp;
var gCook  = {};
var gRows  = {};

// cookie 
gCook.main    = 'TitanWALL';
gCook.portal  = 'TitanWALLPortal';
// declaire obj default
gObj.config = '';
gObj.active  = {};
gObj.actived = {};
gObj.stamper = new Date().getTime();
gObj.counter = "";
gObj.user      = "";
gObj.userIp    = "";
gObj.isAlias   = 0;
gObj.ipAlias   = [];
gObj.statusMsg = "";
gObj.progress = 99;
gObj.loading  = 99;
gObj.progress = '';
gObj.tab;
gObj.tabber;
gObj.tabIndex = 0;
gObj.tabIndexId;
gObj.tabIndexed = 0;
gObj.use_common_ip_list = [];
gObj.isForm    = [];
gObj.inUsed    = 0;

gObj.calc      = {};
gObj.reg       = '';
gObj.phpQuery  = {};
gObj.phpQuery.php = 'common_query';
gObj.phpQuery.pi  = 1;
gObj.phpQuery.ps  = 1;
gObj.phpQuery.pp  = 20;
gObj.phpQuery.id  = '';
gObj.systime = '';

gObj.idleOut = 0;
gObj.forceOut = 0;
gObj.delay  = 0;
gObj.help   = 0;
gObj.sigVer = 0;
gObj.blinking = 0;
gObj.blinkings = [ 'D', 'L', 'U' ];
//gObj.blinkings = [ 'E', 'H', 'I', 'A' ];
gObj.debugMode = 0;

// if condition 
gIf.multi   = true;
gIf.loading = false;
gIf.session = false;
gIf.systime = false;
gIf.invalid = false;
gIf.getSessInfo = false;
gIf.limited = false;
gIf.reboot  = false;
gIf.alter   = false;
gIf.ipAlias = false;
gIf.hasDefaultRt = false;
gIf.isDefaultRt = false;
gIf.wasDefaultRt = false;
gIf.progressT = false;
gIf.delay   = false;
gIf.rtMode  = false;
gIf.query   = false;
gIf.dialog  = false;
gIf.checked = false;
gIf.wanProto = false;
gIf.pass     = false;
gIf.valid    = false;
gIf.remove   = false;
gIf.tag      = false;
gIf.radio    = false;
gIf.check_name  = false;
gIf.newUsername = false;
gIf.checkIp     = false;
gIf.checkAlias  = false;
gIf.columns     = false;
gIf.power       = false;
gIf.ajaxed      = false;
gIf.toEmail     = false;
gIf.refresh     = false;
gIf.isStart     = false;
gIf.isMAC       = false;
gIf.over90      = false;
gIf.isCapture   = false;
gIf.newFirmware = false;
gIf.pcap        = false;
gIf.log         = false;
gIf.debug       = false;
gIf.isNext      = false;
gIf.inUsed      = false;

// regexp 
// try to reg per element instead of obj, for solve ie issues 
gReg.ascii = {};
gReg.ascii.default  = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{1,63}$/;
gReg.ascii.vlan     = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{1,15}$/;
gReg.ascii.lan      = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{1,15}$/;
gReg.ascii.login    = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{1,31}$/;
gReg.ascii.user     = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{1,31}$/;
gReg.ascii.group    = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{1,31}$/;
gReg.ascii.account  = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{1,31}$/;
gReg.ascii.password = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{1,31}$/;

gReg.ascii.admin    = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{1,31}$/;
gReg.ascii.username = /^[\x2D\x2E\x5F\x30-x39\x40-\x5A\x61-\x7A]{6,20}$/;
gReg.ascii.userpass = /^[\x2D\x2E\x5F\x30-x39\x40-\x5A\x61-\x7A]{6,20}$/;
gReg.ascii.license32   = /^[\x20\x2D\x2E\x5F\x30-x39\x40-\x5A\x61-\x7A]{1,32}$/;
gReg.ascii.license64   = /^[\x20\x2D\x2E\x5F\x30-x39\x40-\x5A\x61-\x7A]{1,64}$/;
gReg.ascii.license064  = /^[\x20\x2D\x2E\x5F\x30-x39\x40-\x5A\x61-\x7A]{0,64}$/;
gReg.ascii.email    = /^[\x2D\x2E\x5F\x30-x39\x40-\x5A\x61-\x7A]{6,63}$/;

gReg.ascii.description  = /^[\x20\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{0,100}$/;
gReg.ascii.remoteGw     = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{0,127}$/;
gReg.ascii.presharedkey = /^[\x21\x23\x24\x26\x28-\x3E\x40-\x5F\x61-\x7E]{1,255}$/;

gReg.vpn = 0x12 << 16;

gReg.ipv4  = /^((((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3})(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))$/;
gReg.mac   = /^((([0-9a-f]{2}\:){5})([0-9a-z]{2}))$/i;
gReg.vid   = /^([1-9]|\d{2,3}|[1-3]\d{3}|40[1-8]\d|409[0-6])$/;
gReg.mtuValue  = /^(57[6-9]|5[89]\d|[6-9]\d{2}|1[0-4]\d{2}|1500)$/;
gReg.mtuValue6 = /^(12[89]\d|1[34]\d{2}|1500)$/;
gReg.mtuValuePPPoE  = /^(57[6-9]|5[89]\d|[6-9]\d{2}|1[0-3]\d{2}|14[0-8]\d|149[012])$/;
gReg.mtuValue6PPPoE = /^(12[89]\d|13\d{2}|14[0-8]\d|149[012])$/;
gReg.leaseTime = /^(1[89]\d|[2-9]\d{2}|[1-9]\d{3}|[1-7]\d{4}|8[1-5]\d{3}|86[0-3]\d{2}|86400)$/;
gReg.ipv6PrefixLength = /^(\d{1,2}|1[01]\d|12[0-8])$/;
gReg.securityLevel    = /^(\d{1,2}|100)$/;
gReg.period    = /^([3-9]|[1-9]\d{1,2}|[12]\d{3}|3[0-5]\d{2}|3600)$/;
gReg.count     = /^([3-9]|[1-9]\d|100)$/;
gReg.hour      = /^(2[1-3]|[01]?\d)$/;
gReg.min       = /^([1-5]?\d)$/;
gReg.sec       = /^([1-5]?\d)$/;
gReg.expDay    = /^([0-2]?\d{0,2}|300)$/;
gReg.expHour   = /^([1]?\d|2[0-3])$/;
gReg.blacklist = /^([1-9]\d{0,2}|[1-6]?\d{3}|7[01]\d{2}|7200)$/;
gReg.passOut   = /^((.){1,31})$/;
gReg.userOut63 = /^((.){1,63})$/;
gReg.passOut63 = /^((.){1,63})$/;
gReg.email     = /^((.){6,63})$/;
gReg.length255 = /^((.){0,255})$/;
gReg.length127 = /^((.){1,127})$/;
gReg.length0127 = /^((.){0,127})$/;

//gReg.hostname     = /^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])$/;
gReg.hostname   = /^([a-zA-Z0-9\._]{0,31})$/;
gReg.domainName   = /^((.){0,255})$/;
gReg.domainURL    = /^(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?$/i;
gReg.domain       = /^[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z]{2,})$/;
gReg.description  = /^((.){0,100})$/;
gReg.presharedkey = /^((.){1,255})$/;
gReg.remoteGw     = /^(((((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3})(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))|[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?)$/i;
gReg.dpddelay     = /^(300|[1-2]?[0-9]?[0-9])$/;
gReg.dpdtimeout   = /^(1800|1[0-7]\d{2}|[1-9][0-9][0-9]|[3-9][0-9])$/;
gReg.fallbackTime = /^([1-5][0-9]|[3-9])$/;
gReg.maxIdleTime  = /^([5-9]|[1-9]\d{1,2})$/;
gReg.loginInactiveTimeout = /^([6-9]\d|[1-9]\d{2}|1000)$/;
gReg.loginSessionLimit    = /^([6-9]\d|[1-9]\d{2}|1000)$/;
gReg.loginFailBlockMaxAttempts  = /^(\d{1,3}|1000)$/;
gReg.loginFailBlockTime = /^([3-9]\d|[1-9]\d{2}|[1-2]\d{3}|3[0-5]\d{2}|3600)$/;

gReg.lifetime = /^(86400|86[0-3][0-9]{2}|[1-7][0-9]{4}|[1-9][0-9]{3}|[2-9][0-9]{2}|1[89][0-9])$/;
gReg.password = /^((\S){1,31})$/;

gReg.timeout   = /^([1-3]?\d{1,3}|3[0-5]\d{2}|3600)$/;
gReg.threshold = /^([1-4]?\d{1,4}|50000)$/;

gReg.portList  = /^([1-9]|[1-9]\d{1,3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/;
gReg.maxFileSize = /^(\d{1,4}|10[01]\d{2}|102[0-3]\d|10240)$/;
gReg.cacheSize = /^(1[5-9]\d|[2-9]\d{2}|[1-9]\d{3}|10000)$/;

gReg.cpuAlertThreshold  = /^([1-9]\d|100)$/;
gReg.diskAlertThreshold = /^([5-9]\d|100)$/;
gReg.alertInterval  = /^([3-9]|[1-9]\d{1,2}|1[0-3]\d{2}|14[0-3]\d|1440)$/;

gReg.profileImport  = /^[0-9a-zA-Z._-]+$/;

gReg.isTop          = /top_/;
gReg.isPhp          = /php/;
gReg.isEnabled      = /Enable/i;
gReg.invalid        = /invalid|ERR/;
gReg.isWan          = /^(WAN[1-6])$/;
gReg.isPage         = /(Save|Cancel)/g;
gReg.isDigit        = /\d+/;
gReg.isRoute        = /lan|wan|vlan/;
gReg.isRow          = /(Add|Edit|Mod|Delete|MoveUp|MoveDown|Force|Active|Connect|Disconnect)/g;
gReg.isTable        = /(Create|Save|Remove|Refresh|Query|Forces|Clear|Export|Disconnects|LicenseRefresh)/g;
gReg.isBtn          = /(Add|Edit|Mod|Delete|MoveUp|MoveDown|Move2Add|Move2Del|Force|Active|Connect|Disconnect|Create|Save|Cancel|Remove|Refresh|Query|Forces|Clear|Export|Disconnects|Reboot|Reset|Shutdown|Check|LicenseUpgrade|LicenseRefresh|Move2First|Move2Prev|Move2Next|Move2Last|Update|Move2White|Move2Whites)/;

gReg.isPercent      = /%/;
gReg.isIndex        = /index-(\d)-(\d)(-)?(\d)?/;
gReg.isJoin         = /\&/;
gReg.isPipe         = /\|/;
gReg.isSemicolon    = /;/;
gReg.isDash         = /-/;
gReg.isComma        = /,/;
gReg.isDelimiter    = / |\s|\/|-/g;
gReg.isBracket      = / |\s]?\(.*\)/;
gReg.isUnder        = /_/;
gReg.isDot          = /\./;
gReg.isSymbol       = /,|-|;/;
gReg.isRefresh      = /Refresh/;
gReg.isSelect       = /selectCol/;
gReg.isRadio        = /radioCol/;
gReg.isCheckbox     = /checkboxCol/;
gReg.isTooltip      = /tooltipCol/;
gReg.isIPAlias      = /^\d.*\d$/;
gReg.isBlur         = /(lan|ports|vlan_interfaces|staticipT)-(address|ip|netmask)/;
gReg.isQuery        = /query-(severity|facility|startDate|endDate|srcIp|dstIp|srcUsr|dstUsr|aggregateBy)/;
gReg.isDomain       = /.*\.\w{2,4}$/;
gReg.isName         = /^[\w\.-]+$/;
gReg.isEmail        = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/;
gReg.isIP3          = /^\d+\.\d+\.\d+\./;
gReg.isRegistration = /^[\w\.\@\-\_ ]+$/;
gReg.isPassword     = /^[\w\.\@\-\_]+$/;
gReg.isZipCode      = /^[0-9a-zA-Z]{1,10}$/;
gReg.isTrialCode    = /^[0-9a-zA-Z-]$/;
gReg.isIPv4         = /\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/;
gReg.isIPAddr       = /\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b\/\d{0,2}/;
gReg.isMAC          = /^[0-9a-fA-F]{2}\:[0-9a-fA-F]{2}\:[0-9a-fA-F]{2}\:[0-9a-fA-F]{2}\:[0-9a-fA-F]{2}\:[0-9a-fA-F]{2}$/;
gReg.isCMAC         = /cMAC|macInput/;
gReg.isSize         = /Size/;
gReg.isUtil         = /Utilization/;
gReg.isDate         = /^(\d){4}\/(\d){2}\/(\d){2}$/;
gReg.isHide         = /^\/0$/;
gReg.isMulti        = /\\n|\n/g;
gReg.isEnd          = /--END--/;
gReg.isNA           = /^NA$/;
gReg.isURL          = /[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/;
gReg.isXML          = /\.xml$/i;

gReg.isNumeric      = /trafficAmount|sessions|tx|rx|accessCount|virusCount|firewallCount|virusHitCount|hitCount/;
gReg.isIPAddress    = /srcIp|dstIp/;

// yui chart 
gObj.chart = {};

// for gid & name
gCache.list     = {};
gCache.thisNo   = 0;
gCache.wanProto = {};
gCache.wanId    = 0;
gCache.uniq     = {};
gCache.tabber   = {};
gCache.dstIpId  = {};
gCache.ipAlias  = {};
gCache.ipCheck  = {};
gCache.ipName   = {};
gCache.type     = {};
gCache.address  = {};
gCache.service  = {};
gCache.schedule  = {};
gCache.name      = {};
gCache.sID       = "";
gCache.pID       = "";
gCache.loadline  = [];
gCache.loadCount = 0;
gCache.facility  = {};
gCache.vlanType  = {};
gCache.portType  = {};
// func

// html template 
gHtml.aMenu     = '<span id="activedMenu"></span>';
gHtml.pgSave    = '<button id="pgSave" class="Save" title="Save"><span class="ui-icon"></span></button>';
gHtml.pgCancel  = '<button id="pgCancel" class="Cancel" title="Cancel"><span class="ui-icon"></span></button>';
gHtml.pgCheck   = '<button id="pgCheck" class="CheckSMTP" title="Check SMTP"><span class="ui-icon"></span></button>';
gHtml.pgExtend  = '<button id="pgExtend" class="Extend" title="Extend"><span class="ui-icon"></span></button>';
gHtml.pgClear   = '<button id="pgClear" class="Clear" title="Clear"><span class="ui-icon"></span></button>';
gHtml.pgExport  = '<button id="pgExport" class="Export" title="Export"><span class="ui-icon"></span></button>';
gHtml.pgExport2 = '<button id="pgExport2" class="Export" title="Export"><span class="ui-icon"></span></button>';
gHtml.pgImport  = '<button id="pgImport" class="Import" title="Import"><span class="ui-icon"></span></button>';
gHtml.pgColumns = '<button id="pgColumns" class="Columns" title="Columns"><span class="ui-icon"></span></button>';
gHtml.pgRun     = '<button id="pgRun" class="Run" title="Run"><span class="ui-icon"></span></button>';
gHtml.pgClean   = '<button id="pgClean" class="Clean" title="Clean"><span class="ui-icon"></span></button>';
gHtml.pgStart   = '<button id="pgStart" class="Start" title="Start"><span class="ui-icon"></span></button>';
gHtml.pgStop    = '<button id="pgStop" class="Stop" title="Stop"><span class="ui-icon"></span></button>';
gHtml.html;
gHtml.help;

gHtml.layout =  '<div id="outline">';
gHtml.layout +=   '<div id="layout">';
gHtml.layout +=     '<div id="hd"></div>';
gHtml.layout +=     '<div id="bd"></div>';
gHtml.layout +=     '<div id="ft"></div>';
gHtml.layout +=   '</div>';
gHtml.layout +=   '<div class="modals">';
gHtml.layout +=     '<div id="divSec">';
gHtml.layout +=       '<div class="titleA" ></div>';
gHtml.layout +=       '<div class="numbers" id="dsec" ></div>';
gHtml.layout +=       '<div class="lineH" ></div>';
gHtml.layout +=       '<div class="titleB" ></div>';
gHtml.layout +=       '</div>';
gHtml.layout +=     '</div>';
gHtml.layout +=   '</div>';
gHtml.layout += '</div>';

gHtml.head = '<div class="content">';
gHtml.head += '<div id="hd_top"></div>';
gHtml.head += '<div id="hd_mark"></div>';
gHtml.head += '<div id="hd_label"></div>';
gHtml.head += '<div id="hd_blinkD"></div>';
gHtml.head += '<div id="hd_blinkL"></div>';
gHtml.head += '<div id="hd_blinkU"></div>';
//gHtml.head += '<div id="hd_blinkE"></div>';
//gHtml.head += '<div id="hd_blinkH"></div>';
//gHtml.head += '<div id="hd_blinkI"></div>';
//gHtml.head += '<div id="hd_blinkA"></div>';
gHtml.head += '<div id="hd_user"></div>';
gHtml.head += '<div id="hd_timer"></div>';
gHtml.head += '<div id="hd_ip"></div>';
gHtml.head += '<div id="hd_timeout"></div>';
gHtml.head += '<div id="hd_config"></div>';
gHtml.head += '<div id="hd_help"></div>';
gHtml.head += '<div id="hd_home"></div>';
gHtml.head += '<div id="hd_refresh"></div>';
gHtml.head += '<div id="hd_logout"></div>';
gHtml.head += '</div>';

gHtml.body = '<div class="content">';
gHtml.body += '<div id="menu"></div>';
gHtml.body += '<div id="main">';
gHtml.body += '<div id="main_hd"></div>';
gHtml.body += '<div id="main_bd"></div>';
gHtml.body += '<div id="main_ft"></div>';
gHtml.body += '</div>';
gHtml.body += '<div id="popBase">';
gHtml.body += '<div id="popForm"></div>';
gHtml.body += '<div id="popPlus"></div>';
gHtml.body += '<div id="popMore"></div>';
gHtml.body += '<div id="popError"></div>';
gHtml.body += '</div>';
gHtml.body += '</div>';

gHtml.foot = '<div class="content"></div>';

gHtml.dashboard = '<div id="template-dashboard" class="templateDiv">' ;
gHtml.dashboard += '<div id="yui-main">';
gHtml.dashboard += '<div class="yui-b">';
gHtml.dashboard += '<div class="yui-g">';
gHtml.dashboard += '<div id="play">';
gHtml.dashboard += '<ul class="list" id="list1"></ul>';
gHtml.dashboard += '<ul class="list" id="list2"></ul>';
gHtml.dashboard += '</div>';
gHtml.dashboard += '</div>';
gHtml.dashboard += '</div>';
gHtml.dashboard += '</div>';
gHtml.dashboard += '<div class="yui-b">';
gHtml.dashboard += '<div id="feeds">';
gHtml.dashboard += '<ul></ul>';
gHtml.dashboard += '</div>';
gHtml.dashboard += '</div>';
gHtml.dashboard += '</div>';

gHtml.dashmenu = '<div id="dashmenu"></div>';

$(document).ready(function () {
    
    function failAlert( msg, detail ) {
        if (!$('#popError').exists() )
            $('#popBase').append('<div id="popError"></div>');

        $('#popError').html('<div class="errorForm"><p class="errorMsg"></p></div>');

        $('#popError').dialog({
            width: 300,
            height:200,
            position: "center",
            resizable: false,
            modal: true,
            title: gTerm[ gObj.lang ].failAlert,
            buttons: {
                okay: function() {
                    $( this ).dialog( "close" );
                    document.location.reload(true);
                }
            },
            open : function(event, ui) {
                $( 'a.ui-dialog-titlebar-close' ).remove();
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });

        var err;

        switch(msg)
        {
        case 'cgi_get_fail':
        case 'invalid_data_format':
        case 'please_login_first':
        case 'login_fail':
        case 'session_limit_reached':
            err = '<p>' + gError[ gObj.lang ][ msg ] + '</p>'; 
            break;
        case 'ip_blocked':
            err = '<p>' + gError[ gObj.lang ][ msg ] + '</p>';
            err += '<p>' + gError[ gObj.lang ].pleaseWait + detail + gError[ gObj.lang ].seconds + '</p>';
            break;
        default:
            err = '<p>' + gError[ gObj.lang ].unknownError + '</p>';
        }
        $('.errorMsg').html( err );
    }

    function timerRender() {
        if (gIf.session) {
            gObj.counter = new Date().toLocaleString();
            $('#hd_timer').html('<h4>' + gRef.header[ gObj.lang ].hd_timer + ' : ' + gObj.counter + '</h4>');

            if (gIf.loading)
                ifLoading();

            if (gIf.systime)
                ifSystime();

            if (gIf.progressT)
                ifProgress();

            if (gIf.delay)
                ifDelay();

            if (gIf.debug)
                ifDebugger();

            if (gIf.isStart)
                ifStart();

            if (gIf.refresh)
                ifRefresh();

            ifSessInfo();
        }
    }

    function ifLoading() {
        $('#divSec').show();
        gObj.loading--;
        $('#dsec').html( gObj.loading);
        if ( 0 === gObj.loading ) {
            gIf.loading = false;
            loadingToggle( false );
            getCgiList(gObj.active.pid);
        }
    }

    function ifSystime() {
        $.ajax({
            url: 'cgi-bin/getSystime.cgi',
            dataType: 'json',
            success: function(data) {
                if ($('#systime').exists())
                    $('#systime').html(data.systime);
            }
        });
    }

    function ifProgress() {
        $.ajax({
            url: 'cgi-bin/common_progress_list.cgi',
            dataType: 'json',
            success: function(data) {
                for (var i=0, len=data.progressT.length; i<len; i++)
                {
                    if ( gObj.progress == data.progressT[ i ].name) {
                        $('.errorMsg').html( data.progressT[ i ].statusMsg );
                        $('.processDiv').progressbar({ value: parseInt( data.progressT[ i ].percent ) });
                        if ( 100 === parseInt( data.progressT[ i ].percent ) ) {
                            loadingToggle( false );
                            gIf.progressT = false;
                            gObj.progress = '';
                        }
                    }
                }
            }
        });
    }

    function ifDelay() {
        if (0 === gObj.delay) {
             gIf.delay = false;
             loadingToggle( false );
             getCgiList(gObj.active.pid);
        } else 
             gObj.delay--;
    }

    function ifDebugger() {
        if (gIf.log) {
            if (gIf.pcap) {
                switch( gObj.blinking )
                {
                case 0:
                    gIf.isNext = false;
                    break;
                case 2:
                //case 3:
                    gIf.isNext = true;
                    break;
                }

                for (var i=0, len=gObj.blinkings.length; i<len; i++)
                {
                    if (i === gObj.blinking)
                        $('#hd_blink' + gObj.blinkings[ i ]).show().animate({opacity:0}, 'slow', function(){ $(this).animate({opacity:1})});
                    else
                        $('#hd_blink' + gObj.blinkings[ i ]).hide();
                }

                if (gIf.isNext) 
                    gObj.blinking--;
                else
                    gObj.blinking++;
            } else {
                if (0 === gObj.blinking ) 
                    gObj.blinking = 2;
                    //gObj.blinking = 3;
                else
                    gObj.blinking--;

                for (var i=0, len=gObj.blinkings.length; i<len; i++)
                {
                    if (i === gObj.blinking)
                        $('#hd_blink' + gObj.blinkings[ i ]).show().animate({opacity:0}, 'slow', function(){ $(this).animate({opacity:1})});
                    else
                        $('#hd_blink' + gObj.blinkings[ i ]).hide();
                }
            }
        } else {
            if (gIf.pcap) {
                if (2 === gObj.blinking ) 
                //if (3 === gObj.blinking ) 
                    gObj.blinking = 0;
                else
                    gObj.blinking++;

                for (var i=0, len=gObj.blinkings.length; i<len; i++)
                {
                    if (i === gObj.blinking)
                        $('#hd_blink' + gObj.blinkings[ i ]).show().animate({opacity:0}, 'slow', function(){ $(this).animate({opacity:1})});
                    else
                        $('#hd_blink' + gObj.blinkings[ i ]).hide();
                }
            } else {
                $('#hd_blink' + gObj.blinkings[ gObj.blinking ]).hide();
                gObj.blinking = 0;
                gIf.debug = false;
            }
        }
    }

    function ifRefresh() {
        if ( 0 === gObj.active.counting ) {
            gIf.getSessInfo = true;
            gObj.active.counting = gObj.active.refresh;
            switch( gObj.active.pid )
            {
            case 'system_dashboard':
            case 'network_dashboard':
            case 'security_dashboard':
                refreshDashboard();
                break;
            case 'show_arp_table':
            case 'show_routing_table':
            case 'dhcp_bindings':
            case 'status_summary':
            case 'traffic_statistics':
            case 'nat_status':
            case 'active_users':
            case 'ipsec_vpn_statistics':
            case 'traffic_direction':
            case 'source_report':
            case 'destination_report':
            case 'file_extension':
            case 'blocked_host':
            case 'affected_host':
            case 'antivirus_report':
                refreshReports( gObj.active.pid );
                break;
            case 'active_sessions':
                if (gIf.progressT || gIf.delay) 
                    gIf.getSessInfo = false;
                else 
                    refreshReports( gObj.active.pid );
                break;
            case 'wan_bandwidth_report':
            case 'resource_utilization':
                refreshCharts( gObj.active.pid );
                break;
            default:
                cgiRefresh( gObj.active.pid );
            }
        } else {
            if (gIf.ajaxed) 
                gObj.active.counting--;
        }
    }

    function ifStart() {
        $.ajax({
            url: 'cgi-bin/' + gNode.url.get + '.cgi',
            dataType: 'json',
            success: function(data) {
                var arr;

                switch( gNode.tab )
                {
                case 'ping':
                case 'traceroute':
                    arr = data.result.split( gReg.isMulti );
                    if ( gReg.isEnd.test( data.result ) ) 
                        gIf.isStart = false;
                    break;
                case 'dns_lookup':
                    arr = data.queryResult.split( gReg.isMulti );
                    if ( data.queryResult.length > 0 )
                        gIf.isStart = false;
                    break;
                }
                    
                $('.resultDiv ul').empty();
                for (var i=0, len=arr.length; i<len; i++)
                {
                    $('.resultDiv ul').append('<li>' + arr[ i ] + '</li>');
                }
            }
        });
    }

    function ifSessInfo() {
        if (gIf.getSessInfo) {
            // get current systime & trigger idle recount
            $.ajax({
                url: 'cgi-bin/getSystime.cgi',
                dataType: 'json',
                success: function(data) {
                    gObj.sysTime = new Date( data.systime );
                    gObj.sysHour = gObj.sysTime.getHours();
                    // refresh idle/force timeout
                    $.ajax({
                        url:'cgi-bin/getSessInfo.cgi', 
                        dataType:'json', 
                        success:function(data) {
                            if (data.errormsg) {
                                gIf.session = false;
                                failAlert( data.errormsg, data.detail );
                            }else {
                                gObj.idleOut = data.timeout;
                                gObj.forceOut = data.forcetimeout;
                                if (gIf.limited) {
                                    if (0 === parseInt(data.forcetimeout)) {
                                        gIf.session = false;
                                        if (gIf.reboot) 
                                            document.location.reload(true);
                                        else 
                                            failAlert( 'session_limit_reached' );
                                    }
                                    $('#hd_timeout').html('<h4>' + gRef.header[ gObj.lang ].hd_force + ' : ' + data.forcetimeout + '</h4>');
                                } else {
                                    if (0 === parseInt(data.timeout)) {
                                        gIf.session = false;
                                        if (gIf.reboot) 
                                            document.location.reload(true);
                                        else 
                                            failAlert( 'session_limit_reached' );
                                    }
                                    $('#hd_timeout').html('<h4>' + gRef.header[ gObj.lang ].hd_idle + ' : ' + data.timeout + '</h4>');
                                }
                                // sync once in need and back to client count
                                gIf.getSessInfo = false;
                            }
                        }
                    });
                }
            });
        } else {
            gObj.idleOut--;
            if (gIf.limited) {
                gObj.forceOut--;
                $('#hd_timeout').html('<h4>' + gRef.header[ gObj.lang ].hd_force + ' : ' + gObj.forceOut + '</h4>');
                if (0 === parseInt(gObj.forceOut)) {
                    gIf.session = false;
                    if (gIf.reboot) 
                        document.location.reload(true);
                    else 
                        failAlert( 'session_limit_reached' );
                }
            } else {
                $('#hd_timeout').html('<h4>' + gRef.header[ gObj.lang ].hd_idle + ' : ' + gObj.idleOut + '</h4>');
                if (0 === parseInt(gObj.idleOut)) {
                    gIf.session = false;
                    if (gIf.reboot) 
                        document.location.reload(true);
                    else 
                        failAlert( 'session_limit_reached' );
                }
            }
        }
    }

    function timerStart() {
        gObj.timer = setInterval(function(){ timerRender() }, 1000);    
    }

    function timerStop() {
        clearInterval(gObj.timer);
    }
    
    jQuery.fn.exists = function() {
        return this.length > 0;
    }
    
    function ifLogin() {
        // login label
        $('#login_label').html( gCook.main + '<span>&reg;</span>');
    
        // detect if lang set
        if (gY.Cookie.getSub( gCook.main, 'lang' )) {
            gObj.lang = gY.Cookie.getSub( gCook.main, 'lang' );
        }else {
            gObj.lang = 'en';
        }

        // check if still session
        if (gY.Cookie.getSub( gCook.main, 'username' )) {
            // logout first before login
            gObj.form = {};
            gObj.form.username = gY.Cookie.getSub( gCook.main, 'username' );
            gY.Cookie.remove( gCook.main );
            $.post('cgi-bin/logout.cgi', gY.JSON.stringify(gObj.form));
        }

        $('#userNameLabel').html( gLogin[ gObj.lang ].userName + ' : ' );
        $('#userPassLabel').html( gLogin[ gObj.lang ].userPass + ' : ' );
        $('#userLangLabel').html( gLogin[ gObj.lang ].userLang + ' : ' );
        $('#loginButton').html( '<b>' + gLogin[ gObj.lang ].loginButton + '</b>' );

        if (gIf.multi) {
            $('#userLang').append('<option value="tw">繁體中文</option>');
            $('#userLang').append('<option value="cn">简体中文</option>');
            $('#userLang').val(gObj.lang);
        }

        // listen to lang
        $('#userLang').change( function() {
            $('#userNameLabel').html( gLogin[ $(this).val() ].userName + ' : ');
            $('#userPassLabel').html( gLogin[ $(this).val() ].userPass + ' : ');
            $('#userLangLabel').html( gLogin[ $(this).val() ].userLang + ' : ');
            $('#loginButton').html( '<b>' + gLogin[ $(this).val() ].loginButton + '</b>' );
        });
    
        $('#loginButton').addClass('yui3-button');
        $('#loginButton').on('click', function(e) {
            e.preventDefault();
    
            // get lang for relative msg
            gObj.lang = $('#userLang').val();
            gObj.user = $('#userName').val();
            gObj.pass = $('#userPass').val();

            if (!gReg.ascii.login.test($('#userName').val()) || !gReg.ascii.login.test($('#userPass').val())) {
                failAlert('login_fail');
                return false;
            }
    
            gObj.form = {};
            gObj.form.username = gObj.user;
            gObj.form.password = gObj.pass;
            gObj.form.language = gObj.lang;
    
            $.post('cgi-bin/login.cgi', gY.JSON.stringify(gObj.form), function(data) {
                if (data.servermsg == 'login_success') {
                    $.ajax({
                        url:'cgi-bin/adminsetting.cgi', 
                        dataType:'json', 
                        success:function(data) {
                            // if force logout countdown 
                            if (parseInt(data.loginSessionLimitEnable) == 1)
                                gIf.limited = true;
                            gObj.adminName = data.adminName;
                        }
                    }).done( function() {
                        $.ajax({
                            url:'lang/' + gObj.lang + '-reference.txt',
                            dataType:'json',
                            success:function(data) {
                                // referece by lang 
                                gRef = data;
    
                                // header info by lang 
                                $.ajax({
                                    url:'lang/header.txt', 
                                    dataType:'json', 
                                    success:function(data) {
                                        gRef.header = data;
                                    }
                                });
    
                                // country info by lang 
                                $.ajax({
                                    url:'lang/' + gObj.lang + '-country.txt', 
                                    dataType:'json', 
                                    success:function(data) {
                                        gRef.country = data;
                                    }
                                });
    
                                // systime info by lang 
                                $.ajax({
                                    url:'lang/' + gObj.lang + '-systime.txt', 
                                    dataType:'json', 
                                    success:function(data) {
                                        gRef.systime = data;
                                    }
                                });
    
                                // html tmpl 
                                $.ajax({
                                    url:'lang/tmpl.txt',
                                    dataType:'json',
                                    success:function(data) {
                                        gTmpl = data;
                                    }
                                });
    
                                // cgi json string tmpl 
                                $.ajax({
                                    url:'lang/json.txt',
                                    dataType:'json',
                                    success:function(data) {
                                        gJson = data;
                                    }
                                });
    
                                // limitation by function 
                                $.ajax({
                                    url:'lang/limit.txt', 
                                    dataType:'json', 
                                    success:function(data) {
                                        gLimit = data;
                                    }
                                });
    
                                // mime option for av mime 
                                $.ajax({
                                    url:'lang/' + gObj.lang + '-mime.txt', 
                                    dataType:'json', 
                                    success:function(data) {
                                        gRef.mime = data;
                                    }
                                });

                                // protocol doc 
                                $.ajax({
                                    url:'lang/en-protocol.txt',
                                    dataType:'json',
                                    success:function(data) {
                                        gRef.protocol = {};
                                        for (var i=0,len=data.length; i<len; i++)
                                            gRef.protocol[ data[ i ].key ] = data[ i ].value;
                                    }
                                });

                                // online help
                                $.ajax({
                                    url:'lang/' + gObj.lang + '-docs.txt', 
                                    dataType:'json', 
                                    success:function(data) {
                                        gRef.docs = data;
                                    }
                                });
                            }
                        }).done( function() {
                            $.ajax({
                                url:'cgi-bin/multiwan.cgi',
                                dataType:'json',
                                success:function(data) {
                                    // routing mode 
                                    gIf.rtMode = (parseInt(data.mode) == 1)? true : false;
                                }
                            }).done( function() {
                                $.ajax({
                                    url:'cgi-bin/av_sig.cgi',
                                    dataType:'json',
                                    success:function(data) {
                                        // check av sig version
                                        
                                        gObj.sigVer = Number( ( isNaN( parseFloat( data.version ) )? 0 : parseFloat( data.version ) ) + ( ( isNaN( parseFloat( data.md5Version ) )? 1 : parseFloat( data.md5Version ) ) - 1) ).toFixed(3) ;
                                    }
                                }).done( function() {
                                    $.post('cgi-bin/dev_firmware_post.cgi', gY.JSON.stringify({"action" : 3 }), function(poster) {
                                        // check server firmware
                                        if (0 === parseInt( poster.status ) && 'success' == poster.msg)
                                            gIf.newFirmware = true;
                                    }).done( function() {
                                        $.ajax({
                                            url:'cgi-bin/config_profile_list_v2.cgi', 
                                            dataType:'json', 
                                            success:function(data) {
                                                for (var i=0, len=data.guiProfileTNum; i<len; i++)
                                                {
                                                    if (1 === parseInt( data.guiProfileT[ i ].inUsed ))
                                                        gObj.config = data.guiProfileT[ i ].name;
                                                }
                                            }
                                        }).done( function() {
                                            $.ajax({
                                                url:'cgi-bin/advancedDebug.cgi', 
                                                dataType:'json', 
                                                success:function(data) {
                                                    if (1 === parseInt( data.logEnable )) {
                                                        gIf.log = true;
                                                        gIf.debug = true;
                                                    }
                                                    
                                                    if (1 === parseInt( data.pcapEnable )) {
                                                        gIf.pcap = true;
                                                        gIf.debug = true;
                                                    }
                                                }
                                            }).done( function() {
                                                $.ajax({
                                                    url:'cgi-bin/getSessInfo.cgi', 
                                                    dataType:'json', 
                                                    success:function(data) {
                                                        gRef.menu = 'lang/' + gObj.lang + '-menu.txt';
                                                        gIf.session = true;
                                                        gIf.getSessInfo = true;
                                                        gObj.userIp = data.ipAddr;
                                                        gIf.power  = (3 === parseInt( data.privilege ))? true : false;
                                                        gY.Cookie.setSub( gCook.main, 'username', gObj.user );
                                                        gY.Cookie.setSub( gCook.main, 'lang', gObj.lang );
                                                        isLogin();
                                                    }
                                                });
                                            });
                                        });
                                    });
                                });
                            });
                        });
                    });
                }else  {
                    if (data.errormsg) 
                        failAlert( data.errormsg, data.detail);
                    else 
                        failAlert( data.servermsg);
                }
            });
        });
    
        $(document).bind('keyup', function(e) {
            e.preventDefault();
            gIf.getSessInfo = true; 
            switch( parseInt( e.keyCode ) )
            {
            case 13 :
                if ($('#loginButton').exists())
                    $('#loginButton').click();
                else {
                    if ($(':button:contains("okay")').exists())
                        $(':button:contains("okay")').click();
                    else if ($(':button:contains("ok")').exists())
                        $(':button:contains("ok")').click();
                    else if ($(':button:contains("Ok")').exists())
                        $(':button:contains("Ok")').click();
                    else if ($(':button:contains("OK")').exists())
                        $(':button:contains("OK")').click();
                }
                break;
            case 32:
                switch( $( document.activeElement ).attr('type') )
                {
                case 'checkbox':
                case 'radio':
                    $( document.activeElement ).click();
                    break;
                }
                break;
            } 
        });

        // select change, deal only create object
        // input event to refresh idle timeout
        $('select').live('change', function(e) {
            e.preventDefault();
            gIf.getSessInfo = true; 
            switch($(this).val())
            {
            case 'cMAC':
            case 'cAddr':
            case 'cGAddr':
            case 'cService':
            case 'cGService':
            case 'cSchedule':
                createSelector(e);
                break;
            default:
                switch($(this).attr('id'))
                {
                case 'refreshPage':
                    if (0 === parseInt( $('#refreshPage').val() )) {
                        gIf.refresh = false;
                    } else {
                        gIf.refresh = true;
                        gObj.active.refresh  = parseInt( $('#refreshPage').val() );
                        gObj.active.counting = gObj.active.refresh;
                    }
                    break;
                }
                break;
            }
        });
    
        // button click, tell by btnCtrl
        // input event to refresh idle timeout
        $('button').live('click', function(e) {
            e.preventDefault();
            gIf.getSessInfo = true; 
            btnCtrl( e );
        });
    
        // input event to refresh idle timeout
        $('input:radio').live('click', function(e) {
            gIf.getSessInfo = true; 
        });
    
        // input event to refresh idle timeout
        $('input:checkbox').live('click', function(e) {
            gIf.getSessInfo = true; 
            var tar = {};
            
            tar.id = $(e.currentTarget).attr('id');
            tar.class = $(e.currentTarget).attr('class');
            switch( tar.class )
            {
            case 'blacklistCheckbox':
                if ($(this).is(':checked'))
                    gCheckbox.blacklist[ tar.id ] = true;
                else 
                    gCheckbox.blacklist[ tar.id ] = false;
                $('#blacklist_all').attr('checked', false);
                break;
            case 'whitelistCheckbox':
                if ($(this).is(':checked'))
                    gCheckbox.whitelist[ tar.id ] = true;
                else 
                    gCheckbox.whitelist[ tar.id ] = false;
                $('#whitelist_all').attr('checked', false);
                break;
            case 'backup_restoreCheckbox':
                if ($(this).is(':checked'))
                    gCheckbox.backup_restore[ tar.id ] = true;
                else 
                    gCheckbox.backup_restore[ tar.id ] = false;
                $('#backup_restore_all').attr('checked', false);
                break;
            case 'packet_captureCheckbox':
                if ($(this).is(':checked'))
                    gCheckbox.packet_capture[ tar.id ] = true;
                else 
                    gCheckbox.packet_capture[ tar.id ] = false;
                $('#packet_capture_all').attr('checked', false);
                break;
            case 'logCheckbox':
                if ($(this).is(':checked'))
                    gCheckbox.log[ tar.id ] = true;
                else 
                    gCheckbox.log[ tar.id ] = false;
                $('#log_all').attr('checked', false);
                break;
            case 'debugCheckbox':
                if ($(this).is(':checked'))
                    gCheckbox.debug[ tar.id ] = true;
                else 
                    gCheckbox.debug[ tar.id ] = false;
                $('#debug_all').attr('checked', false);
                break;
            default: 
                switch( tar.id )
                {
                case 'blacklist_all':
                    if ($(this).is(':checked')) {
                        $('#table-blacklist > tbody tr').each( function() {
                            $(this).find('td:eq(0) input:checkbox').attr('checked', true);
                            gCheckbox.blacklist[ $(this).find('td:eq(0) input:checkbox').attr('id') ] = true;
                        });
                    } else {
                        for (var x in gCheckbox.blacklist)
                        {
                            $('#' + x).attr('checked', false);
                        }
                        gCheckbox.blacklist = {};
                    }
                    break;
                case 'whitelist_all':
                    if ($(this).is(':checked')) {
                        $('#table-whitelist > tbody tr').each( function() {
                            $(this).find('td:eq(0) input:checkbox').attr('checked', true);
                            gCheckbox.whitelist[ $(this).find('td:eq(0) input:checkbox').attr('id') ] = true;
                        });
                    } else {
                        for (var x in gCheckbox.whitelist)
                        {
                            $('#' + x).attr('checked', false);
                        }
                        gCheckbox.whitelist = {};
                    }
                    break;
                case 'backup_restore_all':
                    if ($(this).is(':checked')) {
                        $('#table-backup_restore > tbody tr').each( function() {
                            $(this).find('td:eq(0) input:checkbox').attr('checked', true);
                            gCheckbox.backup_restore[ $(this).find('td:eq(0) input:checkbox').attr('id') ] = true;
                        });
                    } else {
                        for (var x in gCheckbox.backup_restore)
                        {
                            $('#' + x).attr('checked', false);
                        }
                        gCheckbox.backup_restore = {};
                    }
                    break;
                case 'packet_capture_all':
                    if ($(this).is(':checked')) {
                        $('#table-packet_capture > tbody tr').each( function() {
                            $(this).find('td:eq(0) input:checkbox').attr('checked', true);
                            gCheckbox.packet_capture[ $(this).find('td:eq(0) input:checkbox').attr('id') ] = true;
                        });
                    } else {
                        for (var x in gCheckbox.packet_capture)
                        {
                            $('#' + x).attr('checked', false);
                        }
                        gCheckbox.packet_caputre = {};
                    }
                    break;
                case 'log_all':
                    if ($(this).is(':checked')) {
                        $('#table-log_list > tbody tr').each( function() {
                            $(this).find('td:eq(0) input:checkbox').attr('checked', true);
                            gCheckbox.log[ $(this).find('td:eq(0) input:checkbox').attr('id') ] = true;
                        });
                    } else {
                        for (var x in gCheckbox.log)
                        {
                            $('#' + x).attr('checked', false);
                        }
                        gCheckbox.log = {};
                    }
                    break;
                case 'debug_all':
                    if ($(this).is(':checked')) {
                        $('#table-debug_list > tbody tr').each( function() {
                            $(this).find('td:eq(0) input:checkbox').attr('checked', true);
                            gCheckbox.debug[ $(this).find('td:eq(0) input:checkbox').attr('id') ] = true;
                        });
                    } else {
                        for (var x in gCheckbox.debug)
                        {
                            $('#' + x).attr('checked', false);
                        }
                        gCheckbox.debug = {};
                    }
                    break;
                }
            }
        });
    
        // achor click, for menu & accordions
        // input event to refresh idle timeout
        $('a').live('click', function(e) {
            e.preventDefault();
        });
    
        // img click, for dashboard
        // input event to refresh idle timeout
        $('img').live('click', function(e) {
            e.preventDefault();
        });
    
        $('div.sortable').live('click', function(e) {
            e.preventDefault();
            gIf.getSessInfo = true; 
            var tar = {};
            tar.ids = $(e.currentTarget).attr('id').split('-');
            tar.id = tar.ids[ tar.ids.length - 1 ];

            var span = $(this).children('span.sortable');
            var spans = gY.one(this).ancestor('table thead').all('span.sortable');

            if (span.hasClass('ascending')) {
                span.removeClass('ascending');
                span.addClass('descending');
            } else if (span.hasClass('descending')) {
                span.removeClass('descending');
                span.addClass('ascending');
            } else {
                spans.removeClass('ascending');
                spans.removeClass('descending');
                span.addClass('ascending');
            }

            switch( gObj.active.pid )
            {
            case 'system_dashboard':
            case 'network_dashboard':
            case 'security_dashboard':
                refreshDashboard( tar.ids[ 1 ], tar.id );
                break;
            case 'status_summary':
            case 'traffic_statistics':
                refreshReports( tar.ids[ 2 ] );
                break;
            case 'show_arp_table':
            case 'show_routing_table':
            case 'dhcp_bindings':
            case 'nat_status':
            case 'active_users':
            case 'active_sessions':
            case 'ipsec_vpn_statistics':
                refreshReports( tar.ids[ 1 ] );
                break;
            case 'traffic_direction':
            case 'source_report':
            case 'destination_report':
            case 'file_extension':
            case 'blocked_host':
            case 'affected_host':
            case 'antivirus_report':
                refreshReports( tar.ids[ 1 ] );
                break;
            }
        })

        $('#userName').focus();
    }
    
    function isLogin() {
    
        // draw layout 
        $('body').html( gHtml.layout );
    
        // draw main head 
        $('#hd').html( gHtml.head );
    
        // assign lang icon
        $('#hd_label').html( gCook.main + '<span>&reg;</span>');
        $('#hd_help').addClass( gObj.lang + '_help' );
        $('#hd_home').addClass( gObj.lang + '_home' );
        $('#hd_refresh').addClass( gObj.lang + '_refresh' );
        $('#hd_logout').addClass( gObj.lang + '_logout' );

        $('#hd_logout').on('click', function(e) {
            e.preventDefault();
            gObj.form = {};
            gObj.form.username = gObj.user;
            $.post('cgi-bin/logout.cgi', gY.JSON.stringify(gObj.form), function(poster) {
                document.location.reload(true);
            });
        });
    
        $('#hd_home').on('click', function(e) {
            e.preventDefault();
            // trigger system_dashboard as default
            $('#system_dashboard h4').click();
        });
    
        $('#hd_refresh').on('click', function(e) {
            e.preventDefault();
            getCgiList(gObj.active.pid);
        });
    
        // online help pop
        $('#hd_help').on('click', function(e) {
            e.preventDefault();
            helpPop();
        });

        $('#hd_user').html('<h4>' + gRef.header[ gObj.lang ].hd_user + ' : ' + gObj.user + '</h4>');
        $('#hd_ip').html('<h4>' + gRef.header[ gObj.lang ].hd_ip + ' : ' + gObj.userIp + '</h4>');
        $('#hd_config').html('<h4>' + gRef.header[ gObj.lang ].hd_config + ' : ' + gObj.config + '</h4>');
    
        // draw main body 
        $('#bd').html( gHtml.body );
        // menu
        // bd loaded 
        $.ajax({
            url:gRef.menu, 
            dataType:'json', 
            scriptCharset: 'utf-8',
            contentType: 'application/json; charset=utf-8',
            success:function(data) {
                gObj.menu = data.menu;
                gObj.active = {};
                gObj.actived = {};
                gObj.active.index  = null;
                gObj.active.h3Arr  = [];
                gObj.active.h4Arr  = [];
                gHtml.html = '<ul class="accordion-ul">';

                for (var i=0, ilen=gObj.menu.length; i<ilen; i++) {
                    gObj.active.h3Arr.push(gObj.menu[i].tab);
                    gHtml.html += '<li id="'+gObj.menu[i].tab+'" class="accordion-ul-li"><h3><a href="#">'+gObj.menu[i].label+'</a></h3>';
                     
                    if  (gObj.menu[i].panel) {
                        gHtml.html += '<ul class="accordion-ul-ul">';
                        for (var j=0, jlen= gObj.menu[i].panel.length; j<jlen; j++) {
                            if ('object' == typeof(gObj.menu[i].panel[j].panel) ) {
                                // h5 
                                gObj.active.h4Arr.push(gObj.menu[i].panel[j].tab);
                                gHtml.html += '<ul class="accordion-ul-ul-ul">';
                                gHtml.html += '<li id="'+gObj.menu[i].panel[j].tab+'" class="accordion-ul-ul-ul-li"><h4><a href="#">'+gObj.menu[i].panel[j].label+'</a></h4>';
                                gHtml.html += '<ul class="accordion-ul-ul-ul-ul">';
                                for (var k=0, klen= gObj.menu[i].panel[j].panel.length; k<klen; k++) 
                                {
                                    gHtml.html += '<li id="'+gObj.menu[i].panel[j].panel[k].tab+'" class="accordion-ul-ul-ul-ul-li index-'+i+'-'+j+'-'+k+'"><h5><a href="#">'+gObj.menu[i].panel[j].panel[k].label+'</a></h5></li>';
                                }
                                gHtml.html += '</ul>';
                                gHtml.html += '</li>';
                                gHtml.html += '</ul>';
                            } else {
                                // h4 
                                gHtml.html += '<li id="'+gObj.menu[i].panel[j].tab+'" class="accordion-ul-ul-li index-'+i+'-'+j+'"><h4><a href="#">'+gObj.menu[i].panel[j].label+'</a></h4></li>';
                            }
                        }
                        gHtml.html += '</ul>';
                    }
                    gHtml.html += '</li>';
                }
                gHtml.html += '</ul>';
        
                $('#menu').html(gHtml.html);
        
                $('.accordion-ul').accordion({
                    collapsible:true, 
                    autoHeight: false
                });
        
                $('.accordion-ul-ul-ul').accordion({
                    collapsible:true, 
                    active:false, 
                    autoHeight: false
                });
        
                $('.accordion-ul-ul-li h4').on('click', function(e) {
                    if (gReg.isIndex.test($(this).parents('li').attr('class'))) {
                        gIf.getSessInfo = true; 
                        gIf.refresh = true;
                        gObj.actived = gObj.active;
                        gObj.active = {};
                        gObj.active.h3Index = RegExp.$1;
                        gObj.active.h4Index = RegExp.$2;
                        gObj.active.h5Index = "NA";
                        gObj.active.icon = $(this);
                        gObj.active.pid     = $(this).parents('li').attr('id');
                        gObj.active.target  = $(this);
                        gObj.active.menu    = '<h3>';
                        gObj.active.menu    += '<b>'+gObj.menu[gObj.active.h3Index].label+'</b> > <b>'+gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index].label+'</b>';
                        if ( gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].refresh ) {
                            gObj.active.menu += '<span class="refreshPage">Refresh Page: <select id="refreshPage"></select></span>';
                            if ($('#refreshPage').exists())
                                gObj.active.refresh = $('#refreshPage').val();
                            else  
                                gObj.active.refresh = gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].refresh;
                        } else {
                            gIf.refresh = false;
                        }

                        if ( gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].columns ) {
                            gObj.active.menu += gHtml.pgColumns;
                        }

                        gObj.active.menu    += '</h3>';
    
                        // navbar 
                        if (gIf.alter) {
                            alterAlert();
                        } else {
                            gObj.tabIndex = 0;
                            gIf.isStart = false; 
                            gIf.query = false;
                            gIf.ajaxed = false;
                            gIf.systime = false; 
                            gIf.columns = false;
                            gSort = {};
                            gQuery = {};
    
                            $('#main_ft').empty();
                            if (gObj.active.icon) {
                                gObj.active.icon.removeClass('ui-actived');
                                $('#activedMenu').remove();
                            } 
                            gObj.active.icon.addClass('ui-actived');
                            gObj.active.icon.prepend(gHtml.aMenu);
                            gNode = gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index];
                            $('#main_hd').html( gObj.active.menu );
                            if (gIf.refresh) {
                                $('#refreshPage').append( genSelectOption( 'refreshPage' ) ).val( gObj.active.refresh );
                                gObj.active.counting = gObj.active.refresh;
                            }
                            getCgiList(gObj.active.pid);
                        }
                    }
                });
        
                $('.accordion-ul-ul-ul-ul-li h5').on('click', function(e) {
                    if (gReg.isIndex.test($(this).parents('li').attr('class'))) {
                        gIf.getSessInfo = true; 
                        gIf.refresh = true;
                        gObj.actived = gObj.active;
                        gObj.active = {};
                        gObj.active.h3Index = RegExp.$1;
                        gObj.active.h4Index = RegExp.$2;
                        gObj.active.h5Index = RegExp.$4;
                        gObj.active.icon    = $(this);
                        gObj.active.pid     = $(this).parents('li').attr('id');
                        gObj.active.target  = $(this);
                        gObj.active.menu    = '<h3>';
                        gObj.active.menu    += '<b>'+gObj.menu[gObj.active.h3Index].label+'</b> > <b>'+gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index].label+'</b> > <b>'+gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index].panel[gObj.active.h5Index].label+'</b>';
                        if ( gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].refresh ) {
                            gObj.active.menu += '<span class="refreshPage">Refresh Page: <select id="refreshPage"></select></span>';
                            if ($('#refreshPage').exists())
                                gObj.active.refresh = $('#refreshPage').val();
                            else 
                                gObj.active.refresh = gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].refresh;
                        } else {
                            gIf.refresh = false;
                        }

                        if ( gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].columns ) {
                            gObj.active.menu += gHtml.pgColumns;
                        }
                        gObj.active.menu    += '</h3>';
    
                        // navbar 
                        if (gIf.alter) {
                            alterAlert();
                        } else {
                            gObj.tabIndex = 0;
                            gIf.isStart = false; 
                            gIf.systime = false; 
                            gIf.ajaxed = false;
                            gIf.query = false;
                            gIf.columns = false;
                            gSort = {};
                            gQuery = {};
                        
                            $('#main_ft').empty();
                            if (gObj.active.icon) {
                                gObj.active.icon.removeClass('ui-actived');
                                $('#activedMenu').remove();
                            }
                            gObj.active.icon.addClass('ui-actived');
                            gObj.active.icon.prepend(gHtml.aMenu);
                            gNode = gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index].panel[gObj.active.h5Index];
                            $('#main_hd').html( gObj.active.menu );
                            if (gObj.active.refresh) {
                                $('#refreshPage').append( genSelectOption( 'refreshPage' ) ).val( gObj.active.refresh );
                                gObj.active.counting = gObj.active.refresh;
                            }
                            getCgiList(gObj.active.pid);
                        }
                    }
                });
    
                // trigger system_dashboard as default
                
                $('#system_dashboard h4').click();

                // check routing 
                $.ajax({
                    url: 'cgi-bin/routing.cgi', 
                    dataType: 'json', 
                    success: function(data) {
                        gObj.routing = data;
                        gObj.routing.protoType = parseInt(gObj.routing.protoType);
                    }
                });
            }
        });
                
        $('#ft').html( gHtml.foot );
        $('#ft .content').append('<p>Copyright &copy; 2014 Titan ARC Corp.</p>');
        // $('#ft .content').append('<p>The Next Generation Technology Appliances by Tech Titan, powerd by Kaspersky</p>');
    
        // set row limits
        getLimit();

        // trigger timer
        timerStart();
    }

    function getLimit() {
        // users
        gRows.maxUserGroup = 50;
        gRows.maxUser = 1000;
        gRows.maxUserPerGroup = 100;

        // interfaces
        gRows.maxWAN = 6;
        gRows.maxPorts = 8;
        gRows.maxLAN = 32;
        gRows.maxMemberPerLAN = 16;
        gRows.maxVLAN = 128;
        gRows.maxZone = 32;
        gRows.maxMemberPerZone = 20;
        gRows.maxIPAlias = 8;
        gRows.maxIPAddress = 512;
        gRows.maxMACAddress = 512;
        gRows.maxAddress = 1024;
        gRows.maxGroupAddress = 64;
        gRows.maxMemberPerGroupAddress = 64;
        gRows.maxService = 256;
        gRows.maxGroupService = 64;
        gRows.maxMemberPerGroupService = 64;

        // networking
        gRows.maxTransformPolicy = 16;
        gRows.maxIKEPolicy = 16;
        gRows.maxIPSecPolicies = 100;

        // device
        gRows.maxProfile = 16;
        gRows.maxDebug = 400;
        gRows.maxLog = 400;
    }
    
// btn 
    function btnCtrl( e, btClass ) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');

        if (btClass)
            tar.class = btClass;
        else 
            tar.class = $(e.currentTarget).attr('class');
        if (tar.id)
            tar.pid = tar.id.split(gReg.isDash)[1];
    
        switch( tar.class )
        {
        case 'Create':
            switch( tar.pid )
            {
            case 'lan':
            case 'vlan_interfaces':
            case 'wan_settings':
            case 'zone':
                createInterface( e );
                break;
            case 'static_routing':
            case 'ipsec_policies':
            case 'ike_policy':
            case 'transform_policy':
            case 'dns_forwarder':
                createNetworking( e );
                break;
            case 'rule':
            case 'static_nat':
            case 'port_forwarding':
            case 'port_trigger':
            case 'advanced_nat':
                createFirewall( e );
                break;
            case 'address_exceptions':
            case 'mime':
            case 'file_extension':
            case 'ip_mac_binding':
                createSecurity( e );
                break;
            case 'user':
            case 'group':
                createUsers( e );
                break;
            case 'address':
            case 'group_address':
            case 'service':
            case 'group_service':
            case 'schedule':
                createObject( e );
                break;
            case 'dhcp_binding':
                createDhcpBinding( e );
                break;
            case 'ip_alias':
                createAlias( e );
                break;
            case 'backup_restore':
                createDevice( e );
                break;
            }
            break;
        case 'Duplicate':
            switch( tar.pid )
            {
            case 'user':
            case 'group':
                createUsers( e, tar.class );
                break;
            case 'address':
            case 'group_address':
            case 'service':
            case 'group_service':
            case 'schedule':
                createObject( e, tar.class );
                break;
            }
            break;
        case 'New':
            btnNew();
            break;
        case 'Edit':
            switch( tar.pid )
            {
            case 'ports':
            case 'lan':
            case 'vlan_interfaces':
            case 'wan_settings':
            case 'zone':
                editInterface( e );
                break;
            case 'static_routing':
            case 'ipsec_policies':
            case 'ike_policy':
            case 'transform_policy':
            case 'dns_forwarder':
                editNetworking( e );
                break;
            case 'rule':
            case 'wan_address_settings':
            case 'static_nat':
            case 'port_forwarding':
            case 'port_trigger':
            case 'advanced_nat':
                editFirewall( e );
                break;
            case 'address_exceptions':
            case 'mime':
            case 'file_extension':
            case 'ip_mac_binding':
                editSecurity( e );
                break;
            case 'user':
            case 'group':
                editUsers( e );
                break;
            case 'address':
            case 'group_address':
            case 'service':
            case 'group_service':
            case 'schedule':
                editObject( e );
                break;
            case 'management_settings':
                editDevice( e );
                break;
            case 'dhcp_binding':
                editDhcpBinding( e );
                break;
            case 'ip_alias':
                editAlias( e );
                break;
            }
            break;
        case 'Delete':
            gIf.alter = true;
            switch( tar.pid )
            {
            case 'lan':
            case 'vlan_interfaces':
            case 'wan_settings':
            case 'zone':
                deleteInterface( e );
                break;
            case 'static_routing':
            case 'ipsec_policies':
            case 'ike_policy':
            case 'transform_policy':
            case 'dns_forwarder':
                deleteNetworking( e );
                break;
            case 'rule':
            case 'static_nat':
            case 'port_forwarding':
            case 'port_trigger':
            case 'advanced_nat':
                deleteFirewall( e );
                break;
            case 'address_exceptions':
            case 'mime':
            case 'file_extension':
            case 'blacklist':
            case 'whitelist':
            case 'ip_mac_binding':
                deleteSecurity( e );
                break;
            case 'user':
            case 'group':
                deleteUsers( e );
                break;
            case 'address':
            case 'group_address':
            case 'service':
            case 'group_service':
            case 'schedule':
                deleteObject( e );
                break;
            case 'dhcp_binding':
                deleteDhcpBinding( e );
                break;
            case 'ip_alias':
                deleteAlias( e );
                break;
            case 'backup_restore':
            case 'packet_capture':
            case 'debug':
            case 'log':
                deleteDevice( e );
                break;
            }
            break;
        case 'Remove':
            gIf.alter = true;
            switch( tar.pid )
            {
            case 'lan':
            case 'vlan_interfaces':
            case 'wan_settings':
            case 'zone':
                removeInterface( e );
                break;
            case 'static_routing':
            case 'ipsec_policies':
            case 'ike_policy':
            case 'transform_policy':
            case 'dns_forwarder':
                removeNetworking( e );
                break;
            case 'rule':
            case 'static_nat':
            case 'port_forwarding':
            case 'port_trigger':
            case 'advanced_nat':
                removeFirewall( e );
                break;
            case 'blacklist':
            case 'whitelist':
            case 'ip_mac_binding':
                removeSecurity( e );
                break;
            case 'user':
            case 'group':
                removeUsers( e );
                break;
            case 'address':
            case 'group_address':
            case 'service':
            case 'group_service':
            case 'schedule':
                removeObject( e );
                break;
            case 'dhcp_binding':
                removeDhcpBinding( e );
                break;
            case 'backup_restore':
            case 'packet_capture':
            case 'debug':
            case 'log':
                removeDevice( e );
                break;
            }
            break;
        case 'Refresh':
            switch(tar.pid)
            {
            case 'show_arp_table':
            case 'show_routing_table':
            case 'dhcp_bindings':
            case 'statusSummary_port':
            case 'statusSummary_vlan':
            case 'statusSummary_wan':
            case 'statusSummary_lan':
            case 'trafficStatisticsPort':
            case 'trafficStatisticsVlan':
            case 'trafficStatisticsWan':
            case 'trafficStatisticsLan':
            case 'nat_status':
            case 'active_users':
            case 'traffic_direction':
                refreshReports(tar.pid);
                break;
            default:
                cgiRefresh( tar.pid );
            }
            break;
        case 'Download':
            btnDownload( e );
            break;
        case 'MoveUp':
            btnMoveUp( e );
            break;
        case 'MoveDown':
            btnMoveDown( e );
            break;
        case 'Move2Add':
            btnMove2Add( e );
            break;
        case 'Move2Del':
            btnMove2Del( e );
            break;
        case 'Move2White':
            btnMove2White( e );
            break;
        case 'Move2Whites':
            btnMove2Whites( e );
            break;
        case 'Connect':
            btnConnect( e );
            break;
        case 'Disconnect':
            btnDisconnect( e );
            break;
        case 'Disconnects':
            btnDisconnects( e );
            break;
        case 'Query':
            btnQuery( e );
            break;
        case 'Cancel':
            getCgiList(gObj.active.pid);
            break;
        case 'Columns':
            btnColumns( e );
            break;
        case 'Force':
            btnForce( e );
            break;
        case 'Forces':
            btnForces( e );
            break;
        case 'Check':
            btnCheck( e );
            break;
        case 'Update':
            btnUpdate( e );
            break;
        case 'LicenseUpgrade':
            btnLicenseUpgrade( e );
            break;
        case 'LicenseRefresh':
            btnLicenseRefresh( e );
            break;
        case 'Move2First':
        case 'Move2Prev':
        case 'Move2Next':
        case 'Move2Last':
            btnMove2Page( e ); 
            break;
        case 'History':
            btnHistory( e ); 
            break;
        case 'Start':
            btnStart( e ); 
            break;
        case 'Run':
            btnRun( e ); 
            break;
        case 'Stop':
            btnStop( e ); 
            break;
        case 'Clean':
            btnClean( e ); 
            break;
        case 'Apply':
            btnApply( e );
            break;
        case 'Import':
            btnImport( e );
            break;
        case 'Export':
            btnExport( e );
            break;
        case 'NewFirmware':
            $('#device h3').click();
            if (!$('#administration h4').hasClass('ui-state-active'))
                $('#administration h4').click();
            $('#firmware h5').click();
            break;
        }
    }
    
    function btnQuery(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');

        if (!tar.id)
            return false;
        tar.pid = tar.id.split(gReg.isDash)[1];
        gIf.query = true;
        gQuery = {};
    
        switch( tar.pid )
        {
        case 'rule':
            refreshFirewall(tar.pid);
            break;
        case 'traffic_direction':
        case 'source_report':
        case 'destination_report':
        case 'file_extension':
        case 'blocked_host':
        case 'affected_host':
        case 'antivirus_report':
            // cache query status
            gQuery.a = $('#query-aggregateBy').val();
            gQuery.q = '&q=' + gQuery.a;
            if (gReg.isDate.test($('#query-startDate').val()))
                gQuery.q += '&sd=' + $('#query-startDate').val();
            if (gReg.isDate.test($('#query-endDate').val()))
                gQuery.q += '&ed=' + $('#query-endDate').val();
            gObj.phpQuery.pi = 1;
            refreshReports(tar.pid);
            break;
        case 'view_logs':
            // cache query status
            gQuery.q = '&q=1&s=' + $('#query-severity').val() + '&f=' + $('#query-facility').val();
            if (gReg.isDate.test($('#query-startDate').val()))
                gQuery.q += '&sd=' + $('#query-startDate').val();
            if (gReg.isDate.test($('#query-endDate').val()))
                gQuery.q += '&ed=' + $('#query-endDate').val();
            if (gReg.isIPv4.test($('#query-srcIp').val()))
                gQuery.q += '&srcIp=' + $('#query-srcIp').val();
            if (gReg.isIPv4.test($('#query-dstIp').val()))
                gQuery.q += '&dstIp=' + $('#query-dstIp').val();

            gObj.phpQuery.pi = 1;
            refreshDevice(tar.pid);
            break;
        case 'wan_bandwidth_report':
        case 'resource_utilization':
            // cache query status
            gQuery.f = '%T';
            switch(true)
            {
            case (gReg.isDate.test($('#query-startDate').val()) && gReg.isDate.test($('#query-endDate').val())) :
                gQuery.s = new Date( $('#query-startDate').val() + ' ' + $('#query-startHour').val() + ':' + $('#query-startMin').val() + ':00' ).getTime();
                gQuery.e = new Date( $('#query-endDate').val() + ' ' + $('#query-endHour').val() + ':' + $('#query-endMin').val() + ':59' ).getTime();
                gQuery.r = gQuery.e - gQuery.s;
   
                if (gQuery.r < 3600000)
                    gQuery.t = '&t=0';
                else if (gQuery.r < 86400000)
                    gQuery.t = '&t=1';
                else if (gQuery.r < 604800000) {
                    gQuery.t = '&t=2';
                    gQuery.f = '%D';
                }else if (gQuery.r < 2592000000) {
                    gQuery.t = '&t=3';
                    gQuery.f = '%D';
                }else {
                    gQuery.t = '&t=4';
                    gQuery.f = '%D';
                }
   
                gQuery.q = '&sd=' + $('#query-startDate').val();
                gQuery.q += '&sh=' + $('#query-startHour').val();
                gQuery.q += '&sm=' + $('#query-startMin').val();
                gQuery.q += '&ed=' + $('#query-endDate').val();
                gQuery.q += '&eh=' + $('#query-endHour').val();
                gQuery.q += '&em=' + $('#query-endMin').val();
                break;
            case (gReg.isDate.test($('#query-startDate').val())) :
                gQuery.s = new Date( $('#query-startDate').val() + ' ' + $('#query-startHour').val() + ':' + $('#query-startMin').val() + ':00' ).getTime();
                gQuery.d = new Date();
                gQuery.e = gQuery.d.getTime();
                gQuery.r = gQuery.e - gQuery.s;
 
                if (gQuery.r < 3600000)
                    gQuery.t = '&t=0';
                else if (gQuery.r < 86400000)
                    gQuery.t = '&t=1';
                else if (gQuery.r < 604800000) {
                    gQuery.t = '&t=2';
                    gQuery.f = '%D';
                }else if (gQuery.r < 2592000000) {
                    gQuery.t = '&t=3';
                    gQuery.f = '%D';
                }else {
                    gQuery.t = '&t=4';
                    gQuery.f = '%D';
                }
 
                gQuery.q = '&sd=' + $('#query-startDate').val();
                gQuery.q += '&sh=' + $('#query-startHour').val();
                gQuery.q += '&sm=' + $('#query-startMin').val();
                gQuery.q += '&ed=' + gQuery.d.getFullYear() + '/' + (gQuery.d.getMonth() + 1) + '/' + gQuery.d.getDate();
                gQuery.q += '&eh=' + gQuery.d.getHours();
                gQuery.q += '&em=' + gQuery.d.getMinutes();
                break;
            case (gReg.isDate.test($('#query-endDate').val())) :
                gQuery.q = '&ed=' + $('#query-endDate').val();
                gQuery.q += '&eh=' + $('#query-endHour').val();
                gQuery.q += '&em=' + $('#query-endMin').val();
                break;
            }

            refreshCharts(tar.pid);
            break;
        }
    }
    
    function btnConnect(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;

        tar.pid = tar.id.split(gReg.isDash)[1];
        tar.thisNo = tar.id.split(gReg.isDash)[2];

        $('#Connect-' + tar.pid + '-' + tar.thisNo).prop('disabled', true);
        $('#Disconnect-' + tar.pid + '-' + tar.thisNo).prop('disabled', false);
        gObj.form = {};
        switch(tar.pid)
        {
        case 'active_sessions':
            gObj.form.guiIpsecSessionUpDownTNum = "1";
            gObj.form.guiIpsecSessionUpDownT = [{ "sessionName": gData[ tar.pid ].guiIpsecSessionT[ tar.thisNo ].sessionName, "instno": gData[ tar.pid ].guiIpsecSessionT[ tar.thisNo ].instno, "actionType": "1" }];
            loadingToggle( true );
            $.post('cgi-bin/ipsecSessionUpDown.cgi', gY.JSON.stringify(gObj.form), function() {
                progressTAlert( 's2svpn' );
            });
            break;
        case 'ipsec_policies':
            gObj.form.name = gData[ tar.pid ].guiS2svpnT[ tar.thisNo ].name;
            gObj.form.actionType = "1";
            gData[ tar.pid ].guiS2svpnT[ tar.thisNo ].infoStatus = "1";
            loadingToggle( true );
            $.post('cgi-bin/s2svpnUpDown.cgi', gY.JSON.stringify(gObj.form), function() {
                progressTAlert( 's2svpn' );
            });
            break;
        }
    }
    
    function btnForce(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;

        tar.pid = tar.id.split(gReg.isDash)[1];
        tar.thisNo = tar.id.split(gReg.isDash)[2];
        tar.cgiPost = 'forceLogout';
        tar.guiT = 'activeUsersT';

        gObj.form = {};
        gObj.form.forceLogoutUsersT = [];
        gObj.form.forceLogoutUsersT.push( gData[ tar.pid ][ tar.guiT ][ tar.thisNo ] );
    
        $.post('cgi-bin/' + tar.cgiPost + '.cgi', gY.JSON.stringify(gObj.form)).done( refreshReports( tar.pid ) );
    }
    
    function btnForces(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;

        tar.pid = tar.id.split(gReg.isDash)[1];
        tar.cgiPost = 'forceLogout';
        tar.guiT = 'activeUsersT';

        gObj.form = {};
        gObj.form.forceLogoutUsersT = [];
    
        $('#table-' + tar.pid + ' tbody tr').each(function() {
            if ($(this).find('td:eq(0) input:checkbox').is(':checked')) {
                tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
                gObj.form.forceLogoutUsersT.push( gData[ tar.pid ][ tar.guiT ][ tar.thisNo ] );
            }
        });
    
        $.post('cgi-bin/' + tar.cgiPost + '.cgi', gY.JSON.stringify(gObj.form)).done( refreshReports( tar.pid ) );
    }
    
    function btnDisconnect(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id')
        if (!tar.id)
            return false;
        tar.pid = tar.id.split(gReg.isDash)[1];
        tar.thisNo = parseInt( tar.id.split(gReg.isDash)[ 2 ] );

        $('#Connect-' + tar.pid + '-' + tar.thisNo).prop('disabled', false);
        $('#Disconnect-' + tar.pid + '-' + tar.thisNo).prop('disabled', true);
        gObj.form = {};
        switch(tar.pid)
        {
        case 'active_sessions':
            gObj.form.guiIpsecSessionUpDownTNum = "1";
            gObj.form.guiIpsecSessionUpDownT = [{ "sessionName": gData[ tar.pid ].guiIpsecSessionT[ tar.thisNo ].sessionName, "instno": gData[ tar.pid ].guiIpsecSessionT[ tar.thisNo ].instno, "actionType": "0" }];
            loadingToggle( true );
            $.post('cgi-bin/ipsecSessionUpDown.cgi', gY.JSON.stringify(gObj.form), function() {
                gIf.delay = true;
                gObj.delay = 2;
            });
            break;
        case 'ipsec_policies':
            gObj.form.name = gData[ tar.pid ].guiS2svpnT[ tar.thisNo ].name;
            gObj.form.actionType = "0";
            gData[ tar.pid ].guiS2svpnT[ tar.thisNo ].infoStatus = "0";
            loadingToggle( true );
            $.post('cgi-bin/s2svpnUpDown.cgi', gY.JSON.stringify(gObj.form), function() {
                gIf.delay = true;
                gObj.delay = 2;
            });
            break;
        }
    }
    
    function btnDisconnects(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id')
        if (!tar.id)
            return false;
        tar.pid = tar.id.split(gReg.isDash)[1];

        gObj.form = {};
        switch(tar.pid)
        {
        case 'active_sessions':
            gObj.form.guiIpsecSessionUpDownT = [];
            $('#table-' + tar.pid + ' tbody tr').each(function() {
                switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
                {
                case true:
                    tar.idx = $(this).find('td:eq(0) input:checkbox').val();
                    gObj.form.guiIpsecSessionUpDownT.push( {"sessionName": gData[ tar.pid ].guiIpsecSessionT[ tar.idx ].sessionName, "instno": gData[ tar.pid ].guiIpsecSessionT[ tar.idx ].instno, "actionType": "0" } );
                    $('#Connect-' + tar.pid + '-' + tar.idx).prop('disabled', false);
                    $('#Disconnect-' + tar.pid + '-' + tar.idx).prop('disabled', true);
                    $(this).find('td:eq(0) input:checkbox').attr('checked', false);
                    break;
                }
            });
            
            gObj.form.guiIpsecSessionUpDownTNum = gObj.form.guiIpsecSessionUpDownT.length;
            loadingToggle( true );
            $.post('cgi-bin/ipsecSessionUpDown.cgi', gY.JSON.stringify(gObj.form), function() {
                gIf.delay = true;
                gObj.delay = 2;
            });
            break;
        }
    }
    
    function btnMoveUp(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id')
        if (!tar.id)
            return false;
        tar.pid = tar.id.split(gReg.isDash)[1];

        tar.thisNo = parseInt( tar.id.split(gReg.isDash)[ 2 ] );
        tar.idx = gRef.rules.move.indexOf( tar.thisNo );
        tar.newIdx = tar.idx - 1;
        if (tar.idx > 0) {
            var tmp = gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.newIdx ] ];
            gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.newIdx ] ] = gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.idx ] ];
            if (parseInt(gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.newIdx ] ].gid)>0)
                gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.newIdx ] ].cgiAction = 2;
            gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.idx ] ] = tmp;
            if (parseInt(gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.idx ] ].gid)>0)
                gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.idx ] ].cgiAction = 2;
            gIf.alter = true;
            refreshFirewall(tar.pid);
        }
    }
    
    function btnMoveDown(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id')
        if (!tar.id)
            return false;
        tar.pid = tar.id.split(gReg.isDash)[1];

        tar.thisNo = parseInt( tar.id.split(gReg.isDash)[ 2 ] );
        tar.idx = gRef.rules.move.indexOf( tar.thisNo );
        tar.newIdx = tar.idx + 1;
        if (tar.newIdx < gRef.rules.move.length) {
            var tmp = gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.newIdx ] ];
            gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.newIdx ] ] = gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.idx ] ];
            if (parseInt(gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.newIdx ] ].gid)>0)
                gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.newIdx ] ].cgiAction = "2";
            gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.idx ] ] = tmp;
            if (parseInt(gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.idx ] ].gid)>0)
                gData[ tar.pid ].guiRulesT[ gRef.rules.move[ tar.idx ] ].cgiAction = "2";
            gIf.alter = true;
            refreshFirewall(tar.pid);
        }
    }
    
    function btnMove2Page(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id')
        if (!tar.id)
            return false;
        tar.class= $(e.currentTarget).attr('class');
        tar.pid = tar.id.split(gReg.isDash)[1];
    
        switch(tar.class)
        {
        case 'Move2First':
            if (gObj.phpQuery.pi > 1) {
                gObj.phpQuery.pi = 1;
                if ( tar.pid == 'view_logs' )
                    refreshDevice( tar.pid );
                else 
                    refreshReports( tar.pid );
            }
            break;
        case 'Move2Prev':
            if (gObj.phpQuery.pi > 1) {
                gObj.phpQuery.pi--;
                if ( tar.pid == 'view_logs' )
                    refreshDevice( tar.pid );
                else 
                    refreshReports( tar.pid );
            }
            break;
        case 'Move2Next':
            if (gObj.phpQuery.pi < gObj.phpQuery.ps) {
                gObj.phpQuery.pi++
                if ( tar.pid == 'view_logs' )
                    refreshDevice( tar.pid );
                else 
                    refreshReports( tar.pid );
            }
            break;
        case 'Move2Last':
            if (gObj.phpQuery.pi < gObj.phpQuery.ps) {
                gObj.phpQuery.pi = gObj.phpQuery.ps;
                if ( tar.pid == 'view_logs' )
                    refreshDevice( tar.pid );
                else 
                    refreshReports( tar.pid );
            }
            break;
        }
    }
    
    function btnMove2Add(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id')
        if (!tar.id)
            return false;
        tar.pid = tar.id.split(gReg.isDash)[1];

        tar.val;
    
        switch(tar.pid)
        {
        case 'idList':
// group address/service
            if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerGroupAddress ) {
                errorAlert('<p>' + gError[ gObj.lang ].memberLimit + '</p>');
                return false;
            } else {
                tar.val = $('#pool option:selected');
                tar.val.clone().appendTo('#pick');
            }
            break;
        case 'users':
// users and groups
            if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxUserPerGroup ) {
                errorAlert('<p>' + gError[ gObj.lang ].memberLimit + '</p>');
                return false;
            } else {
                tar.val = $('#pool option:selected');
                tar.val.clone().appendTo('#pick');
            }
            break;
        case 'member':
// zone
            if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerZone ) {
                errorAlert('<p>' + gError[ gObj.lang ].memberLimit + '</p>');
                return false;
            } else {
                tar.val = $('#pool option:selected');
                tar.val.clone().appendTo('#pick');
            }
            break;
        case 'interfaces':
// lan
            if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerLAN ) {
                errorAlert('<p>' + gError[ gObj.lang ].memberLimit + '</p>');
                return false;
            } else {
                tar.val = $('#pool option:selected');
                tar.val.clone().appendTo('#pick');
            }
            break;
        default:
// antivirus
            tar.val = $('#' + tar.pid + 'Pool option:selected');
            tar.val.clone().appendTo('#' + tar.pid);
        }
        tar.val.remove();
    }
    
    function btnMove2Del(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id')
        if (!tar.id)
            return false;
        tar.pid = tar.id.split(gReg.isDash)[1];

        tar.val;
        switch(tar.pid)
        {
        case 'idList':
            tar.val = $('#pick option:selected');
            tar.val.clone().appendTo('#pool');
            break;
        case 'users':
            tar.val = $('#pick option:selected');
            tar.val.clone().appendTo('#pool');
            break;
        case 'member':
            tar.val = $('#pick option:selected');
            tar.val.clone().appendTo('#pool');
            break;
        case 'interfaces':
            tar.val = $('#pick option:selected');
            tar.val.clone().appendTo('#pool');
            break;
        default:
            tar.val = $('#' + tar.pid + ' option:selected');
            tar.vai.clone().appendTo('#' + tar.pid + 'Pool');
        }
    
        tar.val.remove();
    }

    function btnHistory(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id')
        if (!tar.id) 
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        tar.thisNo  = tar.id.split(gReg.isDash).pop();
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');

        switch( tar.pid )
        {
        case 'whitelist':
            $.post('cgi-bin/av_whitelist_info.cgi', gY.JSON.stringify(  {"virusID" : gData[ tar.pid ].urlT[ tar.thisNo ].virusID} ), function(poster) {
                gPop.popForm = $('#popForm').dialog({
                    width: 480,
                    height: 320,
                    position: "center",
                    resizable: false,
                    modal: true,
                    title: gTerm[ gObj.lang ].virusHistory,
                    buttons: {
                        ok: function() {
                            $( this ).dialog( "close" );
                        }
                    },
                    open: function(event, ui) {
                        var tmp = '<div id="div-whitelist_info">';
                        tmp += '<table id="table-whitelist_info">';
                        tmp +=   '<thead>';
                        tmp +=     '<tr>';
                        tmp +=       '<th colspan="2" class="ui-state-default BT130">' + gTerm[ gObj.lang ].virus + ' ID</th>';
                        tmp +=       '<th>' + gData[ tar.pid ].urlT[ tar.thisNo ].virusID + '</th>';
                        tmp +=     '</tr>';
                        tmp +=     '<tr>';
                        tmp +=       '<th colspan="2" class="ui-state-default BT130">' + gTerm[ gObj.lang ].virusName + '</th>';
                        tmp +=       '<th>' + gData[ tar.pid ].urlT[ tar.thisNo ].virusName + '</th>';
                        tmp +=     '</tr>';
                        tmp +=     '<tr>';
                        tmp +=       '<th class="ui-state-default BT50">' + gTerm[ gObj.lang ].index + '</th>';
                        tmp +=       '<th class="ui-state-default BT80">' + gTerm[ gObj.lang ].type + '</th>';
                        tmp +=       '<th class="ui-state-default" colspan="3">' + gTerm[ gObj.lang ].info + '</th>';
                        tmp +=     '</tr>';
                        tmp +=   '</thead>';
                        tmp +=   '<tbody>';
                        tmp +=     '<tr>';
                        tmp +=       '<td colspan="3">';
                        tmp +=         '<div id="div-whitelist_info-history">';
                        tmp +=           '<table id="table-whitelist_info-history">';
                        tmp +=             '<tbody>';
                        tmp +=             '</tbody>';
                        tmp +=           '</table>';
                        tmp +=         '</div>';
                        tmp +=       '</td>';
                        tmp +=     '</tr>';
                        tmp +=   '</tbody>';
                        tmp += '</table>';
                        tmp += '</div>';

                        $('#popForm').append( tmp );

                        for (var i=0, len=poster.historyT.length; i<len; i++) 
                        {
                            $('#table-whitelist_info-history tbody').append( '<tr class="' + ((i%2 == 0)? 'even' : 'odd') + '"><td class="BT50">' + (i+1) + '</td><td class="BT80">' + poster.historyT[ i ].type + '</td><td>' + poster.historyT[ i ].Info + '</td></tr>' );
                        }
                    },
                    close: function(event, ui) {
                        $(this).dialog('destroy').remove();
                    }
                });

            });
            break;
        }
    }

    function btnMove2White(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id')
        if (!tar.id) 
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        tar.thisNo  = tar.id.split(gReg.isDash).pop();
        switch(tar.pid)
        {
        case 'blacklist':
            if (!$('#popError').exists())
                $('#popBase').append('<div id="popError"></div>');
    
            $('#popError').html('<div class="errorForm"><p class="errorMsg"></p></div>');
            $('#popError').dialog({
                width: 300,
                height:200,
                position: "center",
                resizable: false,
                modal: true,
                title: gTerm[ gObj.lang ].moveAlert,
                buttons: {
                    okay: function() {
                        gIf.alter = true;
                        tar.blacklist = [];
                        gData.whitelist.urlT.push({"virusID" : gData[ tar.pid ].urlT[ tar.thisNo ].virusID, "virusName" : gData[ tar.pid ].urlT[ tar.thisNo ].virusName });
                        gData.whitelist.number = gData.whitelist.urlT.length;
                        gCache.whitelist.push( parseInt( gData[ tar.pid ].urlT[ tar.thisNo ].virusID ) );

                        for (var i=0, len=gData[ tar.pid ].urlT.length; i<len; i++)
                        {
                            if ( gCache.whitelist.indexOf( parseInt( gData[ tar.pid ].urlT[ i ].virusID ) ) != -1 ) {
                                gData[ tar.pid ].urlT[ i ].act = 0;
                                gCache[ tar.pid ].push( gData[ tar.pid ].urlT[ i ] );
                            } else {
                                tar.blacklist.push( gData[ tar.pid ].urlT[ i ] );
                            }
                        }

                        gData[ tar.pid ].urlT = tar.blacklist;
                        gData[ tar.pid ].number = gData[ tar.pid ].urlT.length;

                        gCache.tabber[ 5 ] = true;
                        gCache.tabber[ 6 ] = true;
                        gCheckbox.blacklist = {};
                        gCheckbox.whitelist = {};
                        $('#blacklist_all').attr('checked', false);
                        $('#whitelist_all').attr('checked', false);
                        refreshSecurity( tar.pid );

                        $( this ).dialog( "close" );
                    },
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                close: function(event, ui) {
                    $(this).dialog('destroy').remove();
                }
            });

            $('.errorMsg').html( gError[ gObj.lang ].move_black_or_white );
            break;
        }
    }

    function btnMove2Whites(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id')
        if (!tar.id) 
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];

        switch(tar.pid)
        {
        case 'blacklist':
            if (!$('#popError').exists())
                $('#popBase').append('<div id="popError"></div>');
    
            $('#popError').html('<div class="errorForm"><p class="errorMsg"></p></div>');
            $('#popError').dialog({
                width: 300,
                height:200,
                position: "center",
                resizable: false,
                modal: true,
                title: gTerm[ gObj.lang ].moveAlert,
                buttons: {
                    okay: function() {
                        gIf.alter = true;
                        tar.blacklist = [];

                        $('#table-' + tar.pid + ' > tbody tr').each(function() {
                            tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
                            if ($(this).find('td:eq(0) input:checkbox').is(':checked')) {
                                if ( gCache.whitelist.indexOf( parseInt( gData[ tar.pid ].urlT[ tar.thisNo ].virusID ) ) == -1 ) {
                                    gCache.whitelist.push( parseInt( gData[ tar.pid ].urlT[ tar.thisNo ].virusID ) );
                                    gData.whitelist.urlT.push({"virusID" : gData[ tar.pid ].urlT[ tar.thisNo ].virusID, "virusName" : gData[ tar.pid ].urlT[ tar.thisNo ].virusName});
                                }
                            }
                        });

                        gData.whitelist.number = gData.whitelist.urlT.length;

                        for (var i=0, len=gData[ tar.pid ].urlT.length; i<len; i++)
                        {
                            if ( gCache.whitelist.indexOf( parseInt( gData[ tar.pid ].urlT[ i ].virusID ) ) != -1 ) {
                                gData[ tar.pid ].urlT[ i ].act = 0;
                                gCache.blacklist.push( gData[ tar.pid ].urlT[ i ] );
                            } else {
                                tar.blacklist.push( gData[ tar.pid ].urlT[ i ] );
                            }
                        }

                        gData[ tar.pid ].urlT = tar.blacklist;
                        gData[ tar.pid ].number = gData[ tar.pid ].urlT.length;

                        gCache.tabber[ 5 ] = true;
                        gCache.tabber[ 6 ] = true;
                        gCheckbox.blacklist = {};
                        gCheckbox.whitelist = {};
                        $('#blacklist_all').attr('checked', false);
                        $('#whitelist_all').attr('checked', false);
                        refreshSecurity( tar.pid );

                        $( this ).dialog( "close" );
                    },
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                close: function(event, ui) {
                    $(this).dialog('destroy').remove();
                }
            });
            $('.errorMsg').html( gError[ gObj.lang ].move_black_or_white );
            break;
        }
    }
    
    function btnColumns( e ) {
        if (!e) {
            gIf.columns = false;
        } else {
            gIf.columns = !gIf.columns;
        }

        if (gIf.columns) {
            $('#div-columns').html( '<ul></ul>' );

            switch( gNode.ext )
            {
            case 'php':
                if ( gNode.query ) {
                    if (!gQuery.a) 
                        gQuery.a = 0;
                    for (var i=0; i<gNode.col[ gQuery.a ].length; i++)
                    {
                        $('#div-columns ul').append( '<li><input type="checkbox" id="columns-' + gQuery.a + '-' + gNode.col[ gQuery.a ][ i ].tab + '" value="1" /><label for="columns-' + gQuery.a + '-' + gNode.col[ gQuery.a ][ i ].tab + '">' + gNode.col[ gQuery.a ][ i ].label + '</label></li>' );
                        if (gColumns[ gNode.tab ][ gQuery.a ][ gNode.col[ gQuery.a ][ i ].tab ])
                            $('#columns-' + gQuery.a + '-' + gNode.col[ gQuery.a ][ i ].tab).attr('checked', true);
                    } 
                }
                break;
            case 'mix':
                break;
            case 'cgi':
                switch( gNode.type )
                {
                case 'tabs':
                    for (var i=0; i<gNode.col[ gObj.tabIndexId ].length; i++)
                    {
                        $('#div-columns ul').append( '<li><input type="checkbox" id="columns-' + gObj.tabIndexId + '-' + gNode.col[ gObj.tabIndexId ][ i ].tab + '" value="1" /><label for="columns-' + gObj.tabIndexId + '-' + gNode.col[ gObj.tabIndexId ][ i ].tab + '">' + gNode.col[ gObj.tabIndexId ][ i ].label + '</label></li>' );
                        if (gColumns[ gNode.tab ][ gObj.tabIndexId ][ gNode.col[ gObj.tabIndexId ][ i ].tab ])
                            $('#columns-' + gObj.tabIndexId + '-' + gNode.col[ gObj.tabIndexId ][ i ].tab).attr('checked', true);
                    }
                    break;
                default: 
                    for (var i=0; i<gNode.col.length; i++)
                    {
                        $('#div-columns ul').append( '<li><input type="checkbox" id="columns-' + gNode.col[ i ].tab + '" value="1" /><label for="columns-' + gNode.col[ i ].tab + '">' + gNode.col[ i ].label + '</label></li>' );
                        if (gColumns[ gNode.tab ][ gNode.col[ i ].tab ])
                            $('#columns-' + gNode.col[ i ].tab).attr('checked', true);
                    }
                }
                break;
            }
        
            $('#div-columns').show();

            $('#div-columns input:checkbox').bind('click', function() {
                var cid = $(this).attr('id').split('-').pop();
                switch( gNode.ext )
                {
                case 'php':
                    if (gColumns[ gNode.tab ][ gQuery.a ][ cid ]) {
                        delete gColumns[ gNode.tab ][ gQuery.a ][ cid ];
                        $('.' + gNode.tab + '-' + gQuery.a + '-' + cid ).hide();
                    } else {
                        gColumns[ gNode.tab ][ gQuery.a ][ cid ] = true;
                        $('.' + gNode.tab + '-' + gQuery.a + '-' + cid ).show();
                    }
                    break;
                case 'mix':
                    break;
                case 'cgi':
                    switch( gNode.type )
                    {
                    case 'tabs':
                        if (gColumns[ gNode.tab ][ gObj.tabIndexId ][ cid ]) {
                             delete gColumns[ gNode.tab ][ gObj.tabIndexId ][ cid ];
                             $('.' + gNode.tab + '-' + gObj.tabIndexId + '-' + cid ).hide();
                        } else {
                             gColumns[ gNode.tab ][ gObj.tabIndexId ][ cid ] = true;
                             $('.' + gNode.tab + '-' + gObj.tabIndexId + '-' + cid ).show();
                        }
                        break;
                    default:
                        if (gColumns[ gNode.tab ][ cid ]) {
                             delete gColumns[ gNode.tab ][ cid ];
                             $('.' + gNode.tab + '-' + cid ).hide();
                        } else {
                             gColumns[ gNode.tab ][ cid ] = true;
                             $('.' + gNode.tab + '-' + cid ).show();
                        }
                    }
                    break;
                }
            });
        } else {
            $('#div-columns').hide();
        }
    }

    function btnClear(e) {
        $.ajax({
            url: 'logClear.php?param=view_logs',
            dataType: 'json',
            success: function(data) {
                if (parseInt(data.status) == 0)
                    getCgiList(gObj.active.pid);
                else {
                    if (!$('#popPlus').exists())
                        $('#popBase').append('<div id="popPlus"></div>');
                    $('#popPlus').html('<div class="plusForm"><p class="plusMsg"></p></div>');
                    $('#popPlus').dialog({
                        width: 300,
                        height:200,
                        position: "center",
                        resizable: false,
                        modal: true,
                        buttons: {
                            Ok: function() {
                                $( this ).dialog( "close" );
                            },
                            Cancel: function() {
                                $( this ).dialog( "close" );
                            }
                        },
                        close: function(event, ui) {
                            $(this).dialog('destroy').remove();
                        }
                    });
                    switch(parseInt(data.status))
                    {
                    default:
                        $('.plusMsg').html(poster.msg);
                        break;
                    }
                }
            }
        });
    }
    
    function btnExport(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');

        switch (tar.id)
        {
        case 'pgExport':
            window.open("logExport.php?param=view_logs", "_blank");
            break;
        case 'pgExport2':
            break;
        default:
            if (!($('#popForm').exists()))
                $('#popBase').append('<div id="popForm"></div>');

            tar.pid = tar.id.split('-')[1];
            tar.thisNo = tar.id.split('-')[2];

            gPop.popForm = $('#popForm').dialog({
                width: 300,
                height: 200,
                position: "center",
                resizable: false,
                modal: true,
                title: gTerm[ gObj.lang ].backup_restore_export,
                buttons: {
                    ok: function() {
                        switch( parseInt( $('input[name=Editor-exportTo]:checked').val() ) )
                        {
                        case 1:
                            window.open('cgi-bin/' + gNode.url.exportToPC + '.cgi?config_name=' + gData[ gNode.tab ][ gNode.guiT ][ tar.thisNo ].name, "_blank");
                            break;
                        case 2:
                            $.get('cgi-bin/' + gNode.url.exportToUSB + '.cgi?config_name=' + gData[ gNode.tab ][ gNode.guiT ][ tar.thisNo ].fileName, function() {
                                successAlert('<p>' + gTerm[ gObj.lang ].exportDone + '</p>');
                            });
                            break;
                        }
                        $( this ).dialog( "close" );
                    },
                    cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                open: function(event, ui) {
                    var tmp = '<div>';
                    tmp += '<table>';
                    tmp += '<tr>';
                    tmp += '<td class="BT40">';
                    tmp += '<input type="radio" id="Editor-exportTo-1" name="Editor-exportTo" value="1" />'; 
                    tmp += '</td>';
                    tmp += '<th class="alignLeft">';
                    tmp += '<label for="Editor-exportTo-1">' + gNode.editor.export.option[ "1" ].label + '</label>';
                    tmp += '</th>';
                    tmp += '</tr>';
                    tmp += '<tr>';
                    tmp += '<td class="BT40">';
                    tmp += '<input type="radio" id="Editor-exportTo-2" name="Editor-exportTo" value="2" />'; 
                    tmp += '</td>';
                    tmp += '<th class="alignLeft">';
                    tmp += '<label for="Editor-exportTo-2">' + gNode.editor.export.option[ "2" ].label + '</label>';
                    tmp += '</th>';
                    tmp += '</tr>';
                    tmp += '</table>';
                    tmp += '</div>';
                    $('#popForm').html( tmp );

                    $('#Editor-exportTo-1').click();

                    $.ajax({
                        url: 'cgi-bin/common_usbFile_list.cgi',
                        dataType: 'json',
                        success: function(data) {
                            if (0 === parseInt(data.status)) {
                                $('#Editor-exportTo-2').prop('disabled', true);
                            }
                        }
                    });
                },
                close: function(event, ui) {
                    $(this).dialog('destroy').remove();
                }
           });
        }
    }

    function btnImport(e) {
        var tar = {};
        var checker;
        tar.id = $(e.currentTarget).attr('id');

        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');

        tar.pid = tar.id.split('-')[1];
        tar.thisNo = tar.id.split('-')[2];

        switch (tar.id)
        {
        case 'pgImport':
            break;
        default:
            gPop.popForm = $('#popForm').dialog({
                width: 500,
                height: 250,
                position: "center",
                resizable: false,
                modal: true,
                title: gTerm[ gObj.lang ].backup_restore_import,
                buttons: {
                    ok: function() {
                        gObj.form = {};
                        gObj.form.profileName = gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name;
                        switch( parseInt( $('input[name=Editor-importFrom]:checked').val() ) )
                        {
                        case 0:
                            if ('NA' != $('#Editor-importFrom-device').val()) {
                                gObj.form.baseOn = $('#Editor-importFrom-device').val();
                                $.ajax({
                                    type: "POST",
                                    url: 'cgi-bin/' + gNode.url.importFromDevice + '.cgi',
                                    data: gObj.form,
                                    success: function(data) {
                                        if (0 === parseInt( data.status ) ) {
                                            genDevice( 'backup_restore' );
                                        } else
                                            errorAlert('<p>' + gError[ gObj.lang ][ data.msg ] + '</p>');
                                    }
                                });
                                $( this ).dialog( "close" );
                            } else {
                                errorAlert('<p>' + gError[ gObj.lang ].profileName + '</p>');
                            }
                            break;
                        case 1:
                            if (!gIf.uploaded && gObj.uploader.get("fileList").length > 0) {
                                if (gIf.invalid) {
                                    $('.errorMsg').html( gError[ gObj.lang ].please_check_file );
                                } else {
                                    loadingToggle( true );
                                    gObj.uploader.upload(gObj.uploaderFile, gObj.uploader.uploadURL, gObj.form);
                                }
                            } else {
                                errorAlert('<p>' + gError[ gObj.lang ].profileName + '</p>');
                            }
                            break;
                        case 2:
                            if ('NA' != $('#Editor-importFrom-usb').val()) {
                                if (gReg.profileImport.test( $('#Editor-importFrom-usb').val())) {
                                    gObj.form.fpath = $('#Editor-importFrom-usb').val();
                                    $.ajax({
                                        type: "POST",
                                        url: 'cgi-bin/' + gNode.url.importFromUSB + '.cgi',
                                        data: gObj.form,
                                        success: function(data) {
                                            if (0 === parseInt( data.status ) ) {
                                                genDevice( 'backup_restore' );
                                            } else
                                                errorAlert('<p>' + gError[ gObj.lang ][ data.msg ] + '</p>');
                                        }
                                    });
                                    $( this ).dialog( "close" );
                                } else {
                                    errorAlert('<p>' + gError[ gObj.lang ].profileImport + '</p>');
                                }
                            } else {
                                errorAlert('<p>' + gError[ gObj.lang ].profileName + '</p>');
                            }
                            break;
                        }
                    }
                },
                open: function(event, ui) {
                    var tmp = '<div>'; 
                    tmp += '<table>';
                    tmp += '<tr>';
                    tmp += '<td class="BT40">';
                    tmp += '<input type="radio" id="Editor-importFrom-0" name="Editor-importFrom" value="0" />'; 
                    tmp += '</td>';
                    tmp += '<th class="alignLeft BT120">';
                    tmp += '<label for="Editor-importFrom-0">' + gNode.editor.import.option[ "0" ].label + '</label>';
                    tmp += '</th>';
                    tmp += '<td colspan="2" class="alignLeft">';
                    tmp += '<select id="Editor-importFrom-device"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';
                    tmp += '<tr>';
                    tmp += '<td class="BT40">';
                    tmp += '<input type="radio" id="Editor-importFrom-1" name="Editor-importFrom" value="1" />'; 
                    tmp += '</td>';
                    tmp += '<th class="alignLeft BT120">';
                    tmp += '<label for="Editor-importFrom-1">' + gNode.editor.import.option[ "1" ].label + '</label>';
                    tmp += '</th>';
                    tmp += '<td class="alignLeft BT120">';
                    tmp += '<div id="Editor-' + gNode.editor.import.option[ "1" ].tab + '"></div>';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft">';
                    tmp += '<div id="Editor-' + gNode.editor.import.option[ "1" ].tab + '-status"></div>';
                    tmp += '</td>';
                    tmp += '</tr>';
                    tmp += '<tr>';
                    tmp += '<td class="BT40">';
                    tmp += '<input type="radio" id="Editor-importFrom-2" name="Editor-importFrom" value="2" />'; 
                    tmp += '</td>';
                    tmp += '<th class="alignLeft BT120">';
                    tmp += '<label for="Editor-importFrom-2">' + gNode.editor.import.option[ "2" ].label + '</label>';
                    tmp += '</th>';
                    tmp += '<td colspan="2" class="alignLeft">';
                    tmp += '<select id="Editor-importFrom-usb"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';
                    tmp += '</table>';
                    tmp += '</div>';
                    
                    $('#popForm').html( tmp );
    
                    cgiSelectOption( 'Editor-importFrom-device', tar.thisNo );
    
                    gObj.uploader = new gY.Uploader({
                                       width: "100px",
                                       multipleFiles: false,
                                       fileFieldName: 'binary',
                                       swfURL: "assets/flashuploader.swf?t=" + Math.random(),
                                       uploadURL: "cgi-bin/" + gNode.url.importFromPC + ".cgi",
                                       simLimit: 1,
                                       withCredentials: false
                                   });
                    gIf.uploaded = false;
    
                    gObj.uploader.render("#Editor-importFrom-pc");
    
                    gObj.uploader.after("fileselect", function (e) {
                        gObj.uploaderFile = e.fileList[0];
                        if (gReg.profileImport.test( gObj.uploaderFile.get('name') )) {
                            gIf.invalid = false;
                            gY.one("#Editor-importFrom-pc-status").set("text", gObj.uploaderFile.get('name') );
                        } else {
                            errorAlert( '<p>' + gError[ gObj.lang ].profileImport + '</p>' );
                        }
                    });
    
                    gObj.uploader.on("uploadprogress", function (e) {
                        $('.processDiv').progressbar({ value: parseInt( e.percentLoaded ) });
                    });
    
                    gObj.uploader.on("uploadstart", function (e) {
                        gObj.uploader.set("enabled", false);
                    });
    
                    gObj.uploader.on("uploadcomplete", function (e) {
                        var json = gY.JSON.parse(e.data);
                        loadingToggle( false );
                        if (parseInt(json.status) == 0) {
                            gIf.uploaded = true;
                            gPop.popForm.dialog( "close" );
                            genDevice( 'backup_restore' );
                        } else {
                            gIf.uploaded = false;
                            gIf.invalid = true;
                            errorAlert( '<p>' + json.msg + '</p>' );
                        }
                    });
    
                    $('#Editor-importFrom-usb').html('<option value="NA">' + gTerm[ gObj.lang ].selectFromUSB + '</option>');
                    $('input[name=Editor-importFrom]').change( function() {
                        $('#Editor-importFrom-device').prop('disabled', true);
                        $('#Editor-importFrom-pc button').prop('disabled', true);
                        $('#Editor-importFrom-usb').prop('disabled', true);
                        switch( parseInt( $(this).val() ) )
                        {
                        case 0:
                            $('#Editor-importFrom-device').prop('disabled', false);
                            break;
                        case 1:
                            $('#Editor-importFrom-pc button').prop('disabled', false);
                            break;
                        case 2:
                            $.ajax({
                                url: 'cgi-bin/common_usbFile_list.cgi',
                                dataType: 'json',
                                success: function(data) {
                                    gData[ 'common_usbFile_list' ] = data;
                                    $('#Editor-importFrom-usb').html('<option value="NA">' + gTerm[ gObj.lang ].selectFromUSB + '</option>');
                                    if (1 === parseInt(data.status)) {
                                        $('#Editor-importFrom-usb').prop('disabled', false);
                                        for (var i=0, len=data.guiUsbFileT.length; i<len; i++) {
                                            $('#Editor-importFrom-usb').append('<option value="' + data.guiUsbFileT[ i ].path + '">' + data.guiUsbFileT[ i ].name + '</option>');
                                        }
                                    } else {
                                        $('#Editor-importFrom-usb').prop('disabled', true);
                                    }
                                }
                            });
                            break;
                        }
                    }).eq( 0 ).trigger('click');
    
                },
                close: function(event, ui) {
                    $(this).dialog('destroy').remove();
                }
            });
        }
    }
    
    function btnCheckSMTP( pid ) {
        var pass = true;
        var msg = '';
        if (gData[ pid ]) {
            if (!gReg.ascii.default.test( $('#server').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].smtpServer + '</p>';
            }
    
            if (!gReg.portList.test( $('#port').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].portList + '</p>';
            }

            if ($('#enableAuth').is(':checked')) {
                if (!gReg.userOut63.test( $('#account').val() )) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].userOut63 + '</p>';
                }
    
                if (!gReg.passOut63.test( $('#password').val() )) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].passOut63 + '</p>';
                }
            }
    
            if (!gReg.isEmail.test( $('#fromEmail').val() ) || !gReg.email.test( $('#fromEmail').val() ) ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].fromEmail + '</p>';
            }
    
            gIf.toEmail = false;
            gObj.toEmails = [];

            if (gReg.email.test( $('#toEmail0').val() ) ) {
                if (gReg.isEmail.test( $('#toEmail0').val() )) {
                    gObj.toEmails.push( $('#toEmail0').val() );
                    gIf.toEmail = true;
                } else {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].toEmail + '</p>';
                }
            }

            if ( gReg.email.test( $('#toEmail1').val() ) ) {
                if (gReg.isEmail.test( $('#toEmail1').val() )) {
                    gObj.toEmails.push( $('#toEmail1').val() );
                    gIf.toEmail = true;
                } else {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].toEmail + '</p>';
                }
            }

            if ( gReg.email.test( $('#toEmail2').val() ) ) {
                if (gReg.isEmail.test( $('#toEmail2').val() )) {
                    gObj.toEmails.push( $('#toEmail2').val() );
                    gIf.toEmail = true;
                } else {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].toEmail + '</p>';
                }
            }

            if (!gIf.toEmail) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].toEmail + '</p>';
            }

            if ($('#cpuAlertEnable').is(':checked') && !gReg.cpuAlertThreshold.test( $('#cpuAlertThreshold').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].cpuThreshold + '</p>';
            }
    
            if ($('#diskAlertEnable').is(':checked') && !gReg.diskAlertThreshold.test( $('#diskAlertThreshold').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].diskThreshold + '</p>';
            }
    
            if ($('#wanAlertEnable').is(':checked') && !gReg.alertInterval.test( $('#wanAlertInterval').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].wanAlertInterval + '</p>';
            }
    
            if ($('#virusAlertEnable').is(':checked') && !gReg.alertInterval.test( $('#virusAlertInterval').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].virusAlertInterval + '</p>';
            }
    
            //if ($('#ipsAlertEnable').is(':checked') && !gReg.alertInterval.test( $('#ipsAlertInterval').val() )) {
            //    pass = false;
            //    msg += '<p>' + gError[ gObj.lang ].ipsAlertInterval + '</p>';
            //}

            if (pass) {
                gCache.email_alert = {};
                gCache.email_alert.server = $('#server').val();
                gCache.email_alert.port = $('#port').val();
                gCache.email_alert.secureMethod = $('#secureMethod').val();
                gCache.email_alert.enableAuth = ($('#enableAuth').is(':checked'))? 1 : 0;
                gCache.email_alert.account = $('#account').val();
                gCache.email_alert.password = $('#password').val();
                gCache.email_alert.fromEmail = $('#fromEmail').val();

                gCache.email_alert.toEmail = gObj.toEmails.join(';');

                $.post('cgi-bin/checkSmtpSetting.cgi', gY.JSON.stringify( gCache.email_alert ), function(poster) {
                    if ( 0 === parseInt( poster.smtpErrorCode ) ) {
                        //noteAlert( gError[ gObj.lang ]['smtpErrorCode-0'] + gCache.email_alert.toEmail + ', ' + gError[ gObj.lang ].please_check_email );
                        noteAlert(); 
                    } else {
                        errorAlert( poster.smtpErrorMsg );
                    } 
                });
            } else {
                errorAlert( msg );
            }
        } else {
            errorAlert( gError[ gObj.lang ].no_data );
        }
    }

    function btnCheck(e) {
        var btID = $(e.currentTarget).attr('id');
        gIf.newUsername = false;
        if (gReg.ascii.username.test( $('#newUsername').val() )) {
            gCache.registration.registrationMode = 2;
            gCache.registration.newUsername = $('#newUsername').val();
            $.post('cgi-bin/accountRegistration.cgi', gY.JSON.stringify( gCache.registration ), function(poster) {
                if (parseInt(poster.status) == 0) {
                    gIf.newUsername = true;
                    $('.newUsername').removeClass('isKO');
                    $('.newUsername').addClass('isOK');
                }else {
                    $('.newUsername').removeClass('isOK');
                    $('.newUsername').addClass('isKO');
                    errorAlert( poster.msg );
                }
            }).fail( function(){
                errorAlert( 'register server connecting failed' );
            });
        }else {
            $('.newUsername').removeClass('isOK');
            $('.newUsername').addClass('isKO');
            errorAlert( 'username can only be [a-zA-Z0-9.@_-] and length should between 6 ~ 20' );
        }
    }
    
    function btnUpdate(e) {
        var btID = $(e.currentTarget).attr('id');
        json = gData.signature;
        json.startUpdate = 1;
        loadingToggle( true );

        $.ajax({
            type: "POST",
            url: 'cgi-bin/av_sig.cgi',
            dataType: "json",
            data: gY.JSON.stringify( json ),
            success: function( poster ) {
                if (0 === parseInt( poster.status )) {
                    loadingToggle( false );
                    successAlert( '<p>' + poster.msg + '</p>' );
                } else if (1 === parseInt( poster.status )) {
                    progressTAlert( 'avsignature' );
                } else {
                    loadingToggle( false );
                    errorAlert( gError[ gObj.lang ][ poster.msg ]);
                }
            }
        });
    }
    
    function btnLicenseUpgrade(e) {
        var btID = $(e.currentTarget).attr('id');
        if ($('#activeCode').val().length == 25 && gReg.isPassword.test($('#activeCode').val())) {
            var json = {};
            json = gData.services;
            json.activeCodeUpdate = 1;
            json.activeCode = $('#activeCode').val();
            loadingToggle( true );
            $.post('cgi-bin/serviceExpiration.cgi', gY.JSON.stringify(json), function(poster) {
                loadingToggle( false );
                if (parseInt(poster.status) == 0)
                    successAlert( '<p>' + poster.msg + '</p>' );
                else 
                    errorAlert( '<p>' + poster.msg + '</p>' ) ;
                
            });
        }else {
            errorAlert('<p>invalid active code!</p>');
        }
    }
    
    function btnLicenseRefresh(e) {
        var btID = $(e.currentTarget).attr('id');
        var json = gData.services;
        json.serviceRefresh = 1;
        loadingToggle( true );
        $.post('cgi-bin/serviceExpiration.cgi', gY.JSON.stringify(json), function(poster) {
            loadingToggle( false );
            if (parseInt(poster.status) == 0) 
                successAlert( '<p>' + poster.msg + '</p>' );
            else 
                errorAlert( poster.msg );
            
        });
    }

    function btnRun( e ) {
        var json = { "queryString" : $('#queryString').val(), "queryType" : false, "queryResult" : "" };
        if (gReg.isIPv4.test( $('#queryString').val() ) ) {
            json.queryType = "n";
        } else if (gReg.isURL.test( $('#queryString').val() ) ) {
            json.queryType = "a";
        }

        if (json.queryType) {
            loadingToggle( true );
            $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(json), function(poster) {
                loadingToggle( false );
                gIf.isStart = true;
            });
        }
    }

    function btnStart( e ) {
        var json = {};
        var checker = {};
        var msg = '';
        if ($('#destination').exists() && (gReg.isIPv4.test( $('#destination').val() ) || gReg.isURL.test( $('#destination').val() ) ) ) {
            loadingToggle( true );
            switch( gNode.tab )
            {   
            case 'ping':    
                json.packetsize = $('#packetsize').val();
                json.packetcount = $('#packetcount').val();
                break;
            case 'traceroute':    
                json.ttl = $('#ttl').val();
                break;
            }

            json.destination = $('#destination').val();
            json.result = '';
            json.action = 'start';

            $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(json), function(poster) {
                loadingToggle( false );
                gIf.isStart = true;
            });
        } else if ( 'advanced_debug' == gNode.tab ) {
            //checker = callCheckers( 'debug' );
            checker = formChecker( 'debug' );
            if (checker.pass) {
                loadingToggle( true );
                json = gData[ gNode.tab ];
                json.pcapEnable = 1;
                json.pcapDesc = $('#pcapDesc').val();
                json.pcapIfName = $('#pcapIfName').val();
                json.pcapPortStart = $('#pcapPortStart').val();
                json.pcapPortEnd = $('#pcapPortEnd').val();
                json.pcapHost = $('#pcapHost').val();
                json.pcapNetAddress = $('#pcapNetAddress').val();
                json.pcapNetmask = $('#pcapNetmask').val();
                json.pcapMac = $('#pcapMac').val();
                $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(json), function(poster) {
                    loadingToggle( false );
                    gObj.tabIndex = 1;
                    getCgiList(gObj.active.pid);
                });
            } else {
                for (var i=0, len=checker.cols.length; i<len; i++)
                {
                    if (!checker.cols[ i ].pass) {
                        msg += '<p>' + gError[ gObj.lang ][ checker.cols[ i ].id ] + '</p>';
                    }
                }
                errorAlert( msg );
                return false;
            }

        }
    }

    function btnStop( e ) {
        var json = {};
        if ( $('#destination').exists() && (gReg.isIPv4.test( $('#destination').val() ) || gReg.isURL.test( $('#destination').val() ) ) ) { 
            switch( gNode.tab )
            {
            case 'ping':
                json.packetsize = $('#paketsize').val();
                json.packetcount = $('#packetcount').val();
                break;
            case 'traceroute':
                json.ttl = $('#ttl').val();
                break;
            }

            json.destination = $('#destination').val();
            json.result = '';
            json.action = 'stop';
            gIf.isStart = false;

            $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(json));
        } else if ( 'advanced_debug' == gNode.tab ) {
            gData[ gNode.tab ].pcapEnable = 0;
            $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(gData[ gNode.tab ]), function(poster) {
                gObj.tabIndex = 1;
                getCgiList(gObj.active.pid);
            });
        }
    }

    function btnClean( e ) {
        $('#queryString').empty();
        $('#queryResult').empty();
    }

    function btnNew( data ) {
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');

        $('#popForm').dialog({
            width: 480,
            height:320,
            position: "center",
            resizable: false,
            modal: true,
            title: gTerm[ gObj.lang ][ gNode.tab ],
            buttons: {
                Start: function() {
                    if (!gIf.isCapture) {
                        var pass = true;
                        var msg = '';
                        if (!gReg.length127.test($('#Editor-desc').val())) {
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].length127 + '</p>';
                        }
                        
                        if ('NA' == $('#Editor-ifname').val()) {
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].ifname + '</p>';
                        }

                        if (!pass) {
                            errorAlert( msg );
                            return false;
                        }

                        $(':button:contains("Start")').prop('disabled', true);
                        $(':button:contains("Stop")').prop('disabled', false);

                        $('.debugging').prop('disabled', true);

                        gIf.isCapture = true;                    
                        gObj.form = {};
                        gObj.form.desc = $('#Editor-desc').val();
                        gObj.form.ifname = $('#Editor-ifname').val();
                        gObj.form.autoStop = ($('#Editor-autoStop').is(':checked'))? 1 : 0;
                        gObj.form.portStart = $('#Editor-portStart').val();
                        gObj.form.portEnd = $('#Editor-portEnd').val();
                        gObj.form.host = $('#Editor-host').val();
                        gObj.form.netAddress = $('#Editor-netAddress').val();
                        gObj.form.netmask = $('#Editor-netmask').val();
                        gObj.form.mac = $('#Editor-mac').val();
                        gObj.form.action = "start";
                        gObj.form.status = 0;
                        $.post('cgi-bin/' + gNode.url.capture + '.cgi', gY.JSON.stringify( gObj.form ));
                    }
                    gIf.isCapture = true;                    
                },
                Stop: function() {
                    $( this ).dialog( "close" );
                }
            },
            open: function(event, ui) {
                var tmp = '<div id="div-Editor-' + gNode.tab + '">';
                tmp += '<table id="table-Editor-' + gNode.tab + '">';
                for (var i=0, len=gNode.editor.length; i<len; i++)
                {
                    tmp += '<tr>';
                    switch( gNode.editor[ i ].type )
                    {
                    case 'table':
                        tmp += '<th class="alignLeft BT100" >';
                        tmp += gNode.editor[ i ].label;
                        tmp += '</th>';
                        tmp += '<td class="alignLeft">';
                        tmp += '<table id="table-Editor-' + gNode.editor[ i ].tab + '">';
                        for (var j=0, jlen=gNode.editor[ i ].col.length; j<jlen; j++)
                        {
                            tmp += '<tr>';
                            tmp += '<td class="alignLeft BT80">';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</td>';
                            tmp += '<td class="alignLeft">';
                            tmp += '<input class="debugging" type="text" id="Editor-' + gNode.editor[ i ].col[ j ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].size)? 'size="' + gNode.editor[ i ].col[ j ].size + '"' : '' ) + '/>';
                            tmp += '</td>';
                            tmp += '</tr>';
                        }
                        tmp += '</table>';
                        tmp += '</td>';
                        break;
                    case 'text':
                        tmp += '<th class="alignLeft BT120" >';
                        tmp += gNode.editor[ i ].label;
                        tmp += '</th>';
                        tmp += '<td class="alignLeft">';
                        tmp += '<input class="debugging" type="text" id="Editor-' + gNode.editor[ i ].tab + '" />';
                        tmp += '</td>';
                        break;
                    case 'checkbox':
                        tmp += '<td class="alignRight BT120" >';
                        tmp += '<input class="debugging" type="checkbox" id="Editor-' + gNode.editor[ i ].tab + '" value="1" />';
                        tmp += '</td>';
                        tmp += '<th class="alignLeft">';
                        tmp += '<label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label>';
                        tmp += '</th>';
                        break;
                    case 'select':
                        tmp += '<th class="alignLeft BT120" >';
                        tmp += gNode.editor[ i ].label;
                        tmp += '</th>';
                        tmp += '<td class="alignLeft">';
                        tmp += '<select class="debugging" id="Editor-' + gNode.editor[ i ].tab + '"></select>';
                        tmp += '</td>';
                        break;
                    }
                    tmp += '</tr>';
                }
                tmp += '</table>';
                tmp += '</div>';
        
                $('#popForm').html( tmp );
        
                if (data) {
                    $('#Editor-desc').val( data.desc );
                    cgiSelectOption( 'Editor-ifname', data.ifname );
                    if (1 === parseInt( data.autoStop ))
                        $('#Editor-autoStop').click();
                    $('#Editor-portStart').val( data.portStart );
                    $('#Editor-portEnd').val( data.portEnd);
                    $('#Editor-host').val( data.host );
                    $('#Editor-netAddress').val( data.netAddress );
                    $('#Editor-netmask').val( data.netmask );
                    $('#Editor-mac').val( data.mac );
                    $(':button:contains("Start")').prop('disabled', true);
                    $('.debugging').prop('disabled', true);
                    gIf.isCapture = true;                    
                } else {
                    $('#Editor-portStart').val(0);
                    $('#Editor-portEnd').val(0);
                    cgiSelectOption( 'Editor-ifname' );
                    $(':button:contains("Stop")').prop('disabled', true);
                }
            },
            close: function(event, ui) {
                if (gIf.isCapture) {
                    gObj.form.action = "stop";
                    gObj.form.status = 1;
                    $.post('cgi-bin/' + gNode.url.capture + '.cgi', gY.JSON.stringify( gObj.form ));
                    genDevice( gNode.tab );

                }
                gIf.isCapture = false;                    
                $(this).dialog('destroy').remove();
            }
        });

    }

    function btnDownload( e ) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');

        if (!tar.id)
            return false;

        tar.pid = tar.id.split('-')[ 1 ];

        tar.thisNo = tar.id.split('-')[ 2 ];

        window.open('cgi-bin/' + gNode.url.download + '.cgi?fpath=' + gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].filepath, "_blank");
    }

    function btnApply( e ) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');

        if (!tar.id)
            return false;

        tar.pid = tar.id.split('-')[ 1 ];
        tar.thisNo = tar.id.split('-')[ 2 ];

        gObj.config = gData.backup_restore.guiProfileT[ tar.thisNo ].name;

        cmdAlert( tar.pid, tar.thisNo );
    }
    
// alert 
    function successAlert( msg ) {
        if (!$('#popError').exists())
            $('#popBase').append('<div id="popError"></div>');
    
        $('#popError').html('<div class="errorForm"><p class="errorMsg"></p></div>');
        $('#popError').dialog({
            width: 300,
            height:200,
            position: "center",
            resizable: false,
            modal: true,
            title: gTerm[ gObj.lang ].successAlert,
            buttons: {
                okay: function() {
                    $( this ).dialog( "close" );
                    getCgiList(gObj.active.pid);
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });
    
        $('.errorMsg').html( msg );
    }

    function errorAlert( msg ) {
        if (!$('#popError').exists())
            $('#popBase').append('<div id="popError"></div>');
    
        $('#popError').html('<div class="errorForm"><p class="errorMsg"></p></div>');
        $('#popError').dialog({
            width: 300,
            height:200,
            position: "center",
            resizable: false,
            modal: true,
            title: gTerm[ gObj.lang ].errorAlert,
            buttons: {
                okay: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });

        $('.errorMsg').html( msg );
    }

    function noteAlert() {
        if (!$('#popError').exists())
            $('#popBase').append('<div id="popError"></div>');
    
        $('#popError').html('<div class="errorForm"></div>');
        $('#popError').dialog({
            width: 300,
            height:200,
            position: "center",
            resizable: false,
            modal: true,
            title: gTerm[ gObj.lang ].noteAlert,
            buttons: {
                okay: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });

        $('.errorForm').append( '<p>' + gError[ gObj.lang ][ 'smtpErrorCode-0' ] + '</p>' );
        for (var i=0, len=gObj.toEmails.length; i<len; i++) 
        {
            $('.errorForm').append( '<p>' + gObj.toEmails[ i ] + '</p>' );
        }
        $('.errorForm').append( '<p>' + gError[ gObj.lang ].please_check_email + '</p>' );
    }
    
    function remindAlert( msg ) {
        if (!$('#popError').exists())
            $('#popBase').append('<div id="popError"></div>');
    
        $('#popError').html('<div class="errorForm"><p class="errorMsg"></p></div>');
        $('#popError').dialog({
            width: 300,
            height:200,
            position: "center",
            resizable: false,
            modal: true,
            title: gTerm[ gObj.lang ].remindAlert,
            buttons: {
                okay: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });

        $('.errorMsg').html( msg );
    }

    function rebootAlert(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        var msg;
        if (!$('#popError').exists())
            $('#popBase').append('<div id="popError"></div>');
    
        $('#popError').html('<div class="errorForm"><p class="errorMsg"></p><div class="processDiv"></div></div>');
    
        // alert msg depend on target
        switch(tar.id)
        {
        case 'restoreConf':
            msg = '<p>' + gError[ gObj.lang ][ tar.id ] + gRef.rebooting[ tar.id ] + gError[ gObj.lang ].seconds + '</p>';
            break;
        case 'checkFirmware':
            msg = '<p>' + gError[ gObj.lang ][ tar.id ] + '</p>';
            break;
        case 'switchFirmware':
            msg = '<p>' + gError[ gObj.lang ][ tar.id ] + gRef.rebooting[ tar.id ] + gError[ gObj.lang ].seconds + '</p>';
            break;
        case 'resetDefault':
            msg = '<p>' + gError[ gObj.lang ][ tar.id ] + (($('#type-1').is(':checked'))? gError[ gObj.lang ].few_minutes : gRef.rebooting[ tar.id ] + gError[ gObj.lang ].seconds ) + '</p>';
            break;
        case 'upgradeFirmware':
            msg = '<p>' + gError[ gObj.lang ][ tar.id ] + (($('#type-1').is(':checked'))? gError[ gObj.lang ].few_minutes : gRef.rebooting[ tar.id ] + gError[ gObj.lang ].seconds) + '</p>';
            break;
        }
    
        $('.errorMsg').html(msg);

        gPop.popError = $('#popError').dialog({
            width: 300,
            height:200,
            position: "center",
            resizable: false,
            modal: true,
            title: gTerm[ gObj.lang ][ tar.id ],
            buttons: {
                okay: function() {
                    switch(tar.id)
                    {
                    case 'switchFirmware':
                        gData.firmware = {};
                        gData.firmware.action = 0;
                        loadingToggle( true );
                        $.post('cgi-bin/dev_firmware_post.cgi', gData.firmware , function(poster) {
                            if (0 === parseInt(poster.status)) {
                                gPop.popError.dialog( "close" );
                                gObj.loading = 99;
                                gIf.loading = true;
                                gIf.reboot = true;
                            }else {
                                loadingToggle( false );
                                $('.errorMsg').html( gError[ gObj.lang ][ poster.msg ]);
                            }
                        });
                        break;
                    case 'checkFirmware':
                        gData.firmware = {};
                        gData.firmware.action = 3;
                        loadingToggle( true );
                        $.post('cgi-bin/dev_firmware_post.cgi', gData.firmware, function(poster) {
                            loadingToggle( false );
                            $('.errorMsg').html( gError[ gObj.lang ][ poster.msg ]);
                            if (0 === parseInt(poster.status)) {
                                if ('success' == poster.msg)
                                    gIf.newFirmware = true;
                                else
                                    gIf.newFirmware = false;
                                gPop.popError.dialog( "close" );
                                getCgiList(gObj.active.pid);
                            }
                        });
                        break;
                    case 'upgradeFirmware':
                        gData.firmware = {};
                        $('#upgradeFirmware').prop('disabled', true);
                        $('#resetDefault').prop('disabled', true);

                        if ( $('#type-1').is(':checked') ) {
                            gData.firmware.type = 1;
                            gData.firmware.action = 1;
                            loadingToggle( true );
                            $.post('cgi-bin/dev_firmware_post.cgi', gData.firmware , function(poster) {
                                if (0 === parseInt(poster.status)) {
                                    gPop.popError.dialog( "close" );
                                    if ('no_change_required' == poster.msg) {
                                        loadingToggle( false );
                                        errorAlert( gError[ gObj.lang ][ poster.msg ] );
                                    } else {
                                        gObj.loading = 99;
                                        gIf.loading = true;
                                        gIf.reboot = true;
                                    }
                                }else {
                                    loadingToggle( false );
                                    $('.errorMsg').html( gError[ gObj.lang ][ poster.msg ]);
                                }
                            });
                        }else if ( $('#type-2').is(':checked') && $('#fpath').val() != 'NA') {
                            gData.firmware.type = 2;
                            gData.firmware.action = 1;
                            gData.firmware.fpath = $('#fpath').val();
                            loadingToggle( true );
                            $.post('cgi-bin/dev_firmware_post.cgi', gData.firmware , function(poster) {
                                if (0 === parseInt(poster.status)) {
                                    gPop.popError.dialog( "close" );
                                    gObj.loading = 99;
                                    gIf.loading = true;
                                    gIf.reboot = true;
                                }else {
                                    loadingToggle( false );
                                    $('.errorMsg').html( gError[ gObj.lang ][ poster.msg ]);
                                }
                            });
                        }else if (!gIf.uploaded && gObj.uploader.get("fileList").length > 0) {
                            gData.firmware.type = 0;
                            gData.firmware.action = 1;
                            if (gIf.invalid) {
                                $('.errorMsg').html( gError[ gObj.lang ][ 'invalid_firmware' ] );
                            } else {
                                loadingToggle( true );
                                $('.errorMsg').html( gError[ gObj.lang ][ 'please_wait_for_check' ] );
                                gObj.uploader.upload(gObj.uploaderFile, gObj.uploader.uploadURL, gData.firmware);
                            }
                        }
                        break;
                    case 'resetDefault':
                        gData.firmware = {};
                        $('#upgradeFirmware').prop('disabled', true);
                        $('#resetDefault').prop('disabled', true);

                        gObj.form = gData.firmware;
                        if ( $('#type-1').is(':checked') ) {
                            gData.firmware.type = 1;
                            gData.firmware.action = 2;
                            loadingToggle( true );
                            $.post('cgi-bin/dev_firmware_post.cgi', gData.firmware , function(poster) {
                                if (0 === parseInt(poster.status)) {
                                    gPop.popError.dialog( "close" );
                                    if ('no_change_required' == poster.msg) {
                                        loadingToggle( false );
                                        errorAlert( gError[ gObj.lang ][ poster.msg ] );
                                    } else {
                                        gObj.loading = 99;
                                        gIf.loading = true;
                                        gIf.reboot = true;
                                    }
                                }else {
                                    loadingToggle( false );
                                    $('.errorMsg').html( gError[ gObj.lang ][ poster.msg ]);
                                }
                            });
                        }else if ( $('#type-2').is(':checked') && $('#fpath').val() != 'NA') {
                            gData.firmware.type = 2;
                            gData.firmware.action = 2;
                            gData.firmware.fpath = $('#fpath').val();
                            loadingToggle( true );
                            $.post('cgi-bin/dev_firmware_post.cgi', gData.firmware , function(poster) {
                                if (0 === parseInt(poster.status)) {
                                    gPop.popError.dialog( "close" );
                                    gObj.loading = 99;
                                    gIf.loading = true;
                                    gIf.reboot = true;
                                }else {
                                    loadingToggle( false );
                                    $('.errorMsg').html( gError[ gObj.lang ][ poster.msg ]);
                                }
                            });
                        }else if (!gIf.uploaded && gObj.uploader.get("fileList").length > 0) {
                            gData.firmware.type = 0;
                            gData.firmware.action = 2;
                            if (gIf.invalid) {
                                $('.errorMsg').html( gError[ gObj.lang ].pleaes_check_file );
                            } else {
                                loadingToggle( true );
                                $('.errorMsg').html( gError[ gObj.lang ].please_wait_for_check );
                                gObj.uploader.upload(gObj.uploaderFile, gObj.uploader.uploadURL, gData.firmware);
                            }
                        }
                        break;
                    case 'restoreConf':
                        gData.firmware = {};
                        $('#backupConf').prop('disabled', true);
                        $('#restoreConf').prop('disabled', true);
                        if (parseInt(gData.backup_restore.status) == 1 && $('#restoreMode-1').is(':checked')) {
                            if ($('#fpath').val() != 'NA') {
                                gObj.conf = {};
                                gObj.conf.fpath = $('#fpath').val();
                                loadingToggle( true );
                                $.post('cgi-bin/conf_usb_restore.cgi', gObj.conf, function(poster) {
                                    if (0 === parseInt(poster.status)) {
                                        gPop.popError.dialog( "close" );
                                        gObj.loading = 99;
                                        gIf.loading = true;
                                        gIf.reboot = true;
                                    }else {
                                        loadingToggle( false );
                                        $('.errorMsg').html( gError[ gObj.lang ][ poster.msg ]);
                                    }
                                });
                            }
                        }else if (!gIf.uploaded && gObj.uploader.get("fileList").length > 0) {
                            if (gIf.invalid) {
                                $('.errorMsg').html( gError[ gObj.lang ].please_check_file );
                            } else {
                                loadingToggle( true );
                                gObj.uploader.upload(gObj.uploaderFile, gObj.uploader.uploadURL);
                            }
                        }
                        break;
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });
    
    }
    
    function alterAlert() {
        if (!$('#popError').exists())
            $('#popBase').append('<div id="popError"></div>');
    
        $('#popError').html('<div class="errorForm"><p class="errorMsg"></p></div>');
        
        $('#popError').dialog({
            width: 300,
            height:200,
            position: "center",
            resizable: false,
            modal: true,
            title: gTerm[ gObj.lang ].alterAlert,
            buttons: {
                okay: function() {
                    gIf.ajaxed = false;
                    gIf.columns = false;
                    gIf.systime = false; 
                    gObj.tabIndex = 0;
                    gIf.alter = false;
                    gIf.query = false;
                    gSort = {};
                    gQuery = {};
                    if (gObj.active.icon) {
                        gObj.active.icon.removeClass('ui-actived');
                        $('#activedMenu').remove();
                    }
                    gObj.actived = gObj.active;
        
                    if ($('#refreshPage').exists())
                        gObj.active.refresh = $('#refreshPage').val();
    
                    $('#main_hd').html( gObj.active.menu );
    
                    if (gIf.refresh) 
                        $('#refreshPage').append(genSelectOption( 'refreshPage' )).val( gObj.active.refresh );
    
                    if (gObj.active.h5Index == 'NA')
                        gNode = gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index];
                    else
                        gNode = gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index].panel[gObj.active.h5Index];
                    $('#main_ft').empty();
                    gObj.active.icon.addClass('ui-actived');
                    gObj.active.icon.prepend(gHtml.aMenu);
                    getCgiList( gObj.active.pid );
    
                    $( this ).dialog( "close" );
                },
                Cancel: function() {
                    gObj.active = gObj.actived;
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });
        $('.errorMsg').html('Change will not be saved!');
    }
    
    function cmdAlert(cmd, thisNo) {
        if (!$('#popError').exists())
            $('#popBase').append('<div id="popError"></div>');
    
        $('#popError').html('<div class="errorForm"><p class="errorMsg"></p></div>');
    
        $('#popError').dialog({
            width: 300,
            height:200,
            position: "center",
            resizable: false,
            modal: true,
            title: gTerm[ gObj.lang ].cmdAlert,
            buttons: {
                okay: function() {
                    loadingToggle( true );
                    gObj.loading = 99;
                    gIf.loading = true;
                    switch( cmd )
                    {
                    case 'reboot':
                        gObj.form = {};
                        gObj.form.action = 0;
                        gIf.reboot = true;
                        $.post('cgi-bin/dev_reboot.cgi', gY.JSON.stringify(gObj.form));
                        break;
                    case 'reset':
                        gObj.form = {};
                        gObj.form.action = 1;
                        gObj.form.resetMode = $('input[name=resetMode]:checked').val();
                        gIf.reboot = true;
                        $.post('cgi-bin/dev_reboot.cgi', gY.JSON.stringify(gObj.form));
                        break;
                    case 'shutdown':
                        gObj.form = {};
                        gObj.form.action = 2;
                        gObj.loading = 20;
                        gIf.shutdown = true;
                        $.post('cgi-bin/dev_reboot.cgi', gY.JSON.stringify(gObj.form));
                        break;
                    case 'backup_restore':
                        gData[ cmd ][ gNode.guiT ][ thisNo ].cgiAction = 1;
                        gIf.reboot = true;
                        $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(gData[ cmd ]));
                        break;
                    }

                    $( this ).dialog( "close" );
                },
                cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });
    
        switch(cmd)
        {
        case 'reboot':
        case 'reset':
        case 'shutdown':
        case 'backup_restore':
            $('.errorMsg').html( gTerm[ gObj.lang ][ cmd ] + gRef.rebooting[ cmd ] + ' ' + gError[ gObj.lang ].seconds);
            break;
        }
    }

    function progressTAlert( progress ) {
        if (!$('#popError').exists())
            $('#popBase').append('<div id="popError"></div>');
    
        $('#popError').html('<div class="errorForm"><p class="errorMsg"></p><div class="processDiv"></div></div>');
        $('#popError').dialog({
            width: 300,
            height:200,
            position: "center",
            resizable: false,
            modal: true,
            title: gTerm[ gObj.lang ].progressTAlert,
            buttons: {
                okay: function() {
                    if (!gIf.progressT) {
                        $(this).dialog('destroy').remove();
                        getCgiList(gObj.active.pid);
                    }
                }
            }
        });
        $( 'a.ui-dialog-titlebar-close' ).remove();
        gObj.progress = progress;
        gIf.progressT = true;
    }
    
    // based on template head, filter from data, with actions 
    function genDashboard(pid)
    {
        gIf.ajaxed = true;
        $('#main_bd').html( gHtml.dashboard );
    
        $('#main_ft').html( gHtml.dashmenu );
        // try portal start 
        //Use loader to grab the modules needed
        YUI({filter:"raw"}).use('anim', 'charts', 'console', 'cookie', 'dd', 'io-base', 'io-upload-iframe', 'json', 'json-parse', 'json-stringify', 'uploader', 'yui', function(Y) {
            //Make this an Event Target so we can bubble to it
            var Portal = function() {
                Portal.superclass.constructor.apply(this, arguments);
            };
            //Portal.NAME = 'portal';
            Portal.NAME = pid;
            Y.extend(Portal, Y.Base);
            //This is our new bubble target..
            Y.Portal = new Portal();
        
            Y.one('#feeds').hide();
    
            var showFeeds = false;
    
            Y.one('#dashmenu').on('click', function(e) {
                if (showFeeds) {
                    Y.one('#dashmenu').removeClass('isFocus');
                    showFeeds = false;
                    Y.one('#feeds').hide();
                } else {
                    Y.one('#dashmenu').addClass('isFocus');
                    showFeeds = true;
                    Y.one('#feeds').show();
                }
            });
    
            //Setup some private variables..
            var goingUp = false, lastY = 0, trans = {};
        
            //The list of feeds that we are going to use
        
            var feeds = {};
        
            for (var x in gNode.tmpl) 
                feeds[ gNode.tmpl[ x ].tab ] = { id: gNode.tmpl[ x ].tab, title: gNode.tmpl[ x ].label, url: gNode.tmpl[ x ].url, ext: gNode.tmpl[ x ].ext, links: gNode.tmpl[ x ].links, tag: gNode.tmpl[ x ].tag, type: gNode.tmpl[ x ].type, guiT: gNode.tmpl[ x ].guiT, guiTNum: gNode.tmpl[ x ].guiTNum, thead: gNode.tmpl[ x ].thead, col: gNode.tmpl[ x ].col , icon: gNode.tmpl[ x ].icon};
    
            //Simple method for stopping event propagation
            //Using this so we can detach it later
            var stopper = function(e) {
                e.stopPropagation();
            };
        
            //Get the order, placement and minned state of the modules and save them to a cookie
            var _setCookies = function() {
                var dds = Y.DD.DDM._drags;
                var list = {};
                //Walk all the drag elements
                Y.each(dds, function(v, k) {
                    var par = v.get('node').get('parentNode');
                    //Find all the lists with drag items in them
                    if (par.test('ul.list')) {
                        if (!list[par.get('id')]) {
                            list[par.get('id')] = [];
                        }
                    }
                });
                //Walk the list
                Y.each(list, function(v, k) {
                    //Get all the li's in the list
                    var lis = Y.all('#' + k + ' li.item');
                    lis.each(function(v2, k2) {
                        //Get the drag instance for the list item
                        var dd = Y.DD.DDM.getDrag('#' + v2.get('id'));
                        //Get the mod node
                        var mod = dd.get('node').one('div.mod');
                        //Is it minimized
                        var min = (mod.hasClass('minned')) ? true : false;
                        //Setup the cookie data
                        list[k][list[k].length] = { id: dd.get('data').id, min: min };
                    });
                });
                //JSON encode the cookie data
                var cookie = Y.JSON.stringify(list);
                //Set the sub-cookie
                Y.Cookie.setSub( gCook.portal, pid, cookie );
            };
        
            //Helper method for creating the feed DD on the left
            var _createFeedDD = function(node, data) {
                //Create the DD instance
                var dd = new Y.DD.Drag({
                    node: node,
                    data: data,
                    bubbles: Y.Portal
                }).plug(Y.Plugin.DDProxy, {
                    moveOnEnd: false,
                    borderStyle: 'none'
                });
                //Setup some stopper events
                dd.on('drag:start', _handleStart);
                dd.on('drag:end', stopper);
                dd.on('drag:drophit', stopper);
                
            };
        
            //Handle the node:click event
            var _nodeClick = function(e) {
                //Is the target an href?
                if (e.target.test('span')) {
                    var a = e.target, anim = null, div = a.get('parentNode').get('parentNode').get('parentNode');
    
                    // if links trigger?
                    if (a.hasClass('dashboardL')) {
                        var sArr = a.get('id').split(gReg.isDash);
                        for (var i=0, len=sArr.length; i<len; i++)
                        {
                            switch(i) 
                            {
                            case 0:
                                $('#' + sArr[ i ] + ' h3').click();
                                break;
                            case 1:
                                if ( $('#' + sArr[ i ] + ' h4').is('.ui-state-active') == false)
                                    $('#' + sArr[ i ] + ' h4').click();
                                break;
                            case 2:
                                $('#' + sArr[ i ] + ' h5').click();
                                break;
                            }
                        }
                    }
                    //Did they click on the min button
                    if (a.hasClass('dashboardM')) {
                        //Get some node references
                        var ul = div.one('ul'),
                            h2 = div.one('h2'),
                        h = h2.get('offsetHeight'),
                        //hUL = ul.get('offsetHeight'),
                        inner = div.one('div.inner'),
                        innerDV = inner.one('div.innerDiv'),
                        hDV   = innerDV.get('offsetHeight');
                        
                        //Create an anim instance on this node.
                        anim = new Y.Anim({
                            node: inner
                        });
                        //Is it expanded?
                        if (!div.hasClass('minned')) {
                            //Set the vars for collapsing it
                            anim.setAttrs({
                                to: {
                                    height: 0
                                },
                                //duration: '.25',
                                duration: '1',
                                easing: Y.Easing.easeOut,
                                iteration: 1
                            });
                            //On the end, toggle the minned class
                            //Then set the cookies for state
                            anim.on('end', function() {
                                div.toggleClass('minned');
                                _setCookies();
                            });
                        } else {
                            //Set the vars for expanding it
                            anim.setAttrs({
                                to: {
                                    //height: (hUL)
                                    height: (hDV)
                                },
                                //duration: '.25',
                                duration: '1',
                                easing: Y.Easing.easeOut,
                                iteration: 1
                            });
                            //Toggle the minned class
                            //Then set the cookies for state
                            div.toggleClass('minned');
                            _setCookies();
                        }
                        //Run the animation
                        anim.run();
        
                    }
                    //Was close clicked?
                    if (a.hasClass('dashboardX')) {
                        // reset inner counts
                        //Get some Node references..
                        var li = div.get('parentNode'),
                            id = li.get('id'),
                            dd = Y.DD.DDM.getDrag('#' + id),
                            data = dd.get('data'),
                            item = Y.one('#' + data.id);
        
                        //Destroy the DD instance.
                        dd.destroy();
                        //Setup the animation for making it disappear
                        anim = new Y.Anim({
                            node: div,
                            to: {
                                opacity: 0
                            },
                            duration: '.25',
                            easing: Y.Easing.easeOut
                        });
                        anim.on('end', function() {
                            //On end of the first anim, setup another to make it collapse
                            var anim = new Y.Anim({
                                node: div,
                                to: {
                                    height: 0
                                },
                                duration: '.25',
                                easing: Y.Easing.easeOut
                            });
                            anim.on('end', function() {
                                //Remove it from the document
                                li.get('parentNode').removeChild(li);
                                item.removeClass('disabled');
                                //Setup a drag instance on the feed list
                                _createFeedDD(item, data);
                                _setCookies();
        
                            });
                            //Run the animation
                            anim.run();
                        });
                        //Run the animation
                        anim.run();
                    }
                    //Stop the click
                    e.halt();
                }
            };
            
            //This creates the module, either from a drag event or from the cookie load
            var setupModDD = function(mod, data, dd) {
                var node = mod;
                //Listen for the click so we can react to the buttons
                node.one('h2').on('click', _nodeClick);
                
                //Remove the event's on the original drag instance
                dd.detachAll('drag:start');
                dd.detachAll('drag:end');
                dd.detachAll('drag:drophit');
                
                //It's a target
                dd.set('target', true);
                //Setup the handles
                dd.addHandle('h2').addInvalid('a');
                //Remove the mouse listeners on this node
                dd._unprep();
                //Update a new node
                dd.set('node', mod);
                //Reset the mouse handlers
                dd._prep();
                // cache for sorting        
                gSort[ data.id ] = data;

                // Define a function to handle the response data.
                genInnerHTML( mod.one('div.inner'), data);
            };
        
            //Helper method to create the markup for the module..
            var createMod = function(feed) {
                var str = '<li class="item"><div class="mod"><h2><strong>' + feed.title + '</strong> ';
                if (feed.links)
                    str += '<a title="links module" class="links" href="#"><span id="' + feed.links + '" class="dashboardL"></span></a>';
                str += '<a title="minimize module" class="min" href="#"><span class="dashboardM"></span></a>';
                str += '<a title="close module" class="close" href="#"><span class="dashboardX"></span></a></h2>';
                str += '<div class="inner">';
                str += '<div class="loading">loading, please wait..</div>'; 
                str += '</div>';
                str += '</div>';
                str += '</li>';
                return Y.Node.create(str);
            };
            
            //Handle the start Drag event on the left side
            var _handleStart = function(e) {
                //Stop the event
                stopper(e);
                //Some private vars
                var drag = this,
                    mod = createMod(drag.get('data'));
                
                //Add it to the first list
                //list3.appendChild(mod);
                Y.one('#list1').appendChild(mod);
                //Set the item on the left column disabled.
                drag.get('node').addClass('disabled');
                //Set the node on the instance
                drag.set('node', mod);
                //Add some styles to the proxy node.
                drag.get('dragNode').setStyles({
                    opacity: '.5',
                    borderStyle: 'none',
                    width: '320px',
                    height: '61px'
                });
                //Update the innerHTML of the proxy with the innerHTML of the module
                drag.get('dragNode').set('innerHTML', drag.get('node').get('innerHTML'));
                //set the inner module to hidden
                drag.get('node').one('div.mod').setStyle('visibility', 'hidden');
                //add a class for styling
                drag.get('node').addClass('moving');
                //Setup the DD instance
                setupModDD(mod, drag.get('data'), drag);
        
                //Remove the listener
                this.detach('drag:start', _handleStart);
            };
            
            //Walk through the feeds list and create the list on the left
            var feedList = Y.one('#feeds ul');
            Y.each(feeds, function(v, k) {
                var li = Y.Node.create('<li id="' + k + '">' + v.title + '</li>');
                feedList.appendChild(li);
                //Create the DD instance for this item
                _createFeedDD(li, v);
            });
        
            //This does the calculations for when and where to move a module
            var _moveMod = function(drag, drop) {
                if (drag.get('node').hasClass('item')) {
                    var dragNode = drag.get('node'),
                        dropNode = drop.get('node'),
                        append = false,
                        padding = 30,
                        xy = drag.mouseXY,
                        region = drop.region,
                        middle1 = region.top + ((region.bottom - region.top) / 2),
                        middle2 = region.left + ((region.right - region.left) / 2),
                        dir = false,
                        dir1 = false,
                        dir2 = false;
                        
                        //We could do something a little more fancy here, but we won't ;)
                        if ((xy[1] < (region.top + padding))) {
                            dir1 = 'top';
                        }
                        if ((region.bottom - padding) < xy[1]) {
                            dir1 = 'bottom';
                        }
                        if ((region.right - padding) < xy[0]) {
                            dir2 = 'right';
                        }
                        if ((xy[0] < (region.left + padding))) {
                            dir2 = 'left';
                        }
                        dir = dir2;
                        if (dir2 === false) {
                            dir = dir1;
                        }
                        switch (dir) {
                            case 'top':
                                var next = dropNode.get('nextSibling');
                                if (next) {
                                    dropNode = next;
                                } else {
                                    append = true;
                                }
                                break;
                            case 'bottom':
                                break;
                            case 'right':
                            case 'left':
                                break;
                        }
                    
        
                    if ((dropNode !== null) && dir) {
                        if (dropNode && dropNode.get('parentNode')) {
                            if (!append) {
                                dropNode.get('parentNode').insertBefore(dragNode, dropNode);
                            } else {
                                dropNode.get('parentNode').appendChild(dragNode);
                            }
                        }
                    }
                    //Resync all the targets because something moved..
                    Y.Lang.later(50, Y, function() {
                        Y.DD.DDM.syncActiveShims(true);
                    });
                }
            };
        
            // Handle the drop:enter event
            // Now when we get a drop enter event, we check to see if the target is an LI, then we know it's out module.
            // Here is where we move the module around in the DOM.    
    
            Y.Portal.on('drop:enter', function(e) {
                if (!e.drag || !e.drop || (e.drop !== e.target)) {
                    return false;
                }
                if (e.drop.get('node').get('tagName').toLowerCase() === 'li') {
                    if (e.drop.get('node').hasClass('item')) {
                        _moveMod(e.drag, e.drop);
                    }
                }
            });
        
            // Handle the drag:drag event
            // On drag we need to know if they are moved up or down so we can place the module in the proper DOM location.
            Y.Portal.on('drag:drag', function(e) {
                var y = e.target.mouseXY[1];
                if (y < lastY) {
                    goingUp = true;
                } else {
                    goingUp = false;
                }
                lastY = y;
            });
        
            // Handle the drop:hit event
            // Now that we have a drop on the target, we check to see if the drop was not on a LI.
            // This means they dropped on the empty space of the UL.
    
            Y.Portal.on('drag:drophit', function(e) {
                var drop = e.drop.get('node'),
                    drag = e.drag.get('node');
        
                if (drop.get('tagName').toLowerCase() !== 'li') {
                    if (!drop.contains(drag)) {
                        drop.appendChild(drag);
                    }
                }
            });
        
            //Handle the drag:start event
            //Use some CSS here to make our dragging better looking.
            Y.Portal.on('drag:start', function(e) {
                var drag = e.target;
                if (drag.target) {
                    drag.target.set('locked', true);
                }
                drag.get('dragNode').set('innerHTML', drag.get('node').get('innerHTML'));
                drag.get('dragNode').setStyle('opacity','.5');
                drag.get('node').one('div.mod').setStyle('visibility', 'hidden');
                drag.get('node').addClass('moving');
            });
        
            //Handle the drag:end event
            //Replace some of the styles we changed on start drag.
            Y.Portal.on('drag:end', function(e) {
                var drag = e.target;
                if (drag.target) {
                    drag.target.set('locked', false);
                }
                drag.get('node').setStyle('visibility', '');
                drag.get('node').one('div.mod').setStyle('visibility', '');
                drag.get('node').removeClass('moving');
                drag.get('dragNode').set('innerHTML', '');
                _setCookies();
            });
        
            //Handle going over a UL, for empty lists
            Y.Portal.on('drop:over', function(e) {
                var drop = e.drop.get('node'),
                    drag = e.drag.get('node');
        
                if (drop.get('tagName').toLowerCase() !== 'li') {
                    if (!drop.contains(drag)) {
                        drop.appendChild(drag);
                        Y.Lang.later(50, Y, function() {
                            Y.DD.DDM.syncActiveShims(true);
                        });
                    }
                }
            });
        
            //Create simple targets for the main lists..
            var uls = Y.all('#play ul.list');
            uls.each(function(v, k) {
                var tar = new Y.DD.Drop({
                    node: v,
                    padding: '20 0',
                    bubbles: Y.Portal
                });
            });
            
            //Get the cookie data
            var cookie = Y.Cookie.getSub( gCook.portal, pid );
            var obj = {};
            if (cookie) {
                //JSON parse the stored data
                obj = Y.JSON.parse(cookie);
            } else {
                obj.list1 = [];
                obj.list2 = [];
                var cnt = 0;
                var list;
                for (var x in feeds)
                {
                    if (cnt % 2 == 0) {
                        list = Y.one('#list1');
                        obj.list1.push({id: feeds[ x ].id, min: false});
                    } else {
                        list = Y.one('#list2');
                        obj.list2.push({id: feeds[ x ].id, min: false});
                    }
                    cnt++;
                }
            }
    
            //Walk the data
            Y.each(obj, function(v, k) {
                //Get the node for the list
                var list = Y.one('#' + k);
                //Walk the items in this list
                Y.each(v, function(v2, k2) {
                    //Get the drag for it
                    var drag = Y.DD.DDM.getDrag('#' + v2.id);
                    //Create the module
                    var mod = createMod(drag.get('data'));
                    if (v2.min) {
                        //If it's minned add some CSS
                        mod.one('div.mod').addClass('minned');
                        mod.one('div.inner').setStyle('height', '0px');
                    }
                    //Add it to the list
                    list.appendChild(mod);
                    //Set the drag listeners
                    drag.get('node').addClass('disabled');
                    drag.set('node', mod);
                    drag.set('dragNode', Y.DD.DDM._proxy);
                    drag.detachAll('drag:start');
                    drag.detachAll('drag:end');
                    drag.detachAll('drag:drophit');
                    drag._unprep();
                    //Setup the new Drag listeners
                    setupModDD(mod, drag.get('data'), drag);
                });
            });
        });
    }

    function refreshDashboard( pid, id ) {
        gIf.ajaxed = true;
        gIf.getSessInfo = true;
        var tmp = '';

        if (pid) {
            // id 
            $('#table-' + pid + ' tbody').empty();
            switch( gSort[ pid ].ext )
            {
            case 'cgi':
                $.ajax({
                    url: 'cgi-bin/' + gSort[ pid ].url.get + '.' + gSort[ pid ].ext,
                    dataType: 'json',
                    success: function(data) {
                        data[ gSort[ pid ].guiT ] = dataSort( data[ gSort[ pid ].guiT ], pid );
                        for (var i=0, len=((pid == 'dashboard_log')? data[ gSort[ pid ].guiT ].length : data[ gSort[ pid ].guiTNum ]); i<len; i++)
                        {
                            tmp += '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                            for (var j=0; j<gSort[ pid ].col.length; j++)
                            {
                                tmp += '<td class="';
                                if (gSort[ pid ].col[ j ].align)
                                    tmp += ' align' + gSort[ pid ].col[ j ].align;
                                tmp += '"';
                                if (gSort[ pid ].col[ j ].wiz)
                                    tmp += ' style="width:' + gSort[ pid ].col[ j ].wiz + '"';
                                tmp += '>';
                                if ( gSort[ pid ].col[ j ].tab == 'link' ) {
                                    tmp += gRef[ pid ][ gSort[ pid ].col[ j ].tab ][ data[ gSort[ pid ].guiT ][ i ][ gSort[ pid ].col[ j ].tab ] ];
                                    tmp += '<span class="linkStatus ' + ( (1 === parseInt( data[ gSort[ pid ].guiT ][ i ][ gSort[ pid ].col[ j ].tab ] ))? 'linkUp' : 'linkDown' ) + '"></span>';
    
                                }else if ( gSort[ pid ].col[ j ].tab == 'tx' || gSort[ pid ].col[ j ].tab == 'rx' ) {
                                    var mkbs = parseInt( data[ gSort[ pid ].guiT ][ i ][ gSort[ pid ].col[ j ].tab ] ) * 8;
                                    if (mkbs > 1000) {
                                        tmp += (mkbs/1000).toFixed(2) + ' Mb/s';
                                    } else if ( mkbs == 0) {
                                        tmp += '0';
                                    } else {
                                        tmp += mkbs + ' Kb/s';
                                    }
                                } else if ( gRef[ pid ] && gRef[ pid ][ gSort[ pid ].col[ j ].tab ] )
                                    tmp += gRef[ pid ][ gSort[ pid ].col[ j ].tab ][ data[ gSort[ pid ].guiT ][ i ][ gSort[ pid ].col[ j ].tab ] ];
                                else
                                    tmp += data[ gSort[ pid ].guiT ][ i ][ gSort[ pid ].col[ j ].tab ];
                                tmp += '</td>';
                            }
                            tmp += '</tr>';
                        }
                        $('#table-' + pid + ' tbody').append( tmp );
                    }
                });
                break;
            case 'php':
                var ascend = gY.one('#table-' + pid + ' thead').all('span.sortable.ascending');
                var descend = gY.one('#table-' + pid + ' thead').all('span.sortable.descending');
                var sortBy = '';

                if (ascend._nodes.length > 0) {
                    sortBy = '&oby=' + ascend._nodes[ 0 ].id.split('-')[ 2 ];
                    sortBy += '&asc=1';
                } else if ( descend._nodes.length > 0) {
                    sortBy = '&oby=' + descend._nodes[ 0 ].id.split('-')[ 2 ];
                }
                
                $.ajax({
                    url: gObj.phpQuery.php + '.php?param=' + pid + sortBy,
                    dataType: 'json',
                    success: function(data) {
                       
                        if (parseInt(data.queryRows) > 0) {
                            data.queryResults = dataSortPhp( data.queryResults, pid );
                            for (var j=0; j<data.queryResults.length; j++)
                            {
                                tmp += '<tr class="' + ( (j%2==0)? 'even': 'odd' )+ '">';
                                for (var i=0; i<gSort[ data.param ].col.length; i++)
                                {
                                    tmp += '<td class="';
                                    if (gSort[ data.param ].col[ i ].align)
                                        tmp += ' align' + gSort[ data.param ].col[ i ].align;
                                    tmp += '"';
                                    if (gSort[ data.param ].col[ i ].wiz)
                                        tmp += ' style="width:' + gSort[ data.param ].col[ i ].wiz + '"';
                                    tmp += '>';
                                    if ( gSort[ data.param ].col[ i ].tab == 'index' )
                                        tmp += (i+1);
                                    else if (data.queryResults[ j ][ gSort[ data.param ].col[ i ].tab ]) {
                                        switch ( gSort[ data.param ].col[ i ].tab )
                                        {
                                        case 'trafficAmount':
                                        case 'tx':
                                        case 'rx':
                                            var mkbs = parseInt( data.queryResults[ j ][ gSort[ data.param ].col[ i ].tab ] );
                                            if (mkbs > 1000000000) {
                                                tmp += (mkbs/1000000000).toFixed(2) + ' GB';
                                            } else if (mkbs > 1000000) {
                                                tmp += (mkbs/1000000).toFixed(2) + ' MB';
                                            } else if (mkbs == 0) {
                                                tmp += '0';
                                            } else {
                                                tmp += (mkbs/1000).toFixed(2) + ' KB';
                                            }
                                            break;
                                        default:
                                            tmp += data.queryResults[ j ][ gSort[ data.param ].col[ i ].tab ];
                                        }
                                    } else
                                        tmp += '';
                                    tmp += '</td>';
                                }
                                tmp += '</tr>';
                            }
                            $('#table-' + pid + ' tbody').append( tmp );
                        }
                        if (gIf.refresh)
                            gObj.active.counting = gObj.active.refresh;
                    }
                });                

                break;
            }
        } else {
            // all
            //Get the cookie data
            var cookie = gY.Cookie.getSub( gCook.portal, gObj.active.pid );
            if ( cookie ) {
                var obj = gY.JSON.parse(cookie);
            
                //Walk the data
                gY.each(obj, function(v, k) {
                    //Get the node for the list
                    var list = gY.one('#' + k);
                    //Walk the items in this list
                    gY.each(v, function(v2, k2) {
                        switch( gSort[ v2.id ].ext )
                        {
                        case 'cgi':
                            $.ajax({
                                url: 'cgi-bin/' + gSort[ v2.id ].url.get + '.' + gSort[ v2.id ].ext,
                                dataType: 'json',
                                success: function(data) {
                                    if ( 'dashboard_sys_info' == v2.id ) {
                                        for (var z in data)
                                        {
                                            switch( z )
                                            {
                                            case 'sigVer':
                                                $('#' + v2.id + '-' + z).html( gObj.sigVer );
                                                break;
                                            case 'primaryVer':
                                                $('#' + v2.id + '-' + z).html( data[ z ] );
                                                if (gIf.newFirmware)
                                                    $('#' + v2.id + '-' + z).html( data[ z ] + '<button id="newFirmware" class="NewFirmware" title="new firmware available"><span class="ui-icon"></span></button>');
                                                else 
                                                    $('#' + v2.id + '-' + z).html( data[ z ] );
                                                break;
                                            default:
                                                $('#' + v2.id + '-' + z).html( data[ z ] );
                                            }
                                        }
                                    } else if ( 'dashboard_resource' == v2.id ) {
                                        $('#' + v2.id + '-cpuUtilization').html( data.cpuUtilization + '%' );
                                        $('.cpuUtilization').progressbar( {value: parseInt( data.cpuUtilization )} );
                                        $('#' + v2.id + '-memoryUtilization').html( data.memoryUtilization + '%' );
                                        $('.memoryUtilization').progressbar( {value: parseInt( data.memoryUtilization )} );
                                    } else if ( 'dashboard_s2svpn' == v2.id ) {
                                        for (var z in data)
                                        {
                                            $('#' + v2.id + '-' + z).html( data[ z ] );
                                        }
                                    } else {
                                        $('#table-' + v2.id + ' tbody').empty();
                                        if (!gSort[ v2.id ]) 
                                            return false;

                                        data[ gSort[ v2.id ].guiT ] = dataSort( data[ gSort[ v2.id ].guiT ], v2.id );
                                        tmp = '';
                                        for (var i=0, len=((v2.id == 'dashboard_log')? data[ gSort[ v2.id ].guiT ].length : data[ gSort[ v2.id ].guiTNum ]); i<len; i++)
                                        {
                                            tmp += '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                                            for (var j=0; j<gSort[ v2.id ].col.length; j++)
                                            {
                                                tmp += '<td class="';
                                                if (gSort[ v2.id ].col[ j ].align)
                                                    tmp += ' align' + gSort[ v2.id ].col[ j ].align;
                                                tmp += '"';
                                                if (gSort[ v2.id ].col[ j ].wiz)
                                                    tmp += ' style="width:' + gSort[ v2.id ].col[ j ].wiz + '"';
                                                tmp += '>';
                                                if ( gSort[ v2.id ].col[ j ].tab == 'link' ) {
                                                    tmp += gRef[ v2.id ][ gSort[ v2.id ].col[ j ].tab ][ data[ gSort[ v2.id ].guiT ][ i ][ gSort[ v2.id ].col[ j ].tab ] ];
                                                    tmp += '<span class="linkStatus ' + ( (1 === parseInt( data[ gSort[ v2.id ].guiT ][ i ][ gSort[ v2.id ].col[ j ].tab ] ))? 'linkUp' : 'linkDown' ) + '"></span>';
                
                                                } else if ( gSort[ v2.id ].col[ j ].tab == 'tx' || gSort[ v2.id ].col[ j ].tab == 'rx' ) {
                                                    var mkbs = parseInt( data[ gSort[ v2.id ].guiT ][ i ][ gSort[ v2.id ].col[ j ].tab ] ) * 8;
                                                    if (mkbs > 1000) {
                                                        tmp += (mkbs/1000).toFixed(2) + ' Mb/s';
                                                    } else if ( mkbs == 0) {
                                                        tmp += '0';
                                                    } else {
                                                        tmp += mkbs + ' Kb/s';
                                                    }
                                                } else if ( gRef[ v2.id ] && gRef[ v2.id ][ gSort[ v2.id ].col[ j ].tab ] )
                                                    tmp += gRef[ v2.id ][ gSort[ v2.id ].col[ j ].tab ][ data[ gSort[ v2.id ].guiT ][ i ][ gSort[ v2.id ].col[ j ].tab ] ];
                                                else
                                                    tmp += data[ gSort[ v2.id ].guiT ][ i ][ gSort[ v2.id ].col[ j ].tab ];
                                                tmp += '</td>';
                                            }
                                            tmp += '</tr>';
                                        }
                                        $('#table-' + v2.id + ' tbody').append( tmp );
                                    }
                                }
                            });
                            break;
                        case 'php':
                            var ascend = gY.one('#table-' + v2.id + ' thead').all('span.sortable.ascending');
                            var descend = gY.one('#table-' + v2.id + ' thead').all('span.sortable.descending');
                            var sortBy = '';
            
                            if (ascend._nodes.length > 0) {
                                sortBy = '&oby=' + ascend._nodes[ 0 ].id.split('-')[ 2 ];
                                sortBy += '&asc=1';
                            } else if ( descend._nodes.length > 0) {
                                sortBy = '&oby=' + descend._nodes[ 0 ].id.split('-')[ 2 ];
                            }
                            
                            $.ajax({
                                url: gObj.phpQuery.php + '.php?param=' + v2.id + sortBy,
                                dataType: 'json',
                                success: function(data) {
                                    if (parseInt(data.queryRows) > 0) {
                                        data.queryResults = dataSortPhp( data.queryResults, pid );
                                        $('#table-' + data.param + ' tbody').empty();
                                        tmp = '';
                                        for (var j=0; j<data.queryResults.length; j++)
                                        {
                                            tmp += '<tr class="' + ( (j%2==0)? 'even': 'odd' )+ '">';
                                            for (var i=0; i<gSort[ data.param ].col.length; i++)
                                            {
                                                tmp += '<td class="';
                                                if (gSort[ data.param ].col[ i ].align)
                                                    tmp += ' align' + gSort[ data.param ].col[ i ].align;
                                                tmp += '"';
                                                if (gSort[ data.param ].col[ i ].wiz)
                                                    tmp += ' style="width:' + gSort[ data.param ].col[ i ].wiz + '"';
                                                tmp += '>';
                                                if ( gSort[ data.param ].col[ i ].tab == 'index' )
                                                    tmp += (i+1);
                                                else if (data.queryResults[ j ][ gSort[ data.param ].col[ i ].tab ]) {
                                                    switch ( gSort[ data.param ].col[ i ].tab )
                                                    {
                                                    case 'trafficAmount':
                                                    case 'tx':
                                                    case 'rx':
                                                        var mkbs = parseInt( data.queryResults[ j ][ gSort[ data.param ].col[ i ].tab ] );
                                                        if (mkbs > 1000000000) {
                                                            tmp += (mkbs/1000000000).toFixed(2) + ' GB';
                                                        } else if (mkbs > 1000000) {   
                                                            tmp += (mkbs/1000000).toFixed(2) + ' MB';
                                                        } else if (mkbs == 0) {
                                                            tmp += '0';
                                                        } else { 
                                                            tmp += (mkbs/1000).toFixed(2) + ' KB';
                                                        }
                                                        break;
                                                    default:
                                                        tmp += data.queryResults[ j ][ gSort[ data.param ].col[ i ].tab ];
                                                    }
                                                } else
                                                    tmp += '';
                                                tmp += '</td>';
                                            }
                                            tmp += '</tr>';
                                        }
                                        $('#table-' + data.param + ' tbody').append( tmp );
                                        if (gIf.refresh)
                                            gObj.active.counting = gObj.active.refresh;
                                    }
                                }
                            });                
                            break;
                        }

                    });
                });
            } else if ( gSort ) {
                for (var x in gSort )
                {
                    switch( gSort[ x ].ext )
                    {
                    case 'cgi':
                        $.ajax({
                            url: 'cgi-bin/' + gSort[ x ].url.get + '.' + gSort[ x ].ext,
                            dataType: 'json',
                            success: function(data) {
                                var y;
                                tmp = '';
                                
                                if ( data.sysName ) {
                                    y = 'dashboard_sys_info';
                                    for (var z in data)
                                    {
                                        $('#' + y + '-' + z).html( data[ z ] );
                                    }
                                } else if ( data.dramSize ) {
                                    y = 'dashboard_resource';

                                    $('#' + y + '-cpuUtilization').html( data.cpuUtilization + '%' );
                                    $('.cpuUtilization').progressbar( {value: parseInt( data.cpuUtilization )} );
                                    $('#' + y + '-memoryUtilization').html( data.memoryUtilization + '%' );
                                    $('.memoryUtilization').progressbar( {value: parseInt( data.memoryUtilization )} );

                                } else if ( data.tunnelNum ) {
                                    y = 'dashboard_s2svpn';
                                    for (var z in data)
                                    {
                                        $('#' + y + '-' + z).html( data[ z ] );
                                    }
                                } else if ( data.guiLanIfT ) {
                                    y = 'dashboard_lan';
                                    $('#table-' + y + ' tbody').empty();
                                    
                                    if (!gSort[ y ])
                                        return false;
                                    data[ gSort[ y ].guiT ] = dataSort( data[ gSort[ y ].guiT ], y );
                                    for (var i=0; i<data[ gSort[ y ].guiTNum ]; i++)
                                    {
                                        tmp += '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                                        for (var j=0; j<gSort[ y ].col.length; j++)
                                        {
                                            tmp += '<td class="';
                                            if (gSort[ y ].col[ j ].align)
                                                tmp += ' align' + gSort[ y ].col[ j ].align;
                                            tmp += '"';
                                            if (gSort[ y ].col[ j ].wiz)
                                                tmp += ' style="width:' + gSort[ y ].col[ j ].wiz + '"';
                                            tmp += '>';
                                            if ( gRef[ y ] && gRef[ y ][ gSort[ y ].col[ j ].tab ] )
                                                tmp += gRef[ y ][ gSort[ y ].col[ j ].tab ][ data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ] ];
                                            else
                                                tmp += data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ];
                                            tmp += '</td>';
                                        }
                                        tmp += '</tr>';
                                    }
                                    $('#table-' + y + ' tbody').append( tmp );

                                } else if ( data.guiWanIfT ) {
                                    y = 'dashboard_wan';
                                    $('#table-' + y + ' tbody').empty();

                                    if (!gSort[ y ])
                                        return false;
                                    data[ gSort[ y ].guiT ] = dataSort( data[ gSort[ y ].guiT ], y );

                                    for (var i=0; i<data[ gSort[ y ].guiTNum ]; i++)
                                    {
                                        tmp += '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                                        for (var j=0; j<gSort[ y ].col.length; j++)
                                        {
                                            tmp += '<td class="';
                                            if (gSort[ y ].col[ j ].align)
                                                tmp += ' align' + gSort[ y ].col[ j ].align;
                                            tmp += '"';
                                            if (gSort[ y ].col[ j ].wiz)
                                                tmp += ' style="width:' + gSort[ y ].col[ j ].wiz + '"';
                                            tmp += '>';
                                            if ( gSort[ y ].col[ j ].tab == 'tx' || gSort[ y ].col[ j ].tab == 'rx' ) {
                                                var mkbs = parseInt( data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ] ) * 8;
                                                if (mkbs > 1000) {
                                                    tmp += (mkbs/1000).toFixed(2) + ' Mb/s';
                                                } else if ( mkbs == 0) {
                                                    tmp += '0';
                                                } else {
                                                    tmp += mkbs + ' Kb/s';
                                                }
                                            } else if ( gRef[ y ] && gRef[ y ][ gSort[ y ].col[ j ].tab ] )
                                                tmp += gRef[ y ][ gSort[ y ].col[ j ].tab ][ data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ] ];
                                            else
                                                tmp += data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ];
                                            tmp += '</td>';
                                        }
                                        tmp += '</tr>';
                                    }
                                    $('#table-' + y + ' tbody').append( tmp );

                                } else if ( data.guiPortIfT ) {
                                    y = 'dashboard_port';
                                    $('#table-' + y + ' tbody').empty();
                                    if (!gSort[ y ])
                                        return false;

                                    data[ gSort[ y ].guiT ] = dataSort( data[ gSort[ y ].guiT ], y );

                                    for (var i=0; i<data[ gSort[ y ].guiTNum ]; i++)
                                    {
                                        tmp += '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                                        for (var j=0; j<gSort[ y ].col.length; j++)
                                        {
                                            tmp += '<td class="';
                                            if (gSort[ y ].col[ j ].align)
                                                tmp += ' align' + gSort[ y ].col[ j ].align;
                                            tmp += '"';
                                            if (gSort[ y ].col[ j ].wiz)
                                                tmp += ' style="width:' + gSort[ y ].col[ j ].wiz + '"';
                                            tmp += '>';
                                            
                                            if ( gSort[ y ].col[ j ].tab == 'link' ) {
                                                tmp += gRef[ y ][ gSort[ y ].col[ j ].tab ][ data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ] ];
                                                tmp += '<span class="linkStatus ' + ( (1 === parseInt( data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ] ))? 'linkUp' : 'linkDown' ) + '"></span>';
                                            } else if ( gRef[ y ] && gRef[ y ][ gSort[ y ].col[ j ].tab ] )
                                                tmp += gRef[ y ][ gSort[ y ].col[ j ].tab ][ data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ] ];
                                            else
                                                tmp += data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ];
                                            tmp += '</td>';
                                        }
                                        tmp += '</tr>';
                                    }
                                    $('#table-' + y + ' tbody').append( tmp );
                                } else if ( data.newlogT ) {
                                    y = 'dashboard_log';
                                    $('#table-' + y + ' tbody').empty();
                                    if (!gSort[ y ])
                                        return false;

                                    data[ gSort[ y ].guiT ] = dataSort( data[ gSort[ y ].guiT ], y );

                                    for (var i=0; i<data[ gSort[ y ].guiT ].length; i++)
                                    {
                                        tmp += '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                                        for (var j=0; j<gSort[ y ].col.length; j++)
                                        {
                                            tmp += '<td class="';
                                            if (gSort[ y ].col[ j ].align)
                                                tmp += ' align' + gSort[ y ].col[ j ].align;
                                            tmp += '"';
                                            if (gSort[ y ].col[ j ].wiz)
                                                tmp += ' style="width:' + gSort[ y ].col[ j ].wiz + '"';
                                            tmp += '>';
                                            if ( gRef[ y ] && gRef[ y ][ gSort[ y ].col[ j ].tab ] )
                                                tmp += gRef[ y ][ gSort[ y ].col[ j ].tab ][ data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ] ];
                                            else
                                                tmp += data[ gSort[ y ].guiT ][ i ][ gSort[ y ].col[ j ].tab ];
                                            tmp += '</td>';
                                        }
                                        tmp += '</tr>';
                                    }
                                    $('#table-' + y + ' tbody').append( tmp );
                                }
                            }
                        });
                        break;
                    case 'php':
                        $('#table-' + x + ' tbody').empty();
                        if (! gY.one('#table-' + x + ' thead') )
                            return false;

                        var ascend = gY.one('#table-' + x + ' thead').all('span.sortable.ascending');
                        var descend = gY.one('#table-' + x + ' thead').all('span.sortable.descending');
                        var sortBy = '';

                        if (ascend._nodes.length > 0) {
                            sortBy = '&oby=' + ascend._nodes[ 0 ].id.split('-')[ 2 ];
                            sortBy += '&asc=1';
                        } else if ( descend._nodes.length > 0) {
                            sortBy = '&oby=' + descend._nodes[ 0 ].id.split('-')[ 2 ];
                        }

                        $.ajax({
                            url: gObj.phpQuery.php + '.php?param=' + x + sortBy, 
                            dataType: 'json',
                            success: function(data) {
                                if (parseInt(data.queryRows) > 0) {
                                    data.queryResults = dataSortPhp( data.queryResults, data.param );
                                    $('#table-' + data.param + ' tbody').empty();
                                    tmp = '';
                                    for (var j=0; j<data.queryResults.length; j++)
                                    {
                                        tmp += '<tr class="' + ( (j%2==0)? 'even': 'odd' )+ '">';
                                        for (var i=0; i<gSort[ data.param ].col.length; i++)
                                        {
                                            tmp += '<td class="';
                                            if (gSort[ data.param ].col[ i ].align)
                                                tmp += ' align' + gSort[ data.param ].col[ i ].align;
                                            tmp += '"';
                                            if (gSort[ data.param ].col[ i ].wiz)
                                                tmp += ' style="width:' + gSort[ data.param ].col[ i ].wiz + '"';
                                            tmp += '>';
                                            if ( gSort[ data.param ].col[ i ].tab == 'index' )
                                                tmp += (i+1);
                                            else if (data.queryResults[ j ][ gSort[ data.param ].col[ i ].tab ]) {
                                                switch ( gSort[ data.param ].col[ i ].tab )
                                                {
                                                case 'trafficAmount':
                                                case 'tx':
                                                case 'rx':
                                                    var mkbs = parseInt( data.queryResults[ j ][ gSort[ data.param ].col[ i ].tab ] );
                                                    if (mkbs > 1000000000) {
                                                        tmp += (mkbs/1000000000).toFixed(2) + ' GB';
                                                    } else if (mkbs > 1000000) {
                                                        tmp += (mkbs/1000000).toFixed(2) + ' MB';
                                                    } else if (mkbs == 0) {
                                                        tmp += '0';
                                                    } else {  
                                                        tmp += (mkbs/1000).toFixed(2) + ' KB';
                                                    }
                                                    break;
                                                default:
                                                    tmp += data.queryResults[ j ][ gSort[ data.param ].col[ i ].tab ];
                                                }
                                            } else
                                                tmp += '';
                                            tmp += '</td>';
                                        }
                                        tmp += '</tr>';
                                    }
                                    $('#table-' + data.param + ' tbody').append( tmp );
                                    if (gIf.refresh)
                                        gObj.active.counting = gObj.active.refresh;
                                }
                            }
                        });
                        break;
                    }
                }
            }
        }
    }
    
    function genInnerHTML(node, feed) {
        var tmp = "";
        var tableID = 'table-' + feed.id;
    
        switch(feed.ext)
        {
        case 'cgi':
            $.ajax({
                url: 'cgi-bin/' + feed.url.get + '.' + feed.ext,
                dataType: 'json',
                success: function(data) {
                    switch(feed.tag)
                    {
                    case 'table':
                        tmp = '<div class="innerDiv">';
                        tmp += '<table id="' + tableID + '" class="' + gRef[ feed.tag ][ feed.type ] + '">';
                        switch(feed.type)
                        {
                        case 'dual':
                            for (var i=0, len=feed.col.length; i<len; i++)
                            {
                                tmp += '<tr>';
                                tmp += '<th>';
                                tmp += feed.col[ i ].label;
                                tmp += '</th>';
                                tmp += '<td id="' + feed.id + '-' + feed.col[ i ].tab + '">';
                                switch (feed.col[ i ].tab) 
                                {
                                case 'sigVer':
                                    tmp += gObj.sigVer;
                                    break;
                                case 'primaryVer':
                                    tmp += data[ feed.col[ i ].tab ];
                                    if (gIf.newFirmware)
                                        tmp += '<button id="newFirmware" class="NewFirmware" title="new firmware available"><span  class="ui-icon"></span></button>';
                                    break;
                                default: 
                                    tmp += data[ feed.col[ i ].tab ];
                                }
                                tmp += '</td>';
                                tmp += '</tr>';
                            }
                            break;
                        case 'list':
                            tmp += '<thead>';
                            tmp += '<tr>';
                            for (var i=0, len=feed.col.length; i<len; i++)
                            {
                                var wiz = 'auto';
                                if (feed.col[ i ].wiz)
                                    wiz = feed.col[i].wiz ;
                                tmp += '<th class="ui-state-default" style="width:' + wiz + '">';
                                if (feed.col[ i ].sortable) {
                                    tmp += '<div id="div-' + feed.id + '-' + feed.col[ i ].tab + '" class="sortable">' + feed.col[ i ].label + '<span id="span-' + feed.id + '-' + feed.col[ i ].tab + '" class="sortable" ></span></div>';
                                } else {
                                    tmp += feed.col[ i ].label;
                                }
                                tmp += '</th>';
                            }
                            tmp += '</tr>';
                            tmp += '</thead>';
                            tmp += '<tbody>';
                            var feedlen;
                            if (feed.guiTN) 
                                feedlen = parseInt( data[ feed.guiTNum ] );
                            else 
                                feedlen = data[ feed.guiT ].length;
                            for (var j=0; j<feedlen; j++)
                            {
                                tmp += '<tr class="' + ( (j%2==0)? 'even': 'odd' )+ '">';
                                for (var i=0, len=feed.col.length; i<len; i++)
                                {
                                    var wiz = 'auto';
                                    if (feed.col[ i ].wiz)
                                        wiz = feed.col[ i ].wiz;
                                    tmp += '<td class="';
                                    if (feed.col[ i ].align)
                                        tmp += ' align' + feed.col[ i ].align;
                                    tmp += '"';
                                    if (feed.col[ i ].wiz)
                                        tmp += ' style="width:' + feed.col[ i ].wiz + '"';
                                    tmp += '>';
                                    if ( gRef[ feed.url ] && gRef[ feed.url ][ feed.col[ i ].tab ] )
                                        tmp += gRef[ feed.url ][ feed.col[ i ].tab ][ data[ feed.guiT ][ j ][ feed.col[ i ].tab ] ];
                                    else if ( feed.col[ i ].tab == 'level' )
                                        tmp += gRef.loggings.severity[ data[ feed.guiT ][ j ][ feed.col[ i ].tab ] ];
                                    else if ( feed.col[ i ].tab == 'type' )
                                        tmp += gRef.dashboard_lan.type[ data[ feed.guiT ][ j ][ feed.col[ i ].tab ] ];
                                    else if ( feed.col[ i ].tab == 'speed' )
                                        tmp += gRef.dashboard_port.speed[ data[ feed.guiT ][ j ][ feed.col[ i ].tab ] ];
                                    else if ( feed.col[ i ].tab == 'duplex' )
                                        tmp += gRef.dashboard_port.duplex[ data[ feed.guiT ][ j ][ feed.col[ i ].tab ] ];
                                    else if ( feed.col[ i ].tab == 'link' ) {
                                        tmp += gRef.dashboard_port.link[ data[ feed.guiT ][ j ][ feed.col[ i ].tab ] ];
                                        // up or down arrow
                                        tmp += '<span class="linkStatus ' + ( (1 === parseInt( data[ feed.guiT ][ j ][ feed.col[ i ].tab ] ))? 'linkUp' : 'linkDown' ) + '"></span>';
                                    } else if ( feed.col[ i ].tab == 'index' ) 
                                        tmp += (j+1);
                                    else if ( feed.col[ i ].tab == 'tx' || feed.col[ i ].tab == 'rx' ) {
                                        var mkbs = parseInt( data[ feed.guiT ][ j ][ feed.col[ i ].tab ] ) * 8;
                                        if (mkbs > 1000) {
                                            tmp += (mkbs/1000).toFixed(2) + ' Mb/s'; 
                                        } else if ( mkbs == 0) {
                                            tmp += '0';
                                        } else {
                                            tmp += mkbs + ' Kb/s'; 
                                        }
                                    } else
                                        tmp += data[ feed.guiT ][ j ][ feed.col[ i ].tab ];
                                    tmp += '</td>';
                                }
                                tmp += '</tr>';
                            }
                            tmp += '</tbody>';
                            break;
                        case 'chart':
                            for (var i=0, len=feed.col.length; i<len; i++)
                            {
                                tmp += '<tr>';
                                tmp += '<th>';
                                tmp += feed.col[ i ].label;
                                tmp += '</th>';
                                tmp += '<td>';
                                tmp += '<img src="css/images/' + feed.col[ i ].icon + '"/>';
                                tmp += '</td>';
                                tmp += '<td>';
                                tmp += '<div class="progressDiv ' + feed.col[ i ].tab + '" style="text-align:center"></div>';
                                tmp += '</td>';
                                tmp += '<td>';
                                tmp += '<span id="' + feed.id + '-' + feed.col[ i ].tab + '">' + data[ feed.col[ i ].tab ] + '%</span>';
                                tmp += '</td>';
                                tmp += '</tr>';
                            }
                            break;
                        }
                        tmp += '</table>';
                        break;
                    }
                    tmp += '</div>';
                    node.set('innerHTML', tmp);
    
                    switch (feed.tag == 'table' && feed.type == 'chart') 
                    {
                    case true:
                        for (var i=0, len=feed.col.length; i<len; i++)
                        {
                            $('.' + feed.col[ i ].tab ).progressbar({ value: parseInt( data[ feed.col[ i ].tab ] ) });
                        }
                        break;
                    }
                }
            });
            break;
        case 'php':
            $.ajax({
                url: gObj.phpQuery.php + '.php?param=' + feed.id,
                dataType: 'json',
                success: function(data) {
                    tmp = '<div class="innerDiv">';
                    tmp += '<table id="' + tableID + '" class="' + gRef[ feed.tag ][ feed.type ] + '">';
                    tmp += '<thead>';
                    if (feed.thead) {
                        for (var i=0, len=feed.thead.length; i<len; i++)
                        {
                            tmp += '<tr>';
                            for (var j=0; j<feed.thead[i].length; j++)
                            {
                                var spans = "";
                                if (feed.thead[ i ][ j ].rowspan)
                                   spans += 'rowspan="' + feed.thead[ i ][ j ].rowspan + '"';
                                if (feed.thead[ i ][ j ].colspan)
                                   spans += 'colspan="' + feed.thead[ i ][ j ].colspan + '"';

                                var wiz = 'auto';
                                if (feed.thead[ i ][ j ].wiz)
                                    wiz = feed.thead[ i ][ j ].wiz ;
                                tmp += '<th class="ui-state-default" style="width:' + wiz + '" ' + spans + '>';
                                if (feed.thead[ i ][ j ].sortable) {
                                    tmp += '<div id="div-' + feed.id + '-' + feed.thead[ i ][ j ].tab + '" class="sortable">' + feed.thead[ i ][ j ].label + '<span id="span-' + feed.id + '-' + feed.thead[ i ][ j ].tab + '" class="sortable" ></span></div>';
                                } else {
                                    tmp += feed.thead[ i ][ j ].label;
                                }
                                tmp += '</th>';
                            }
                            tmp += '</tr>';
                        }
                    }else {
                        tmp += '<tr>';
                        for (var i=0, len=feed.col.length; i<len; i++)
                        {
                            var wiz = 'auto';
                            if (feed.col[ i ].wiz)
                                wiz = feed.col[ i ].wiz ;
                            tmp += '<th class="ui-state-default" style="width:' + wiz + '">';
                            if (feed.col[ i ].sortable) {
                                tmp += '<div id="div-' + feed.id + '-' + feed.col[ i ].tab + '" class="sortable">' + feed.col[ i ].label + '<span id="span-' + feed.id + '-' + feed.col[ i ].tab + '" class="sortable" ></span></div>';
                            } else {
                                tmp += feed.col[ i ].label;
                            }
                            tmp += '</th>';
                        }
                        tmp += '</tr>';
                    }
                    tmp += '</thead>';
                    tmp += '<tbody>';
                    if (parseInt(data.queryRows) > 0) {
                        for (var j=0, jlen=data.queryResults.length; j<jlen; j++)
                        {
                            tmp += '<tr class="' + ( (j%2==0)? 'even': 'odd' )+ '">';
                            for (var i=0, len=feed.col.length; i<len; i++)
                            {
                                var wiz = 'auto';
                                if (feed.col[ i ].wiz)
                                    wiz = feed.col[ i ].wiz;
                                tmp += '<td class="';
                                if (feed.col[ i ].align)
                                    tmp += ' align' + feed.col[ i ].align;
                                tmp += '"';
                                if (feed.col[ i ].wiz)
                                    tmp += ' style="width:' + feed.col[ i ].wiz + '"';
                                tmp += '>';
                                if ( feed.col[ i ].tab == 'index' )
                                    tmp += (i+1);
                                else if (data.queryResults[ j ][ feed.col[ i ].tab ]) {
                                    switch ( feed.col[ i ].tab )
                                    {
                                    case 'trafficAmount':
                                    case 'tx':
                                    case 'rx':
                                        var mkbs = parseInt( data.queryResults[ j ][ feed.col[ i ].tab ] );
                                        if (mkbs > 1000000000) {
                                            tmp += (mkbs/1000000000).toFixed(2) + ' GB'; 
                                        } else if (mkbs > 1000000) {
                                            tmp += (mkbs/1000000).toFixed(2) + ' MB'; 
                                        } else if (mkbs == 0) {
                                            tmp += '0';
                                        } else {
                                            tmp += (mkbs/1000).toFixed(2) + ' KB'; 
                                        }
                                        break;
                                    default: 
                                        tmp += data.queryResults[ j ][ feed.col[ i ].tab ];
                                    }
                                } else 
                                    tmp += '';
                                tmp += '</td>';
                            }
                            tmp += '</tr>';
                        }
                    }
                    tmp += '</tbody>';
                    tmp += '</div>';
                    node.set('innerHTML', tmp);
                }
            });
            break;
        }
    }
    
    function genReports(pid)
    {
        var tmp = '';
        var wiz = 'auto';
    
        switch(gNode.ext)
        {
        case 'cgi':
            switch(gNode.tag)
            {
            case 'div':
                switch(gNode.type)
                {
                case 'tabs':
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"></div>');
                    if ( gNode.columns ) {
                        gColumns[ gNode.tab ] = {};
                        $('div.templateDiv').append('<div id="div-columns" style="display: none"></div>');
                    }
                    $('div.templateDiv').append('<div class="tabber"><ul></ul></div>');
                    gNode.cache = {};
                    for (var y in gNode.url.get)
                    {
                        gY.one('.tabber ul').append('<li id="tab-' + y + '"><a href="#panel-' + y + '">' + gNode.tabs[ y ] + '</a></li>');
                        gY.one('.tabber').append('<div id="panel-' + y + '"></div>');
                        gNode.cache[ y ] = false;
                        
                        $.ajax({
                            url: 'cgi-bin/' + gNode.url.get[ y ] + '.' + gNode.ext,
                            dataType: 'json',
                            success: function(data) {
                                gIf.ajaxed = true;
                                var x = "";
                                for (var z in gNode.guiT)
                                {
                                    if (data[ gNode.guiT[ z ] ]) {
                                        x = z;
                                        gNode.cache[ gNode.url.get[ z ] ] = true;
                                        gData[ x ] = data;
                                        gColumns[ gNode.tab ][ x ] = {};
                                    }
                                }
                                var tblID   = 'table-' + gNode.tab + '-' + x;
                                var divID   = 'div-' + gNode.tab + '-' + x;
                                var tableID = '#' + tblID;
                                var tableHD = tableID + ' thead';
    
                                if (gNode.guiTN)
                                    gNodelen = parseInt( data[ gNode.guiTNum[ x ] ] );
                                else 
                                    gNodelen = data[ gNode.guiT[ x ] ].length;
    
                                tmp = '<div id="' + divID + '" class="tableDiv">';
                                tmp += '<table id="' + tblID + '" class="' + gRef[ gNode.tag ][ gNode.type ] + ' ' + gNode.tblAction +'">';
                                tmp += '<thead>';
                                tmp += '<tr>';
                                for (var i=0; i<gNode.col[ x ].length; i++)
                                {
                                    if (gNode.col[ x ][ i ].wiz)
                                        wiz = gNode.col[ x ][i].wiz ;
                                    tmp += '<th id="' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ i ].tab + '" class="ui-state-default ' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ i ].tab + '" style="width: ' + wiz + ';';
                                    if ( gNode.columns ) {
                                        if ( gNode.col[ x ][ i ].display ) {
                                            gColumns[ gNode.tab ][ x ][ gNode.col[ x ][ i ].tab ] = true;
                                        } else {
                                            tmp += ' display: none;';
                                        }
                                    }
                                    tmp += '">';
                                    if (gNode.col[ x ][ i ].sortable) {
                                        tmp += '<div id="div-' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ i ].tab + '" class="sortable">' + gNode.col[ x ][ i ].label + '<span id="span-' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ i ].tab + '" class="sortable" ></span></div>';
                                    } else {
                                        tmp += gNode.col[ x ][ i ].label;
                                    }
                                    tmp += '</th>';
                                }
                                tmp += '</tr>';
                                tmp += '</thead>';
                                tmp += '<tbody>';
    
                                for (var i=0; i<gNodelen; i++)
                                {
                                    tmp += '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                                    for (var j=0; j<gNode.col[ x ].length; j++)
                                    {
                                        tmp += '<td id="' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ j ].tab + '-' + i + '"';
                                        if ( gNode.columns ) {
                                            tmp += 'class="' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ j ].tab ;
                                            if ( gNode.col[ x ][ j ].align ) {
                                                tmp += ' align' + gNode.col[ x ][ j ].align ;
                                            }
                                            tmp += '"';
                                            if ( !gNode.col[ x ][ j ].display ) {
                                                tmp += ' style="display: none" ';
                                            }
                                        }
                                        tmp += '>';
                                        if ('linkStatus' === gNode.col[ x ][ j ].tab) {
                                            tmp += gRef[ gNode.tab ][ gNode.col[ x ][ j ].tab ][ data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] ];
                                        } else if ( 'txBps' == gNode.col[ x ][ j ].tab || 'rxBps' == gNode.col[ x ][ j ].tab ) {
                                            var mkbs = parseInt( data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] ) * 8;
                                            tmp += ( mkbs > 1000000 )? (mkbs/1000000).toFixed(2) + ' Mb/s' : ( ( mkbs == 0 )? 0 : (mkbs/1000).toFixed(2) + ' Kb/s' );
                                        }else {
                                            tmp += data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ];
                                        }
                                        tmp += '</td>';
                                    }
                                    tmp += '</tr>';
                                }
                                tmp += '</tbody>';
                                tmp += '</table>';
                                tmp += '</div>';
                                gY.one('#panel-' + x).set('innerHTML', tmp);
    
                                if (gNode.tblAction && gIf.power)
                                    genTblAction(gNode.url.get[ x ]);
                            }
                        });
                    }
                    gObj.tabber = $('.tabber').tabs({
                        create: function( event, ui ) {
                            gObj.tabIndexId = ui.tab[ 0 ].id.split('-').pop();
                        },
                        activate: function( event, ui ) { 
                            gObj.tabIndexId = ui.newTab[ 0 ].id.split('-').pop();
                            btnColumns( false );
                        }
                    });
                    break;
                }
                break;
            case 'table':
                gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"></div>');

                $.ajax({
                    url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                    dataType: 'json',
                    success: function(data) {
                        gIf.ajaxed = true;

                        gData[ gNode.tab ] = data;
                        var tblID   = 'table-' + gNode.tab;
                        var tableID = '#' + tblID;
                        var tableHD = tableID + ' thead';
                        var tableBD = tableID + ' tbody';
    
                        switch(gNode.type)
                        {
                        case 'list':
                            tmp = '<div id="div-' + gNode.tab + '" class="tableDiv">';
                            if ( gNode.columns ) {
                                gColumns[ gNode.tab ] = {};
                                tmp += '<div id="div-columns" style="display: none"></div>';
                            }
                            tmp += '<table id="' + tblID + '" class="' + gRef[ gNode.tag ][ gNode.type ] + ' ' + gNode.tblAction +'">';
                            gSort[ gNode.tab ] = data;
                            tmp += '<thead>';
                            tmp += '<tr>';
                            for (var i=0; i<gNode.col.length; i++)
                            {
                                if (gNode.col[ i ].wiz)
                                    wiz = gNode.col[i].wiz ;
                                tmp += '<th id="' + gNode.tab + '-' + gNode.col[ i ].tab + '" class="ui-state-default ' + gNode.tab + '-' + gNode.col[ i ].tab + '" style="width: ' + wiz + ';';
                                if ( gNode.columns ) {
                                    if ( gNode.col[ i ].display ) {
                                        gColumns[ gNode.tab ][ gNode.col[ i ].tab ] = true;
                                    } else {
                                        tmp += ' display: none;';
                                    }
                                }
                                tmp += '">';
                                if (gNode.col[ i ].sortable) {
                                    tmp += '<div id="div-' + gNode.tab + '-' + gNode.col[ i ].tab + '" class="sortable">' + gNode.col[ i ].label + '<span id="span-' + gNode.tab + '-' + gNode.col[ i ].tab + '" class="sortable" ></span></div>';
                                } else {
                                    tmp += gNode.col[ i ].label;
                                }
                                tmp += '</th>';
                            }

                            tmp += '</tr>';
                            tmp += '</thead>';
                            tmp += '<tbody>';
                            tmp += '</tbody>';
                            tmp += '</table>';
                            tmp += '</div>';
                            gY.one('.templateDiv').set('innerHTML', tmp);
    
                            if (gNode.guiTN)
                                gNodelen = parseInt( data[ gNode.guiTNum ] );
                            else 
                                gNodelen = data[ gNode.guiT ] .length;
    
                            if (gNode.rowAction)
                                gObj.btn = gNode.rowAction.split(' ');
                            var cols = [];

                            for (var j=0; j<gNodelen; j++)
                            {
                                if (gNode.pattern)
                                    cols = data[ gNode.guiT ][ j ][ gNode.key ].split( gNode.pattern );
                                tmp = '<tr class="' + ( (j%2==0)? 'even': 'odd' ) + '">';
                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    tmp += '<td id="' + gNode.tab + '-' + gNode.col[ i ].tab + '-' + j + '"';
                                    if ( gNode.columns ) {
                                        tmp += 'class="' + gNode.tab + '-' + gNode.col[ i ].tab;
                                        if ( gNode.col[ i ].align ) {
                                            tmp += ' align' + gNode.col[ i ].align ;
                                        }
                                        tmp += '"';
                                        if ( !gNode.col[ i ].display ) {
                                            tmp += ' style="display: none" ';
                                        }
                                    }
                                    tmp += '>';
                                    if ( gRef[ gNode.url.get ] && gRef[ gNode.url.get ][ gNode.col[ i ].tab ] )
                                        tmp += gRef[ gNode.url.get ][ gNode.col[ i ].tab ][ data[ gNode.guiT ][ j ][ gNode.col[ i ].tab ] ];
                                    else if ( gNode.col[ i ].tab == 'index' )
                                        tmp += (j+1);
                                    else if ( gNode.col[ i ].tab == 'checkbox') {
                                        if (gIf.power) {
                                            tmp += '<input type="checkbox" value="' + i + '" />';
                                        } else {
                                            tmp += '';
                                        }
                                    } else if ( gNode.col[ i ].tab == 'tx_bytes' || gNode.col[ i ].tab == 'rx_bytes' ) {
                                        var mkbs = parseInt( data[ gNode.guiT ][ j ][ gNode.col[ i ].tab ] );
                                        tmp += ( mkbs > 1000000000 )? (mkbs/1000000000).toFixed(2) + ' GB' : ( ( mkbs > 1000000 )? (mkbs/1000000).toFixed(2) + ' MB' : ( ( mkbs == 0 )? 0 : (mkbs/1000).toFixed(2) + ' KB' ) );
                                    } else if ( gNode.col[ i ].tab == 'action' ) {
                                        if ( gIf.power ) {
                                            for (var z=0, zlen=gObj.btn.length; z<zlen; z++)
                                            {
                                                tmp += '<button id="' + gObj.btn[z] + '-' + gNode.tab + '-' + j + '" class="' + gObj.btn[z] + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon" ></span></button>';
                                            }
                                        } else {
                                            tmp += '';
                                        }
                                    } else if (cols.length > 0)
                                        tmp += cols[ i ];
                                    else
                                        tmp += data[ gNode.guiT ][ j ][ gNode.col[ i ].tab ];
                                    tmp += '</td>';
                                }
                                tmp += '</tr>';

                                $(tableBD).append( tmp );

                                if ( 'active_sessions' == pid ) {
                                    switch( parseInt( data[ gNode.guiT ][ j ].infoStatus ) )
                                    {
                                    case 0:
                                        $('#Disconnect-' + pid + '-' + j).prop('disabled', true);
                                        break;
                                    case 1:
                                        $('#Connect-' + pid + '-' + j).prop('disabled', true);
                                        break;
                                    case 2:
                                        $('#Connect-' + pid + '-' + j).prop('disabled', true);
                                        $('#Disconnect-' + pid + '-' + j).prop('disabled', true);
                                        break;
                                    }
                                }
                            }
                            break;
                        }
                    }
                });
                break;
            }
            break;
        case 'php':
            loadingToggle( true );
            switch(gNode.tag)
            {
            case 'div':
                switch(gNode.type)
                {
                case 'tabsChart':
                    // create chart gNode
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div class="queryDiv"></div><div class="tabber"><ul></ul></div></div>');
                    phpQuery(pid);
    
                    for (var x in gNode.tabs)
                    {
                        gY.one('.tabber ul').append('<li id="tab-' + x + '"><a href="#panel-' + x + '">' + gNode.tabs[ x ] + '</a></li>');
                        gY.one('.tabber').append('<div id="panel-' + x + '"><div id="chart-' + x + '"></div></div>');
                    }
    
                    gObj.chartIndex = 0;
                    refreshCharts(pid);
    
                    $('.tabber').tabs().on('tabsactivate', function(event, ui) { 
                        gObj.chartIndex = $(this).tabs("option", "active");
                        refreshCharts(pid, gObj.chartIndex);
                    });
    
                    break;
                case 'tabs':
                    break;
                }
                break;
            case 'table':
                switch(gNode.type)
                {
                case 'list':
                    gObj.phpQuery.pi = 1;
                    gObj.phpQuery.ps = 1;
                    gObj.phpQuery.pp = 20;
                    gObj.phpQuery.id = pid;
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"></div>');
                    tmp = '';
                    $.ajax({
                        url: gObj.phpQuery.php + '.php?param=' + pid + '&pp=20&pi=1',
                        dataType: 'json',
                        success: function(data) {
                            gIf.ajaxed = true;
                            loadingToggle( false );
                            if ( gNode.columns ) {
                                gColumns[ gNode.tab ] = {};
                                tmp += '<div id="div-columns" style="display: none"></div>';
                            }
                            gSort[ gNode.tab ] = data;

                            // thead table 
                            if (gNode.query)
                                tmp += '<div class="queryDiv"></div>';
                            if (gNode.pager)
                                tmp += '<div id="pagerDiv-' + pid + '" class="pagerDiv"></div>';
                            tmp += '<div id="theadDiv-' + pid + '">';
                            tmp += '<table id="theadTable-' + pid + '" class="' + gRef[ gNode.tag ][ gNode.type ] + '">';
                            tmp += '<thead>';
                            tmp += '<tr>';

                            if (gNode.query) {
                                gColumns[ gNode.tab ][ 0 ] = {};
                                for (var i=0; i<gNode.col[0].length; i++)
                                {
                                    if (gNode.col[ 0 ][ i ].wiz)
                                        wiz = gNode.col[ 0 ][ i ].wiz;
                                    else
                                        wiz = 'auto';
                                    tmp += '<th id="' + gNode.tab + '-0-' + gNode.col[ 0 ][ i ].tab + '" class="ui-state-default ' + gNode.tab + '-0-' + gNode.col[ 0 ][ i ].tab + '" style="width:' + wiz;
                                    if ( gNode.columns ) {
                                        if ( gNode.col[ 0 ][ i ].display ) {
                                            gColumns[ gNode.tab ][ 0 ][ gNode.col[ 0 ][ i ].tab ] = true;
                                        } else {
                                            tmp += ' display: none;';
                                        }
                                    }
                                    tmp += '">';
                                    if (gNode.col[ 0 ][ i ].sortable) {
                                        tmp += '<div id="div-' + gNode.tab + '-0-' + gNode.col[ 0 ][ i ].tab + '" class="sortable">' + gNode.col[ 0 ][ i ].label + '<span id="span-' + gNode.tab + '-0-' + gNode.col[ 0 ][ i ].tab + '" class="sortable" ></span></div>';
                                    } else {
                                        tmp += gNode.col[ 0 ][ i ].label;
                                    }
                                    tmp += '</th>';
                                }
                            }else {
                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    if (gNode.col[ i ].wiz)
                                        wiz = gNode.col[ i ].wiz;
                                    else
                                        wiz = 'auto';
                                    tmp += '<th id="' + gNode.tab + '-' + gNode.col[ i ].tab + '" class="ui-state-default ' + gNode.tab + '-' + gNode.col[ i ].tab + '" style="width:' + wiz + '">';
                                    if ( gNode.columns ) {
                                        if ( gNode.col[ i ].display ) {
                                            gColumns[ gNode.tab ][ gNode.col[ 0 ][ i ].tab ] = true;
                                        } else {
                                            tmp += ' display: none;';
                                        }
                                    }
                                    tmp += gNode.col[ i ].label;
                                    tmp += '</th>';
                                }
                            }
                            tmp += '</tr>';
                            tmp += '</thead>';
                            tmp += '</table>';
                            tmp += '</div>';
    
                            // tbody table 
                            tmp += '<div id="tbodyDiv-' + pid +'" class="tbodyDiv">';
                            tmp += '<table id="tbodyTable-' + pid +'">';
                            tmp += '<tbody>';
                            if (parseInt(data.queryRows) > 0) {
                                if (gNode.query) {
                               
                                    for (var j=0; j<data.queryResults.length; j++)
                                    {
                                        tmp += '<tr class="' + ( (j%2==0)? 'even': 'odd' )+ '">';
                                        for (var i=0; i<gNode.col[ 0 ].length; i++)
                                        {
                                            if (gNode.col[0][i].wiz)
                                                wiz = gNode.col[0][i].wiz;
                                            else
                                                wiz = 'auto';
                                            tmp += '<td style="width:' + wiz + '"';
                                            tmp += ' id="' + gNode.tab + '-0-' + gNode.col[ 0 ][ i ].tab + '-' + j + '"';
                                            tmp += ' class="' + gNode.tab + '-0-' + gNode.col[ 0 ][ i ].tab;
                                            if ( gNode.col[ 0 ][ i ].align ) {
                                                tmp += ' align' + gNode.col[ 0 ][ i ].align;
                                            }
                                            tmp += '">';
                                            switch( gNode.col[ 0 ][ i ].tab )
                                            {
                                            case 'id':
                                                tmp += (j+1);
                                                break;
                                            case 'protocol':
                                                if ('traffic_direction' == pid)
                                                    tmp += gRef.protocol[ data.queryResults[ j ][ gNode.col[ 0 ][ i ].tab ] ];
                                                else
                                                    tmp += data.queryResults[ j ][ gNode.col[ 0 ][ i ].tab ];
                                                break;
                                            case 'totalBytes':
                                            case 'txBytes':
                                            case 'rxBytes':
                                                var mkbs = parseInt( data.queryResults[ j ][ gNode.col[ 0 ][ i ].tab ] );
                                                tmp += ( mkbs > 1000000000 )? (mkbs/1000000000).toFixed(2) + ' GB' : ( ( mkbs > 1000000 )? (mkbs/1000000).toFixed(2) + ' MB' : ( ( mkbs == 0 )? 0 : (mkbs/1000).toFixed(2) + ' KB' ) );
                                                break;
                                            default: 
                                                if (data.queryResults[ j ][ gNode.col[ 0 ][ i ].tab ])
                                                    tmp += data.queryResults[ j ][ gNode.col[ 0 ][ i ].tab ];
                                                else
                                                    tmp += '';
                                            }
                                            tmp += '</td>';
                                        }
                                    }
                                }else {
                                    for (var i=0; i<data.queryResults.length; i++)
                                    {
                                        tmp += '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                                        for (var j=0; j<gNode.col.length; j++)
                                        {
                                            if (gNode.col[ j ].wiz)
                                                wiz = gNode.col[ j ].wiz;
                                            else
                                                wiz = 'auto';
                                            tmp += '<td style="width:' + wiz + '"';
                                            if ( gNode.col[ j ].align ) {
                                                tmp += ' class="align' + gNode.col[ j ].align + '"';
                                            }
                                            tmp += '>';
                                            if ( gNode.col[ j ].tab == 'index' )
                                                tmp += (i+1);
                                            else if (data.queryResults[ i ][ gNode.col[ j ].tab ])
                                                tmp += data.queryResults[ i ][ gNode.col[ j ].tab ];
                                            else
                                                tmp += '';
                                            tmp += '</td>';
                                        }
                                        tmp += '</tr>';
                                    }
                                }
                            }
                            tmp += '</tbody>';
                            tmp += '</table>';
                            tmp += '</div>';
    
                            gY.one('.templateDiv').set('innerHTML', tmp);
                            if (gNode.query)
                                phpQuery( pid );
                            if (gNode.pager) {
                                gObj.phpQuery.ps = Math.ceil(data.queryRows/gObj.phpQuery.pp);
                                phpPager( pid , gObj.phpQuery.pi, gObj.phpQuery.ps );
                            }
                        }
                    });
                    break;
                }
                break;
            }
            break;
        }
    }
    
    function refreshCharts(pid) 
    {
        var q;
        var c;
        var d;
        var f;
        var s;
        var e;
        gIf.ajaxed = false; 
        switch(pid)
        {
        case 'wan_bandwidth_report':
            q = '&q=wan' + (gObj.chartIndex+1);
            if (gIf.query) {
                q += gQuery.q + gQuery.t
                f = gQuery.f;
            } else {
                q += '&t=0'; 
                f = '%T';
            }
            gObj.chart.id = '#chart-wan' + (gObj.chartIndex+1);
    
            gY.io( gObj.phpQuery.php + '.php?param=' + pid + q, {
                on: {
                    complete: function(id, e) {
                        gIf.ajaxed = true;
                        loadingToggle( false );
                        gObj.chart.data = new gY.JSON.parse(e.responseText);
                        var mkb = 0;
                        for (var i=0; i<parseInt(gObj.chart.data.queryRows); i++) 
                        {
                            if ( parseInt(gObj.chart.data.queryResults[ i ].Transmit) > 10000000 || parseInt(gObj.chart.data.queryResults[ i ].Receive) > 10000000 )  {
                                mkb = 2;
                            }else if (mkb < 2 && ( parseInt(gObj.chart.data.queryResults[ i ].Transmit) > 1000000 || parseInt(gObj.chart.data.queryResults[ i ].Receive) > 1000000 ) ) {
                                mkb = 1;
                            }
                        }
    
                        var mkbs = (mkb == 2)? 'MB/s' : ( (mkb == 1)? 'KB/s' : 'Bytes/s' );
    
                        for (var i=0; i<parseInt(gObj.chart.data.queryRows); i++)
                        {
                            switch (mkb)
                            {
                            case 2:
                                gObj.chart.data.queryResults[ i ].Transmit = gObj.chart.data.queryResults[ i ].Transmit/1000000;
                                gObj.chart.data.queryResults[ i ].Receive = gObj.chart.data.queryResults[ i ].Receive/1000000;
                                break;
                            case 1:
                                gObj.chart.data.queryResults[ i ].Transmit = gObj.chart.data.queryResults[ i ].Transmit/1000;
                                gObj.chart.data.queryResults[ i ].Receive = gObj.chart.data.queryResults[ i ].Receive/1000;
                                break;
                            }
                        }
    
                        if (gObj.chart.has)
                            gObj.chart.now.destroy();
                        if (parseInt(gObj.chart.data.queryRows) == 0) {
                            gObj.chart.has = false;
                            gY.one(gObj.chart.id).setHTML('<div class="noData"><b>' + gTerm[ gObj.lang ].noData + '</b></div>');  
                        } else {
                            if ($('.noData').exists())
                                $(gObj.chart.id).empty();
                            gObj.chart.has = true;
                            gObj.chart.now = new gY.Chart({
                                dataProvider: gObj.chart.data.queryResults,
                                legend: {
                                    position: "right",
                                    width: 150,
                                    height:200,
                                    styles: {
                                        hAlign: "center",
                                        hSpacing: 8
                                    }
                                },
                                axes: { 
                                    txRate: {
                                        keys:["Transmit","Receive"],
                                        position:"left",
                                        type:"numeric",
                                        title: mkbs
                                    },
                                    dateRange: {
                                        keys:["datetime"],
                                        position:"bottom",
                                        type:"time",
                                        labelFormat: f,
                                        styles:{
                                            label: {
                                                rotation:-45,
                                                margin:{top:5}
                                            }
                                        }
                                    }
                                },
                                horizontalGridlines: {
                                    styles: {
                                        line: {
                                            color: "#dad8c9"
                                        }
                                    }
                                },
                                verticalGridlines: {
                                    styles: {
                                        line: {
                                            color: "#dad8c9"
                                        }
                                    }
                                },
                                categoryKey: "datetime",
                                categoryType:"time",
                                type: "area",
                                interactionType: "planar",
                                seriesKeys: ["Transmit", "Receive"]
                            }).render(gObj.chart.id);
                        }
                    }
                }
            });
            break;
        case 'resource_utilization':
            q = '&q=' + gObj.chartIndex;
            if (gIf.query) {
                q += gQuery.q + gQuery.t;
                f = gQuery.f;
            } else {
                q += '&t=0';
                f = '%T';
            }

            gObj.chart.id = ( 0 === gObj.chartIndex )? '#chart-cpu' : '#chart-memory';
    
            gY.io( gObj.phpQuery.php + '.php?param=' + pid + q, {
                on: {
                    complete: function(id, e) {
                        gIf.ajaxed = true;
                        loadingToggle( false );
                        gObj.chart.data = new gY.JSON.parse(e.responseText);
                        if (gObj.chart.has)
                            gObj.chart.now.destroy();
                        if (gObj.chart.data.queryRows == 0) {
                            gObj.chart.has = false;
                            gY.one(gObj.chart.id).setHTML('<div class="noData"><b>' + gTerm[ gObj.lang ].noData + '</b></div>');  
                        } else {
                            if ($('.noData').exists()) {
                                $(gObj.chart.id).empty();
                            }
                            gObj.chart.has = true;
    
                            gObj.chart.now = new gY.Chart({
                                dataProvider: gObj.chart.data.queryResults,
                                legend: {
                                    position: "right",
                                    width: 100,
                                    height: 100,
                                    styles: {
                                        hAlign: "center",
                                        hSpacing: 8
                                    }
                                },
                                axes: {
                                    usage: {
                                        keys:["usage"],
                                        position:"left",
                                        type:"numeric",
                                        labelFormat: f,
                                        title: '%',
                                        styles:{
                                            stroke: {
                                                weight: 0.5
                                            }
                                        },
                                        labelFunction: function(label, format) {
                                            return label.toFixed(2);
                                        }
                                    },
                                    dateRange: {
                                        keys:["datetime"],
                                        position:"bottom",
                                        type:"time",
                                        labelFormat: f,
                                        styles:{
                                            label: {
                                                rotation:-45,
                                                margin:{top:5}
                                            }
                                        }
                                    }
                                },
                                horizontalGridlines: {
                                    styles: {
                                        line: {
                                            color: "#dad8c9"
                                        }
                                    }
                                },
                                verticalGridlines: {
                                    styles: {
                                        line: {
                                            color: "#dad8c9"
                                        }
                                    }
                                },
                                categoryKey: "datetime",
                                categoryType:"time",
                                type: "area",
                                interactionType: "planar"
                            }).render(gObj.chart.id);
                        }
                    }
                }
            });
            break;
        }
    
    }
    
    function refreshReports(pid)
    {
        var tmp = '';
        var query = '';
        gIf.ajaxed = false;
    
        if ( typeof gNode.url.get == 'object' ) {
            switch( gNode.ext )
            {
            case 'cgi':
                if ( pid == gNode.tab ) {
                    for (var z in gNode.url.get)
                        refreshReports( z );
                }else {
                    var tableID = '#table-' + gNode.tab + '-' + pid;
                    var tableBD = tableID + ' tbody';
                    var tableHD = tableID + ' thead';

                    $.ajax({
                        url: 'cgi-bin/' + gNode.url.get[ pid ] + '.' + gNode.ext,
                        dataType: 'json',
                        success: function(data) {
                            gIf.ajaxed = true;
                            var x = "";
                            for (var z in gNode.guiT)
                            {
                                if (data[ gNode.guiT[ z ] ]) {
                                    x = z;
                                    data[ gNode.guiT[ x ] ] = dataSort( data[ gNode.guiT[ x ] ], x, true );
                                }
                            }
                  
                            if (gNode.guiTN)
                                gNodelen = parseInt( data[ gNode.guiTNum[ x ] ] );
                            else 
                                gNodelen = data[ gNode.guiT[ x ] ] .length;
        
                            $(tableBD).empty();

                            for (var i=0; i<gNodelen; i++)
                            {
                                tmp = '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                                for (var j=0; j<gNode.col[ x ].length; j++)
                                {
                                    tmp += '<td id="' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ j ].tab + '-' + i + '"';
                                    if ( gNode.columns ) {
                                        tmp += 'class="' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ j ].tab ;
                                        if ( gNode.col[ x ][ j ].align ) {
                                            tmp += ' align' + gNode.col[ x ][ j ].align ;
                                        }
                                        tmp += '"';
                                        if (!gColumns[ gNode.tab ][ x ][ gNode.col[ x ][ j ].tab ]) {
                                            tmp += ' style="display: none" ';
                                        }
                                    }

                                    tmp += '>';
                                    if ('linkStatus' === gNode.col[ x ][ j ].tab) {
                                        tmp += gRef[ gNode.tab ][ gNode.col[ x ][ j ].tab ][ data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] ];
                                    } else if ( 'txBps' == gNode.col[ x ][ j ].tab || 'rxBps' == gNode.col[ x ][ j ].tab ) {
                                        var mkbs = parseInt( data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] ) * 8;
                                        tmp += ( mkbs > 1000000 )? (mkbs/1000000).toFixed(2) + ' Mb/s' : ( ( mkbs == 0 )? 0 : (mkbs/1000).toFixed(2) + ' Kb/s' );
                                    }else {
                                        tmp += data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ];
                                    }
                                    tmp += '</td>';
                                }
                                tmp += '</tr>';
                                $(tableBD).append(tmp);
                            }
                        }
                    });
                }
                break;
            }
        }else {
            switch( gNode.ext)
            {
            case 'cgi':
                var tableID = '#table-' + pid;
                var tableBD = tableID + ' > tbody';
                var tableHD = tableID + ' > thead';
                $(tableBD).empty();
        
                $.ajax({
                    url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                    dataType: 'json',
                    success: function(data) {
                        gIf.ajaxed = true;

                        if (gNode.guiTN)
                            gNodelen = parseInt( data[ gNode.guiTNum ] );
                        else 
                            gNodelen = data[ gNode.guiT ].length;

                        if (gNode.rowAction)
                            gObj.btn = gNode.rowAction.split(' ');

                        data[ gNode.guiT ] = dataSort( data[ gNode.guiT ], pid );
                        gData[ gNode.tab ] = data;
                        var cols = [];
                        for (var i=0; i<gNodelen; i++)
                        {
                            if (pid == 'active_users' && data[ gNode.guiT ][ i ].username == "")
                                continue;
                            if (gNode.pattern)
                                cols = data[ gNode.guiT ][ i ][ gNode.key ].split( gNode.pattern );
                            tmp = '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                            for (var j=0; j<gNode.col.length; j++)
                            {
                                tmp += '<td ';
                                if ( gNode.columns ) {
                                    tmp += 'class="' + gNode.tab + '-' + gNode.col[ j ].tab;
                                    if (gNode.col[ j ].align) {
                                        tmp += ' align' + gNode.col[ j ].align;
                                    }
                                    tmp += '"';
                                    if (!gColumns[ gNode.tab ][ gNode.col[ j ].tab ]) {
                                        tmp += ' style="display: none" ';
                                    }
                                }
                                tmp += '>';

                                if ( gRef[ gNode.url.get ] && gRef[ gNode.url.get ][ gNode.col[ j ].tab ] )
                                    tmp += gRef[ gNode.url.get ][ gNode.col[ j ].tab ][ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ];
                                else if ( gNode.col[ j ].tab == 'index' )
                                    tmp += (i+1);
                                else if ( gNode.col[ j ].tab == 'checkbox') {
                                    if (gIf.power) {
                                        tmp += '<input type="checkbox" value="' + i + '" />';
                                    } else {
                                        tmp += ''; 
                                    } 
                                } else if ( gNode.col[ j ].tab == 'tx_bytes' || gNode.col[ j ].tab == 'rx_bytes' ) {
                                    var mkbs = parseInt( data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] );
                                    tmp += ( mkbs > 1000000000 )? (mkbs/1000000000).toFixed(2) + ' GB' : ( ( mkbs > 1000000 )? (mkbs/1000000).toFixed(2) + ' MB' : ( ( mkbs == 0 )? 0 : (mkbs/1000).toFixed(2) + ' KB' ) );
                                } else if ( gNode.col[ j ].tab == 'action') {
                                    if (gIf.power) {
                                        for (var z=0; z<gObj.btn.length; z++)
                                        {
                                            tmp += '<button id="' + gObj.btn[z] + '-' + gNode.tab + '-' + i + '" class="' + gObj.btn[z] + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon" ></span></button>';
                                        }
                                    } else {
                                        tmp += ''; 
                                    } 
                                } else if (cols.length > 0)
                                    tmp += cols[ j ];
                                else
                                    tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                tmp += '</td>';
                            }
                            tmp += '</tr>';
                            $(tableBD).append(tmp);

                            if ( 'active_sessions' == gNode.tab ) {
                                switch( parseInt( data[ gNode.guiT ][ i ].infoStatus ) )
                                {
                                case 0:
                                    $('#Disconnect-' + pid + '-' + i).prop('disabled', true);
                                    break;
                                case 1:
                                    $('#Connect-' + pid + '-' + i).prop('disabled', true);
                                    break;
                                case 2:
                                    $('#Connect-' + pid + '-' + i).prop('disabled', true);
                                    $('#Disconnect-' + pid + '-' + i).prop('disabled', true);
                                    break;
                                }
                            }

                        }
                    }
                });
                break;
            case 'php':
                query = '';
    
                if (gNode.pager) {
                    gObj.phpQuery.pp = $('#phpPerPage').val();
                    if (gIf.query) 
                        query += gQuery.q;
                    else if (!gQuery.a) {
                        query += '&sh=' + gObj.sysHour + '&eh=' + gObj.sysHour;
                        gQuery.a = 0;
                    }
                    query += '&pi=' + gObj.phpQuery.pi + '&pp=' + gObj.phpQuery.pp;
                }
    
                switch(gNode.tag)
                {
                case 'table':
                    switch(gNode.type)
                    {
                    case 'list':

                        var tableHD = '#theadTable-' + pid + ' thead';
                        var tableBD = '#tbodyTable-' + pid + ' tbody';
                        var ascend = gY.one( tableHD).all('span.sortable.ascending');
                        var descend = gY.one( tableHD ).all('span.sortable.descending');
                        var sortBy = '';
                        var sorted = false;
                        var asc = false;
                        var sortID = '';
                        var columns = false;

                        if (ascend._nodes.length > 0) {
                            sortID = ascend._nodes[ 0 ].id;
                            sorted = sortID.split('-').pop();
                            sortBy = '&oby=' + sorted + '&asc=1';
                            asc = true;
                        } else if ( descend._nodes.length > 0) {
                            sortID = descend._nodes[ 0 ].id;
                            sorted = sortID.split('-').pop();
                            sortBy = '&oby=' + sorted;
                        }

                        if (gNode.query) {
                            if (!gColumns[ gNode.tab ][ gQuery.a ]) {
                                columns = true;
                                gColumns[ gNode.tab ][ gQuery.a ] = {};
                            }
                            tmp = '<tr>';
                            for (var i=0; i<gNode.col[ gQuery.a ].length; i++)
                            {
                                if (gNode.col[ gQuery.a ][i].wiz)
                                    wiz = gNode.col[ gQuery.a ][i].wiz;
                                else
                                    wiz = 'auto';
                                tmp += '<th id="' + gNode.tab + '-' + gQuery.a + '-' + gNode.col[ gQuery.a ][ i ].tab + '" class="ui-state-default ' + gNode.tab + '-' + gQuery.a + '-' + gNode.col[ gQuery.a ][ i ].tab + '" style="width:' + wiz + ';';
                                if ( gNode.columns ) {
                                    if ( columns ) { 
                                        if ( gNode.col[ gQuery.a ][ i ].display ) {
                                            gColumns[ gNode.tab ][ gQuery.a ][ gNode.col[ gQuery.a ][ i ].tab ] = true;
                                        } else {
                                            tmp += ' display: none;';
                                        }
                                    } else if (!gColumns[ gNode.tab ][ gQuery.a ][ gNode.col[ gQuery.a ][ i ].tab ] ) {
                                        tmp += ' display: none;';
                                    }
                                }
                                tmp += '">';
                                if (gNode.col[ gQuery.a ][ i ].sortable) {
                                    tmp += '<div id="div-' + gNode.tab + '-' + gQuery.a + '-' + gNode.col[ gQuery.a ][ i ].tab + '" class="sortable">' + gNode.col[ gQuery.a ][ i ].label + '<span id="span-' + gNode.tab + '-' + gQuery.a + '-' + gNode.col[ gQuery.a ][ i ].tab + '" class="sortable ';
                                    if (sorted && sorted == gNode.col[ gQuery.a ][ i ].tab) {
                                        tmp += (asc)? 'ascending' : 'descending';
                                    }
                                    tmp += '" ></span></div>';
                                } else {
                                    tmp += gNode.col[ gQuery.a ][ i ].label;
                                }
                                tmp += '</th>';
                            }
                            tmp += '</tr>';
   
                            gY.one(tableHD).set('innerHTML', tmp);
                        }

                        if (!(sorted && $('#' + sortID).exists())) {
                            sortBy = '';
                        }

                        loadingToggle( true );
                        $.ajax({
                            url: gObj.phpQuery.php + '.php?param=' + pid + query + sortBy,
                            dataType: 'json',
                            success: function(data) {
                                gIf.ajaxed = true;
                                // cache for sorting locally
                                gData[ pid ] = data; 
                                loadingToggle( false );
                                if (gNode.query) {
                                    tmp = '';
    
                                    if (parseInt(data.queryRows) > 0) {
                                        data.queryResults = dataSortPhp( data.queryResults, pid );
                                        for (var j=0, jlen=data.queryResults.length; j<jlen; j++)
                                        {
                                            tmp += '<tr class="' + ( (j%2==0)? 'even': 'odd' )+ '">';
                                            for (var i=0; i<gNode.col[ gQuery.a ].length; i++)
                                            {
                                                if (gNode.col[ gQuery.a ][i].wiz)
                                                    wiz = gNode.col[ gQuery.a ][i].wiz;
                                                else
                                                    wiz = 'auto';
                                                tmp += '<td style="width:' + wiz + ';';
                                                if ( gNode.columns ) {
                                                    if (!gColumns[ gNode.tab ][ gQuery.a ][ gNode.col[ gQuery.a ][ i ].tab ] ) {
                                                        tmp += ' display: none;';
                                                    }
                                                }
                                                tmp += '"';
                                                tmp += ' id="' + gNode.tab + '-' + gQuery.a + '-' + gNode.col[ gQuery.a ][ i ].tab + '-' + j + '"';     
                                                tmp += ' class="' + gNode.tab + '-' + gQuery.a + '-' + gNode.col[ gQuery.a ][ i ].tab;

                                                if ( gNode.col[ gQuery.a ][ i ].align ) {
                                                    tmp += ' align' + gNode.col[ gQuery.a ][ i ].align;
                                                }
                                                tmp += '">';

                                                switch( gNode.col[ gQuery.a ][ i ].tab )
                                                {
                                                case 'id':
                                                    tmp += (j+1);
                                                    break;
                                                case 'protocol':
                                                    if ('traffic_direction' == pid)
                                                        tmp += gRef.protocol[ data.queryResults[ j ][ gNode.col[ gQuery.a ][ i ].tab ] ];
                                                    else
                                                        tmp += data.queryResults[ j ][ gNode.col[ gQuery.a ][ i ].tab ];
                                                    break;
                                                case 'totalBytes':
                                                case 'txBytes':
                                                case 'rxBytes':
                                                    var mkbs = parseInt( data.queryResults[ j ][ gNode.col[ gQuery.a ][ i ].tab ] );
                                                    tmp += ( mkbs > 1000000000 )? (mkbs/1000000000).toFixed(2) + ' GB' : ( ( mkbs > 1000000 )? (mkbs/1000000).toFixed(2) + ' MB' : ( ( mkbs == 0 )? 0 : (mkbs/1000).toFixed(2) + ' KB' ) );
                                                    break;
                                                default: 
                                                    if (data.queryResults[ j ][ gNode.col[ gQuery.a ][ i ].tab ])
                                                        tmp += data.queryResults[ j ][ gNode.col[ gQuery.a ][ i ].tab ];
                                                    else
                                                        tmp += '';
                                                }
                                                tmp += '</td>';
                                            }
                                            tmp += '</tr>';
                                        }
                                    }
    
                                    gY.one(tableBD).set('innerHTML', tmp);
                                }
    
                                if (gNode.pager) {
                                    gObj.phpQuery.ps = Math.ceil(data.queryRows/gObj.phpQuery.pp);
                                    phpPager( pid , gObj.phpQuery.pi, gObj.phpQuery.ps );
                                }
                            }
                        });
                        break;
                    }
                    break;
                }   
                break;
            }
        }
    }
    
    function genInterface(pid) {
    
        switch(gNode.ext)
        {
        case 'cgi':
            switch(gNode.tag)
            {
            case 'table':
                switch(gNode.type)
                {
                case 'table':
                    if (gIf.power) {
                        $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                        gY.one('#pgSave').on('click', function(e) {
                            saveInterface(pid);
                        });
                    } 

                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"></div>');
    
                    $.ajax({
                        url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                        dataType: 'json',
                        success: function(data) {
                            gData[ pid ] = data;
                            gData[ gNode.url.get ] = data;

                            // cache for name
                            gCache.uniq[ pid ] = {};
                            gCache[ pid ] = {};
        
                            switch(pid)
                            {
                            case 'vlan_interfaces':
                                gCache[ pid ].vlan = {};
                                gCache[ pid ].interface = {};
                                gCache[ pid ].gid = 0;
                                gCache[ pid ].if = {};
                                gCache[ pid ].reservTGid = 0;
                                break;
                            case 'ports':
                                gCache[ pid ].if = {};
                                gCache[ pid ].reservTGid = 0;
                                break;
                            case 'lan':
                                gCache[ pid ].interfaces = {};
                                gCache[ pid ].cache = {};
                                gCache[ pid ].gid = 0;
                                gCache[ pid ].if = {};
                                gCache[ pid ].reservTGid = 0;
                                break;
                            case 'zone':
                                gCache[ pid ].member = {};
                                gCache[ pid ].cache = {};
                                gCache[ pid ].vpn = [];
                                gCache[ pid ].zoneId = 0;
                                gCache[ pid ].vpnId = 0;
                                gCache[ pid ].lanId = 0;
                                gCache[ pid ].wanId = 0;
                                break;
                            }

                            gObj.btn = [];
                            var tmp = '<div id="div-' + pid + '" class="tableDiv">';
                            tmp += '<table id="table-' + pid + '" class="' + gNode.tblAction + '">';
                            tmp += '<thead>';
                            tmp += '<tr>';
    
                            for (var i=0, len=gNode.col.length; i<len; i++)
                            {
                                tmp += '<th id="' + pid + '-' + gNode.col[ i ].tab + '" class="ui-state-default ';
                                if (gNode.col[ i ].tab == 'checkbox')
                                    tmp += ' checkTD';
                                else if (gNode.col[ i ].tab == 'action') {
                                    tmp += ' rowAction';
                                    gObj.btn = gNode.rowAction.split(' ');
                                }
                                tmp += '" style="width: ' + gNode.col[ i ].wiz + '">';
                                tmp += gNode.col[ i ].label;
                                tmp += '</th>';
                            }
    
                            tmp += '</thead>';
                            tmp += '<tbody></tbody>';
                            tmp += '</div>';
                            $('.templateDiv').append(tmp);
    
                            for (var i=0, len=parseInt(data[ gNode.guiTNum ]); i<len; i++)
                            {
                                tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                switch( pid )
                                {
                                case 'vlan_interfaces':
                                    gCache[ pid ].vlan[ parseInt( data[ gNode.guiT ][ i ].gid ) ] = parseInt( data[ gNode.guiT ][ i ].type );
                                    for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                                    {
                                        tmp += '<td>';
                                        switch(gNode.col[ j ].tab)
                                        {
                                        case 'checkbox':
                                            tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ j ].tab + '-' + i + '" />';
                                            break;
                                        case 'action':
                                            //tmp += '<button class="Edit" id="Edit-' + pid + '-' + i + '" title="Edit" ' + ((parseInt( data[ gNode.guiT ][ i ].type ) > 0)? 'disabled="disabled"' : '')+ '><span class="ui-icon"></span></button>';
                                            tmp += '<button class="Edit" id="Edit-' + pid + '-' + i + '" title="Edit" ';
                                            if ( 2 === parseInt( gCache.ports[ data[ gNode.guiT ][ i ].interface ] ) )
                                                tmp += 'disabled';
                                            
                                            tmp += '><span class="ui-icon"></span></button>';
                                            tmp += '<button class="Delete" id="Delete-' + pid + '-' + i + '" title="Delete"><span class="ui-icon"></span></button>';
                                            break;
                                        case 'zoneId':
                                            if ( 2 === parseInt( gCache.ports[ data[ gNode.guiT ][ i ].interface ] ) || parseInt( data[ gNode.guiT ][ i ].type ) > 0 || 0 === parseInt( data[ gNode.guiT ][ i ].zoneId ) ) {
                                                tmp += '';
                                            }else {
                                                tmp += gCache.name[ parseInt( data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ) ];
                                            }
                                            break;
                                        case 'address':
                                            if (2 === gCache.ports[ data[ gNode.guiT ][ i ].interface ] || parseInt( data[ gNode.guiT ][ i ].type ) > 0) {
                                                tmp += '';
                                            } else {
                                                tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                            }
                                            break;
                                        case 'dhcpPool':
                                            if (2 === gCache.ports[ data[ gNode.guiT ][ i ].interface ] || parseInt( data[ gNode.guiT ][ i ].type ) > 0) {
                                                tmp += '';
                                            } else {
                                                tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                            }
                                            break;
                                        case 'interface':
                                            if (!gCache[ pid ].interface[ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ]) {
                                                gCache[ pid ].interface[ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] = [];
                                            }
                                            gCache[ pid ].interface[ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ].push( parseInt( data[ gNode.guiT ][ i ].vid ));
                                        
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ]
                                            break;
                                        case 'name':
                                            gCache.uniq[ pid ][ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] = true;
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                            break;
                                        default:
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                        }
                                        tmp += '</td>';
                                    }
                                    break;
                                case 'lan':
                                    for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                                    {
                                        tmp += '<td>';
                                        switch(gNode.col[ j ].tab)
                                        {
                                        case 'checkbox':
                                            if (1 === parseInt( data[ gNode.guiT ][ i ].userDefined )) {
                                                tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ j ].tab + '-' + i + '" />';
                                            } else {
                                                tmp += '';
                                            }
                                            break;
                                        case 'action':
                                            tmp += '<button class="Edit" id="Edit-' + pid + '-' + i + '" title="Edit"><span class="ui-icon"></span></button>';
                                            if ( 1 === parseInt( data[ gNode.guiT ][ i ].userDefined ) ) {
                                                tmp += '<button class="Delete" id="Delete-' + pid + '-' + i + '" title="Delete"><span class="ui-icon"></span></button>';
                                            }
                                            break;
                                        case 'name':
                                            gCache.uniq[ pid ][ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] = true;
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                            break;
                                        case 'interfaces':
                                            gCache[ pid ].interfaces[ data[ gNode.guiT ][ i ].gid ] = [];
                                            gCache[ pid ].cache[ data[ gNode.guiT ][ i ].gid ] = [];
                                            var arr = data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ].split(';');
                                            for (var k=0; k<arr.length; k++)
                                            {
                                                if (!isNaN(parseInt(arr[k]))) {
                                                    if ( gCache.name[ arr[ k ] ] ) {
                                                        tmp += gCache.name[ arr[ k ] ] + ';';
                                                        gCache[ pid ].interfaces[ data[ gNode.guiT ][ i ].gid ].push(parseInt(arr[ k ]));
                                                        gCache[ pid ].cache[ data[ gNode.guiT ][ i ].gid ].push(parseInt(arr[ k ]));
                                                    } else {
                                                        tmp += arr[ k ] + ';';
                                                    }
                                                }
                                            }
                                            break;
                                        case 'zoneId':
                                            if ( 2 === parseInt( gCache.ports[ data[ gNode.guiT ][ i ].interface ] ) || parseInt( data[ gNode.guiT ][ i ].type ) > 0 || 0 === parseInt( data[ gNode.guiT ][ i ].zoneId ) ) {
                                                tmp += '';
                                            }else {
                                                tmp += gCache.name[ parseInt( data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ) ];
                                            }
                                            break;
                                        case 'address':
                                            if (2 === gCache.ports[ data[ gNode.guiT ][ i ].interface ] || parseInt( data[ gNode.guiT ][ i ].type ) > 0) {
                                                tmp += '';
                                            } else {
                                                tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                            }
                                            break;
                                        default:
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                        }
                                        tmp += '</td>';
                                    }
                                    break;
                                case 'ports':
                                    for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                                    {
                                        tmp += '<td>';
                                        switch(gNode.col[ j ].tab)
                                        {
                                        case 'speed_duplex':
                                            tmp += gRef[ gNode.url.get ].speed[ data[ gNode.guiT ][ i ].speed ] + '/' + gRef[ gNode.url.get ].duplex[ data[ gNode.guiT ][ i ].duplex ];
                                            break;
                                        case 'linkStatus':
                                            tmp += gRef[ gNode.url.get ][ gNode.col[ j ].tab ][ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ];
                                            break;
                                        case 'zoneId':
                                            if ( 2 === parseInt( gCache.ports[ data[ gNode.guiT ][ i ].interface ] ) || parseInt( data[ gNode.guiT ][ i ].type ) > 0 || 0 === parseInt( data[ gNode.guiT ][ i ].zoneId ) ) {
                                                tmp += '';
                                            }else {
                                                tmp += gCache.name[ parseInt( data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ) ];
                                            }
                                            break;
                                        case 'address':
                                            if (2 === gCache.ports[ data[ gNode.guiT ][ i ].interface ] || parseInt( data[ gNode.guiT ][ i ].type ) > 0) {
                                                tmp += '';
                                            } else {
                                                tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                            }
                                            break;
                                        case 'dhcpPool':
                                            if (2 === gCache.ports[ data[ gNode.guiT ][ i ].interface ] || parseInt( data[ gNode.guiT ][ i ].type ) > 0) {
                                                tmp += '';
                                            } else {
                                                tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                            }
                                            break;
                                        case 'action':
                                            tmp += '<button class="Edit" id="Edit-' + pid + '-' + i + '" title="Edit"><span class="ui-icon"></span></button>';
                                            break;
                                        default:
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                        }
                                        tmp += '</td>';
                                    }
                                    break;
                                case 'zone':
                                    if (data[ gNode.guiT ][ i ].name == 'LAN') {
                                        gCache[ pid ].lanId = parseInt( data[ gNode.guiT ][ i ].gid );
                                    }else if (data[ gNode.guiT ][ i ].name == 'VPN') {
                                        gCache[ pid ].vpnId = parseInt( data[ gNode.guiT ][ i ].gid );
                                    }else if (data[ gNode.guiT ][ i ].name == 'WAN') {
                                        gCache[ pid ].wanId = parseInt( data[ gNode.guiT ][ i ].gid );
                                    }
                                    for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                                    {
                                        tmp += '<td>';
                                        switch(gNode.col[ j ].tab)
                                        {
                                        case 'checkbox':
                                            if (1 === parseInt( data[ gNode.guiT ][ i ].userDefined )) {
                                                tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ j ].tab + '-' + i + '" />';
                                            } else {
                                                tmp += '';
                                            }
                                            break;
                                        case 'name':
                                            gCache.uniq[ pid ][ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] = true;
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                            break;
                                        case 'action':
                                            tmp += '<button class="Edit" id="Edit-' + pid + '-' + i + '" title="Edit"><span class="ui-icon"></span></button>';
                                            if ( 1 === parseInt( data[ gNode.guiT ][ i ].userDefined ) ) {
                                                tmp += '<button class="Delete" id="Delete-' + pid + '-' + i + '" title="Delete"><span class="ui-icon"></span></button>';
                                            }
                                            break;
                                        case 'member':
                                            var arr = data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ].split(';');
                                            gCache[ pid ].member[ parseInt( data[ gNode.guiT ][ i ].gid ) ] = [];
                                            gCache[ pid ].cache[ parseInt( data[ gNode.guiT ][ i ].gid ) ] = [];
                                            for (var k=0, klen=arr.length; k<klen; k++)
                                            {
                                                if (!isNaN(parseInt(arr[k]))) {
                                                    if ( gReg.vpn == (gReg.vpn & parseInt( arr[ k ] )) ) {
                                                        // ignore, but cache
                                                        gCache[ pid ].vpn.push( parseInt( arr[ k ] ) );
                                                    } else if ( gCache.name[ arr[ k ] ] ) {
                                                        tmp += gCache.name[ arr[ k ] ] + ';';
                                                        gCache[ pid ].member[ parseInt( data[ gNode.guiT ][ i ].gid ) ].push(parseInt(arr[ k ]));
                                                        gCache[ pid ].cache[ parseInt( data[ gNode.guiT ][ i ].gid ) ].push(parseInt(arr[ k ]));
                                                    } else {
                                                        tmp += arr[ k ] + ';';
                                                    }
                                                }
                                            }
                                            if (parseInt( data[ gNode.guiT ][ i ].gid ) == gCache[ pid ].vpnId) {
                                               tmp += "IPSec VPN Tunnel";
                                            }
                                            break;
                                        default:
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                        }
                                        tmp += '</td>';
                                    }
                                    break;
                                }
                                tmp += '</tr>';
                                $('#table-' + pid + ' tbody').append(tmp);
                            }

                            if (gNode.tblAction && gIf.power) {
                                genTblAction( pid );
    
                                switch( parseInt( data[ gNode.guiTNum ] ) )
                                {
                                case 0:
                                    $('#Remove-' + pid ).prop('disabled', true);
                                    break;
                                case gRows[ ( ('ports' == pid)? 'maxPorts' : ( ('vlan_interfaces' == pid)? 'maxVLAN' : ( ('lan' == pid)? 'maxLAN' : 'maxZone') ) ) ] :
                                    $('#Create-' + pid ).prop('disabled', true);
                                    break;
                                default: 
                                    $('#Create-' + pid ).prop('disabled', false);
                                    $('#Remove-' + pid ).prop('disabled', false);
                                }
                            }
                        }
                    });
                    break;
                }
                break;
            case 'div' :
                switch(gNode.type)
                {
                case 'tabs':
                    if (gIf.power) {
    
                         $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                         gY.one('#pgSave').on('click', function(e) {
                            gObj.tabIndex = gObj.tabber.tabs('option', 'selected');
                            saveInterface( (( 0 == gObj.tabber.tabs('option', 'selected') )? 'wan_settings' : (( 1 == gObj.tabber.tabs('option', 'selected') )? 'multiwan_settings' : 'default_dns_settings' )) );
                        });
                    };
    
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div class="tabber"><ul></ul></div></div>');
    
                    gCache[ pid ] = {};
                    gCache[ pid ].wan = {"WAN1": true, "WAN2": true, "WAN3": true, "WAN4": true, "WAN5": true, "WAN6": true};
                    gCache[ pid ].wanName = {};
                    gCache[ pid ].backupWanName = {};
                    gCache[ pid ].portId = {};
                    gCache[ pid ].wanId = 0;
    
                    for (var y in gNode.url.get)
                    {
                        gY.one('.tabber ul').append('<li id="tab-' + y + '"><a href="#panel-' + y + '">' + gNode.tabs[ y ] + '</a></li>');
                        gY.one('.tabber').append('<div id="panel-' + y + '"></div>');
    
                        $.ajax({
                            url: 'cgi-bin/' + gNode.url.get[ y ] + '.' + gNode.ext,
                            dataType: 'json',
                            success: function(data) {
                                var x = ( data.wanIpIfT )? 'wan_settings' : ( (isNaN( parseInt( data.mode )))? 'default_dns_settings' : 'multiwan_settings');
                                var tmp;
                                gData[ x ] = data;
                                switch(pid)
                                {
                                case 'wan':
                                    tmp = '<div id="div-' + x + '" class="tableDiv">';
                                    tmp += '<table id="table-' + x + '"';
                                    if (gNode.tblAction[ x ])
                                        tmp += 'class="' + gNode.tblAction[ x ] + '"';
                                    tmp += '>';
                                    if ('wan_settings' == x) {
                                        tmp += '<thead>';
                                        for (var i=0, len=gNode.col[ x ].length; i<len; i++)
                                        {
                                            tmp += '<th id="' + x + '-' + gNode.col[ x ][ i ].tab + '"';
                                            if (gNode.col[ x ][ i ].tab == 'action') {
                                                tmp += 'class="ui-state-default"';
                                                gObj.btn = gNode.rowAction[ x ].split(' ');
                                            }else if (gNode.col[ x ][ i ].tab == 'checkbox') {
                                                tmp += 'class="ui-state-default"';
                                            }else {
                                                tmp += 'class="ui-state-default"';
                                            }
                                            if (gNode.col[ x ][ i ].wiz) {
                                                tmp += 'style="width: ' + gNode.col[ x ][ i ].wiz + '"';
                                            }
                                            tmp += '>';
                                            tmp += gNode.col[ x ][ i ].label;
                                            tmp += '</th>';
                                        }
                                        tmp += '</thead>';
                                    }
                                    tmp += '<tbody></tbody>';
                                    tmp += '</table>';
                                    tmp += '</div>';
                                    $('#panel-' + x).html(tmp);
    
                                    switch(x)
                                    {
                                    case 'wan_settings':
                                        for (var i=0; i<data[ gNode.guiT ].length; i++)
                                        {
                                            tmp = '<tr class="' + ((i % 2 == 0)? 'even' : 'odd') + '">';
                                            for (var j=0, jlen=gNode.col[ x ].length; j< jlen; j++)
                                            {
                                                tmp += '<td >';
                                                if (gNode.col[ x ][ j ].tab == 'checkbox') {
                                                    if ( gIf.power ) {
                                                        tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ x ][ j ].tab + '-' + i + '" />';
                                                    } else {
                                                        tmp += '';
                                                    }
                                                } else if (gNode.col[ x ][ j ].tab == 'name') {
                                                    gCache[ pid ].wan[ data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ] ] = false;
                                                    tmp += data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ];
                                                } else if (gNode.col[ x ][ j ].tab == 'backupWanName') {
                                                    if ( 1 === parseInt( data[ gNode.guiT ][ i ].failoverEnable ) ) {
                                                        gCache.wan.wanName[ data[ gNode.guiT ][ i ].name ] = true;
                                                        gCache.wan.backupWanName[ data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ] ] = true;
                                                        tmp += data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ];
                                                    } else {
                                                        tmp += '';
                                                    }
                                                } else if (gNode.col[ x ][ j ].tab == 'action') {
                                                    if ( gIf.power ) {
                                                        for (var z=0, zlen=gObj.btn.length; z<zlen; z++)
                                                        {
                                                            tmp += '<button id="' + gObj.btn[z] + '-' + x + '-' + i + '" class="' + gObj.btn[z] + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon"></span></button>';
                                                        }
                                                    } else {
                                                        tmp += '';
                                                    }
                                                } else if (gNode.col[ x ][ j ].tab == 'wanProto') {
                                                    tmp += gRef[ gNode.url.get[ x ] ][ gNode.col[ x ][ j ].tab ][ data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ] ];
                                                } else if (gNode.col[ x ][ j ].tab == 'weight') {
                                                    for (var y in gRef.wan.weight )
                                                    {
                                                        if (parseInt( data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ] ) <= y) {
                                                            tmp += gRef.wan.weight[ y ];
                                                            break;
                                                        }
                                                    }
                                                } else if (gNode.col[ x ][ j ].tab == 'portId') {
                                                    gCache[ pid ].portId[ parseInt( data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ] ) ] = data[ gNode.guiT ][ i ].name;
                                                    tmp += gCache.name[ parseInt( data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ] ) ];
                                                } else if (gNode.col[ x ][ j ].tab == 'zoneId') {
                                                    tmp += gCache.name[ parseInt( data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ] ) ];
                                                } else if (gNode.col[ x ][ j ].tab == 'address') {
                                                    if (0 === parseInt( data[ gNode.guiT ][ i ].wanProto )) {
                                                        tmp += data[ gNode.staticipT ][ i ].ip + '/' + autoMaskBits( data[ gNode.staticipT ][ i ].netmask ); 
                                                    }else {
                                                        tmp += data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ];
                                                    }
                                                } else {
                                                    tmp += data[ gNode.guiT ][ i ][ gNode.col[ x ][ j ].tab ];
                                                }
                                                tmp += '</td>';
                                            }
                                            tmp += '</tr>';
                                            $('#table-' + x + ' tbody').append( tmp );
                                        }
    
                                        if ( gIf.power )
                                            genTblAction( x );
                                        
                                        switch( data[ gNode.guiT ].length )
                                        {
                                        case 0:
                                            $('#table-' + x + ' tbody').append( '<td colspan="10">' + gError[ gObj.lang ][ 'no_dns' ] + '</td>' );
                                            if ( gIf.power )
                                                $('#Remove-' + pid ).prop('disabled', true);
                                            break;
                                        case gRows.maxWAN:
                                            if ( gIf.power )
                                                $('#Create-' + pid ).prop('disabled', true);
                                            break;
                                        default: 
                                            if ( gIf.power ) {
                                                $('#Create-' + pid ).prop('disabled', false);
                                                $('#Remove-' + pid ).prop('disabled', false);
                                            }
                                        }
                                        break;
                                    case 'default_dns_settings':
                                        for (var j=0, jlen=gNode.col[ x ].length; j<jlen; j++) 
                                        {
                                            switch( gNode.col[ x ][ j ].type )
                                            {
                                            case 'text':
                                                tmp = '<tr>';
                                                tmp += '<th class="alignLeft" style="width: ' + gNode.col[ x ][ j ].wiz + '">' + gNode.col[ x ][ j ].label + '</th>';
                                                tmp += '<td class="alignLeft"><input type="text" id="' + gNode.col[ x ][ j ].tab + '" /></td>';
                                                tmp += '</tr>';
                                                $('#table-' + x + ' tbody').append( tmp );
                                                break;
                                            }
                                        }
                                        
                                        $('#defaultDNS1').val( data.defaultDNS1 );
                                        $('#defaultDNS2').val( data.defaultDNS2 );
                                        if ( !gIf.power ) {
                                            $('#defaultDNS1').prop('disabled', true);
                                            $('#defaultDNS2').prop('disabled', true);
                                        }
                                        break;
                                    case 'multiwan_settings':
                                        for (var j=0, jlen=gNode.col[ x ].length; j<jlen; j++) 
                                        {
                                            switch( gNode.col[ x ][ j ].type )
                                            {
                                            case 'radio':
                                                for (var y in gNode.col[ x ][ j ].option)
                                                {
                                                    tmp = '<tr>';
                                                    tmp += '<td class="align' + gNode.col[ x ][ j ].option[ y ].align[ 0 ] + '" style="width: ' + gNode.col[ x ][ j ].option[ y ].wiz + '">';
                                                    tmp += '<input type="' + gNode.col[ x ][ j ].type + '" id="' + gNode.col[ x ][ j ].option[ y ].tab + '" name="' + gNode.col[ x ][ j ].tab + '" value="' + y + '" />';
                                                    tmp += '</td>';
                                                    tmp += '<td colspan="2" class="align' + gNode.col[ x ][ j ].option[ y ].align[ 1 ] + '">';
                                                    tmp += '<label for="' + gNode.col[ x ][ j ].option[ y ].tab + '">' + gNode.col[ x ][ j ].option[ y ].label + '</label>';
                                                    tmp += '</td>';
                                                    tmp += '</tr>';
                                                    if (gNode.col[ x ][ j ].option[ y ].col) {
                                                        for ( var k=0, klen=gNode.col[ x ][ j ].option[ y ].col.length; k<klen; k++)
                                                        {
                                                            tmp += '<tr>';
                                                            tmp += '<td>'; 
                                                            tmp += '</td>';
                                                            tmp += '<td class="align' + gNode.col[ x ][ j ].option[ y ].col[ k ].align[ 1 ] + '" style="width: ' + gNode.col[ x ][ j ].option[ y ].col[ k ].wiz + '">';
                                                            tmp += gNode.col[ x ][ j ].option[ y ].col[ k ].label;
                                                            tmp += '</td>';
                                                            tmp += '<td class="align' + gNode.col[ x ][ j ].option[ y ].col[ k ].align[ 2 ] + '" >';
                                                            tmp += '<input type="' + gNode.col[ x ][ j ].option[ y ].col[ k ].type + '" id="' + gNode.col[ x ][ j ].option[ y ].col[ k ].tab + '" ' + ( (gNode.col[ x ][ j ].option[ y ].col[ k ].size)? 'size="' + gNode.col[ x ][ j ].option[ y ].col[ k ].size + '"' : '' ) + ' />';
                                                            tmp += '&nbsp;' + gNode.col[ x ][ j ].option[ y ].col[ k ].note;
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                        }
                                                    }
                                                    $('#table-' + x + ' tbody').append( tmp );
                                                }
                                                
                                                $('input[name=mode]').bind('change', function() {
                                                    switch(parseInt($(this).val()))
                                                    {
                                                    case 0:
                                                        $('#period').attr('disabled', false);
                                                        $('#count').attr('disabled', false);
                                                        break;
                                                    case 1:
                                                        $('#period').attr('disabled', true);
                                                        $('#count').attr('disabled', true);
                                                        break;
                                                    }
                                                });
                                                
                                                $('#period').val( data.period );
                                                $('#count').val( data.count );
                                                $('#mode-' + data.mode).click();
                                                break;
                                            }
                                        }
    
                                        if ( !gIf.power ) {
                                            $('#period').prop( 'disabled', true );
                                            $('#count').prop( 'disabled', true );
                                            $('#mode-0').prop( 'disabled', true );
                                            $('#mode-1').prop( 'disabled', true );
                                        }
                                        break;
                                    }
                                    break;
                                }
                            }
                        });
                    }
                    gObj.tabber = $('.tabber').tabs({ active: gObj.tabIndex });
                }
                break;
            }
            break;
        }
    }
    
    function refreshInterface(pid) {
    
        $('#table-' + pid + ' tbody').empty();
    
        var trNo = 0;
        switch(pid)
        {
        case 'wan_settings':
            if (gNode.rowAction)
                gObj.btn = gNode.rowAction[ pid ].split(' ');
            for (var i=0, len=gData[ pid ][ gNode.guiT ].length; i<len; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) == 3) {
                    continue;
                }
                tmp = '<tr class="' + ((trNo%2==0)? 'even' : 'odd') + '">';
                for (var j=0, jlen=gNode.col[ pid ].length; j<jlen; j++)
                {
                    tmp += '<td>';
                    switch (gNode.col[ pid ][ j ].tab)
                    {
                    case 'checkbox':
                        if ( gIf.power ) {
                            tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ pid ][ j ].tab + '-' + i + '" />';
                        } else {
                            tmp += '';
                        } 
                        break; 
                    case 'action':
                        if ( gIf.power ) {
                            for (var z=0, zlen=gObj.btn.length; z<zlen; z++)
                            {
                                tmp += '<button class="' + gObj.btn[ z ] + '" id="' + gObj.btn[ z ] + '-' + pid + '-' + i + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon"></span></button>';
                            }
                        } else {
                            tmp += '';
                        } 
                        break;
                    case 'name':
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ pid ][ j ].tab ];
                        break;
                    case 'wanProto':
                        tmp += gRef[ gNode.url.get[ pid ] ][ gNode.col[ pid ][ j ].tab ][ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ pid ][ j ].tab ] ];
                        break;
                    case 'zoneId':
                        tmp += gCache.name[ parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ pid ][ j ].tab ] ) ];
                        break;
                    case 'portId':
                        tmp += gCache.name[ parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ pid ][ j ].tab ] ) ];
                        break;
                    case 'weight':
                        for (var y in gRef.wan.weight )
                        {
                            if (parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ pid ][ j ].tab ] ) <= y) {
                                tmp += gRef.wan.weight[ y ];
                                break;
                            }
                        }
                        break;
                    case 'backupWanName':
                        if ( 1 === parseInt( gData[ pid ][ gNode.guiT ][ i ].failoverEnable ) ) {
                            tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ pid ][ j ].tab ];
                        }
                        break;
                    case 'address':
                        if (0 === parseInt( gData[ pid ][ gNode.guiT ][ i ].wanProto )) {
                            tmp += gData[ pid ][ gNode.staticipT ][ i ].ip + '/' + autoMaskBits( gData[ pid ][ gNode.staticipT ][ i ].netmask ); 
                        }else {
                            tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ pid ][ j ].tab ];
                        }
                        break;
                    default:
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ pid ][ j ].tab ];
                    }
                    tmp += '</td>';
                }
                tmp += '</tr>';
                $('#table-' + pid + ' tbody').append(tmp);
                trNo++;
            }
    
            var cnt = 0;
            for (var i=0; i<gData[ pid ][ gNode.guiT ].length; i++)
            {
                if (gData[ pid ][ gNode.guiT ][ i ].cgiAction != 3)
                    cnt ++
            }
    
            switch( cnt )
            {
            case 0:
                $('#table-' + pid + ' tbody').append( '<td colspan="10">' + gError[ gObj.lang ][ 'no_dns' ] + '</td>');
                if (gIf.power)
                    $('#Remove-' + pid ).prop('disabled', true);
                break;
            case gRows.maxWAN:
                if (gIf.power)
                    $('#Create-' + pid ).prop('disabled', true);
                break;
            default:
                if (gIf.power) { 
                    $('#Create-' + pid ).prop('disabled', false);
                    $('#Remove-' + pid ).prop('disabled', false);
                }
            }
            break;
        case 'ports':
            for (var i=0, len=parseInt(gData[ pid ][ gNode.guiTNum ]); i<len; i++)
            {
                tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
    
                for (var j=0; j<gNode.col.length; j++)
                {
                    tmp += '<td>';
                    switch (gNode.col[ j ].tab)
                    {
                    case 'action':
                        if (gIf.power) {
                            tmp += '<button class="Edit" id="Edit-' + pid + '-' + i + '" title="Edit"><span class="ui-icon" ></span></button>';
                        } else {
                            tmp += '';
                        }
                        break;
                    case 'name':
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                        break;
                    case 'speed_duplex':
                        tmp += gRef[ gNode.url.get ].speed[ gData[ pid ][ gNode.guiT ][ i ].speed ] + '/' + gRef[ gNode.url.get ].duplex[ gData[ pid ][ gNode.guiT ][ i ].duplex ];
                        break;
                    case 'linkStatus':
                        tmp += gRef[ gNode.url.get ][ gNode.col[ j ].tab ][ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ];
                        break;
                    case 'zoneId':
                        if ( 2 === parseInt( gCache.ports[ gData[ pid ][ gNode.guiT ][ i ].interface ] ) || parseInt( gData[ pid ][ gNode.guiT ][ i ].type ) > 0 || 0 === parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ) ) {
                            tmp += '';
                        }else {
                            tmp += gCache.name[ parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ) ];
                        }
                        break;
                    case 'address':
                    case 'dhcpPool':
                        if (2 === gCache.ports[ gData[ pid ][ gNode.guiT ][ i ].interface ] || parseInt( gData[ pid ][ gNode.guiT ][ i ].type ) > 0) {
                            tmp += '';
                        } else {
                            tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                        }
                        break;
                    default:
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                    }
                    tmp += '</td>';
                }
    
                tmp += '</tr>';
    
                $('#table-' + pid + ' tbody').append(tmp);
            }
            break;
        case 'lan':
            if (gNode.rowAction)
                gObj.btn = gNode.rowAction.split(' ');
            for (var i=0, len=parseInt(gData[ pid ][ gNode.guiTNum ]); i<len; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) == 3) {
                    continue;
                }
                tmp = '<tr class="' + ((trNo%2==0)? 'even' : 'odd') + '">';
    
                for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                {
                    tmp += '<td>';
                    switch (gNode.col[ j ].tab)
                    {
                    case 'checkbox':
                        if (1 === parseInt( gData[ pid ][ gNode.guiT ][ i ].userDefined ) && gIf.power) { 
                            tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ j ].tab + '-' + i + '" />';
                        } else {
                            tmp += '';
                        }
                        break;
                    case 'action':
                        if (gIf.power) {
                            tmp += '<button class="Edit" id="Edit-' + pid + '-' + i + '" title="Edit"><span class="ui-icon" ></span></button>';
                            if (1 === parseInt( gData[ pid ][ gNode.guiT ][ i ].userDefined )) {
                                tmp += '<button class="Delete" id="Delete-' + pid + '-' + i + '" title="Delete"><span class="ui-icon" ></span></button>';
                            }
                        } else {
                            tmp += '';
                        }
                        break;
                    case 'name':
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                        break;
                    case 'zoneId':
                        if (gCache.ports[ gData[ pid ][ gNode.guiT ][ i ].interface ] == 2 || parseInt( gData[ pid ][ gNode.guiT ][ i ].type ) > 0) {
                            tmp += '';
                        }else {
                            tmp += gCache.name[ parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ) ];
                        }
                        break;
                    case 'address':
                    case 'dhcpPool':
                        if (2 === gCache.ports[ gData[ pid ][ gNode.guiT ][ i ].interface ] || parseInt( gData[ pid ][ gNode.guiT ][ i ].type ) > 0) {
                            tmp += '';
                        } else {
                            tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                        }
                        break;
                    case 'interfaces':
                        for (var k=0; k<gCache[ pid ].interfaces[ gData[ pid ][ gNode.guiT ][ i ].gid ].length; k++)
                        {
                            if (!isNaN(parseInt(gCache[ pid ].interfaces[ gData[ pid ][ gNode.guiT ][ i ].gid ][k]))) {
                                if ( gCache.name[ gCache[ pid ].interfaces[ gData[ pid ][ gNode.guiT ][ i ].gid ][ k ] ] ) {
                                    tmp += gCache.name[ gCache[ pid ].interfaces[ gData[ pid ][ gNode.guiT ][ i ].gid ][ k ] ] + ';';
                                } else {
                                    tmp += gCache[ pid ].interfaces[ gData[ pid ][ gNode.guiT ][ i ].gid ][ k ] + ';';
                                }
                            }
                        }
                        break;
                    default:
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                    }
                    tmp += '</td>';
                }
    
                tmp += '</tr>';
    
                $('#table-' + pid + ' tbody').append(tmp);
                trNo++;
            }
    
            if (gIf.power) {
                switch( parseInt( gData[ pid ][ gNode.guiTNum ] ) )
                {
                case 0:
                    $('#Remove-' + pid ).prop('disabled', true);
                    break;
                case gRows.maxLAN:
                    $('#Create-' + pid ).prop('disabled', true);
                    break;
                default:
                    $('#Create-' + pid ).prop('disabled', false);
                    $('#Remove-' + pid ).prop('disabled', false);
                }
            }
            break;
        case 'vlan_interfaces':
            if (gNode.rowAction)
                gObj.btn = gNode.rowAction.split(' ');
            for (var i=0, len=parseInt(gData[ pid ][ gNode.guiTNum ]); i<len; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) == 3) {
                    continue;
                }
                tmp = '<tr class="' + ((trNo%2==0)? 'even' : 'odd') + '">';
                for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                {
                    tmp += '<td>';
                    switch (gNode.col[ j ].tab)
                    {
                    case 'checkbox':
                        if (gIf.power) {
                            tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ j ].tab + '-' + i + '" />';
                        } else {
                            tmp += '';
                        }
                        break;
                    case 'action':
                        if (gIf.power) {
                            tmp += '<button class="Edit" id="Edit-' + pid + '-' + i + '" title="Edit"';
                            if ( 2 === parseInt( gCache.ports[ gData[ pid ][ gNode.guiT ][ i ].interface ] ) )
                                tmp += 'disabled';

                            tmp += '><span class="ui-icon" ></span></button>';
                            tmp += '<button class="Delete" id="Delete-' + pid + '-' + i + '" title="Delete"><span class="ui-icon" ></span></button>';
                        } else {
                            tmp += '';
                        }
                        break;
                    case 'name':
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                        break;
                    case 'zoneId':
                        if (gCache.ports[ gData[ pid ][ gNode.guiT ][ i ].interface ] == 2 || parseInt( gData[ pid ][ gNode.guiT ][ i ].type ) > 0) {
                            tmp += '';
                        }else {
                            tmp += gCache.name[ parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ) ];
                        }
                        break;
                    case 'address':
                    case 'dhcpPool':
                        if (2 === gCache.ports[ gData[ pid ][ gNode.guiT ][ i ].interface ] || parseInt( gData[ pid ][ gNode.guiT ][ i ].type ) > 0) {
                            tmp += '';
                        } else {
                            tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                        }
                        break;
                    default:
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                    }
                    tmp += '</td>';
                }
                tmp += '</tr>';
                $('#table-' + pid + ' tbody').append(tmp);
                trNo++;
            }
    
            if (gIf.power) {
                switch( parseInt( gData[ pid ][ gNode.guiTNum ] ) )
                {
                case 0:
                    $('#Remove-' + pid ).prop('disabled', true);
                    break;
                case gRows.maxVLAN:
                    $('#Create-' + pid ).prop('disabled', true);
                    break;
                default: 
                    $('#Create-' + pid ).prop('disabled', false);
                    $('#Remove-' + pid ).prop('disabled', false);
                }
            }
            break;
        case 'zone':
            if (gNode.rowAction)
                gObj.btn = gNode.rowAction.split(' ');
            for (var i=0, len=parseInt(gData[ pid ][ gNode.guiTNum ]); i<len; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) == 3) {
                    continue;
                }
                tmp = '<tr class="' + ((trNo%2==0)? 'even' : 'odd') + '">';
                for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                {
                    tmp += '<td>';
                    switch (gNode.col[ j ].tab)
                    {
                    case 'checkbox':
                        if ((1 === parseInt( gData[ pid ][ gNode.guiT ][ i ].userDefined ))  && gIf.power) {
                            tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ j ].tab + '-' + i + '" />';
                        } else {
                            tmp += '';
                        }
                        break;
                    case 'action':
                        if (gIf.power) {
                            tmp += '<button class="Edit" id="Edit-' + pid + '-' + i + '" title="Edit"><span class="ui-icon" ></span></button>';
                            if (1 === parseInt( gData[ pid ][ gNode.guiT ][ i ].userDefined )) {
                                tmp += '<button class="Delete" id="Delete-' + pid + '-' + i + '" title="Delete"><span class="ui-icon" ></span></button>';
                            }
                        } else {
                            tmp += '';
                        }
                        break;
                    case 'name':
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                        break;
                    case 'member':
                        for (var k=0, klen=gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ].length; k<klen; k++)
                        {
                            if ( gCache.name[ gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ][ k ] ] ) {
                                tmp += gCache.name[ gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ][ k ] ] + ';';
                            } else {
                                tmp += gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ][ k ] + ';';
                            }
                        }
                        if ( parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) == gCache[ pid ].vpnId ) {
                            tmp += "IPSec VPN Tunnel";
                        }
                        break;
                    default:
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                    }
                    tmp += '</td>';
                }
                tmp += '</tr>';
                $('#table-' + pid + ' tbody').append(tmp);
                trNo++;
            }
    
            if (gIf.power) {
                switch( parseInt( gData[ pid ][ gNode.guiTNum ] ) )
                {
                case 0:
                    $('#Remove-' + pid ).prop('disabled', true);
                    break;
                case gRows.maxZone:
                    $('#Create-' + pid ).prop('disabled', true);
                    break;
                default: 
                    $('#Create-' + pid ).prop('disabled', false);
                    $('#Remove-' + pid ).prop('disabled', false);
                }
            }
    
            break;
        }
    }
    
    function createInterface(e) {
    
        var tmp = '';
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        tar.w = 600;
        tar.h = 480;
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        switch(tar.pid)
        {
        case 'wan_settings':
            tar.w = 660;
            tar.h = 600;
            $('#popForm').append('<div class="editorDiv"><div class="tabs"><ul></ul></div></div>');
    
            for (var i=0; i<gNode.editor.length; i++) 
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ i ].tab + '"><a href="#panel-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ i ].tab + '"><table id="table-' + gNode.editor[ i ].tab + '"></table></div>');
    
                for (var j=0, jlen=gNode.editor[ i ].col.length; j<jlen; j++)
                {
                    switch (gNode.editor[ i ].col[ j ].tag)
                    {
                    case 'p':
                        tmp = '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                        tmp += gNode.editor[ i ].col[ j ].label;
                        tmp += '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                        tmp += '<p id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                        for (var x in gCache.wan.wan)
                        {
                            if (gCache.wan.wan[ x ]) {
                                tmp += x;
                                break;
                            }
                        }
                        tmp += '</p>';
                        if (gNode.editor[ i ].col[ j ].note)
                            tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].note;
                        tmp += '</td>';
                        tmp += '</tr>';
                        break;
                    case 'input':
                        switch(gNode.editor[ i ].col[ j ].type)
                        {
                        case 'text':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].size)? 'size="' + gNode.editor[ i ].col[ j ].size + '"' : '' ) + '/>';
                            if (gNode.editor[ i ].col[ j ].note)
                                tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'radio':
                            var cnt = 0;
                            tmp = '';
                            for (var x in gNode.editor[ i ].col[ j ].option) 
                            {
                                tmp += '<tr>';
                                tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                                if (cnt == 0) 
                                    tmp += gNode.editor[ i ].col[ j ].label;
                                tmp += '</th>';
                                tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                tmp += '<input type="radio" name="' + gNode.editor[ i ].col[ j ].tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '" value="' + x + '" /> <label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '">' + gNode.editor[ i ].col[ j ].option[ x ].label + '</label>';
                                if (gNode.editor[ i ].col[ j ].option[ x ].col) {
                                    switch( gNode.editor[ i ].col[ j ].option[ x ].col.length )
                                    {
                                    case 1:
                                        tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].label + '&nbsp;<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].tab + '"' + ( (gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].size)? 'size="' + gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].size + '"' : '' ) + '/>';
                                        if (gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].note)
                                            tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].note;
                                        break;
                                    default: 
                                        for (var k=0, klen=gNode.editor[ i ].col[ j ].option[ x ].col.length; k<klen; k++)
                                        {
                                            tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col[ k ].label + '&nbsp;<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].col[ k ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].option[ x ].col[ k ].size)? 'size="' + gNode.editor[ i ].col[ j ].option[ x ].col[ k ].size + '"' : '' ) + '/>';
                                            if (gNode.editor[ i ].col[ j ].option[ x ].col[ k ].note)
                                                tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col[ k ].note;
                                        }
                                    }
                                }
                                tmp += '</td>';
                                tmp += '</tr>';
                                cnt++;
                            }
                            break;
                        case 'checkbox':
                            if ( gNode.editor[ i ].col[ j ].col ) {
                                if ( gNode.editor[ i ].col[ j ].col.type == 'radio' ) {
                                    tmp = '<tr>'
                                    tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + gNode.editor[ i ].col[ j ].wiz + '" >';
                                    tmp += '<input type="checkbox" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" value="' + gNode.editor[ i ].col[ j ].val + '" />';
                                    tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">&nbsp;' + gNode.editor[ i ].col[ j ].label + '</label>';
                                    tmp += '</th>';
                                    tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                    tmp += '<table>';
                                    for ( var x in gNode.editor[ i ].col[ j ].col.option )
                                    {
                                        tmp += '<tr>'
                                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].col.align)? gNode.editor[ i ].col[ j ].col.align[ 0 ] : "Left") + '">';
                                        tmp += '<input type="radio" name="' + gNode.editor[ i ].col[ j ].col.tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.option[ x ].tab + '" value="' + x + '" />';
                                        tmp += '</td>';
                                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].col.align)? gNode.editor[ i ].col[ j ].col.align[ 1 ] : "Left") + '">';
                                        tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.option[ x ].tab + '">' + gNode.editor[ i ].col[ j ].col.option[ x ].label + '&nbsp;</label>';
                                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.option[ x ].col.tab + '"></select>';
                                        tmp += '</td>';
                                        tmp += '</tr>'
                                    }
                                    tmp += '</table>';
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }else if ( gNode.editor[ i ].col[ j ].col.type == 'select' ) {
                                    tmp = '<tr>'
                                    tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + gNode.editor[ i ].col[ j ].wiz + '" >';
                                    tmp += '<input type="checkbox" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" value="' + gNode.editor[ i ].col[ j ].val + '" />';
                                    tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">&nbsp;' + gNode.editor[ i ].col[ j ].label + '&nbsp;</label>';
                                    tmp += '</th>';
                                    tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                    tmp += gNode.editor[ i ].col[ j ].col.label;    
                                    tmp += '&nbsp;<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.tab + '"></select>';    
                                    tmp += '</td>';
                                    tmp += '</tr>'
                                }
                            }
                            break;
                        }
                        break;
                    case 'select':
                        tmp = '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                        tmp += gNode.editor[ i ].col[ j ].label;
                        tmp += '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                        if ( 'object' === typeof gNode.editor[ i ].col[ j ].option ) {
                            for (var x in gNode.editor[ i ].col[ j ].option)
                                tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                        }
                        tmp += '</select>';
                        tmp += '</td>';
                        tmp += '</tr>';
    
                        if ( gNode.editor[ i ].col[ j ].col ) {
                            for (var x in gNode.editor[ i ].col[ j ].col)
                            {
                                tmp += '<tr class="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '">';
                                tmp += '<th></th>';
                                tmp += '<td>';
                                tmp += '<table id="table-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '">';
                                for (var k=0, klen=gNode.editor[ i ].col[ j ].col[ x ].length; k<klen; k++)
                                {
                                    tmp += '<tr>';
                                    switch( gNode.editor[ i ].col[ j ].col[ x ][ k ].type )
                                    {
                                    case 'text' :
                                        tmp += '<td class="alignLeft" style="width: ' + gNode.editor[ i ].col[ j ].col[ x ][ k ].wiz + '" >' + gNode.editor[ i ].col[ j ].col[ x ][ k ].label + '</td>';
                                        tmp += '<td class="alignLeft"><input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].col[ x ][ k ].size)? 'size="' + gNode.editor[ i ].col[ j ].col[ x ][ k ].size + '"' : '' ) + '/></td>';
                                        break;
                                    case 'radio' :
                                        tmp += '<td class="alignLeft" >';
                                        tmp += gNode.editor[ i ].col[ j ].col[ x ][ k ].label;
                                        tmp += '</td>';
                                        tmp += '<td class="alignLeft">';
                                        tmp += '<table id="table-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '">';

                                        for (var y in gNode.editor[ i ].col[ j ].col[ x ][ k ].option)
                                        {
                                            tmp += '<tr>';
                                            tmp += '<td class="alignLeft" >';
                                            tmp += '<input type="radio" name="' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '-' + y + '" value="' + y + '" />&nbsp;<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '-' + y + '">' + gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].label + '</label>';
                                            tmp += '</td>';
                                            tmp += '<td class="alignLeft">';
                                            if (gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col) { 
                                                tmp += '<table id="table-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].tab + '">';
                                                for (var m=0, mlen=gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col.length; m<mlen; m++) 
                                                { 
                                                    tmp += '<tr>';
                                                    tmp += '<td class="alignLeft">';
                                                    tmp += gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col[ m ].label;
                                                    tmp += '</td>';
                                                    tmp += '<td class="alignLeft">';
                                                    tmp += '<input type="text" ' + ( ( gNode.editor[ i ].col[ j ].col[ x ][ k].option[ y ].col[ m ].size )? 'size="8"' : '') + ' id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col[ m ].tab + '" />'; 
                                                    tmp += '&nbsp;';
                                                    tmp += ( gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col[ m ].note )? gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col[ m ].note : '';
                                                    tmp += '</td>';
                                                    tmp += '</tr>';
                                                } 
                                                tmp += '</table>'; 
                                            }
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                        }

                                        tmp += '</table>';
                                        tmp += '</td>';
                                        break;
                                    case 'select' :
                                        tmp += '<td class="alignLeft" style="width: ' + gNode.editor[ i ].col[ j ].col[ x ][ k ].wiz + '" >' + gNode.editor[ i ].col[ j ].col[ x ][ k ].label + '</td>';
                                        tmp += '<td class="alignLeft">';

                                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" >';

                                        if ( 'object' === typeof gNode.editor[ i ].col[ j ].col[ x ][ k ].option ) {
                                            for (var y in gNode.editor[ i ].col[ j ].col[ x ][ k ].option)
                                                tmp += '<option value="' + y + '">' + gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ] + '</option>';
                                        }

                                        tmp += '</select>';
                                        tmp += '</td>';
                                        break;
                                    }
                                    tmp += '</tr>';
                                }
                                tmp += '</table>';
                                tmp += '</td>';
                                tmp += '</tr>';
                            }
                        }
                        break;
                    case 'table':
                        tmp = '<thead>';
                        tmp += '<tr>';
                        for (var k=0; k<gNode.editor[ i ].col[ j ].col.length; k++)
                        {
                            tmp += '<th class="ui-state-default" style="width: ' + gNode.editor[ i ].col[ j ].col[ k ].wiz + '">' + gNode.editor[ i ].col[ j ].col[ k ].label + '</th>';
                        }
                        tmp += '</tr>';
                        tmp += '</thead>';
                        break;
                    }
                    $('#table-' + gNode.editor[ i ].tab).append(tmp);
                }
            }
    
            gObj.tab = $('.tabs').tabs();
    
            genAlias(tar.pid);
    
            cgiSelectOption('basic_settings-zoneId', gCache.wanId);
            cgiSelectOption('basic_settings-portId');
            cgiSelectOption('multiple_wan_settings-netDetectPingIpId');
            cgiSelectOption('multiple_wan_settings-netDetectDnsIpId');
            genSelector('multiple_wan_settings-backupWanName');
    
            $('input[name=ondemand]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-2-maxIdleTime').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-2-maxIdleTime').prop('disabled', false);
                    break;
                }
            });

            $('input[name=0-mtuMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-0-mtu').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-0-mtu').prop('disabled', false);
                    if (3 == gObj.routing.protoType) {
                        if (!gReg.mtuValue6.test( $('#basic_settings-wanProto-0-mtu').val() ))
                            remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                    }
                    break;
                }
            });

            $('#basic_settings-wanProto-0-mtu').blur( function() {
                if (3 == gObj.routing.protoType) {
                    if (!gReg.mtuValue6.test( $('#basic_settings-wanProto-0-mtu').val() ))
                        remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                }
            });

            $('input[name=1-mtuMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-1-mtu').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-1-mtu').prop('disabled', false);
                    if (3 == gObj.routing.protoType) {
                        if (!gReg.mtuValue6.test( $('#basic_settings-wanProto-1-mtu').val() ))
                            remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                    }
                    break;
                }
            });

            $('#basic_settings-wanProto-1-mtu').blur( function() {
                if (3 == gObj.routing.protoType) {
                    if (!gReg.mtuValue6.test( $('#basic_settings-wanProto-1-mtu').val() ))
                        remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                }
            });
    
            $('input[name=2-mtuMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-2-mtu').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-2-mtu').prop('disabled', false);
                    if (3 == gObj.routing.protoType) {
                        if (!gReg.mtuValue6PPPoE.test( $('#basic_settings-wanProto-2-mtu').val() ))
                            remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                    }
                    break;
                }
            });

            $('#basic_settings-wanProto-2-mtu').blur( function() {
                if (3 == gObj.routing.protoType) {
                    if (!gReg.mtuValue6PPPoE.test( $('#basic_settings-wanProto-2-mtu').val() ))
                        remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                }
            });
    
            $('input[name=0-dnsMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-0-userDns1').prop('disabled', true);
                    $('#basic_settings-wanProto-0-userDns2').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-0-userDns1').prop('disabled', false);
                    $('#basic_settings-wanProto-0-userDns2').prop('disabled', false);
                    break;
                }
            });

            $('input[name=1-dnsMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-1-userDns1').prop('disabled', true);
                    $('#basic_settings-wanProto-1-userDns2').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-1-userDns1').prop('disabled', false);
                    $('#basic_settings-wanProto-1-userDns2').prop('disabled', false);
                    break;
                }
            });

            $('input[name=2-dnsMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-2-userDns1').prop('disabled', true);
                    $('#basic_settings-wanProto-2-userDns2').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-2-userDns1').prop('disabled', false);
                    $('#basic_settings-wanProto-2-userDns2').prop('disabled', false);
                    break;
                }
            });

            $('#basic_settings-wanProto').change( function() {
                $('.' + $(this).attr('id') + '-0').hide();
                $('.' + $(this).attr('id') + '-1').hide();
                $('.' + $(this).attr('id') + '-2').hide();
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('.' + $(this).attr('id') + '-0').show();
                    $('#basic_settings-wanProto-0-dnsMode-0').prop('disabled', true);
                    $('#basic_settings-wanProto-0-dnsMode-1').click().trigger('change');
                    if (gReg.ipv4.test( $('#basic_settings-wanProto-0-ip').val() ) && gReg.ipv4.test( $('#basic_settings-wanProto-0-netmask').val() )) {
                        gObj.tab.tabs("enable", 2);
                    }else {
                        if (3 == gObj.routing.protoType) {
                            gObj.tab.tabs({"disabled": [2]});
                        }else {
                            gObj.tab.tabs({"disabled": [2,3]});
                        }
                    }
                    break;
                case 1:
                    $('.' + $(this).attr('id') + '-1').show();
                    $('#basic_settings-wanProto-1-dnsMode-0').prop('disabled', false);
                    $('#basic_settings-wanProto-1-dnsMode-0').click().trigger('change');;
                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs("enable", 2);
                    } else {
                        gObj.tab.tabs({"disabled": [3]});
                    }
                    break;
                case 2:
                    $('.' + $(this).attr('id') + '-2').show();
                    $('#basic_settings-wanProto-2-dnsMode-0').prop('disabled', false);
                    $('#basic_settings-wanProto-2-dnsMode-0').click().trigger('change');;

                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs({"disabled": [2]});
                    }else {
                        gObj.tab.tabs({"disabled": [2,3]});
                    }
                    break;
                }
            }).val(1).trigger('change');
    
            $('input[name=macCloneEnable]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-macClone').prop('disabled', true);   
                    break;
                case 1:
                    $('#basic_settings-macClone').prop('disabled', false);   
                    break;
                }
            });
    
            $('input[name=netDetectMethod]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', false);   
                    $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', true);   
                    break;
                case 1:
                    $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', true);   
                    $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', false);   
                    break;
                }
            });
    
            $('#multiple_wan_settings-netDetectEnable').change( function() {
                if ($(this).is(':checked')) {
                    $('input[name=netDetectMethod]').prop('disabled', false);
                    if ($('#multiple_wan_settings-netDetectMethod-0').is(':checked')) {
                        $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', false);   
                    }else {
                        $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', false);   
                    }
                }else {
                    $('input[name=netDetectMethod]').prop('disabled', true);
                    $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', true);   
                    $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', true);   
                }
            });
    
            $('#multiple_wan_settings-failoverEnable').change( function() {
                if ($(this).is(':checked')) {
                    $('#multiple_wan_settings-backupWanName').prop('disabled', false);
                }else {
                    $('#multiple_wan_settings-backupWanName').prop('disabled', true);
                }
            });
    
            $('#basic_settings-wanProto').val(1).trigger('change');
            $('#basic_settings-wanProto-2-ondemand-0').click();
            $('#basic_settings-wanProto-2-maxIdleTime').val(10);
            $('#basic_settings-wanProto-0-mtuMode-0').click();
            $('#basic_settings-wanProto-1-mtuMode-0').click();
            $('#basic_settings-wanProto-2-mtuMode-0').click();
            $('#basic_settings-wanProto-0-dnsMode-1').click();
            $('#basic_settings-wanProto-1-dnsMode-0').click();
            $('#basic_settings-wanProto-2-dnsMode-0').click();
            $('#basic_settings-wanProto-0-mtu').val(1500);
            $('#basic_settings-wanProto-1-mtu').val(1500);
            $('#basic_settings-wanProto-2-mtu').val(1492);
            $('#basic_settings-macCloneEnable-0').click();
    
            $('#multiple_wan_settings-weight').val( 50 );
            $('#multiple_wan_settings-netDetectMethod-0').click();
            
            $('input[name=netDetectMethod]').prop('disabled', true);
            $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', true);   
            $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', true);   
            $('#multiple_wan_settings-backupWanName').prop('disabled', true);
    
            $('#basic_settings-wanProto_v6').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#tr-' + $(this).attr('id') + '-0').show();
                    break;
                default:
                    $('#tr-' + $(this).attr('id') + '-0').hide();
                }
            });
    
            $('#basic_settings-wanProto-0-ip').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-wanProto-0-ip').val() ) && gReg.ipv4.test( $('#basic_settings-wanProto-0-netmask').val() ) ) {
                    gObj.tab.tabs('enable', 2);
                } else {
                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs({"disabled": [2]});
                    } else {
                        gObj.tab.tabs({"disabled": [2,3]});
                    }
                }
            });

            $('#basic_settings-wanProto-0-netmask').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-wanProto-0-ip').val() ) && gReg.ipv4.test( $('#basic_settings-wanProto-0-netmask').val() ) ) {
                    gObj.tab.tabs('enable', 2);
                } else {
                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs({"disabled": [2]});
                    } else {
                        gObj.tab.tabs({"disabled": [2,3]});
                    }
                }
            });

            break;
        case 'lan':
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ i ].tab + '"><a href="#panel-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ i ].tab + '"></div>');
                $('#panel-' + gNode.editor[ i ].tab).append('<table id="table-' + gNode.editor[ i ].tab + '"></table>');
                for (var j=0, jlen=gNode.editor[ i ].col.length; j<jlen; j++)
                {
                    switch (gNode.editor[ i ].col[ j ].tag)
                    {
                    case 'input':
                        switch(gNode.editor[ i ].col[ j ].type)
                        {
                        case 'text':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].size)? 'size="' + gNode.editor[ i ].col[ j ].size + '"' : '' ) + '/>';
                            if (gNode.editor[ i ].col[ j ].note)
                                tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'checkbox':
                            tmp = '<tr>'
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + gNode.editor[ i ].col[ j ].wiz + '" >';
                            tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">' + gNode.editor[ i ].col[ j ].label + '</label>';
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="checkbox" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" value="' + gNode.editor[ i ].col[ j ].val + '" />';
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        }
                        break;
                    case 'select':
                        switch(gNode.editor[ i ].col[ j ].type)
                        {
                        case 'select':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                            if ( gNode.editor[ i ].col[ j ].option ) {
                                for (var x in gNode.editor[ i ].col[ j ].option)
                                    tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                            }
                            tmp += '</select>';
                            tmp += '</td>';
                            tmp += '</tr>';
        
                            if ( gNode.editor[ i ].col[ j ].col ) {
                                for (var x in gNode.editor[ i ].col[ j ].col)
                                {
                                    tmp += '<tr class="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '">';
                                    tmp += '<th></th>';
                                    tmp += '<td>';
                                    tmp += '<table>';
                                    for (var k=0, klen=gNode.editor[ i ].col[ j ].col[ x ].length; k<klen; k++)
                                    {
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft" style="width: ' + gNode.editor[ i ].col[ j ].col[ x ][ k ].wiz + '" >' + gNode.editor[ i ].col[ j ].col[ x ][ k ].label + '</td>';
                                        tmp += '<td class="alignLeft"><input type="text" id="' + gNode.editor[ i ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].col[ x ][ k ].size)? 'size="' + gNode.editor[ i ].col[ j ].col[ x ][ k ].size + '"' : '' ) + ' /></td>';
                                        tmp += '</tr>';
                                    }
                                    tmp += '</table>';
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }
                            }
                            break;
                        case 'multiple':
                            tmp = '<tr>';
                            tmp += '<td colspan="2">';
                            tmp += '<table>';
            
                            tmp += '<tr>';
                            tmp += '<th style="width: ' + gNode.editor[ i ].col[ j ].multiple.pool.wiz + '">';
                            tmp += gNode.editor[ i ].col[ j ].multiple.pool.label;
                            tmp += '</th>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.del.wiz + '">';
                            tmp += '</th>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.add.wiz + '">';
                            tmp += '</th>';
                            tmp += '<th style="width: ' + gNode.editor[ i ].col[ j ].multiple.pick.wiz + '">';
                            tmp += gNode.editor[ i ].col[ j ].multiple.pick.label;
                            tmp += '</th>';
                            tmp += '</tr>';
            
                            tmp += '<tr>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.pool.wiz + '">';
                            tmp += '<select id="pool" multiple size="10"></select>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.del.wiz + '">';
                            tmp += '<button class="Move2Del" id="Move2Del-interfaces"><span class="ui-icon"></span></button>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.add.wiz + '">';
                            tmp += '<button class="Move2Add" id="Move2Add-interfaces"><span class="ui-icon"></span></button>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.pick.wiz + '">';
                            tmp += '<select id="pick" multiple size="10"></select>';
                            tmp += '</td>';
                            tmp += '</tr>';
            
                            tmp += '</table>';
                            tmp += '</td>';
                            tmp += '<tr>';
                            break;
                        }
                        break;
                    case 'table':
                        tmp = '<thead>';
                        tmp += '<tr>';
                        for (var k=0; k<gNode.editor[ i ].col[ j ].col.length; k++)
                        {
                            tmp += '<th class="ui-state-default" style="width: ' + gNode.editor[ i ].col[ j ].col[ k ].wiz + '">' + gNode.editor[ i ].col[ j ].col[ k ].label + '</th>';
                        }
                        tmp += '</tr>';
                        tmp += '</thead>';
                        break;
                    }
    
                    $('#table-' + gNode.editor[ i ].tab).append(tmp);
                }
            }
    
            gObj.tab = $('.tabs').tabs();
    
            $('#dhcp_pool_settings-1-leaseTime').val( 86400 );

            $('#dhcp_pool_settings-type').change( function() {
                $('.dhcp_pool_settings-type-1').hide();
                $('.dhcp_pool_settings-type-2').hide();

                switch(parseInt($(this).val()))
                {
                case 2:
                    $('.dhcp_pool_settings-type-2').show();
                case 0:
                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs({"disabled": [2]});
                    } else {
                        gObj.tab.tabs({"disabled": [2,4]});
                    }
                    break;
                case 1:
                    $('.dhcp_pool_settings-type-1').show();
                    gObj.tab.tabs("enable", 2);
                    gObj.tab.tabs("enable", 3);
                    break;
                }
            }).val(1).trigger('change');
    
            cgiSelectOption( 'basic_settings-zoneId' );
            $('#ipv6_settings-ipv6PrefixLength').val(0);
            $('#ipv6_settings-ipv6Address').val("::");
    
            genAlias( tar.pid );
            genDhcpBinding( );
            genMultiSelector( tar.pid );
    
            // bind name check
            $('#basic_settings-name').blur( function() {
                gCheck = {};
                $.post('cgi-bin/common_interface_check_name.cgi', gY.JSON.stringify({"name" : $('#basic_settings-name').val()}) , function(poster) {
                    gCheck = poster;
                });
            });

            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerLAN ) {
                    errorAlert( '<p>' + gError[ gObj.lang ].memberLimit + '</p>' );
                    return false;
                } else {
                    vSel.clone().appendTo('#pick');
                    vSel.remove();
                }
            });
    
            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
    
            $('#basic_settings-address').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-address').val() ) ) {
                    
                    $('#basic_settings-netmask').prop('disabled', false).focus();
                    $('#basic_settings-zoneId').prop('disabled', false);
                    if (gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                        gObj.tab.tabs('enable', 1);
                        gObj.tab.tabs('enable', 3);
                        if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                            gObj.tab.tabs('enable', 2);
                        autoDhcpServer( tar.pid, $('#basic_settings-address').val(), $('#basic_settings-netmask').val() );
                        gObj.addressed = $('#basic_settings-address').val();
                    }
                } else {
                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs({"disabled": [1,2,3]});
                    } else {
                        gObj.tab.tabs({"disabled": [1,2,3,4]});
                    }
                }
            });

            $('#basic_settings-netmask').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-address').val() ) && gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                    gObj.addressed = $('#basic_settings-address').val();
                    gObj.tab.tabs('enable', 1);
                    gObj.tab.tabs('enable', 3);
                    if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                        gObj.tab.tabs('enable', 2);
                    autoDhcpServer( tar.pid, $('#basic_settings-address').val(), $('#basic_settings-netmask').val() );
                }else {
                    gIf.addressed = false;
                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs({"disabled": [1,2,3]});
                    } else {
                        gObj.tab.tabs({"disabled": [1,2,3,4]});
                    }
                }
            });

            $('#basic_settings-netmask').prop('disabled', true);
            $('#basic_settings-zoneId').prop('disabled', true);
            if (3 == gObj.routing.protoType) { 
                gObj.tab.tabs({"disabled": [1,2,3]});
            } else {
                gObj.tab.tabs({"disabled": [1,2,3,4]});
            }       

            $('#dhcp_pool_settings-1-startIp').blur( function() {
                var pass = dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $(this).val(), $('#dhcp_pool_settings-1-endIp').val() );
                if (!pass) 
                    errorAlert( '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>' );
            });

            $('#dhcp_pool_settings-1-endIp').blur( function() {
                var pass = dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $(this).val() );
                if (!pass) 
                    errorAlert( '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>' );
            });
            break;
        case 'vlan_interfaces':
            // check if interface available 
            var pass = false;
            for (var x in gCache.ports)
            {
                if (2 != gCache.ports[ x ])
                    pass = true;
            }
    
            if (!pass) {
                //errorAlert(' To add a Vlan on GE port, please remove the GE port from LAN interface ');
                errorAlert( '<p>' + gError[ gObj.lang ].noVlanInterface + '</p>' );
                return false;
            }else {
                $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
    
                for (var i=0, len=gNode.editor.length; i<len; i++) 
                {
                    $('.tabs ul').append('<li id="tab-' + gNode.editor[ i ].tab + '"><a href="#panel-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</a></li>');
                    $('.tabs').append('<div id="panel-' + gNode.editor[ i ].tab + '"></div>');
                    $('#panel-' + gNode.editor[ i ].tab).append('<table id="table-' + gNode.editor[ i ].tab + '"></table>');
                    for (var j=0, jlen=gNode.editor[ i ].col.length; j<jlen; j++)
                    {
                        switch (gNode.editor[ i ].col[ j ].tag)
                        {
                        case 'input':
                            switch(gNode.editor[ i ].col[ j ].type)
                            {
                            case 'text':
                                tmp = '<tr>';
                                tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                                tmp += gNode.editor[ i ].col[ j ].label;
                                tmp += '</th>';
                                tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].size)? 'size="' + gNode.editor[ i ].col[ j ].size + '"' : '' ) + ' />';
                                if (gNode.editor[ i ].col[ j ].note)
                                    tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].note;
                                tmp += '</td>';
                                tmp += '</tr>';
                                break;
                            case 'radio':
                                var cnt = 0;
                                tmp = '';
                                for (var x in gNode.editor[ i ].col[ j ].option) 
                                {
                                    tmp += '<tr>';
                                    tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                                    if (cnt == 0) 
                                        tmp += gNode.editor[ i ].col[ j ].label;
                                    tmp += '</th>';
                                    tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                    tmp += '<input type="radio" name="' + gNode.editor[ i ].col[ j ].tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '" value="' + x + '" /> <label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '">' + gNode.editor[ i ].col[ j ].option[ x ].label + '</label>';
                                    if (gNode.editor[ i ].col[ j ].option[ x ].col) {
                                        tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col.label + '&nbsp;<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].col.tab + '" ' + ( (gNode.editor[ i ].col[ j ].option[ x ].col.size)? 'size="' + gNode.editor[ i ].col[ j ].option[ x ].col.size + '"' : '' ) + ' />';
                                        if (gNode.editor[ i ].col[ j ].option[ x ].col.note)
                                            tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col.note;
                                    }
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                    cnt++;
                                }
                                break;
                            }
                            break;
                        case 'select':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                            if ( gNode.editor[ i ].col[ j ].option ) {
                                for (var x in gNode.editor[ i ].col[ j ].option)
                                    tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                            }
                            tmp += '</select>';
                            tmp += '</td>';
                            tmp += '</tr>';
        
                            if ( gNode.editor[ i ].col[ j ].col ) {
                                for (var x in gNode.editor[ i ].col[ j ].col)
                                {
                                    tmp += '<tr class="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '">';
                                    tmp += '<th></th>';
                                    tmp += '<td>';
                                    tmp += '<table>';
                                    for (var k=0, klen=gNode.editor[ i ].col[ j ].col[ x ].length; k<klen; k++)
                                    {
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft" style="width: ' + gNode.editor[ i ].col[ j ].col[ x ][ k ].wiz + '" >' + gNode.editor[ i ].col[ j ].col[ x ][ k ].label + '</td>';
                                        tmp += '<td class="alignLeft"><input type="text" id="' + gNode.editor[ i ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].col[ x ][ k ].size)? 'size="' + gNode.editor[ i ].col[ j ].col[ x ][ k ].size + '"' : '' ) + '/></td>';
                                        tmp += '</tr>';
                                    }
                                    tmp += '</table>';
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }
                            }
                            break;
                        case 'table':
                            tmp = '<thead>';
                            tmp += '<tr>';
                            for (var k=0; k<gNode.editor[ i ].col[ j ].col.length; k++)
                            {
                                tmp += '<th class="ui-state-default" style="width: ' + gNode.editor[ i ].col[ j ].col[ k ].wiz + '">' + gNode.editor[ i ].col[ j ].col[ k ].label + '</th>';
                            }
                            tmp += '</tr>';
                            tmp += '</thead>';
                            break;
                        }
                        $('#table-' + gNode.editor[ i ].tab).append(tmp);
        
                    }
                }
    
                gObj.tab = $('.tabs').tabs();
                cgiSelectOption( 'basic_settings-interface' );
                cgiSelectOption( 'basic_settings-zoneId' );
    
                $('#dhcp_pool_settings-1-leaseTime').val( 86400 );

                $('#dhcp_pool_settings-type').change( function() {
                    $('.dhcp_pool_settings-type-1').hide();
                    $('.dhcp_pool_settings-type-2').hide();
    
                    switch(parseInt($(this).val()))
                    {
                    case 2:
                        $('.dhcp_pool_settings-type-2').show();
                    case 0:
                        if (3 == gObj.routing.protoType) {
                            gObj.tab.tabs({"disabled": [2]});
                        } else {
                            gObj.tab.tabs({"disabled": [2,4]});
                        }
                        break;
                    case 1:
                        $('.dhcp_pool_settings-type-1').show();
                        gObj.tab.tabs("enable", 2);
                        gObj.tab.tabs("enable", 3);
                        break;
                    }
                }).val(0).trigger('change');

                $('#ipv6_settings-ipv6PrefixLength').val(0);
                $('#ipv6_settings-ipv6Address').val('::');
    
                $('#basic_settings-mtuValue').val(1500);
                $('input[name=mtuMode]').change( function() {
                    switch(parseInt($(this).val()))
                    {
                    case 0:
                        $('#basic_settings-mtuValue').prop('disabled', true);
                        break;
                    case 1:
                        $('#basic_settings-mtuValue').prop('disabled', false);
                        if (3 == gObj.routing.protoType) {
                            if (!gReg.mtuValue6.test( $('#basic_settings-mtuValue').val() ))
                                remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                        }
                        break;
                    }
                }).eq(0).trigger('click');
        

                $('#basic_settings-mtuValue').blur( function() {
                    if (3 == gObj.routing.protoType) {
                        if (!gReg.mtuValue6.test( $('#basic_settings-mtuValue').val() ))
                            remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );

                    }
                });


                // bind name check
                $('#basic_settings-name').blur( function() {
                    gCheck = {};
                    $.post('cgi-bin/common_interface_check_name.cgi', gY.JSON.stringify({"name" : $('#basic_settings-name').val()}) , function(poster) {
                        gCheck = poster;
                    });
                });

                genAlias( tar.pid );
                genDhcpBinding( );

                $('#basic_settings-address').blur( function() {
                    if (gReg.ipv4.test( $('#basic_settings-address').val() ) ) {
                        $('#basic_settings-netmask').prop('disabled', false).focus();
                        $('#basic_settings-zoneId').prop('disabled', false);
                        if (gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                            gObj.tab.tabs('enable', 1);
                            gObj.tab.tabs('enable', 3);
                            if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                                gObj.tab.tabs('enable', 2);
                            autoDhcpServer( tar.pid, $('#basic_settings-address').val(), $('#basic_settings-netmask').val() );
                            gObj.addressed = $('#basic_settings-address').val();
                        } 
                    } else {
                        if (3 == gObj.routing.protoType) {
                            gObj.tab.tabs({"disabled": [1,2,3]});
                        } else {
                            gObj.tab.tabs({"disabled": [1,2,3,4]});
                        }
                    }
                });
                
                $('#basic_settings-netmask').blur( function() {
                    if (gReg.ipv4.test( $('#basic_settings-address').val() ) && gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {      
                        gObj.addressed = $('#basic_settings-address').val();
                        gObj.tab.tabs('enable', 1);
                        gObj.tab.tabs('enable', 3);
                        if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                            gObj.tab.tabs('enable', 2);
                        autoDhcpServer( tar.pid, $('#basic_settings-address').val(), $('#basic_settings-netmask').val() );
                    }else {
                        gIf.addressed = false;
                        if (3 == gObj.routing.protoType) {
                            gObj.tab.tabs({"disabled": [1,2,3]});
                        } else {
                            gObj.tab.tabs({"disabled": [1,2,3,4]});
                        }
                    }
                });
    
                $('#basic_settings-netmask').prop('disabled', true);
                $('#basic_settings-zoneId').prop('disabled', true);
                if (3 == gObj.routing.protoType) {
                    gObj.tab.tabs({"disabled": [1,2,3]});
                } else {
                    gObj.tab.tabs({"disabled": [1,2,3,4]});
                }

                $('#dhcp_pool_settings-1-startIp').blur( function() {
                    var pass = dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $(this).val(), $('#dhcp_pool_settings-1-endIp').val() );
                    if (!pass) 
                        errorAlert( '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>' );
                });

                $('#dhcp_pool_settings-1-endIp').blur( function() {
                    var pass = dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $(this).val() );
                    if (!pass)
                        errorAlert( '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>' );
                });
            }
            break;
        case 'zone':
            $('#popForm').append('<div class="formDiv"><table id="table-editor"></table></div>');
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                tmp = '<tr>';
                switch(gNode.editor[ i ].tab)
                {
                case 'name':
                case 'securityLevel':
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>'; 
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '" >';
                    tmp += '<input type="' + gNode.editor[ i ].type + '" id="editor-' + gNode.editor[ i ].tab + '" ' + (( gNode.editor[ i ].tab == 'securityLevel')? 'size="8"' : '') + '/>';
                    if (gNode.editor[ i ].note)
                        tmp += '&nbsp;' + gNode.editor[ i ].note;
                    tmp += '</td>';
                    break;
                case 'member':
                    tmp += '<td colspan="2">';
                    tmp += '<table>';
    
                    tmp += '<tr>';
                    tmp += '<th style="width: ' + gNode.editor[ i ].multiple.pool.wiz + '">';
                    tmp += gNode.editor[ i ].multiple.pool.label;
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.del.wiz + '">';
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.add.wiz + '">';
                    tmp += '</th>';
                    tmp += '<th style="width: ' + gNode.editor[ i ].multiple.pick.wiz + '">';
                    tmp += gNode.editor[ i ].multiple.pick.label;
                    tmp += '</th>';
                    tmp += '</tr>';
    
                    tmp += '<tr>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.pool.wiz + '">';
                    tmp += '<select id="pool" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.del.wiz + '">';
                    tmp += '<button class="Move2Del" id="Move2Del-member"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.add.wiz + '">';
                    tmp += '<button class="Move2Add" id="Move2Add-member"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.pick.wiz + '">';
                    tmp += '<select id="pick" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';
    
                    tmp += '</table>';
                    tmp += '</td>';
                    break;
                }
                tmp += '</tr>';
                $('#table-editor').append(tmp);
            }
            genMultiSelector( tar.pid );
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerZone ) {
                    errorAlert( '<p>' + gError[ gObj.lang ].memberLimit + '</p>' );
                    return false;
                } else {
                    vSel.clone().appendTo('#pick');
                    vSel.remove();
                }
            });
    
            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
    
            break;
        }
    
        interfaceEditor(e, tar.w, tar.h);
    }
    
    function editInterface(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
    
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        tar.thisNo = tar.id.split(gReg.isDash)[2];
        tar.w = 600;
        tar.h = 480;
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        var tmp = '';
    
        switch(tar.pid)
        {
        case 'wan_settings':
            tar.w = 660;
            tar.h = 600;
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
    
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ i ].tab + '"><a href="#panel-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ i ].tab + '"></div>');
                $('#panel-' + gNode.editor[ i ].tab).append('<table id="table-' + gNode.editor[ i ].tab + '"></table>');
                for (var j=0, jlen=gNode.editor[ i ].col.length; j<jlen; j++)
                {
                    switch (gNode.editor[ i ].col[ j ].tag)
                    {
                    case 'p':
                        tmp = '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                        tmp += gNode.editor[ i ].col[ j ].label;
                        tmp += '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                        tmp += '<p id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                        tmp += '</p>';
                        if (gNode.editor[ i ].col[ j ].note)
                            tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].note;
                        tmp += '</td>';
                        tmp += '</tr>';
                        break;
                    case 'input':
                        switch(gNode.editor[ i ].col[ j ].type)
                        {
                        case 'text':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].size)? 'size="' + gNode.editor[ i ].col[ j ].size + '"' : '' ) + '/>';
                            if (gNode.editor[ i ].col[ j ].note)
                                tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'radio':
                            var cnt = 0;
                            tmp = '';
                            for (var x in gNode.editor[ i ].col[ j ].option) 
                            {
                                tmp += '<tr>';
                                tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                                if (cnt == 0) 
                                    tmp += gNode.editor[ i ].col[ j ].label;
                                tmp += '</th>';
                                tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                tmp += '<input type="radio" name="' + gNode.editor[ i ].col[ j ].tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '" value="' + x + '" /> <label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '">' + gNode.editor[ i ].col[ j ].option[ x ].label + '</label>';
                                if (gNode.editor[ i ].col[ j ].option[ x ].col) {
                                    switch( gNode.editor[ i ].col[ j ].option[ x ].col.length )
                                    {
                                    case 1:
                                        tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].label + '&nbsp;<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].tab + '" ' + ((gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].size)? 'size="' + gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].size + '"' : '' ) + '/>';
                                        if (gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].note)
                                            tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col[ 0 ].note;
                                        break;
                                    default: 
                                        for (var k=0, klen=gNode.editor[ i ].col[ j ].option[ x ].col.length; k<klen; k++)
                                        {
                                            tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col[ k ].label + '&nbsp;<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].col[ k ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].option[ x ].col[ k ].size)? 'size="' + gNode.editor[ i ].col[ j ].option[ x ].col[ k ].size + '"' : '' ) + '/>';
                                            if (gNode.editor[ i ].col[ j ].option[ x ].col[ k ].note)
                                                tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col[ k ].note;
                                        }
                                    }
                                }
                                tmp += '</td>';
                                tmp += '</tr>';
                                cnt++;
                            }
                            break;
                        case 'checkbox':
                            if ( gNode.editor[ i ].col[ j ].col ) {
                                if ( gNode.editor[ i ].col[ j ].col.type == 'radio' ) {
                                    tmp = '<tr>'
                                    tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + gNode.editor[ i ].col[ j ].wiz + '" >';
                                    tmp += '<input type="checkbox" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" value="' + gNode.editor[ i ].col[ j ].val + '" />';
                                    tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">&nbsp;' + gNode.editor[ i ].col[ j ].label + '</label>';
                                    tmp += '</th>';
                                    tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                    for ( var x in gNode.editor[ i ].col[ j ].col.option )
                                    {
                                        tmp += '<tr>'
                                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].col.align)? gNode.editor[ i ].col[ j ].col.align[ 0 ] : "Left") + '">';
                                        tmp += '<input type="radio" name="' + gNode.editor[ i ].col[ j ].col.tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.option[ x ].tab + '" value="' + x + '" />';
                                        tmp += '</td>';
                                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].col.align)? gNode.editor[ i ].col[ j ].col.align[ 1 ] : "Left") + '">';
                                        tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.option[ x ].tab + '">' + gNode.editor[ i ].col[ j ].col.option[ x ].label + '&nbsp;</label>';
                                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.option[ x ].col.tab + '"></select>';
                                        tmp += '</td>';
                                        tmp += '</tr>'
                                    }
                                }else if ( gNode.editor[ i ].col[ j ].col.type == 'select' ) {
                                    tmp = '<tr>'
                                    tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + gNode.editor[ i ].col[ j ].wiz + '" >';
                                    tmp += '<input type="checkbox" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" value="' + gNode.editor[ i ].col[ j ].val + '" />';
                                    tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">&nbsp;' + gNode.editor[ i ].col[ j ].label + '&nbsp;</label>';
                                    tmp += '</th>';
                                    tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                    tmp += gNode.editor[ i ].col[ j ].col.label;    
                                    tmp += '&nbsp;<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.tab + '"></select>';    
                                    tmp += '</td>';
                                    tmp += '</tr>'
                                }
                            }
                            break;
                        }
                        break;
                    case 'select':
                        tmp = '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                        tmp += gNode.editor[ i ].col[ j ].label;
                        tmp += '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                        if ( gNode.editor[ i ].col[ j ].option && 'object' == typeof gNode.editor[ i ].col[ j ].option ) {
                            for (var x in gNode.editor[ i ].col[ j ].option)
                                tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                        }
                        tmp += '</select>';
                        tmp += '</td>';
                        tmp += '</tr>';
    
                        if ( gNode.editor[ i ].col[ j ].col ) {
                            for (var x in gNode.editor[ i ].col[ j ].col)
                            {
                                tmp += '<tr class="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '">';
                                tmp += '<th></th>';
                                tmp += '<td>';
                                tmp += '<table id="table-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '">';

                                for (var k=0, klen=gNode.editor[ i ].col[ j ].col[ x ].length; k<klen; k++)
                                {
                                    tmp += '<tr>';
                                    switch( gNode.editor[ i ].col[ j ].col[ x ][ k ].type )
                                    {
                                    case 'text' :
                                        tmp += '<td class="alignLeft" style="width: ' + gNode.editor[ i ].col[ j ].col[ x ][ k ].wiz + '" >' + gNode.editor[ i ].col[ j ].col[ x ][ k ].label + '</td>';
                                        tmp += '<td class="alignLeft"><input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].col[ x ][ k ].size)? 'size="' + gNode.editor[ i ].col[ j ].col[ x ][ k ].size + '"' : '' ) + '/></td>';
                                        break;
                                    case 'radio' :
                                        tmp += '<td class="alignLeft" >';
                                        tmp += gNode.editor[ i ].col[ j ].col[ x ][ k ].label;
                                        tmp += '</td>';
                                        tmp += '<td class="alignLeft">';
                                        tmp += '<table id="table-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '">';

                                        for (var y in gNode.editor[ i ].col[ j ].col[ x ][ k ].option)
                                        {
                                            tmp += '<tr>';
                                            tmp += '<td class="alignLeft" >';
                                            tmp += '<input type="radio" name="' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '-' + y + '" value="' + y + '" />&nbsp;<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '-' + y + '">' + gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].label + '</label>';
                                            tmp += '</td>';
                                            tmp += '<td class="alignLeft">';
                                            if (gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col) {
                                                tmp += '<table id="table-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].tab + '">';
                                                for (var m=0, mlen=gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col.length; m<mlen; m++)
                                                {
                                                    tmp += '<tr>';
                                                    tmp += '<td class="alignLeft">';
                                                    tmp += gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col[ m ].label;
                                                    tmp += '</td>';
                                                    tmp += '<td class="alignLeft">';
                                                    tmp += '<input type="text" ' + ( ( gNode.editor[ i ].col[ j ].col[ x ][ k].option[ y ].col[ m ].size )? 'size="8"' : '') + ' id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col[ m ].tab + '" />';
                                                    tmp += '&nbsp;';
                                                    tmp += ( gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col[ m ].note )?
 gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ].col[ m ].note : '';
                                                    tmp += '</td>';
                                                    tmp += '</tr>';
                                                }
                                                tmp += '</table>';
                                            }
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                        }

                                        tmp += '</table>';
                                        tmp += '</td>';
                                        break;
                                    case 'select' :
                                        tmp += '<td class="alignLeft" style="width: ' + gNode.editor[ i ].col[ j ].col[ x ][ k ].wiz + '" >' + gNode.editor[ i ].col[ j ].col[ x ][ k ].label + '</td>';
                                        tmp += '<td class="alignLeft">';

                                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" >';

                                        if ( 'object' === typeof gNode.editor[ i ].col[ j ].col[ x ][ k ].option ) {
                                            for (var y in gNode.editor[ i ].col[ j ].col[ x ][ k ].option)
                                                tmp += '<option value="' + y + '">' + gNode.editor[ i ].col[ j ].col[ x ][ k ].option[ y ] + '</option>';
                                        }

                                        tmp += '</select>';
                                        tmp += '</td>';
                                        break;
                                    }
                                    tmp += '</tr>';
                                }
                                tmp += '</table>';
                                tmp += '</td>';
                                tmp += '</tr>';
                            }
                        }
                        break;
                    case 'table':
                        tmp = '<thead>';
                        tmp += '<tr>';
                        for (var k=0; k<gNode.editor[ i ].col[ j ].col.length; k++)
                        {
                            tmp += '<th class="ui-state-default" style="width: ' + gNode.editor[ i ].col[ j ].col[ k ].wiz + '">' + gNode.editor[ i ].col[ j ].col[ k ].label + '</th>';
                        }
                        tmp += '</tr>';
                        tmp += '</thead>';
                        break;
                    }
                    $('#table-' + gNode.editor[ i ].tab).append(tmp);
                }
            }
    
            gObj.tab = $('.tabs').tabs();
    
            if (3 == gObj.routing.protoType) {
                gObj.tab.tabs({"disabled": [3]});
            }else {
                gObj.tab.tabs({"disabled": [2,3]});
            }
    
            $('#basic_settings-name').html( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name );
            $('#basic_settings-description').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].description );
            $('#basic_settings-wanProto-0-ip').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-wanProto-0-ip').val() ) && gReg.ipv4.test( $('#basic_settings-wanProto-0-netmask').val() ) ) {
                    gObj.tab.tabs('enable', 2);
                } else {
                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs({"disabled": [2]});
                    }else {
                        gObj.tab.tabs({"disabled": [2,3]});
                    }
                }
            }).val( gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].ip ).trigger('blur');

            $('#basic_settings-wanProto-0-netmask').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-wanProto-0-ip').val() ) && gReg.ipv4.test( $('#basic_settings-wanProto-0-netmask').val() ) ) {
                    gObj.tab.tabs('enable', 2);
                } else {
                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs({"disabled": [2]});
                    }else {
                        gObj.tab.tabs({"disabled": [2,3]});
                    }
                }
            }).val( gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].netmask ).trigger('blur');

            $('#basic_settings-wanProto-0-gateway').val( gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].gateway );
            $('#basic_settings-wanProto-2-username').val( gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].username );
            $('#basic_settings-wanProto-2-password').val( gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].password );
            $('#basic_settings-wanProto-2-authType').val( gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].authType );
            $('#basic_settings-wanProto-2-maxIdleTime').val( gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].maxIdleTime );
            $('#basic_settings-macClone').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].macClone );
    
            $('input[name=0-dnsMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-0-userDns1').prop('disabled', true);
                    $('#basic_settings-wanProto-0-userDns2').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-0-userDns1').prop('disabled', false);
                    $('#basic_settings-wanProto-0-userDns2').prop('disabled', false);
                    break;
                }
            });

            $('input[name=0-mtuMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-0-mtu').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-0-mtu').prop('disabled', false);
                    $(this).click();
                    if (3 == gObj.routing.protoType) {
                        if (!gReg.mtuValue6.test( $('#basic_settings-wanProto-0-mtu').val() ))
                            remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                    }
                    break;
                }
            });

            $('#basic_settings-wanProto-0-mtu').blur( function() {
                if (3 == gObj.routing.protoType) {
                    if (!gReg.mtuValue6.test( $('#basic_settings-wanProto-0-mtu').val() ))
                        remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );

                }
            });

            $('input[name=1-mtuMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-1-mtu').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-1-mtu').prop('disabled', false);
                    $(this).click();
                    if (3 == gObj.routing.protoType) {
                        if (!gReg.mtuValue6.test( $('#basic_settings-wanProto-1-mtu').val() ))
                            remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                    }
                    break;
                }
            });

            $('#basic_settings-wanProto-1-mtu').blur( function() {
                if (3 == gObj.routing.protoType) {
                    if (!gReg.mtuValue6.test( $('#basic_settings-wanProto-1-mtu').val() ))
                        remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );

                }
            });

            $('input[name=2-mtuMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-2-mtu').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-2-mtu').prop('disabled', false);
                    $(this).click();
                    if (3 == gObj.routing.protoType) {
                        if (!gReg.mtuValue6PPPoE.test( $('#basic_settings-wanProto-2-mtu').val() ))
                            remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                    }
                    break;
                }
            });

            $('#basic_settings-wanProto-2-mtu').blur( function() {
                if (3 == gObj.routing.protoType) {
                    if (!gReg.mtuValue6PPPoE.test( $('#basic_settings-wanProto-2-mtu').val() ))
                        remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                }
            });
    
            $('#basic_settings-wanProto').change( function() {
                $('.' + $(this).attr('id') + '-0').hide();
                $('.' + $(this).attr('id') + '-1').hide();
                $('.' + $(this).attr('id') + '-2').hide();
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('.' + $(this).attr('id') + '-0').show();
                    if ( parseInt( gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].mtuMode ) == 0 ) {
                        $('#basic_settings-wanProto-0-mtuMode-0').click();
                    }else {
                        $('#basic_settings-wanProto-0-mtuMode-1').click();
                    }
                    $('#basic_settings-wanProto-0-mtu').val( gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].mtu );
                    $('#basic_settings-wanProto-0-dnsMode-1').click();
                    $('#basic_settings-wanProto-0-dnsMode-0').prop('disabled', true);
                    $('#basic_settings-wanProto-0-userDns1').val( gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].userDns1 );
                    $('#basic_settings-wanProto-0-userDns2').val( gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].userDns2 );
                    if (gReg.ipv4.test( $('#basic_settings-wanProto-0-ip').val() ) && gReg.ipv4.test( $('#basic_settings-wanProto-0-netmask').val() ) ) {
                        gObj.tab.tabs("enable", 2);
                    }else {
                        if (3 == gObj.routing.protoType) {
                            gObj.tab.tabs({"disabled": [2]});
                        }else {
                            gObj.tab.tabs({"disabled": [2,3]});
                        }
                    }
                    break;
                case 1:
                    $('.' + $(this).attr('id') + '-1').show();
                    $('#basic_settings-wanProto-1-dnsMode-0').prop('disabled', false);
                    if ( parseInt( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].mtuMode ) == 0 ) {
                        $('#basic_settings-wanProto-1-mtuMode-0').click();
                    }else {
                        $('#basic_settings-wanProto-1-mtuMode-1').click();
                    }
    
                    if ( parseInt( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dnsMode ) == 0 ) {
                        $('#basic_settings-wanProto-1-dnsMode-0').click();
                    }else {
                        $('#basic_settings-wanProto-1-dnsMode-1').click();
                    }
    
                    $('#basic_settings-wanProto-1-mtu').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].mtu );
                    $('#basic_settings-wanProto-1-userDns1').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].userDns1 );
                    $('#basic_settings-wanProto-1-userDns2').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].userDns2 );
                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs("enable", 2);
                    } else {
                        gObj.tab.tabs({"disabled": [3]});
                    }
                    break;
                case 2:
                    $('.' + $(this).attr('id') + '-2').show();
                    $('#basic_settings-wanProto-2-dnsMode-0').prop('disabled', false);
                    $('#basic_settings-wanProto-2-dnsMode-0').click().trigger('change');;

                    if ( parseInt( gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].mtuMode ) == 0 ) {
                        $('#basic_settings-wanProto-2-mtuMode-0').click();
                    }else {
                        $('#basic_settings-wanProto-2-mtuMode-1').click();
                    }
   
                    if ( parseInt( gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].dnsMode ) == 0 ) {
                        $('#basic_settings-wanProto-2-dnsMode-0').click();
                    }else {
                        $('#basic_settings-wanProto-2-dnsMode-1').click();
                    }
   
                    $('#basic_settings-wanProto-2-mtu').val( gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].mtu );
                    $('#basic_settings-wanProto-2-userDns1').val( gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].userDns1 );
                    $('#basic_settings-wanProto-2-userDns2').val( gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].userDns2 );

                    if (3 == gObj.routing.protoType) {
                        gObj.tab.tabs({"disabled": [2]});
                    }else {
                        gObj.tab.tabs({"disabled": [2,3]});
                    }

                    if (2 != parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanProto ))
                        remindAlert( '<p>' + gTerm[ gObj.lang ].pppoe + '</p>' );
                    break;
                }
            }).val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanProto ).trigger('change');
    
            $('input[name=ondemand]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-wanProto-2-maxIdleTime').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-wanProto-2-maxIdleTime').prop('disabled', false);
                    break;
                }
            });

            $('input[name=macCloneEnable]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-macClone').prop('disabled', true);   
                    break;
                case 1:
                    $('#basic_settings-macClone').prop('disabled', false);   
                    break;
                }
            });
    
            $('input[name=netDetectMethod]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', false);   
                    $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', true);   
                    break;
                case 1:
                    $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', true);   
                    $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', false);   
                    break;
                }
            });
    
            $('#multiple_wan_settings-weight').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].weight );
    
            $('#multiple_wan_settings-netDetectEnable').change( function() {
                if ($(this).is(':checked')) {
                    $('input[name=netDetectMethod]').prop('disabled', false);
                    if ($('#multiple_wan_settings-netDetectMethod-0').is(':checked')) {
                        $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', false);   
                    }else {
                        $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', false);   
                    }
                }else {
                    $('input[name=netDetectMethod]').prop('disabled', true);
                    $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', true);   
                    $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', true);   
                }
            });
    
            $('#multiple_wan_settings-failoverEnable').change( function() {
                if ($(this).is(':checked')) {
                    $('#multiple_wan_settings-backupWanName').prop('disabled', false);
                }else {
                    $('#multiple_wan_settings-backupWanName').prop('disabled', true);
                }
            });
    
            $('#ipv6_settings-wanProto_v6').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#tr-' + $(this).attr('id') + '-0').show();
                    break;
                default:
                    $('#tr-' + $(this).attr('id') + '-0').hide();
                }
            });
    
            cgiSelectOption('basic_settings-zoneId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId);
            cgiSelectOption('basic_settings-portId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].portId);
            cgiSelectOption('multiple_wan_settings-netDetectPingIpId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectPingIpId);
            cgiSelectOption('multiple_wan_settings-netDetectDnsIpId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectDnsIpId);
            genSelector('multiple_wan_settings-backupWanName', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName, gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name );
    
            if (parseInt( gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].ondemand ) == 1) {
                $('#basic_settings-wanProto-2-ondemand-1').click();
            } else {
                $('#basic_settings-wanProto-2-ondemand-0').click();
            }
    
            if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].macCloneEnable ) == 1) {
                $('#basic_settings-macCloneEnable-1').click();
            } else {
                $('#basic_settings-macCloneEnable-0').click();
            }
    
            if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectMethod ) == 1) {
                $('#multiple_wan_settings-netDetectMethod-1').click();
            } else {
                $('#multiple_wan_settings-netDetectMethod-0').click();
            }
    
            if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectEnable) == 1) {
                $('#multiple_wan_settings-netDetectEnable').click();
                $('input[name=netDetectMethod]').prop('disabled', false);
                if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectMethod ) == 0) {
                    $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', false);
                    $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', true);
                }else {
                    $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', true);
                    $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', false);
                }
            }else {
                $('input[name=netDetectMethod]').prop('disabled', true);
                $('#multiple_wan_settings-netDetectPingIpId').prop('disabled', true);
                $('#multiple_wan_settings-netDetectDnsIpId').prop('disabled', true);
            }
    
            if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].failoverEnable) == 1) {
                $('#multiple_wan_settings-failoverEnable').click();
                $('#multiple_wan_settings-backupWanName').prop('disabled', false);
            }else {
                $('#multiple_wan_settings-backupWanName').prop('disabled', true);
            }
    
            if (gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ]) {
                $('#multiple_wan_settings-failoverEnable').prop('disabled', true);
                $('#multiple_wan_settings-backupWanName').prop('disabled', true);
            }
    
            $('#ipv6_settings-wanProto_v6-0-ip').val( gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].ip );
            $('#ipv6_settings-wanProto_v6-0-prefix').val( gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].prefix );
            $('#ipv6_settings-wanProto_v6-0-gateway').val( gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].gateway );
            $('#ipv6_settings-wanProto_v6-0-userDns1').val( gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].userDns1 );
            $('#ipv6_settings-wanProto_v6-0-userDns2').val( gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].userDns2 );
    
            $('#basic_settings-wanProto_v6').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#tr-' + $(this).attr('id') + '-0').show();
                    break;
                default:
                    $('#tr-' + $(this).attr('id') + '-0').hide();
                }
            });
    
            $('#ipv6_settings-wanProto_v6').val( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanProto_v6 ) ).trigger('change');
            genAlias(tar.pid, gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ]);
            break;
        case 'ports':
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ i ].tab + '"><a href="#panel-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ i ].tab + '"></div>');
                $('#panel-' + gNode.editor[ i ].tab).append('<table id="table-' + gNode.editor[ i ].tab + '"></table>');
                for (var j=0, jlen=gNode.editor[ i ].col.length; j<jlen; j++)
                {
                    switch (gNode.editor[ i ].col[ j ].tag)
                    {
                    case 'p':
                        tmp = '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                        tmp += gNode.editor[ i ].col[ j ].label;
                        tmp += '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                        tmp += '<p id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                        tmp += '</p>';
                        tmp += '</td>';
                        tmp += '</tr>';
                        break;
                    case 'input':
                        switch(gNode.editor[ i ].col[ j ].type)
                        {
                        case 'text':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].size)? 'size="' + gNode.editor[ i ].col[ j ].size + '"' : '' ) + '/>';
                            if (gNode.editor[ i ].col[ j ].note)
                                tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'checkbox':
                            tmp = '<tr>'
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + gNode.editor[ i ].col[ j ].wiz + '" >';
                            tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">' + gNode.editor[ i ].col[ j ].label + '</label>';
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="checkbox" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" value="' + gNode.editor[ i ].col[ j ].val + '" />';
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'radio':
                            var cnt = 0;
                            tmp = '';
                            for (var x in gNode.editor[ i ].col[ j ].option) 
                            {
                                tmp += '<tr>';
                                tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                                if (cnt == 0) 
                                    tmp += gNode.editor[ i ].col[ j ].label;
                                tmp += '</th>';
                                tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                tmp += '<input type="radio" name="' + gNode.editor[ i ].col[ j ].tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '"  value="' + x + '" /> <label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '">' + gNode.editor[ i ].col[ j ].option[ x ].label + '</label>';
                                if (gNode.editor[ i ].col[ j ].option[ x ].col) {
                                    tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col.label + '&nbsp;<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].col.tab + '" ' + ( (gNode.editor[ i ].col[ j ].option[ x ].col.size)? 'size="' + gNode.editor[ i ].col[ j ].option[ x ].col.size + '"' : '' ) + '/>';
                                    if (gNode.editor[ i ].col[ j ].option[ x ].col.note)
                                        tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col.note;
                                }
                                tmp += '</td>';
                                tmp += '</tr>';
                                cnt++;
                            }
                            break;
                        }
                        break;
                    case 'select':
                        switch(gNode.editor[ i ].col[ j ].type)
                        {
                        case 'select':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                            if ( gNode.editor[ i ].col[ j ].option && 'object' == typeof gNode.editor[ i ].col[ j ].option) {
                                for (var x in gNode.editor[ i ].col[ j ].option)
                                    tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                            }
                            tmp += '</select>';
                            tmp += '</td>';
                            tmp += '</tr>';
        
                            if ( gNode.editor[ i ].col[ j ].col ) {
                                for (var x in gNode.editor[ i ].col[ j ].col)
                                {
                                    tmp += '<tr class="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '">';
                                    tmp += '<th></th>';
                                    tmp += '<td>';
                                    tmp += '<table>';
                                    for (var k=0, klen=gNode.editor[ i ].col[ j ].col[ x ].length; k<klen; k++)
                                    {
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft" style="width: ' + gNode.editor[ i ].col[ j ].col[ x ][ k ].wiz + '" >' + gNode.editor[ i ].col[ j ].col[ x ][ k ].label + '</td>';
                                        tmp += '<td class="alignLeft"><input type="text" id="' + gNode.editor[ i ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].col[ x ][ k ].size)? 'size="' + gNode.editor[ i ].col[ j ].col[ x ][ k ].size + '"' : '' ) + '/></td>';
                                        tmp += '</tr>';
                                    }
                                    tmp += '</table>';
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }
                            }
                            break;
                        }
                        break;
                    case 'table':
                        tmp = '<thead>';
                        tmp += '<tr>';
                        for (var k=0; k<gNode.editor[ i ].col[ j ].col.length; k++)
                        {
                            tmp += '<th class="ui-state-default" style="width: ' + gNode.editor[ i ].col[ j ].col[ k ].wiz + '">' + gNode.editor[ i ].col[ j ].col[ k ].label + '</th>';
                        }
                        tmp += '</tr>';
                        tmp += '</thead>';
                        break;
                    }
    
                    $('#table-' + gNode.editor[ i ].tab).append(tmp);
                }
            }
    
            gObj.tab = $('.tabs').tabs();
    
            $('#basic_settings-duplex').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].duplex );
            $('#basic_settings-speed').change( function() {
                switch( parseInt( $(this).val() ) )
                {
                case 0:
                case 1000:
                    $('#basic_settings-duplex').val( 0 );
                    $('#basic_settings-duplex').prop('disabled', true);
                    break;
                default: 
                    $('#basic_settings-duplex').prop('disabled', false);
                    $('#basic_settings-duplex').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].duplex );
                }
            }).val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].speed ).trigger('change');
    
            $('#basic_settings-mtuValue').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuValue );
            $('input[name=mtuMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-mtuValue').prop('disabled', true);
                    break;
                case 1:
                    $('#basic_settings-mtuValue').prop('disabled', false);
                    if (3 == gObj.routing.protoType) {
                        if (!gReg.mtuValue6.test( $('#basic_settings-mtuValue').val() ))
                            remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                    }
                    break;
                }
            }).eq( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuMode ).trigger('click');

            $('#basic_settings-mtuValue').blur( function() {
                if (3 == gObj.routing.protoType) {
                    if (!gReg.mtuValue6.test( $('#basic_settings-mtuValue').val() ))
                        remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                }
            });
    
            $('#basic_settings-name').html( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name );
    
            cgiSelectOption( 'basic_settings-zoneId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId );
    
            $('#dhcp_pool_settings-1-startIp').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].startIp);
            $('#dhcp_pool_settings-1-endIp').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].endIp);
            $('#dhcp_pool_settings-1-leaseTime').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].leaseTime || 86400);
            $('#dhcp_pool_settings-1-gateway').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].gateway);
            $('#dhcp_pool_settings-1-dns1').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns1);
            $('#dhcp_pool_settings-1-dns2').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns2);
            $('#dhcp_pool_settings-1-wins1').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins1);
            $('#dhcp_pool_settings-1-wins2').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins2);
            $('#dhcp_pool_settings-1-domainName').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].domainName);
            $('#dhcp_pool_settings-2-relayIp').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].relayIp);
    
            $('#ipv6_settings-ipv6PrefixLength').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength );
            $('#ipv6_settings-ipv6Address').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address );
    
            genAlias( tar.pid, gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ] );

            genDhcpBinding( tar.thisNo );
    
            if (3 == gObj.routing.protoType)
                gObj.tab.tabs({"disabled": [1,2,3]});
            else
                gObj.tab.tabs({"disabled": [1,2,3,4]});

            $('#dhcp_pool_settings-type').change( function() {
                $('.dhcp_pool_settings-type-1').hide();
                $('.dhcp_pool_settings-type-2').hide();
    
                switch(parseInt($(this).val()))
                {
                case 2:
                    $('.dhcp_pool_settings-type-2').show();
                case 0:
                    if (gObj.routing.protoType == 3) {
                        gObj.tab.tabs({"disabled": [2]});
                    } else {
                        gObj.tab.tabs({"disabled": [2,4]});
                    }
                    break;
                case 1:
                    $('.dhcp_pool_settings-type-1').show();
                    gObj.tab.tabs("enable", 2);
                    gObj.tab.tabs("enable", 3);
                    break;
                }
            }).val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].type ).trigger('change');

            $('#basic_settings-address').on('blur', function() {
                if (gReg.ipv4.test( $('#basic_settings-address').val() ) ) {
                    $('#basic_settings-netmask').prop('disabled', false);
                    $('#basic_settings-zoneId').prop('disabled', false);
                    if (gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                        gObj.tab.tabs('enable', 1);
                        gObj.tab.tabs('enable', 3);
                        if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                            gObj.tab.tabs('enable', 2);
                        autoDhcpServer( tar.pid, $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() );
                        gObj.addressed = $('#basic_settings-address').val();
                    } 
                } else {
                    if (gObj.routing.protoType == 3) {
                        gObj.tab.tabs({"disabled": [1,2,3]});
                    } else {
                        gObj.tab.tabs({"disabled": [1,2,3,4]});
                    }
                }
            });
            
            $('#basic_settings-netmask').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-address').val() ) && gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {      
                    gObj.addressed = $('#basic_settings-address').val();
                    gObj.tab.tabs('enable', 1);
                    gObj.tab.tabs('enable', 3);
                    if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                        gObj.tab.tabs('enable', 2);
                    autoDhcpServer( tar.pid, $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() );
                }else {
                    if (gObj.routing.protoType == 3) {
                        gObj.tab.tabs({"disabled": [1,2,3]});
                    } else {
                        gObj.tab.tabs({"disabled": [1,2,3,4]});
                    }
                }
            });


            $('#basic_settings-address').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address );
            $('#basic_settings-netmask').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netmask );

            if (gReg.ipv4.test( $('#basic_settings-address').val() ) ) {
                gObj.addressed = $('#basic_settings-address').val();
                $('#basic_settings-netmask').prop('disabled', false);
                if (gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                    gObj.tab.tabs('enable', 1);
                    gObj.tab.tabs('enable', 3);
                    $('#basic_settings-zoneId').prop('disabled', false);
                    if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                        gObj.tab.tabs('enable', 2);
                }
            } else {
                $('#basic_settings-netmask').prop('disabled', true);
                $('#basic_settings-zoneId').prop('disabled', true);
            }

            $('#dhcp_pool_settings-1-startIp').blur( function() {
                var pass = dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $(this).val(), $('#dhcp_pool_settings-1-endIp').val() );
                if (!pass) 
                    errorAlert( '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>' );
            });

            $('#dhcp_pool_settings-1-endIp').blur( function() {
                var pass = dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $(this).val() );
                if (!pass)
                    errorAlert( '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>' );
            });

            if ( 0 != parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].type ) ) {
                gObj.tab.tabs({"disabled": [0, 1, 2, 3, 4]});
                $('#popForm input').prop('disabled', true);
                $('#popForm select').prop('disabled', true);
                $('#basic_settings-speed').prop('disabled', false);
                if (0 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].speed ) || 1000 == parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].speed )) {
                    $('#basic_settings-duplex').prop('disabled', true);
                } else {
                    $('#basic_settings-duplex').prop('disabled', false);
                }
                $('input[name=mtuMode]').prop('disabled', false);
                if ( 1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuMode ) ) {
                    $('#basic_settings-mtuValue').prop('disabled', false);
                } else {
                    $('#basic_settings-mtuValue').prop('disabled', true);
                }
            }
            break;
        case 'lan':
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ i ].tab + '"><a href="#panel-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ i ].tab + '"></div>');
                $('#panel-' + gNode.editor[ i ].tab).append('<table id="table-' + gNode.editor[ i ].tab + '"></table>');
                for (var j=0, jlen=gNode.editor[ i ].col.length; j<jlen; j++)
                {
                    switch (gNode.editor[ i ].col[ j ].tag)
                    {
                    case 'input':
                        switch(gNode.editor[ i ].col[ j ].type)
                        {
                        case 'text':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].size)? 'size="' + gNode.editor[ i ].col[ j ].size + '"' : '' ) + '/>';
                            if (gNode.editor[ i ].col[ j ].note)
                                tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'checkbox':
                            tmp = '<tr>'
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + gNode.editor[ i ].col[ j ].wiz + '" >';
                            tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">' + gNode.editor[ i ].col[ j ].label + '</label>';
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="checkbox" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" value="' + gNode.editor[ i ].col[ j ].val + '" />';
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'radio':
                            var cnt = 0;
                            tmp = '';
                            for (var x in gNode.editor[ i ].col[ j ].option) 
                            {
                                tmp += '<tr>';
                                tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                                if (cnt == 0) 
                                    tmp += gNode.editor[ i ].col[ j ].label;
                                tmp += '</th>';
                                tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                tmp += '<input type="radio" name="' + gNode.editor[ i ].col[ j ].tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '" value="' + x + '" /> <label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '">' + gNode.editor[ i ].col[ j ].option[ x ].label + '</label>';
                                if (gNode.editor[ i ].col[ j ].option[ x ].col) {
                                    tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col.label + '&nbsp;<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].col.tab + '" ' + ( (gNode.editor[ i ].col[ j ].option[ x ].col.size)? 'size="' + gNode.editor[ i ].col[ j ].option[ x ].col.size + '"' : '' ) + '/>';
                                    if (gNode.editor[ i ].col[ j ].option[ x ].col.note)
                                        tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col.note;
                                }
                                tmp += '</td>';
                                tmp += '</tr>';
                                cnt++;
                            }
                            break;
                        }
                        break;
                    case 'select':
                        switch(gNode.editor[ i ].col[ j ].type)
                        {
                        case 'select':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                            if ( gNode.editor[ i ].col[ j ].option && 'object' == typeof gNode.editor[ i ].col[ j ].option) {
                                for (var x in gNode.editor[ i ].col[ j ].option)
                                    tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                            }
                            tmp += '</select>';
                            tmp += '</td>';
                            tmp += '</tr>';
        
                            if ( gNode.editor[ i ].col[ j ].col ) {
                                for (var x in gNode.editor[ i ].col[ j ].col)
                                {
                                    tmp += '<tr class="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '">';
                                    tmp += '<th></th>';
                                    tmp += '<td>';
                                    tmp += '<table>';
                                    for (var k=0, klen=gNode.editor[ i ].col[ j ].col[ x ].length; k<klen; k++)
                                    {
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft" style="width: ' + gNode.editor[ i ].col[ j ].col[ x ][ k ].wiz + '" >' + gNode.editor[ i ].col[ j ].col[ x ][ k ].label + '</td>';
                                        tmp += '<td class="alignLeft"><input type="text" id="' + gNode.editor[ i ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].col[ x ][ k ].size)? 'size="' + gNode.editor[ i ].col[ j ].col[ x ][ k ].size + '"' : '' ) + ' /></td>';
                                        tmp += '</tr>';
                                    }
                                    tmp += '</table>';
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }
                            }
                            break;
                        case 'multiple':
                            tmp = '<tr>';
                            tmp += '<td colspan="2">';
                            tmp += '<table>';
            
                            tmp += '<tr>';
                            tmp += '<th style="width: ' + gNode.editor[ i ].col[ j ].multiple.pool.wiz + '">';
                            tmp += gNode.editor[ i ].col[ j ].multiple.pool.label;
                            tmp += '</th>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.del.wiz + '">';
                            tmp += '</th>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.add.wiz + '">';
                            tmp += '</th>';
                            tmp += '<th style="width: ' + gNode.editor[ i ].col[ j ].multiple.pick.wiz + '">';
                            tmp += gNode.editor[ i ].col[ j ].multiple.pick.label;
                            tmp += '</th>';
                            tmp += '</tr>';
            
                            tmp += '<tr>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.pool.wiz + '">';
                            tmp += '<select id="pool" multiple size="10"></select>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.del.wiz + '">';
                            tmp += '<button class="Move2Del" id="Move2Del-interfaces"><span class="ui-icon"></span></button>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.add.wiz + '">';
                            tmp += '<button class="Move2Add" id="Move2Add-interfaces"><span class="ui-icon"></span></button>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ i ].col[ j ].multiple.pick.wiz + '">';
                            tmp += '<select id="pick" multiple size="10"></select>';
                            tmp += '</td>';
                            tmp += '</tr>';
            
                            tmp += '</table>';
                            tmp += '</td>';
                            tmp += '<tr>';
                            break;
                        }
                        break;
                    case 'table':
                        tmp = '<thead>';
                        tmp += '<tr>';
                        for (var k=0; k<gNode.editor[ i ].col[ j ].col.length; k++)
                        {
                            tmp += '<th class="ui-state-default" style="width: ' + gNode.editor[ i ].col[ j ].col[ k ].wiz + '">' + gNode.editor[ i ].col[ j ].col[ k ].label + '</th>';
                        }
                        tmp += '</tr>';
                        tmp += '</thead>';
                        break;
                    }
    
                    $('#table-' + gNode.editor[ i ].tab).append(tmp);
                }
            }
    
            gObj.tab = $('.tabs').tabs();
    
            $('#basic_settings-name').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ).prop('disabled', true);
            
            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].stp )) {
                $('#basic_settings-stp').click();
            }
    
            cgiSelectOption( 'basic_settings-zoneId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId );
    
            $('#dhcp_pool_settings-1-startIp').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].startIp);
            $('#dhcp_pool_settings-1-endIp').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].endIp);
            $('#dhcp_pool_settings-1-leaseTime').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].leaseTime || 86400);
            $('#dhcp_pool_settings-1-gateway').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].gateway);
            $('#dhcp_pool_settings-1-dns1').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns1);
            $('#dhcp_pool_settings-1-dns2').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns2);
            $('#dhcp_pool_settings-1-wins1').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins1);
            $('#dhcp_pool_settings-1-wins2').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins2);
            $('#dhcp_pool_settings-1-domainName').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].domainName);
            $('#dhcp_pool_settings-2-relayIp').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].relayIp);
    
            $('#ipv6_settings-ipv6PrefixLength').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength );
            $('#ipv6_settings-ipv6Address').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address );
    
            genMultiSelector( tar.pid, gCache[ tar.pid ].interfaces[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ] );
    
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerLAN ) {
                    errorAlert( '<p>' + gError[ gObj.lang ].memberLimit + '</p>' );
                    return false;
                } else {
                    vSel.clone().appendTo('#pick');
                    vSel.remove();
                }
            });
    
            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
    
            genAlias( tar.pid, gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ] );
            genDhcpBinding( tar.thisNo );
            if (3 == gObj.routing.protoType)
                gObj.tab.tabs({"disabled": [1,2,3]});
            else
                gObj.tab.tabs({"disabled": [1,2,3,4]});

            $('#dhcp_pool_settings-type').change( function() {
                $('.dhcp_pool_settings-type-1').hide();
                $('.dhcp_pool_settings-type-2').hide();
    
                switch(parseInt($(this).val()))
                {
                case 2:
                    $('.dhcp_pool_settings-type-2').show();
                case 0:
                    if (gObj.routing.protoType == 3) {
                        gObj.tab.tabs({"disabled": [2]});
                    } else {
                        gObj.tab.tabs({"disabled": [2,4]});
                    }
                    break;
                case 1:
                    $('.dhcp_pool_settings-type-1').show();
                    gObj.tab.tabs("enable", 2);
                    gObj.tab.tabs("enable", 3);
                    break;
                }
            }).val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].type ).trigger('change');

            $('#basic_settings-address').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-address').val() ) ) {
                    $('#basic_settings-netmask').prop('disabled', false);
                    $('#basic_settings-zoneId').prop('disabled', false);
                    if (gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                        gObj.tab.tabs('enable', 1);
                        gObj.tab.tabs('enable', 3);
                        if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                            gObj.tab.tabs('enable', 2);
                        autoDhcpServer( tar.pid, $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() );
                        gObj.addressed = $('#basic_settings-address').val();
                    } 
                } else {
                    if (gObj.routing.protoType == 3) {
                        gObj.tab.tabs({"disabled": [1,2,3]});
                    } else {
                        gObj.tab.tabs({"disabled": [1,2,3,4]});
                    }
                    $('#basic_settings-address');
                }
            });

            $('#basic_settings-netmask').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-address').val() ) && gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {      
                    gObj.addressed = $('#basic_settings-address').val();
                    gObj.tab.tabs('enable', 1);
                    gObj.tab.tabs('enable', 3);
                    if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                        gObj.tab.tabs('enable', 2);
                    autoDhcpServer( tar.pid, $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() );
                }else {
                    if (gObj.routing.protoType == 3) {
                        gObj.tab.tabs({"disabled": [1,2,3]});
                    } else {
                        gObj.tab.tabs({"disabled": [1,2,3,4]});
                    }
                }
            });

            $('#basic_settings-address').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address );
            $('#basic_settings-netmask').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netmask );

            if (gReg.ipv4.test( $('#basic_settings-address').val() ) ) {
                gObj.addressed = $('#basic_settings-address').val();
                $('#basic_settings-netmask').prop('disabled', false);
                if (gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                    gObj.tab.tabs('enable', 1);
                    gObj.tab.tabs('enable', 3);
                    $('#basic_settings-zoneId').prop('disabled', false);
                    if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                        gObj.tab.tabs('enable', 2);
                }
            } else {
                $('#basic_settings-netmask').prop('disabled', true);
                $('#basic_settings-zoneId').prop('disabled', true);
            }

            $('#dhcp_pool_settings-1-startIp').blur( function() {
                var pass = dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $(this).val(), $('#dhcp_pool_settings-1-endIp').val() );
                if (!pass) 
                    errorAlert( '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>' );
            });

            $('#dhcp_pool_settings-1-endIp').blur( function() {
                var pass = dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $(this).val() );
                if (!pass)
                    errorAlert( '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>' );
            });
            break;
        case 'vlan_interfaces':
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
    
            for (var i=0; i<gNode.editor.length; i++) 
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ i ].tab + '"><a href="#panel-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ i ].tab + '"></div>');
                $('#panel-' + gNode.editor[ i ].tab).append('<table id="table-' + gNode.editor[ i ].tab + '"></table>');
                for (var j=0; j<gNode.editor[ i ].col.length; j++)
                {
                    switch (gNode.editor[ i ].col[ j ].tag)
                    {
                    case 'input':
                        switch(gNode.editor[ i ].col[ j ].type)
                        {
                        case 'text':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].size)? 'size="' + gNode.editor[ i ].col[ j ].size + '"' : '' ) + ' />';
                            if (gNode.editor[ i ].col[ j ].note)
                                tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'radio':
                            var cnt = 0;
                            tmp = '';
                            for (var x in gNode.editor[ i ].col[ j ].option) 
                            {
                                tmp += '<tr>';
                                tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                                if (cnt == 0) 
                                    tmp += gNode.editor[ i ].col[ j ].label;
                                tmp += '</th>';
                                tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                                tmp += '<input type="radio" name="' + gNode.editor[ i ].col[ j ].tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '" value="' + x + '" /> <label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '">' + gNode.editor[ i ].col[ j ].option[ x ].label + '</label>';
                                if (gNode.editor[ i ].col[ j ].option[ x ].col) {
                                    tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col.label + '&nbsp;<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].col.tab + '" ' + ( (gNode.editor[ i ].col[ j ].option[ x ].col.size)? 'size="' + gNode.editor[ i ].col[ j ].option[ x ].col.size + '"' : '' ) + '/>';
                                    if (gNode.editor[ i ].col[ j ].option[ x ].col.note)
                                        tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col.note;
                                }
                                tmp += '</td>';
                                tmp += '</tr>';
                                cnt++;
                            }
                            break;
                        }
                        break;
                    case 'select':
                        tmp = '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto' ) + '" >';
                        tmp += gNode.editor[ i ].col[ j ].label;
                        tmp += '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : "Left") + '">';
                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                        if ( gNode.editor[ i ].col[ j ].option && 'object' == typeof gNode.editor[ i ].col[ j ].option) {
                            for (var x in gNode.editor[ i ].col[ j ].option)
                                tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                        }
                        tmp += '</select>';
                        tmp += '</td>';
                        tmp += '</tr>';
    
                        if ( gNode.editor[ i ].col[ j ].col ) {
                            for (var x in gNode.editor[ i ].col[ j ].col)
                            {
                                tmp += '<tr class="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-' + x + '">';
                                tmp += '<th></th>';
                                tmp += '<td>';
                                tmp += '<table>';
                                for (var k=0, klen=gNode.editor[ i ].col[ j ].col[ x ].length; k<klen; k++)
                                {
                                    tmp += '<tr>';
                                    tmp += '<td class="alignLeft" style="width: ' + gNode.editor[ i ].col[ j ].col[ x ][ k ].wiz + '" >' + gNode.editor[ i ].col[ j ].col[ x ][ k ].label + '</td>';
                                    tmp += '<td class="alignLeft"><input type="text" id="' + gNode.editor[ i ].tab + '-' + x + '-' + gNode.editor[ i ].col[ j ].col[ x ][ k ].tab + '" ' + ( (gNode.editor[ i ].col[ j ].col[ x ][ k ].size)? 'size="' + gNode.editor[ i ].col[ j ].col[ x ][ k ].size + '"' : '' ) + ' /></td>';
                                    tmp += '</tr>';
                                }
                                tmp += '</table>';
                                tmp += '</td>';
                                tmp += '</tr>';
                            }
                        }
                        break;
                    case 'table':
                        tmp = '<thead>';
                        tmp += '<tr>';
                        for (var k=0; k<gNode.editor[ i ].col[ j ].col.length; k++)
                        {
                            tmp += '<th class="ui-state-default" style="width: ' + gNode.editor[ i ].col[ j ].col[ k ].wiz + '">' + gNode.editor[ i ].col[ j ].col[ k ].label + '</th>';
                        }
                        tmp += '</tr>';
                        tmp += '</thead>';
                        break;
                    }
                    $('#table-' + gNode.editor[ i ].tab).append(tmp);
                }
            }
    
            gObj.tab = $('.tabs').tabs();
    
            $('#basic_settings-name').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ).prop('disabled', true);
            $('#basic_settings-vid').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vid );
            cgiSelectOption( 'basic_settings-interface', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface );
            cgiSelectOption( 'basic_settings-zoneId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId );
    
            $('#basic_settings-mtuValue').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuValue );
            $('input[name=mtuMode]').change( function() {
                switch(parseInt($(this).val()))
                {
                case 0:
                    $('#basic_settings-mtuValue').prop('disabled', true); 
                    break;
                case 1:
                    $('#basic_settings-mtuValue').prop('disabled', false);
                    if (3 == gObj.routing.protoType) {
                        if (!gReg.mtuValue6.test( $('#basic_settings-mtuValue').val() ))
                            remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                    }
                    break;
                }
            }).eq( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuMode ).trigger('click');

            $('#basic_settings-mtuValue').blur( function() {
                if (3 == gObj.routing.protoType) {
                    if (!gReg.mtuValue6.test( $('#basic_settings-mtuValue').val() ))
                        remindAlert( '<p>' + gTerm[ gObj.lang ].mtuValue6 + '</p>' );
                }
            });

            $('#dhcp_pool_settings-1-startIp').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].startIp);
            $('#dhcp_pool_settings-1-endIp').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].endIp);
            $('#dhcp_pool_settings-1-leaseTime').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].leaseTime || 86400);
            $('#dhcp_pool_settings-1-gateway').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].gateway);
            $('#dhcp_pool_settings-1-dns1').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns1);
            $('#dhcp_pool_settings-1-dns2').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns2);
            $('#dhcp_pool_settings-1-wins1').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins1);
            $('#dhcp_pool_settings-1-wins2').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins2);
            $('#dhcp_pool_settings-1-domainName').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].domainName);
            $('#dhcp_pool_settings-2-relayIp').val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].relayIp);
    
            $('#ipv6_settings-ipv6Address').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address );
            $('#ipv6_settings-ipv6PrefixLength').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength );
    
            genAlias( tar.pid, gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ] );
            genDhcpBinding( tar.thisNo );

            if ( 2 === gCache.ports[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ] ) {
                gObj.tab.tabs({"disabled": [0, 1, 2, 3, 4]});
                $('#popForm input').prop('disabled', true);
                $('#popForm select').prop('disabled', true);
            } else if ( 0 != parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].type ) ) {
                gObj.tab.tabs({"disabled": [0, 1, 2, 3, 4]});
                $('#popForm input').prop('disabled', true);
                $('#popForm select').prop('disabled', true);
                $('#basic_settings-vid').prop('disabled', false);
                $('#basic_settings-mtuValue').prop('disabled', false);
            }
    
            if (3 == gObj.routing.protoType)
                gObj.tab.tabs({"disabled": [1,2,3]});
            else
                gObj.tab.tabs({"disabled": [1,2,3,4]});

            $('#dhcp_pool_settings-type').change( function() {
                $('.dhcp_pool_settings-type-1').hide();
                $('.dhcp_pool_settings-type-2').hide();
    
                switch(parseInt($(this).val()))
                {
                case 2:
                    $('.dhcp_pool_settings-type-2').show();
                case 0:
                    if (gObj.routing.protoType == 3) {
                        gObj.tab.tabs({"disabled": [2]});
                    } else {
                        gObj.tab.tabs({"disabled": [2,4]});
                    }
                    break;
                case 1:
                    $('.dhcp_pool_settings-type-1').show();
                    gObj.tab.tabs("enable", 2);
                    gObj.tab.tabs("enable", 3);
                    break;
                }
            }).val( gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].type ).trigger('change');

            $('#basic_settings-address').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-address').val() ) ) {
                    $('#basic_settings-netmask').prop('disabled', false);
                    $('#basic_settings-zoneId').prop('disabled', false);
                    if (gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                        gObj.tab.tabs('enable', 1);
                        gObj.tab.tabs('enable', 3);
                        if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                            gObj.tab.tabs('enable', 2);
                        autoDhcpServer( tar.pid, $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() );
                        gObj.addressed = $('#basic_settings-address').val();
                    } 
                } else {
                    if (gObj.routing.protoType == 3) {
                        gObj.tab.tabs({"disabled": [1,2,3]});
                    } else {
                        gObj.tab.tabs({"disabled": [1,2,3,4]});
                    }
                }
            });

            $('#basic_settings-netmask').blur( function() {
                if (gReg.ipv4.test( $('#basic_settings-address').val() ) && gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {      
                    gObj.addressed = $('#basic_settings-address').val();
                    gObj.tab.tabs('enable', 1);
                    gObj.tab.tabs('enable', 3);
                    if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                        gObj.tab.tabs('enable', 2);
                    autoDhcpServer( tar.pid, $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() );
                }else {
                    if (gObj.routing.protoType == 3) {
                        gObj.tab.tabs({"disabled": [1,2,3]});
                    } else {
                        gObj.tab.tabs({"disabled": [1,2,3,4]});
                    }
                }
            });

            $('#basic_settings-address').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address );
            $('#basic_settings-netmask').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netmask );

            if (gReg.ipv4.test( $('#basic_settings-address').val() ) ) {
                gObj.addressed = $('#basic_settings-address').val();
                $('#basic_settings-netmask').prop('disabled', false);
                if (gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                    gObj.tab.tabs('enable', 1);
                    gObj.tab.tabs('enable', 3);
                    $('#basic_settings-zoneId').prop('disabled', false);
                    if (1 === parseInt($('#dhcp_pool_settings-type').val()))
                        gObj.tab.tabs('enable', 2);
                }
            } else {
                $('#basic_settings-netmask').prop('disabled', true);
                $('#basic_settings-zoneId').prop('disabled', true);
            }

            $('#dhcp_pool_settings-1-startIp').blur( function() {
                var pass = dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $(this).val(), $('#dhcp_pool_settings-1-endIp').val() );
                if (!pass) 
                    errorAlert( '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>' );
            });

            $('#dhcp_pool_settings-1-endIp').blur( function() {
                var pass = dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $(this).val() );
                if (!pass)
                    errorAlert( '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>' );
            });

            // if bridge or wan 
            if ( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].type ) > 0 ) {
                $('#popForm input').prop('disabled', true);
                $('#popForm select').prop('disabled', true);
                $('#popForm button').prop('disabled', true);
                $('#basic_settings-vid').prop('disabled', false);
                $('#basic_settings-mtuMode-0').prop('disabled', false);
                $('#basic_settings-mtuMode-1').prop('disabled', false);
                $('#basic_settings-mtuValue').prop('disabled', false);
            }
            break;
        case 'zone':
            $('#popForm').append('<div class="formDiv"><table id="table-editor"></table></div>');
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                tmp = '<tr>';
                switch(gNode.editor[ i ].tab)
                {
                case 'name':
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>'; 
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '" >';
                    tmp += '<input type="' + gNode.editor[ i ].type + '" id="editor-' + gNode.editor[ i ].tab + '" />';
                    if (gNode.editor[ i ].note)
                        tmp += gNode.editor[ i ].note;
                    tmp += '</td>';
                    break;
                case 'securityLevel':
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>'; 
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '" >';
                    tmp += '<input type="' + gNode.editor[ i ].type + '" id="editor-' + gNode.editor[ i ].tab + '" size="8" />';
                    if (gNode.editor[ i ].note)
                        tmp += gNode.editor[ i ].note;
                    tmp += '</td>';
                    break;
                case 'member':
                    tmp += '<td colspan="2">';
                    tmp += '<table>';
    
                    tmp += '<tr>';
                    tmp += '<th style="width: ' + gNode.editor[ i ].multiple.pool.wiz + '">';
                    tmp += gNode.editor[ i ].multiple.pool.label;
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.del.wiz + '">';
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.add.wiz + '">';
                    tmp += '</th>';
                    tmp += '<th style="width: ' + gNode.editor[ i ].multiple.pick.wiz + '">';
                    tmp += gNode.editor[ i ].multiple.pick.label;
                    tmp += '</th>';
                    tmp += '</tr>';
    
                    tmp += '<tr>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.pool.wiz + '">';
                    tmp += '<select id="pool" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.del.wiz + '">';
                    tmp += '<button class="Move2Del" id="Move2Del-member"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.add.wiz + '">';
                    tmp += '<button class="Move2Add" id="Move2Add-member"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ i ].multiple.pick.wiz + '">';
                    tmp += '<select id="pick" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';
    
                    tmp += '</table>';
                    tmp += '</td>';
                    break;
                }
                tmp += '</tr>';
                $('#table-editor').append(tmp);
            }
    
            $('#editor-name').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name );
            $('#editor-securityLevel').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].securityLevel );
    
            genMultiSelector( tar.pid, gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ] );
    
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerZone ) {
                    errorAlert( '<p>' + gError[ gObj.lang ].memberLimit + '</p>' );
                    return false;
                } else {
                    vSel.clone().appendTo('#pick');
                    vSel.remove();
                }
            });
    
            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
            break;
        }
    
        interfaceEditor(e, tar.w, tar.h);
    }
    
    function interfaceEditor(e, w, h) {
        var tar = {};
        var msg = '';

        if (gObj.active.h5Index == 'NA') {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label ;
        }else {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].label;
        }
    
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[1];
    
        gPop.popForm = $('#popForm').dialog({
            width: w || 800,
            height: h || 600,
            position: "center",
            resizable: false,
            modal: true,
            title: tar.title + ' > ' + gTerm[ gObj.lang ][ tar.type ],
            buttons: {
                OK: function() {
                    if (interfaceChecker(e)) {
                        if ( gIf.checkIp ) {
                            $.ajax({
                                type : "post",
                                url : "cgi-bin/checkIp.cgi",
                                dataType: 'json',
                                data: gY.JSON.stringify( gObj.calc.checkIp ),
                                success: function(data) {
                                    if ( 0 === parseInt( data.status ) && 0 === parseInt( data.isConflict ) ) {
                                        gIf.alter = true;

                                        switch( tar.pid )
                                        {
                                        case 'wan_settings':
                                            if (tar.type == 'Create') {
                                                gCache.wan.wanId--;
                                                tar.thisNo = gData[ tar.pid ][ gNode.guiT ].length;
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.guiT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.aliasT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.dhcpT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.pppoecT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.staticipT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.staticip6T ][ 0 ]);
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache.wan.wanId;
                                            } else {
                                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                                            }

                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#basic_settings-name').html();
                                            gCache.wan.wan[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = false;
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].description = $('#basic_settings-description').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].portId = $('#basic_settings-portId').val();
                                            gCache.wan.portId[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].portId ) ] = gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ;
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId = $('#basic_settings-zoneId').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanProto = $('#basic_settings-wanProto').val();
                                            gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].ip = $('#basic_settings-wanProto-0-ip').val();
                                            gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].netmask = $('#basic_settings-wanProto-0-netmask').val();
                                            gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].gateway = $('#basic_settings-wanProto-0-gateway').val();
                                            gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].username = $('#basic_settings-wanProto-2-username').val();
                                            gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].password = $('#basic_settings-wanProto-2-password').val();
                                            gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].authType = $('#basic_settings-wanProto-2-authType').val();
                                            gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].ondemand = ($('#basic_settings-wanProto-2-ondemand-0').is(':checked'))? 0 : 1;
                                            gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].maxIdleTime = $('#basic_settings-wanProto-2-maxIdleTime').val();
                    
                                            switch( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanProto ) ) 
                                            {
                                            case 0:
                                            
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].ip + '/' + autoMaskBits( gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].netmask );
                                                gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].mtuMode = ($('#basic_settings-wanProto-0-mtuMode-0').is(':checked'))? 0 : 1;
                                                gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].mtu = $('#basic_settings-wanProto-0-mtu').val();
                                                gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].dnsMode = 1 ;//($('#basic_settings-wanProto-0-dnsMode-0').is(':checked'))? 0 : 1;
                                                gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].userDns1 = $('#basic_settings-wanProto-0-userDns1').val();
                                                gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].userDns2 = $('#basic_settings-wanProto-0-userDns2').val() || "";
                                                break;
                                            case 2:
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = "";
                                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].mtuMode = ($('#basic_settings-wanProto-2-mtuMode-0').is(':checked'))? 0 : 1;
                                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].mtu = $('#basic_settings-wanProto-2-mtu').val();
                                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].dnsMode = ($('#basic_settings-wanProto-2-dnsMode-0').is(':checked'))? 0 : 1;
                                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].userDns1 = $('#basic_settings-wanProto-2-userDns1').val() || "";
                                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].userDns2 = $('#basic_settings-wanProto-2-userDns2').val() || "";
                                                break;
                                            case 1: 
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = "";
                                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].mtuMode = ($('#basic_settings-wanProto-1-mtuMode-0').is(':checked'))? 0 : 1;
                                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].mtu = $('#basic_settings-wanProto-1-mtu').val();
                                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dnsMode = ($('#basic_settings-wanProto-1-dnsMode-0').is(':checked'))? 0 : 1;
                                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].userDns1 = $('#basic_settings-wanProto-1-userDns1').val() || "";
                                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].userDns2 = $('#basic_settings-wanProto-1-userDns2').val() || "";
                                                break;
                                            }
                    
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt = gObj.ipAlias.length;
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = "";
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = "";
                    
                                            if (gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt > 0) {
                                                var arrs = [];
                                                var masks = [];
                                                for (var i=0; i<gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt; i++)
                                                {
                                                    arrs.push( gObj.ipAlias[ i ].address );
                                                    masks.push( gObj.ipAlias[ i ].netmask );
                                                }
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = arrs.join(';');
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = masks.join(';');
                                            }
                    
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].macCloneEnable = ($('#basic_settings-macCloneEnable-0').is(':checked'))? 0 : 1;
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].macClone = $('#basic_settings-macClone').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].weight = $('#multiple_wan_settings-weight').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectEnable = ($('#multiple_wan_settings-netDetectEnable').is(':checked'))? 1 : 0;
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectMethod = ($('#multiple_wan_settings-netDetectMethod-0').is(':checked'))? 0 : 1;
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectPingIpId = $('#multiple_wan_settings-netDetectPingIpId').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectDnsIpId = $('#multiple_wan_settings-netDetectDnsIpId').val();
                    
                                            // check if backup before
                                            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].failoverEnable )) {
                                                gCache.wan.wanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = false;
                                                gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName ] = false;
                                            }
                    
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].failoverEnable = ($('#multiple_wan_settings-failoverEnable').is(':checked'))? 1 : 0;
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName = ($('#multiple_wan_settings-backupWanName').val() == 'NA')? "" : $('#multiple_wan_settings-backupWanName').val();
                    
                                            // update cache if backup before
                                            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].failoverEnable )) {
                                                gCache.wan.wanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
                                                gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName ] = true;
                                            }
                    
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanProto_v6 = $('#ipv6_settings-wanProto_v6').val();
                                            gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].ip = $('#ipv6_settings-wanProto_v6-0-ip').val() || "";
                                            gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].prefix = $('#ipv6_settings-wanProto_v6-0-prefix').val() || "";
                                            gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].gateway = $('#ipv6_settings-wanProto_v6-0-gateway').val() || "";
                                            gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].userDns1 = $('#ipv6_settings-wanProto_v6-0-userDns1').val() || "";
                                            gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].userDns2 = $('#ipv6_settings-wanProto_v6-0-userDns2').val() || "";
                    
                                            if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0) {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                            } else {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                                            }

                                            break;
                                        case 'ports':
                                            tar.thisNo = tar.id.split(gReg.isDash)[2];
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = $('#basic_settings-address').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netmask = $('#basic_settings-netmask').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].speed = $('#basic_settings-speed').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].duplex = $('#basic_settings-duplex').val();
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].type = $('#dhcp_pool_settings-type').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuMode = $('input[name=mtuMode]:checked').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuValue = $('#basic_settings-mtuValue').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId = $('#basic_settings-zoneId').val();
                    
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].startIp     = $('#dhcp_pool_settings-1-startIp').val()     || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].endIp       = $('#dhcp_pool_settings-1-endIp').val()       || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].gateway     = $('#dhcp_pool_settings-1-gateway').val()     || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].relayIp     = $('#dhcp_pool_settings-2-relayIp').val()     || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].leaseTime   = $('#dhcp_pool_settings-1-leaseTime').val()   || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns1        = $('#dhcp_pool_settings-1-dns1').val()        || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns2        = $('#dhcp_pool_settings-1-dns2').val()        || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins1       = $('#dhcp_pool_settings-1-wins1').val()       || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins2       = $('#dhcp_pool_settings-1-wins2').val()       || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].domainName  = $('#dhcp_pool_settings-1-domainName').val()  || "";
                    
                                            if (gObj.routing.protoType == 3) {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address       = $('#ipv6_settings-ipv6Address').val() || "::";
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength  = $('#ipv6_settings-ipv6PrefixLength').val() || "0";
                                            }
                                            
                                            // dhcp binding
                                            if (gObj.dhcpBinding.length > 0) {
                                                for (var i=0, len=gObj.dhcpBinding.length; i<len; i++)
                                                {
                                                    var exists = false;
                                                    for (var j=0, jlen=gData[ tar.pid ][ gNode.reservT ].length; j<jlen; j++)
                                                    {
                                                        if ( gObj.dhcpBinding[ i ].gid == gData[ tar.pid ][ gNode.reservT ][ j ].gid ) {
                                                            exists = true;
                                                            if (!gCache.dhcpBinding[ i ])
                                                                gObj.dhcpBinding[ i ].cgiAction = 3;
                                                            gData[ tar.pid ][ gNode.reservT ][ j ] = gObj.dhcpBinding[ i ];
                                                        }
                                                    }
                                                    if ((!exists) && gCache.dhcpBinding[ i ])
                                                        gData[ tar.pid ][ gNode.reservT ].push( gObj.dhcpBinding[ i ] );
                                                }
                                                gData[ tar.pid ][ gNode.reservTNum ] = gData[ tar.pid ][ gNode.reservT ].length;
                                            }
                    
                                            // ip alias
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt = gObj.ipAlias.length;
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = "";
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = "";
                    
                                            if (gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt > 0) {
                                                var arrs = [];
                                                var masks = [];
                                                for (var i=0; i<gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt; i++)
                                                {
                                                    arrs.push( gObj.ipAlias[ i ].address );
                                                    masks.push( gObj.ipAlias[ i ].netmask );
                                                }
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = arrs.join(';');
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = masks.join(';');
                                            }
                    
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                            break;
                                        case 'lan':
                                            if (tar.type == 'Create') {
                                                gCache[ tar.pid ].gid--;
                                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.guiT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.aliasT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.dhcpT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
                                                gData[ tar.pid ][ gNode.aliasTNum ] = gData[ tar.pid ][ gNode.aliasT ].length;
                                                gData[ tar.pid ][ gNode.dhcpTNum ] = gData[ tar.pid ][ gNode.dhcpT ].length;
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].userDefined = 1;
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                                                gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
                                            } else {
                                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                                            }
                    
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#basic_settings-name').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = $('#basic_settings-address').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netmask = $('#basic_settings-netmask').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId = $('#basic_settings-zoneId').val();
                    
                                            if ($('#basic_settings-stp').is(':checked')) {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].stp = 1;
                                            } else {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].stp = 0;
                                            }
                    
                                            if (gObj.routing.protoType == 3) {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address       = $('#ipv6_settings-ipv6Address').val() || "::";
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength  = $('#ipv6_settings-ipv6PrefixLength').val() || "0";
                                            }
                    
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].type        = $('#dhcp_pool_settings-type').val();
                    
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].startIp     = $('#dhcp_pool_settings-1-startIp').val()     || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].endIp       = $('#dhcp_pool_settings-1-endIp').val()       || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].gateway     = $('#dhcp_pool_settings-1-gateway').val()     || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].relayIp     = $('#dhcp_pool_settings-2-relayIp').val()     || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].leaseTime   = $('#dhcp_pool_settings-1-leaseTime').val()   || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns1        = $('#dhcp_pool_settings-1-dns1').val()        || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns2        = $('#dhcp_pool_settings-1-dns2').val()        || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins1       = $('#dhcp_pool_settings-1-wins1').val()       || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins2       = $('#dhcp_pool_settings-1-wins2').val()       || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].domainName  = $('#dhcp_pool_settings-1-domainName').val()  || "";
                    
                                            if (gObj.routing.protoType == 3) {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address       = $('#ipv6_settings-ipv6Address').val() || "::";
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength  = $('#ipv6_settings-ipv6PrefixLength').val() || "0";
                                            }
                    
                                            // dhcp binding
                                            if (gObj.dhcpBinding.length > 0) {
                                                for (var i=0, len=gObj.dhcpBinding.length; i<len; i++)
                                                {
                                                    var exists = false;
                                                    for (var j=0, jlen=gData[ tar.pid ][ gNode.reservT ].length; j<jlen; j++)
                                                    {
                                                        if ( gObj.dhcpBinding[ i ].gid == gData[ tar.pid ][ gNode.reservT ][ j ].gid ) {
                                                            exists = true;
                                                            if (!gCache.dhcpBinding[ i ])
                                                                gObj.dhcpBinding[ i ].cgiAction = 3;
                                                            gData[ tar.pid ][ gNode.reservT ][ j ] = gObj.dhcpBinding[ i ];
                                                        }
                                                    }
                                                    if ((!exists) && gCache.dhcpBinding[ i ])
                                                        gData[ tar.pid ][ gNode.reservT ].push( gObj.dhcpBinding[ i ] );
                                                }
                                                gData[ tar.pid ][ gNode.reservTNum ] = gData[ tar.pid ][ gNode.reservT ].length;
                                            }

                                            // ip alias
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt = gObj.ipAlias.length;
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = "";
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = "";
                    
                                            if (gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt > 0) {
                                                var arrs = [];
                                                var masks = [];
                                                for (var i=0; i<gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt; i++)
                                                {
                                                    arrs.push( gObj.ipAlias[ i ].address );
                                                    masks.push( gObj.ipAlias[ i ].netmask );
                                                }
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = arrs.join(';');
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = masks.join(';');
                                            }
                    
                                            // picked
                                            var pick = [];
                    
                                            gCache[ tar.pid ].interfaces[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ] = [];
                    
                                            $('#pick option').each( function() {
                                                pick.push( parseInt( $(this).val() ));
                                                // tell if other lan's interfaces had been altered
                    
                                                for (var x in gCache[ tar.pid ].interfaces)
                                                {
                                                    if (gCache[ tar.pid ].interfaces[ x ].indexOf( parseInt( $(this).val() ) ) != -1) {
                                                        gCache[ tar.pid ].interfaces[ x ].splice( gCache[ tar.pid ].interfaces[ x ].indexOf( parseInt( $(this).val() ) ), 1);
                                                    }
                                                }
                                            });
                    
                                            gCache[ tar.pid ].interfaces[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ] = pick;
                                            if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0) {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                            }else {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                                            }
                    
                                            break;
                                        case 'vlan_interfaces':
                                            if (tar.type == 'Create') {
                                                gCache[ tar.pid ].gid--;
                                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.guiT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.aliasT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.dhcpT ][ 0 ]);
                                                gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
                                                gData[ tar.pid ][ gNode.aliasTNum ] = gData[ tar.pid ][ gNode.aliasT ].length;
                                                gData[ tar.pid ][ gNode.dhcpTNum ] = gData[ tar.pid ][ gNode.dhcpT ].length;
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                                                gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
                                            } else {
                                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                                            }
                    
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#basic_settings-name').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface = $('#basic_settings-interface').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vid = $('#basic_settings-vid').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = $('#basic_settings-address').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netmask = $('#basic_settings-netmask').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuMode = $('input[name=mtuMode]:checked').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuValue = $('#basic_settings-mtuValue').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId = $('#basic_settings-zoneId').val();
                    
                                            if (!gCache[ tar.pid ].interface[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ]) {
                                                gCache[ tar.pid ].interface[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ] = [];
                                            }
                    
                                            gCache[ tar.pid ].interface[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ].push( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vid ));
                    
                                            if (gObj.routing.protoType == 3) {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address       = $('#ipv6_settings-ipv6Address').val() || "::";;
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength  = $('#ipv6_settings-ipv6PrefixLength').val() || "0";
                                            }
                    
                                            // dhcp binding
                                            if (gObj.dhcpBinding.length > 0) {
                                                for (var i=0, len=gObj.dhcpBinding.length; i<len; i++)
                                                {
                                                    var exists = false;
                                                    for (var j=0, jlen=gData[ tar.pid ][ gNode.reservT ].length; j<jlen; j++)
                                                    {
                                                        if ( gObj.dhcpBinding[ i ].gid == gData[ tar.pid ][ gNode.reservT ][ j ].gid ) {
                                                            exists = true;
                                                            if (!gCache.dhcpBinding[ i ])
                                                                gObj.dhcpBinding[ i ].cgiAction = 3;
                                                            gData[ tar.pid ][ gNode.reservT ][ j ] = gObj.dhcpBinding[ i ];
                                                        }
                                                    }
                                                    if ((!exists) && gCache.dhcpBinding[ i ])
                                                        gData[ tar.pid ][ gNode.reservT ].push( gObj.dhcpBinding[ i ] );
                                                }
                                                gData[ tar.pid ][ gNode.reservTNum ] = gData[ tar.pid ][ gNode.reservT ].length;
                                            }

                                            // ip alias
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt = gObj.ipAlias.length;
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = "";
                                            gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = "";
                    
                                            if (gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt > 0) {
                                                var arrs = [];
                                                var masks = [];
                                                for (var i=0; i<gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt; i++)
                                                {
                                                    arrs.push( gObj.ipAlias[ i ].address );
                                                    masks.push( gObj.ipAlias[ i ].netmask );
                                                }
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = arrs.join(';');
                                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = masks.join(';');
                                            }
                    
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].type        = $('#dhcp_pool_settings-type').val();
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].startIp     = $('#dhcp_pool_settings-1-startIp').val()     || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].endIp       = $('#dhcp_pool_settings-1-endIp').val()       || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].gateway     = $('#dhcp_pool_settings-1-gateway').val()     || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].relayIp     = $('#dhcp_pool_settings-2-relayIp').val()     || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].leaseTime   = $('#dhcp_pool_settings-1-leaseTime').val()   || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns1        = $('#dhcp_pool_settings-1-dns1').val()        || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns2        = $('#dhcp_pool_settings-1-dns2').val()        || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins1       = $('#dhcp_pool_settings-1-wins1').val()       || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins2       = $('#dhcp_pool_settings-1-wins2').val()       || "";
                                            gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].domainName  = $('#dhcp_pool_settings-1-domainName').val()  || "";
                    
                                            if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0) {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                            } else {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                                            }
                                            break;
                                        case 'zone':
                                            var member = [];
                                            if (tar.type == 'Create') {
                                                gCache[ tar.pid ].zoneId--;
                                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                                gData[ tar.pid ][ gNode.guiTNum ]++;
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = {};
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].zoneId;
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].userDefined = 1;
                                                gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ] = [];
                                            }else {
                                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                                                delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
                                                member = gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ];
                                            }
                    
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#editor-name').val();
                                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].securityLevel = $('#editor-securityLevel').val();
                    
                                            gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
                    
                                            // picked
                                            var pick = [];
                    
                                            gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ] = [];
                    
                                            $('#pick option').each( function() {
                                                pick.push( parseInt( $(this).val() ));
                                                // tell if other zone's member had been altered
                                                for (var x in gCache[ tar.pid ].member)
                                                {
                                                    if (gCache[ tar.pid ].member[ x ].indexOf( parseInt( $(this).val() ) ) != -1) {
                                                        gCache[ tar.pid ].member[ x ].splice( gCache[ tar.pid ].member[ x ].indexOf( parseInt( $(this).val() ) ), 1);
                                                    }
                                                }
                                            });
                    
                                            gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ] = pick;
                                            // check if member been removed 
                    
                                            for (var i=0, len=member.length; i<len; i++)
                                            {
                                                if (pick.indexOf(member[ i ]) == -1) {
                                                    // removed from member, tell if LAN or WAN
                                                    if (gCache.wans[ member[ i ] ]) {
                                                        gCache[ tar.pid ].member[ gCache[ tar.pid ].wanId ].push( member[ i ] );
                                                    }else {
                                                        gCache[ tar.pid ].member[ gCache[ tar.pid ].lanId ].push( member[ i ] );
                                                    }
                                                }
                                            }
                    
                                            if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0) {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                            }else {
                                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                                            }
                                            break;
                                        }

                                        refreshInterface( tar.pid );
                                        gPop.popForm.dialog( "close" );
                                    } else {
                                        var conflicts = data.conflictType.split(',');
                                        for (var i=0; i<conflicts.length; i++)
                                        {
                                            if (gError[ gObj.lang ][ conflicts[ i ] ] )
                                                msg += '<p>' + gError[ gObj.lang ][ conflicts[ i ] ] + '</p>';
                                        }
                                        errorAlert( msg );
                                    }
                                },
                                fail: function() {
                                    msg = '<p>' + gError[ gObj.lang ].overlapCheck + '</p>';
                                    errorAlert( msg );
                                }
                            });
                        } else {
                            gIf.alter = true;
                            switch( tar.pid )
                            {
                            case 'wan_settings':
                                if (tar.type == 'Create') {
                                    gCache.wan.wanId--;
                                    tar.thisNo = gData[ tar.pid ][ gNode.guiT ].length;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.guiT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.aliasT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.dhcpT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.pppoecT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.staticipT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get[ tar.pid ] ][ gNode.staticip6T ][ 0 ]);
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache.wan.wanId;
                                } else {
                                    tar.thisNo = tar.id.split(gReg.isDash)[2];
                                }
        
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#basic_settings-name').html();
                                gCache.wan.wan[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = false;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].description = $('#basic_settings-description').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].portId = $('#basic_settings-portId').val();
                                gCache.wan.portId[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].portId ) ] = gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId = $('#basic_settings-zoneId').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanProto = $('#basic_settings-wanProto').val();
                                gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].ip = $('#basic_settings-wanProto-0-ip').val();
                                gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].netmask = $('#basic_settings-wanProto-0-netmask').val();
                                gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].gateway = $('#basic_settings-wanProto-0-gateway').val();
        
                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].username = $('#basic_settings-wanProto-2-username').val();
                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].password = $('#basic_settings-wanProto-2-password').val();
                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].authType = $('#basic_settings-wanProto-2-authType').val();
                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].ondemand = ($('#basic_settings-wanProto-2-ondemand-0').is(':checked'))? 0 : 1;
                                gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].maxIdleTime = $('#basic_settings-wanProto-2-maxIdleTime').val();

                                switch( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanProto ) )
                                {
                                case 0:
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].ip + '/' + autoMaskBits( gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].netmask );
                                    gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].mtuMode = ($('#basic_settings-wanProto-0-mtuMode-0').is(':checked'))? 0 : 1;
                                    gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].mtu = $('#basic_settings-wanProto-0-mtu').val();
                                    gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].dnsMode = 1 ;//($('#basic_settings-wanProto-0-dnsMode-0').is(':checked'))? 0 : 1;
                                    gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].userDns1 = $('#basic_settings-wanProto-0-userDns1').val();
                                    gData[ tar.pid ][ gNode.staticipT ][ tar.thisNo ].userDns2 = $('#basic_settings-wanProto-0-userDns2').val() || "";
                                    break;
                                case 1:
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = "";
                                    gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].mtuMode = ($('#basic_settings-wanProto-1-mtuMode-0').is(':checked'))? 0 : 1;
                                    gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].mtu = $('#basic_settings-wanProto-1-mtu').val();
                                    gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dnsMode = ($('#basic_settings-wanProto-1-dnsMode-0').is(':checked'))? 0 : 1;
                                    gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].userDns1 = $('#basic_settings-wanProto-1-userDns1').val() || "";
                                    gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].userDns2 = $('#basic_settings-wanProto-1-userDns2').val() || "";
                                    break;
                                case 2:
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = "";
                                    gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].mtuMode = ($('#basic_settings-wanProto-2-mtuMode-0').is(':checked'))? 0 : 1;
                                    gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].mtu = $('#basic_settings-wanProto-2-mtu').val();
                                    gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].dnsMode = ($('#basic_settings-wanProto-2-dnsMode-0').is(':checked'))? 0 : 1;
                                    gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].userDns1 = $('#basic_settings-wanProto-2-userDns1').val() || "";
                                    gData[ tar.pid ][ gNode.pppoecT ][ tar.thisNo ].userDns2 = $('#basic_settings-wanProto-2-userDns2').val() || "";
                                    break;
                                    break;
                                }
        
                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt = gObj.ipAlias.length;
                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = "";
                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = "";
        
                                if (gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt > 0) {
                                    var arrs = [];
                                    var masks = [];
                                    for (var i=0; i<gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt; i++)
                                    {
                                        arrs.push( gObj.ipAlias[ i ].address );
                                        masks.push( gObj.ipAlias[ i ].netmask );
                                    }
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = arrs.join(';');
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = masks.join(';');
                                }
        
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].macCloneEnable = ($('#basic_settings-macCloneEnable-0').is(':checked'))? 0 : 1;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].macClone = $('#basic_settings-macClone').val();
        
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].weight = $('#multiple_wan_settings-weight').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectEnable = ($('#multiple_wan_settings-netDetectEnable').is(':checked'))? 1 : 0;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectMethod = ($('#multiple_wan_settings-netDetectMethod-0').is(':checked'))? 0 : 1;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectPingIpId = $('#multiple_wan_settings-netDetectPingIpId').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netDetectDnsIpId = $('#multiple_wan_settings-netDetectDnsIpId').val();
        
                                // check if backup before
                                if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].failoverEnable )) {
                                    gCache.wan.wanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = false;
                                    gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName ] = false;
                                }
        
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].failoverEnable = ($('#multiple_wan_settings-failoverEnable').is(':checked'))? 1 : 0;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName = ($('#multiple_wan_settings-backupWanName').val() == 'NA')? "" : $('#multiple_wan_settings-backupWanName').val();
        
                                // update cache if backup before
                                if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].failoverEnable )) {
                                    gCache.wan.wanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
                                    gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName ] = true;
                                }
        
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanProto_v6 = $('#ipv6_settings-wanProto_v6').val();
                                gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].ip = $('#ipv6_settings-wanProto_v6-0-ip').val() || "";
                                gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].prefix = $('#ipv6_settings-wanProto_v6-0-prefix').val() || "";
                                gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].gateway = $('#ipv6_settings-wanProto_v6-0-gateway').val() || "";
                                gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].userDns1 = $('#ipv6_settings-wanProto_v6-0-userDns1').val() || "";
                                gData[ tar.pid ][ gNode.staticip6T ][ tar.thisNo ].userDns2 = $('#ipv6_settings-wanProto_v6-0-userDns2').val() || "";
        
                                if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                } else {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                                }
        
                                break;
                            case 'ports':
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = $('#basic_settings-address').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netmask = $('#basic_settings-netmask').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].speed = $('#basic_settings-speed').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].duplex = $('#basic_settings-duplex').val();
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].type = $('#dhcp_pool_settings-type').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuMode = $('input[name=mtuMode]:checked').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuValue = $('#basic_settings-mtuValue').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId = $('#basic_settings-zoneId').val();
        
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].startIp     = $('#dhcp_pool_settings-1-startIp').val()     || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].endIp       = $('#dhcp_pool_settings-1-endIp').val()       || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].gateway     = $('#dhcp_pool_settings-1-gateway').val()     || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].relayIp     = $('#dhcp_pool_settings-2-relayIp').val()     || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].leaseTime   = $('#dhcp_pool_settings-1-leaseTime').val()   || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns1        = $('#dhcp_pool_settings-1-dns1').val()        || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns2        = $('#dhcp_pool_settings-1-dns2').val()        || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins1       = $('#dhcp_pool_settings-1-wins1').val()       || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins2       = $('#dhcp_pool_settings-1-wins2').val()       || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].domainName  = $('#dhcp_pool_settings-1-domainName').val()  || "";
        
                                if (gObj.routing.protoType == 3) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address       = $('#ipv6_settings-ipv6Address').val() || "::";;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength  = $('#ipv6_settings-ipv6PrefixLength').val() || "0";
                                }
        
                                // dhcp binding
                                if (gObj.dhcpBinding.length > 0) {
                                    for (var i=0, len=gObj.dhcpBinding.length; i<len; i++)
                                    {
                                        var exists = false;
                                        for (var j=0, jlen=gData[ tar.pid ][ gNode.reservT ].length; j<jlen; j++)
                                        {
                                            if ( gObj.dhcpBinding[ i ].gid == gData[ tar.pid ][ gNode.reservT ][ j ].gid ) {
                                                exists = true;
                                                if (!gCache.dhcpBinding[ i ])
                                                    gObj.dhcpBinding[ i ].cgiAction = 3;
                                                gData[ tar.pid ][ gNode.reservT ][ j ] = gObj.dhcpBinding[ i ];
                                            }
                                        }
                                        if ((!exists) && gCache.dhcpBinding[ i ])
                                            gData[ tar.pid ][ gNode.reservT ].push( gObj.dhcpBinding[ i ] );
                                    }
                                    gData[ tar.pid ][ gNode.reservTNum ] = gData[ tar.pid ][ gNode.reservT ].length;
                                }

                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt = gObj.ipAlias.length;
                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = "";
                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = "";
        
                                if (gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt > 0) {
                                    var arrs = [];
                                    var masks = [];
                                    for (var i=0; i<gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt; i++)
                                    {
                                        arrs.push( gObj.ipAlias[ i ].address );
                                        masks.push( gObj.ipAlias[ i ].netmask );
                                    }
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = arrs.join(';');
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = masks.join(';');
                                }
        
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                break;
                            case 'lan':
                                if (tar.type == 'Create') {
                                    gCache[ tar.pid ].gid--;
                                    tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.guiT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.aliasT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.dhcpT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
                                    gData[ tar.pid ][ gNode.aliasTNum ] = gData[ tar.pid ][ gNode.aliasT ].length;
                                    gData[ tar.pid ][ gNode.dhcpTNum ] = gData[ tar.pid ][ gNode.dhcpT ].length;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].userDefined = 1;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                                    gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
                                } else {
                                    tar.thisNo = tar.id.split(gReg.isDash)[2];
                                }
        
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#basic_settings-name').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = $('#basic_settings-address').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netmask = $('#basic_settings-netmask').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId = $('#basic_settings-zoneId').val();
        
                                if ($('#basic_settings-stp').is(':checked')) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].stp = 1;
                                } else {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].stp = 0;
                                }
        
                                if (gObj.routing.protoType == 3) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address       = $('#ipv6_settings-ipv6Address').val() || "::";;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength  = $('#ipv6_settings-ipv6PrefixLength').val() || "0";
                                }
        
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].type        = $('#dhcp_pool_settings-type').val();
        
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].startIp     = $('#dhcp_pool_settings-1-startIp').val()     || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].endIp       = $('#dhcp_pool_settings-1-endIp').val()       || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].gateway     = $('#dhcp_pool_settings-1-gateway').val()     || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].relayIp     = $('#dhcp_pool_settings-2-relayIp').val()     || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].leaseTime   = $('#dhcp_pool_settings-1-leaseTime').val()   || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns1        = $('#dhcp_pool_settings-1-dns1').val()        || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns2        = $('#dhcp_pool_settings-1-dns2').val()        || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins1       = $('#dhcp_pool_settings-1-wins1').val()       || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins2       = $('#dhcp_pool_settings-1-wins2').val()       || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].domainName  = $('#dhcp_pool_settings-1-domainName').val()  || "";
        
                                if (gObj.routing.protoType == 3) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address       = $('#ipv6_settings-ipv6Address').val() || "::";
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength  = $('#ipv6_settings-ipv6PrefixLength').val() || "0";
                                }
        
                                // dhcp binding
                                if (gObj.dhcpBinding.length > 0) {
                                    for (var i=0, len=gObj.dhcpBinding.length; i<len; i++)
                                    {
                                        var exists = false;
                                        for (var j=0, jlen=gData[ tar.pid ][ gNode.reservT ].length; j<jlen; j++)
                                        {
                                            if ( gObj.dhcpBinding[ i ].gid == gData[ tar.pid ][ gNode.reservT ][ j ].gid ) {
                                                exists = true;
                                                if (!gCache.dhcpBinding[ i ])
                                                    gObj.dhcpBinding[ i ].cgiAction = 3;
                                                gData[ tar.pid ][ gNode.reservT ][ j ] = gObj.dhcpBinding[ i ];
                                            }
                                        }
                                        if ((!exists) && gCache.dhcpBinding[ i ])
                                            gData[ tar.pid ][ gNode.reservT ].push( gObj.dhcpBinding[ i ] );
                                    }
                                    gData[ tar.pid ][ gNode.reservTNum ] = gData[ tar.pid ][ gNode.reservT ].length;
                                } 

                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt = gObj.ipAlias.length;
                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = "";
                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = "";
        
                                if (gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt > 0) {
                                    var arrs = [];
                                    var masks = [];
                                    for (var i=0; i<gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt; i++)
                                    {
                                        arrs.push( gObj.ipAlias[ i ].address );
                                        masks.push( gObj.ipAlias[ i ].netmask );
                                    }
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = arrs.join(';');
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = masks.join(';');
                                }
        
                                // picked
                                var pick = [];
        
                                gCache[ tar.pid ].interfaces[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ] = [];
        
                                $('#pick option').each( function() {
                                    pick.push( parseInt( $(this).val() ));
                                    // tell if other lan's interfaces had been altered
        
                                    for (var x in gCache[ tar.pid ].interfaces)
                                    {
                                        if (gCache[ tar.pid ].interfaces[ x ].indexOf( parseInt( $(this).val() ) ) != -1) {
                                            gCache[ tar.pid ].interfaces[ x ].splice( gCache[ tar.pid ].interfaces[ x ].indexOf( parseInt( $(this).val() ) ), 1);
                                        }
                                    }
                                });
        
                                gCache[ tar.pid ].interfaces[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ] = pick;
                                if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                }else {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                                }
        
                                break;
                            case 'vlan_interfaces':
                                if (tar.type == 'Create') {
                                    gCache[ tar.pid ].gid--;
                                    tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.guiT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.aliasT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.dhcpT ][ 0 ]);
                                    gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
                                    gData[ tar.pid ][ gNode.aliasTNum ] = gData[ tar.pid ][ gNode.aliasT ].length;
                                    gData[ tar.pid ][ gNode.dhcpTNum ] = gData[ tar.pid ][ gNode.dhcpT ].length;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                                    gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
                                } else {
                                    tar.thisNo = tar.id.split(gReg.isDash)[2];
                                }
        
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#basic_settings-name').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface = $('#basic_settings-interface').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vid = $('#basic_settings-vid').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].address = $('#basic_settings-address').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].netmask = $('#basic_settings-netmask').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuMode = $('input[name=mtuMode]:checked').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].mtuValue = $('#basic_settings-mtuValue').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].zoneId = $('#basic_settings-zoneId').val();
        
                                if (!gCache[ tar.pid ].interface[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ]) {
                                    gCache[ tar.pid ].interface[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ] = [];
                                }
        
                                gCache[ tar.pid ].interface[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ].push( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vid ));
        
                                if (gObj.routing.protoType == 3) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6Address       = $('#ipv6_settings-ipv6Address').val() || "::";;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipv6PrefixLength  = $('#ipv6_settings-ipv6PrefixLength').val() || "0";
                                }
        
                                // dhcp binding
                                if (gObj.dhcpBinding.length > 0) {
                                    for (var i=0, len=gObj.dhcpBinding.length; i<len; i++)
                                    {
                                        var exists = false;
                                        for (var j=0, jlen=gData[ tar.pid ][ gNode.reservT ].length; j<jlen; j++)
                                        {
                                            if ( gObj.dhcpBinding[ i ].gid == gData[ tar.pid ][ gNode.reservT ][ j ].gid ) {
                                                exists = true;
                                                if (!gCache.dhcpBinding[ i ])
                                                    gObj.dhcpBinding[ i ].cgiAction = 3;
                                                gData[ tar.pid ][ gNode.reservT ][ j ] = gObj.dhcpBinding[ i ];
                                            }
                                        }
                                        if ((!exists) && gCache.dhcpBinding[ i ])
                                            gData[ tar.pid ][ gNode.reservT ].push( gObj.dhcpBinding[ i ] );
                                    }
                                    gData[ tar.pid ][ gNode.reservTNum ] = gData[ tar.pid ][ gNode.reservT ].length;
                                } 

                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt = gObj.ipAlias.length;
                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = "";
                                gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = "";
        
                                if (gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt > 0) {
                                    var arrs = [];
                                    var masks = [];
                                    for (var i=0; i<gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].ipAliasCnt; i++)
                                    {
                                        arrs.push( gObj.ipAlias[ i ].address );
                                        masks.push( gObj.ipAlias[ i ].netmask );
                                    }
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].address = arrs.join(';');
                                    gData[ tar.pid ][ gNode.aliasT ][ tar.thisNo ].netmask = masks.join(';');
                                }
        
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].type        = $('#dhcp_pool_settings-type').val();
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].startIp     = $('#dhcp_pool_settings-1-startIp').val()     || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].endIp       = $('#dhcp_pool_settings-1-endIp').val()       || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].gateway     = $('#dhcp_pool_settings-1-gateway').val()     || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].relayIp     = $('#dhcp_pool_settings-2-relayIp').val()     || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].leaseTime   = $('#dhcp_pool_settings-1-leaseTime').val()   || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns1        = $('#dhcp_pool_settings-1-dns1').val()        || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].dns2        = $('#dhcp_pool_settings-1-dns2').val()        || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins1       = $('#dhcp_pool_settings-1-wins1').val()       || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].wins2       = $('#dhcp_pool_settings-1-wins2').val()       || "";
                                gData[ tar.pid ][ gNode.dhcpT ][ tar.thisNo ].domainName  = $('#dhcp_pool_settings-1-domainName').val()  || "";
        
                                if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                } else {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                                }
                                break;
                            case 'zone':
                                var member = [];
                                if (tar.type == 'Create') {
                                    gCache[ tar.pid ].zoneId--;
                                    tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                    gData[ tar.pid ][ gNode.guiTNum ]++;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = {};
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].zoneId;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].userDefined = 1;
                                    gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ] = [];
                                }else {
                                    tar.thisNo = tar.id.split(gReg.isDash)[2];
                                    delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
                                    member = gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ];
                                }
        
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#editor-name').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].securityLevel = $('#editor-securityLevel').val();
        
                                gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
        
                                // picked
                                var pick = [];
        
                                gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ] = [];
        
                                $('#pick option').each( function() {
                                    pick.push( parseInt( $(this).val() ));
                                    // tell if other zone's member had been altered
                                    for (var x in gCache[ tar.pid ].member)
                                    {
                                        if (gCache[ tar.pid ].member[ x ].indexOf( parseInt( $(this).val() ) ) != -1) {
                                            gCache[ tar.pid ].member[ x ].splice( gCache[ tar.pid ].member[ x ].indexOf( parseInt( $(this).val() ) ), 1);
                                        }
                                    }
                                });
        
                                gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ] = pick;
                                // check if member been removed 
        
                                for (var i=0, len=member.length; i<len; i++)
                                {
                                    if (pick.indexOf(member[ i ]) == -1) {
                                        // removed from member, tell if LAN or WAN
                                        if (gCache.wans[ member[ i ] ]) {
                                            gCache[ tar.pid ].member[ gCache[ tar.pid ].wanId ].push( member[ i ] );
                                        }else {
                                            gCache[ tar.pid ].member[ gCache[ tar.pid ].lanId ].push( member[ i ] );
                                        }
                                    }
                                }
        
                                if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                }else {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                                }
                                break;
                            }
                            refreshInterface( tar.pid );
                            $( this ).dialog( "close" );
                        }
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });
    
        switch( tar.pid )
        {
        case 'wan_settings':
            $('#basic_settings-description').focus();
            break;
        case 'lan':
        case 'vlan':
            if ('Create' == tar.type)
                $('#basic_settings-name').focus();
            break;
        case 'ports':
            break;
        case 'zone':
            $('#editor-name').focus();
            break;
        }
    }

    function interfaceChecker(e, pid) {
    
        var tar = {};
        gObj.calc = {};
        gObj.calc.targetIp;
        gObj.calc.targetNetmask;
        gObj.calc.checkIp = {
            "checkType" : false,
            "startIp" : "",
            "endIp" : "",
            "isConflict" : 0,
            "conflictType" : ""
        };
    
        gIf.checkIp = false;

        if (pid) {
            tar.pid = pid;
            tar.type = 'Save';
        }else {
            tar.id = $(e.currentTarget).attr('id');
            if (!tar.id)
                return false;
            tar.type  = tar.id.split(gReg.isDash)[0];
    
            tar.pid  = tar.id.split(gReg.isDash)[1];
    
            if (tar.type == 'Create')
                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
            else 
                tar.thisNo = tar.id.split(gReg.isDash)[2];
        }
    
        var pass = true;
        var msg = '';
        switch(tar.pid)
        {
        case 'wan_settings':
            
            if (!gReg.description.test( $('#basic_settings-description').val() ) ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].descriptionLength + '</p>';
            }
    
            switch ( parseInt( $('#basic_settings-wanProto').val() ) ) 
            {
            case 0:
                if (!gReg.ipv4.test( $('#basic_settings-wanProto-0-ip').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].address + '</p>';
                }
    
                if (!gReg.ipv4.test( $('#basic_settings-wanProto-0-netmask').val() ) || !autoMaskBits( $('#basic_settings-wanProto-0-netmask').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].netmask + '</p>';
                }
    
                if (!gReg.ipv4.test( $('#basic_settings-wanProto-0-gateway').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].gateway + '</p>';
                }
    
                if (pass) {
                    gObj.calc.targetIp = $('#basic_settings-wanProto-0-ip').val();
                    gObj.calc.targetNetmask = $('#basic_settings-wanProto-0-netmask').val();
                    var arr = $('#basic_settings-wanProto-0-ip').val().split(gReg.isDot);
                    for (var i=0, ilen=arr.length; i<ilen; i++)
                        gObj.calc["ip_" + (i+1)] = parseInt(arr[i]);
    
                    arr = $('#basic_settings-wanProto-0-netmask').val().split(gReg.isDot);
                    for (var i=0, ilen=arr.length; i<ilen; i++)
                        gObj.calc["snm_" + (i+1)] = parseInt(arr[i]);
    
                    calcNWbits(gObj.calc);
    
                    if (gObj.calc.result == 'invalid' || gObj.calc.numofaddr == 'ERR') {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                    } else {
                        gObj.calc.bits = gObj.calc.result;
                        calcNBFL(gObj.calc);
    
                        switch( gObj.calc.numofaddr ) 
                        {
                        case 'ERR':
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                            break;
                        case 'one':
                        case 'two':
                            gObj.calc.startIp = gObj.calc.firstadr_1 + '.' + gObj.calc.firstadr_2 + '.' + gObj.calc.firstadr_3 + '.' + gObj.calc.firstadr_4;
                            gObj.calc.endIp = gObj.calc.lastadr1 + '.' + gObj.calc.lastadr_2 + '.' + gObj.calc.lastadr_3 + '.' + gObj.calc.lastadr_4;
                            gObj.calc.checkIp.startIp = gObj.calc.startIp;
                            gObj.calc.checkIp.endIp = gObj.calc.endIp;
                            gObj.calc.checkIp.checkType = 'wanIp';
                            break;
                        default:
                            gObj.calc.startIp = gObj.calc.nwadr_1 + '.' + gObj.calc.nwadr_2 + '.' + gObj.calc.nwadr_3 + '.' + gObj.calc.nwadr_4;
                            gObj.calc.endIp = gObj.calc.bcast_1 + '.' + gObj.calc.bcast_2 + '.' + gObj.calc.bcast_3 + '.' + gObj.calc.bcast_4;
                            gObj.calc.checkIp.startIp = gObj.calc.startIp;
                            gObj.calc.checkIp.endIp = gObj.calc.endIp;
                            gObj.calc.checkIp.checkType = 'wanIp';
                        }


                        if (pass) {
                            var checker = interfaceIpChecker( tar.pid, tar.thisNo );
                            if (!checker.pass) {
                                pass = checker.pass;
                                msg += checker.msg;
                            }
                        }

                    } 
                }

                if (!gReg.mtuValue.test( $('#basic_settings-wanProto-0-mtu').val() )) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].mtuValue + '</p>';
                }
       
                if ( $('#basic_settings-wanProto-0-dnsMode-1').is(':checked') ) {
                    if (!gReg.ipv4.test( $('#basic_settings-wanProto-0-userDns1').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].dnsMode + '</p>';
                    }
                    if ($('#basic_settings-wanProto-0-userDns2').val().length > 0 && !gReg.ipv4.test( $('#basic_settings-wanProto-0-userDns2').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].dnsMode + '</p>';
                    }
                }
                break;
            case 1:
                if ( $('#basic_settings-wanProto-1-mtuMode-1').is(':checked') ) {
                    if (!gReg.mtuValue.test( $('#basic_settings-wanProto-1-mtu').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].mtuValue + '</p>';
                    }
                }
       
                if ( $('#basic_settings-wanProto-1-dnsMode-1').is(':checked') ) {
                    if (!gReg.ipv4.test( $('#basic_settings-wanProto-1-userDns1').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].dnsMode + '</p>';
                    }
                    if ($('#basic_settings-wanProto-1-userDns2').val().length > 0 && !gReg.ipv4.test( $('#basic_settings-wanProto-1-userDns2').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].dnsMode + '</p>';
                    }
                }
                break;
            case 2:
                if ( !gReg.userOut63.test( $('#basic_settings-wanProto-2-username').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].userOut63 + '</p>';
                }
                
                if ( !gReg.passOut63.test( $('#basic_settings-wanProto-2-password').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].passOut63 + '</p>';
                }

                if ( !gReg.maxIdleTime.test( $('#basic_settings-wanProto-2-maxIdleTime').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].maxIdleTime + '</p>';
                }

                if ( $('#basic_settings-wanProto-2-mtuMode-1').is(':checked') ) {
                    if (!gReg.mtuValuePPPoE.test( $('#basic_settings-wanProto-2-mtu').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].mtuValuePPPoE + '</p>';
                    }
                }
       
                if ( $('#basic_settings-wanProto-2-dnsMode-1').is(':checked') ) {
                    if (!gReg.ipv4.test( $('#basic_settings-wanProto-2-userDns1').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].dnsMode + '</p>';
                    }
                    if ($('#basic_settings-wanProto-2-userDns2').val().length > 0 && !gReg.ipv4.test( $('#basic_settings-wanProto-2-userDns2').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].dnsMode + '</p>';
                    }
                }
                break;
            }
    
            if ( $('#basic_settings-macCloneEnable-1').is(':checked') ) {
                if (!gReg.mac.test( $('#basic_settings-macClone').val() )) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].macAddr + '</p>';
                }
            }
    
            if ( $('#multiple_wan_settings-failoverEnable').is(':checked') ) {
                if (!gReg.isWan.test( $('#multiple_wan_settings-backupWanName').val() )) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].backupWanName + '</p>';
                }
            }
            break;
        case 'ports':
            if ($('#basic_settings-address').val().length > 0 || $('#basic_settings-netmask').val().length > 0) {
                if (gReg.ipv4.test($('#basic_settings-address').val()) && gReg.ipv4.test($('#basic_settings-netmask').val())) {
                    gObj.calc.targetIp = $('#basic_settings-address').val();
                    gObj.calc.targetNetmask = $('#basic_settings-netmask').val();
                    var arr = $('#basic_settings-address').val().split(gReg.isDot);
                    for (var i=0, ilen=arr.length; i<ilen; i++)
                        gObj.calc["ip_" + (i+1)] = parseInt(arr[i]);
    
                    arr = $('#basic_settings-netmask').val().split(gReg.isDot);
                    for (var i=0, ilen=arr.length; i<ilen; i++)
                        gObj.calc["snm_" + (i+1)] = parseInt(arr[i]);
    
                    calcNWbits(gObj.calc);
    
                    if (gObj.calc.result == 'invalid' || gObj.calc.numofaddr == 'ERR') {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                    } else {
                        gObj.calc.bits = gObj.calc.result;
                        calcNBFL(gObj.calc);
    
                        switch( gObj.calc.numofaddr )
                        {
                        case 'ERR':
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                            break;
                        case 'one':
                        case 'two':
                            gObj.calc.startIp = gObj.calc.firstadr_1 + '.' + gObj.calc.firstadr_2 + '.' + gObj.calc.firstadr_3 + '.' + gObj.calc.firstadr_4;
                            gObj.calc.endIp = gObj.calc.lastadr1 + '.' + gObj.calc.lastadr_2 + '.' + gObj.calc.lastadr_3 + '.' + gObj.calc.lastadr_4;
                            gObj.calc.checkIp.startIp = gObj.calc.startIp;
                            gObj.calc.checkIp.endIp = gObj.calc.endIp;
                            gObj.calc.checkIp.checkType = 'portIp';
                            break;
                        default:
                            gObj.calc.startIp = gObj.calc.nwadr_1 + '.' + gObj.calc.nwadr_2 + '.' + gObj.calc.nwadr_3 + '.' + gObj.calc.nwadr_4;
                            gObj.calc.endIp = gObj.calc.bcast_1 + '.' + gObj.calc.bcast_2 + '.' + gObj.calc.bcast_3 + '.' + gObj.calc.bcast_4;
                            gObj.calc.checkIp.startIp = gObj.calc.startIp;
                            gObj.calc.checkIp.endIp = gObj.calc.endIp;
                            gObj.calc.checkIp.checkType = 'portIp';
                        }

                        if (pass) {
                            var checker = interfaceIpChecker( tar.pid, tar.thisNo );
                            if (!checker.pass) {
                                pass = checker.pass;
                                msg += checker.msg;
                            }
                        }

                        switch(parseInt($('#dhcp_pool_settings-type').val()))
                        {
                        case 1:
                            if (gReg.ipv4.test($('#dhcp_pool_settings-1-startIp').val()) && gReg.ipv4.test($('#dhcp_pool_settings-1-endIp').val())) {
                                if (!dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() )) {
                                    pass = false;
                                    msg += '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>';
                                }
            
                                if (!dhcp_range( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() )) {
                                    pass = false;
                                    msg += '<p>' + gError[ gObj.lang ].ipRange + '</p>';
                                }
                            }else {
                                pass = false;
                                msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                            }
            
                            if (!gReg.ipv4.test($('#dhcp_pool_settings-1-gateway').val())) {
                                pass = false;
                                msg += '<p>' + gError[ gObj.lang ].dnsGateway + '</p>';
                            }
                            break;
                        case 2:
                            if (!gReg.ipv4.test($('#dhcp_pool_settings-2-relayIp').val())) {
                                pass = false;
                                msg += '<p>' + gError[ gObj.lang ].ipDhcpRelay + '</p>';
                            }
                            break;
                        }
                    } 
                }else {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipMask + '</p>';
                }
            }

            if (1 === parseInt($('input[name=mtuMode]:checked').val())) {
                if (!gReg.mtuValue.test( $('#basic_settings-mtuValue').val() )) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].mtuValue + '</p>';
                }
            }

            break;
        case 'lan':
            if (tar.type == 'Create' && (!gReg.ascii.lan.test( $('#basic_settings-name').val() ) || gCache.uniq[ tar.pid ][ $('#basic_settings-name').val()]) || parseInt( gCheck.status ) > 0) {
                pass = false;
                if ( parseInt( gCheck.status ) > 0 ) {
                    msg += '<p>' + gCheck.msg + '</p>';
                }
                msg += '<p>' + gError[ gObj.lang ].uniqName15 + '</p>';
            }
    
            if (gReg.ipv4.test($('#basic_settings-address').val()) && gReg.ipv4.test($('#basic_settings-netmask').val())) {
                gObj.calc.targetIp = $('#basic_settings-address').val();
                gObj.calc.targetNetmask = $('#basic_settings-netmask').val();
                var arr = $('#basic_settings-address').val().split(gReg.isDot);
                for (var i=0, ilen=arr.length; i<ilen; i++)
                    gObj.calc["ip_" + (i+1)] = parseInt(arr[i]);

                arr = $('#basic_settings-netmask').val().split(gReg.isDot);
                for (var i=0, ilen=arr.length; i<ilen; i++)
                    gObj.calc["snm_" + (i+1)] = parseInt(arr[i]);

                calcNWbits(gObj.calc);

                if (gObj.calc.result == 'invalid' || gObj.calc.numofaddr == 'ERR') {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                } else {
                    gObj.calc.bits = gObj.calc.result;
                    calcNBFL(gObj.calc);

                    switch( gObj.calc.numofaddr )
                    {
                    case 'ERR':
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                        break;
                    case 'one':
                    case 'two':
                        gObj.calc.startIp = gObj.calc.firstadr_1 + '.' + gObj.calc.firstadr_2 + '.' + gObj.calc.firstadr_3 + '.' + gObj.calc.firstadr_4;
                        gObj.calc.endIp = gObj.calc.lastadr1 + '.' + gObj.calc.lastadr_2 + '.' + gObj.calc.lastadr_3 + '.' + gObj.calc.lastadr_4;
                        gObj.calc.checkIp.startIp = gObj.calc.startIp;
                        gObj.calc.checkIp.endIp = gObj.calc.endIp;
                        gObj.calc.checkIp.checkType = 'lanIp';
                        break;
                    default:
                        gObj.calc.startIp = gObj.calc.nwadr_1 + '.' + gObj.calc.nwadr_2 + '.' + gObj.calc.nwadr_3 + '.' + gObj.calc.nwadr_4;
                        gObj.calc.endIp = gObj.calc.bcast_1 + '.' + gObj.calc.bcast_2 + '.' + gObj.calc.bcast_3 + '.' + gObj.calc.bcast_4;
                        gObj.calc.checkIp.startIp = gObj.calc.startIp;
                        gObj.calc.checkIp.endIp = gObj.calc.endIp;
                        gObj.calc.checkIp.checkType = 'lanIp';
                    }

                    if (pass) {
                        var checker = interfaceIpChecker( tar.pid, tar.thisNo );
                        if (!checker.pass) {
                            pass = checker.pass;
                            msg += checker.msg;
                        }
                    }

                    switch(parseInt($('#dhcp_pool_settings-type').val()))
                    {
                    case 1:
                        if (gReg.ipv4.test($('#dhcp_pool_settings-1-startIp').val()) && gReg.ipv4.test($('#dhcp_pool_settings-1-endIp').val())) {
                            if (!dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() )) {
                                pass = false;
                                msg += '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>';
                            }
        
                            if (!dhcp_range( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() )) {
                                pass = false;
                                msg += '<p>' + gError[ gObj.lang ].ipRange + '</p>';
                            }
                        }else {
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                        }
        
                        if (!gReg.ipv4.test($('#dhcp_pool_settings-1-gateway').val())) {
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].dnsGateway + '</p>';
                        }
                        break;
                    case 2:
                        if (!gReg.ipv4.test($('#dhcp_pool_settings-2-relayIp').val())) {
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].ipDhcpRelay + '</p>';
                        }
                        break;
                    }
                } 
            }else {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].ipMask + '</p>';
            }
            break;
        case 'vlan_interfaces':
            if (tar.type == 'Create' && (!gReg.ascii.vlan.test( $('#basic_settings-name').val() ) || gCache.uniq[ tar.pid ][ $('#basic_settings-name').val()]) || parseInt( gCheck.status ) > 0 ) {
                pass = false;
                if ( parseInt( gCheck.status ) > 0 ) {
                    msg += '<p>' + gCheck.msg + '</p>';
                }
                msg += '<p>' + gError[ gObj.lang ].uniqName15 + '</p>';
            }
    
            if (gReg.vid.test( parseInt($('#basic_settings-vid').val()) ) ) {
                if ( gCache[ tar.pid ].interface[ $('#basic_settings-interface').val() ] && gCache[ tar.pid ].interface[ $('#basic_settings-interface').val() ].indexOf( parseInt( $('#basic_settings-vid').val() ) ) != -1 ) {
                    if (tar.type == 'Edit') {
                        if (!( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface == $('#basic_settings-interface').val() && parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vid ) == $('#basic_settings-vid').val())) {
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].uniqVid + '</p>';
                        }
                    }else {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].uniqVid + '</p>';
                    }
                }
            }else {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].uniqVid + '</p>';
            }
    
            if ($('#basic_settings-address').val().length > 0 || $('#basic_settings-netmask').val().length > 0) {
                if (gReg.ipv4.test($('#basic_settings-address').val()) && gReg.ipv4.test($('#basic_settings-netmask').val())) {
                    gObj.calc.targetIp = $('#basic_settings-address').val();
                    gObj.calc.targetNetmask = $('#basic_settings-netmask').val();
                    var arr = $('#basic_settings-address').val().split(gReg.isDot);
                    for (var i=0, ilen=arr.length; i<ilen; i++)
                        gObj.calc["ip_" + (i+1)] = parseInt(arr[i]);
    
                    arr = $('#basic_settings-netmask').val().split(gReg.isDot);
                    for (var i=0, ilen=arr.length; i<ilen; i++)
                        gObj.calc["snm_" + (i+1)] = parseInt(arr[i]);
    
                    calcNWbits(gObj.calc);
    
                    if (gObj.calc.result == 'invalid' || gObj.calc.numofaddr == 'ERR') {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                    } else {
                        gObj.calc.bits = gObj.calc.result;
                        calcNBFL(gObj.calc);
    
                        switch( gObj.calc.numofaddr )
                        {
                        case 'ERR':
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                            break;
                        case 'one':
                        case 'two':
                            gObj.calc.startIp = gObj.calc.firstadr_1 + '.' + gObj.calc.firstadr_2 + '.' + gObj.calc.firstadr_3 + '.' + gObj.calc.firstadr_4;
                            gObj.calc.endIp = gObj.calc.lastadr1 + '.' + gObj.calc.lastadr_2 + '.' + gObj.calc.lastadr_3 + '.' + gObj.calc.lastadr_4;
                            gObj.calc.checkIp.startIp = gObj.calc.startIp;
                            gObj.calc.checkIp.endIp = gObj.calc.endIp;
                            gObj.calc.checkIp.checkType = 'vlanIp';
                            break;
                        default:
                            gObj.calc.startIp = gObj.calc.nwadr_1 + '.' + gObj.calc.nwadr_2 + '.' + gObj.calc.nwadr_3 + '.' + gObj.calc.nwadr_4;
                            gObj.calc.endIp = gObj.calc.bcast_1 + '.' + gObj.calc.bcast_2 + '.' + gObj.calc.bcast_3 + '.' + gObj.calc.bcast_4;
                            gObj.calc.checkIp.startIp = gObj.calc.startIp;
                            gObj.calc.checkIp.endIp = gObj.calc.endIp;
                            gObj.calc.checkIp.checkType = 'vlanIp';
                        }

                        if (pass) {
                            var checker = interfaceIpChecker( tar.pid, tar.thisNo );
                            if (!checker.pass) {
                                pass = checker.pass;
                                msg += checker.msg;
                            }
                        }

                        switch(parseInt($('#dhcp_pool_settings-type').val()))
                        {
                        case 1:
                            if (gReg.ipv4.test($('#dhcp_pool_settings-1-startIp').val()) && gReg.ipv4.test($('#dhcp_pool_settings-1-endIp').val())) {
                                if (!dhcp_overlap( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() )) {
                                    pass = false;
                                    msg += '<p>' + gError[ gObj.lang ].dhcp_overlap + '</p>';
                                }
            
                                if (!dhcp_range( $('#basic_settings-address').val(), $('#basic_settings-netmask').val(), $('#dhcp_pool_settings-1-startIp').val(), $('#dhcp_pool_settings-1-endIp').val() )) {
                                    pass = false;
                                    msg += '<p>' + gError[ gObj.lang ].ipRange + '</p>';
                                }
                            }else {
                                pass = false;
                                msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                            }
            
                            if (!gReg.ipv4.test($('#dhcp_pool_settings-1-gateway').val())) {
                                pass = false;
                                msg += '<p>' + gError[ gObj.lang ].dnsGateway + '</p>';
                            }
                            break;
                        case 2:
                            if (!gReg.ipv4.test($('#dhcp_pool_settings-2-relayIp').val())) {
                                pass = false;
                                msg += '<p>' + gError[ gObj.lang ].ipDhcpRelay + '</p>';
                            }
                            break;
                        }
                    }
                }else {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipMask + '</p>';
                }
    
            }
    
            if (1 === parseInt($('input[name=mtuMode]:checked').val())) {
                if (!gReg.mtuValue.test( $('#basic_settings-mtuValue').val() )) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].mtuValue + '</p>';
                }
            }
    
            break;
        case 'zone':
            if ( !gReg.ascii.vlan.test( $('#editor-name').val() ) 
               || 
                 ( tar.type == 'Edit' && gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name != $('#editor-name').val() && gCache.uniq[ tar.pid ][ $('#editor-name').val() ] ) 
               ||
                 ( tar.type == 'Create' && gCache.uniq[ tar.pid ][ $('#editor-name').val() ] ) 
               ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].uniqName15 + '</p>';
            }
    
            if (!gReg.securityLevel.test( parseInt($('#editor-securityLevel').val()) ) ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].securityLevel + '</p>';
            }
            break;
        case 'multiwan_settings':
            if ($('#mode-0').is(':checked')) {
                if (!gReg.period.test($('#period').val())) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].detectionPeriod + '</p>';
                }
                if (!gReg.period.test($('#count').val())) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].detectionRelayCount + '</p>';
                }
            }
            break;
        }
    
        if (!pass) {
            errorAlert( msg );
        } else if (pass && gObj.calc.checkIp.checkType) {
            gIf.checkIp = true;
        }

        return pass;
    }

    function interfaceIpChecker(pid, thisNo ) {
        var checker = {};
        checker.pass = true;
        checker.msg = '';

        checker.tarIp = (gObj.calc.ip_1 << 24) + (gObj.calc.ip_2 << 16) + (gObj.calc.ip_3 << 8) + gObj.calc.ip_4;
        checker.tarMask = (gObj.calc.snm_1 << 24) + (gObj.calc.snm_2 << 16) + (gObj.calc.snm_3 << 8) + gObj.calc.snm_4;
        switch( pid )
        {
        case 'wan_settings':
            // wanIpIfT, staticipT, ipAliasT have same length
            for (var i=0; i<gData[ pid ].wanIpIfT.length; i++)
            {
                if (thisNo == i) {
                    // compare with self ip alias
                    checker.arrIp = gData[ pid ].ipAliasT[ thisNo ].address.split(';'); 
                    for (var j=0; j<checker.arrIp.length; j++)
                    {
                        if (gReg.isDigit.test(checker.arrIp[ j ])) {
                            if (checker.tarIp == gCache.ipAlias[ parseInt( checker.arrIp[ j ] ) ]) {
                                checker.pass = false;
                                gObj.calc.checkIp.conflictType = 'wanIfIpAlias';
                                checker.msg += '<p>' + gError[ gObj.lang ][ gObj.calc.checkIp.conflictType ] + '</p>';
                            }
                        }
                    }
                } else {
                    // compare with other ip, netmask
                    if ( 0 === parseInt( gData[ pid ].wanIpIfT[ i ].wanProto ) ) {
                        if (gObj.calc.targetIp == gData[ pid ].staticipT[ i ].ip) {
                            checker.pass = false;
                            gObj.calc.checkIp.conflictType = 'wanIfIp';
                            checker.msg += '<p>' + gError[ gObj.lang ][ gObj.calc.checkIp.conflictType ] + '</p>';
                        } else { 
                            checker.arrIp    = gData[ pid ].staticipT[ i ].ip.split('.');
                            checker.arrMask  = gData[ pid ].staticipT[ i ].netmask.split('.');
                            checker.compIp   = (checker.arrIp[ 0 ] << 24) + (checker.arrIp[ 1 ] << 16) + (checker.arrIp[ 2 ] << 8) + checker.arrIp[ 3 ];
                            checker.compMask = (checker.arrMask[ 0 ] << 24) + (checker.arrMask[ 1 ] << 16) + (checker.arrMask[ 2 ] << 8) + checker.arrMask[ 3 ];

                            if ( (checker.tarIp & checker.tarMask & checker.compMask) == (checker.compIp & checker.compMask & checker.tarMask) ) {
                                checker.pass = false;
                                gObj.calc.checkIp.conflictType = 'wanIfNetwork';
                                checker.msg += '<p>' + gError[ gObj.lang ][ gObj.calc.checkIp.conflictType ] + '</p>';
                            }
                        }
                    }
                    // compare with other alias
                    checker.arrIp = gData[ pid ].ipAliasT[ i ].address.split(';'); 
                    checker.arrMask = gData[ pid ].ipAliasT[ i ].netmask.split(';'); 
                    for (var j=0; j<checker.arrIp.length; j++)
                    {
                        if (gReg.isDigit.test(checker.arrIp[ j ])) {
                            checker.arrIpArr = gCache.ipAlias[ parseInt( checker.arrIp[ j ] ) ].split('.');
                            checker.arrMaskArr = checker.arrMask[ j ].split('.');
                            checker.compIp   = (parseInt(checker.arrIpArr[ 0 ]) << 24) + (parseInt(checker.arrIpArr[ 1 ]) << 16) + (parseInt(checker.arrIpArr[ 2 ]) << 8) + parseInt(checker.arrIpArr[ 3 ]);
                            checker.compMask = (parseInt(checker.arrMaskArr[ 0 ]) << 24) + (parseInt(checker.arrMaskArr[ 1 ]) << 16) + (parseInt(checker.arrMaskArr[ 2 ]) << 8) + (checker.arrMaskArr[ 3 ]);
                            if ( (checker.tarIp & checker.tarMask & checker.compMask) == (checker.comIp & checker.compMask & checker.tarMask) ) {
                                checker.pass = false;
                                gObj.calc.checkIp.conflictType = 'wanIfIpAliasNetwork';
                                checker.msg += '<p>' + gError[ gObj.lang ][ gObj.calc.checkIp.conflictType ] + '</p>';
                            }
                        }
                    }
                }
            }
            break;
        default:
            checker.conflict = ('ports' == pid)? 'port' : ( ('lan' == pid)? 'lan' : 'vlan' );
            for (var i=0; i<gData[ pid ][ gNode.guiTNum ]; i++)
            {
                if (thisNo == i) {
                    // compare with self ip alias
                    checker.arrIp = gData[ pid ].guiIpAliasT[ thisNo ].address.split(';'); 
                    for (var j=0; j<checker.arrIp.length; j++)
                    {
                        if (gReg.isDigit.test(checker.arrIp[ j ])) {
                            if (checker.tarIp == gCache.ipAlias[ parseInt( checker.arrIp[ j ] ) ]) {
                                checker.pass = false;
                                gObj.calc.checkIp.conflictType = checker.conflict + 'IfIpAlias';
                                checker.msg += '<p>' + gError[ gObj.lang ][ gObj.calc.checkIp.conflictType ] + '</p>';
                            }
                        }
                    }
                } else if ( gReg.ipv4.test( gData[ pid ][ gNode.guiT ][ i ].address ) ) {
                    // compare with other ip, netmask
                    if (gObj.calc.targetIp == gData[ pid ][ gNode.guiT ][ i ].address) {
                        checker.pass = false;
                        gObj.calc.checkIp.conflictType = checker.conflict + 'IfIp';
                        checker.msg += '<p>' + gError[ gObj.lang ][ gObj.calc.checkIp.conflictType ] + '</p>';
                    } else {
                        checker.arrIp    = gData[ pid ][ gNode.guiT ][ i ].address.split('.');
                        checker.arrMask  = gData[ pid ][ gNode.guiT ][ i ].netmask.split('.');
                        checker.compIp   = (checker.arrIp[ 0 ] << 24) + (checker.arrIp[ 1 ] << 16) + (checker.arrIp[ 2 ] << 8) + checker.arrIp[ 3 ];
                        checker.compMask = (checker.arrMask[ 0 ] << 24) + (checker.arrMask[ 1 ] << 16) + (checker.arrMask[ 2 ] << 8) + checker.arrMask[ 3 ];

                        if ( (checker.tarIp & checker.tarMask & checker.compMask) == (checker.compIp & checker.compMask & checker.tarMask) ) {
                            checker.pass = false;
                            gObj.calc.checkIp.conflictType = checker.conflict + 'IfNetwork';
                            checker.msg += '<p>' + gError[ gObj.lang ][ gObj.calc.checkIp.conflictType ] + '</p>';
                        }
                    }

                    // compare with other alias
                    checker.arrIp = gData[ pid ].guiIpAliasT[ i ].address.split(';'); 
                    checker.arrMask = gData[ pid ].guiIpAliasT[ i ].netmask.split(';'); 

                    for (var j=0; j<checker.arrIp.length; j++)
                    {
                        if (gReg.isDigit.test(checker.arrIp[ j ])) {
                            checker.arrIpArr = gCache.ipAlias[ parseInt( checker.arrIp[ j ] ) ].split('.');
                            checker.arrMaskArr = checker.arrMask[ j ].split('.');
                            checker.compIp   = (parseInt(checker.arrIpArr[ 0 ]) << 24) + (parseInt(checker.arrIpArr[ 1 ]) << 16) + (parseInt(checker.arrIpArr[ 2 ]) << 8) + parseInt(checker.arrIpArr[ 3 ]);
                            checker.compMask = (parseInt(checker.arrMaskArr[ 0 ]) << 24) + (parseInt(checker.arrMaskArr[ 1 ]) <<  16) + (parseInt(checker.arrMaskArr[ 2 ]) << 8) + (checker.arrMaskArr[ 3 ]);
                            if ( (checker.tarIp & checker.tarMask & checker.compMask) == (checker.comIp & checker.compMask & checker.tarMask) ) {
                                checker.pass = false;
                                gObj.calc.checkIp.conflictType = checker.conflict + 'IfIpAliasNetwork';
                                checker.msg += '<p>' + gError[ gObj.lang ][ gObj.calc.checkIp.conflictType ] + '</p>';
                            }
                        }
                    }
                }
            }
        }

        return checker;

    }

    function deleteInterface(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        tar.thisNo = tar.id.split(gReg.isDash)[2];
    
        switch( tar.pid )
        {
        case 'wan_settings':
            gCache.wan.wan[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
            if (gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName ]) {
                gCache.wan.wanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = false;
                gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName ] = false;
            }
            delete gCache.wan.portId[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].portId ) ]; 
    
            for (var i=0, len=gData[ tar.pid ][ gNode.guiT ].length; i<len; i++)
            {   
                if (gData[ tar.pid ][ gNode.guiT ][ i ].backupWanName == gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name) {
                    gCache.wan.wanName[ gData[ tar.pid ][ gNode.guiT ][ i ].name ] = false;
                    gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ i ].backupWanName ] = false;
                    gData[ tar.pid ][ gNode.guiT ][ i ].backupWanName = "";
                    gData[ tar.pid ][ gNode.guiT ][ i ].failoverEnable = 0;
                    if (parseInt( gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction ) == 0) { 
                        gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction = 2;
                    }   
                }   
            }   
    
            if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0 ) {
                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 3;
            }else {
                gData[ tar.pid ][ gNode.guiT ].splice( tar.thisNo, 1);
                gData[ tar.pid ][ gNode.aliasT ].splice( tar.thisNo, 1);
                gData[ tar.pid ][ gNode.staticipT] .splice( tar.thisNo, 1);
                gData[ tar.pid ][ gNode.dhcpT ].splice( tar.thisNo, 1);
                gData[ tar.pid ][ gNode.pppoecT ].splice( tar.thisNo, 1);
                gData[ tar.pid ][ gNode.staticip6T ].splice( tar.thisNo, 1);
            }
            break;
        case 'lan':
            delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
            delete gCache[ tar.pid ].interfaces[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ];
    
            if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0 ) {
                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 3;
            }else {
                gData[ tar.pid ][ gNode.guiTNum ]--;
                gData[ tar.pid ][ gNode.guiT ].splice(tar.thisNo,1);
                gData[ tar.pid ][ gNode.aliasTNum ]--;
                gData[ tar.pid ][ gNode.aliasT ].splice(tar.thisNo,1);
                gData[ tar.pid ][ gNode.dhcpTNum ]--;
                gData[ tar.pid ][ gNode.dhcpT ].splice(tar.thisNo,1);
            }
            break;
        case 'vlan_interfaces':
            delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
            gCache[ tar.pid ].interface[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ].splice( gCache[ tar.pid ].interface[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ].indexOf( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vid ) ), 1);
            if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0 ) {
                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 3;
            }else {
                gData[ tar.pid ][ gNode.guiTNum ]--;
                gData[ tar.pid ][ gNode.guiT ].splice(tar.thisNo,1);
                gData[ tar.pid ][ gNode.aliasTNum ]--;
                gData[ tar.pid ][ gNode.aliasT ].splice(tar.thisNo,1);
                gData[ tar.pid ][ gNode.dhcpTNum ]--;
                gData[ tar.pid ][ gNode.dhcpT ].splice(tar.thisNo,1);
            }
            break;
        case 'zone':
            delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
    
            if ( gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ] ) {
                for (var i=0, len=gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ].length; i<len; i++)
                {
                    if (!isNaN( parseInt( gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ][ i ] ) )) {
                        if (gCache.wans[ parseInt( gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ][ i ] ) ]) {
                            gCache[ tar.pid ].member[ gCache[ tar.pid ].wanId ].push( gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ][ i ] );
                        }else {
                            gCache[ tar.pid ].member[ gCache[ tar.pid ].lanId ].push( gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ][ i ] );
                        }
                    }
                }
                delete gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ];
            }
    
            if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0 ) {
                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 3;
            }else {
                gData[ tar.pid ][ gNode.guiTNum ]--;
                gData[ tar.pid ][ gNode.guiT ].splice(tar.thisNo,1);
            }
            break;
        }
    
        refreshInterface( tar.pid );
    }
    
    function removeInterface(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        $('#table-' + tar.pid + ' tr').each(function() {
            tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
            switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
            {
            case true:
    
                switch(tar.pid)
                {
                case 'wan_settings':
                    gCache.wan.wan[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
                    if (gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName ]) {
                        gCache.wan.wanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = false;
                        gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupWanName ] = false;
                    }
                    delete gCache.wan.portId[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].portId ) ]; 
    
                    for (var i=0, len=gData[ tar.pid ][ gNode.guiT ].length; i<len; i++)
                    {
                        if (gData[ tar.pid ][ gNode.guiT ][ i ].backupWanName == gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name) {
                            gCache.wan.wanName[ gData[ tar.pid ][ gNode.guiT ][ i ].name ] = false;
                            gCache.wan.backupWanName[ gData[ tar.pid ][ gNode.guiT ][ i ].backupWanName ] = false;
                            gData[ tar.pid ][ gNode.guiT ][ i ].backupWanName = "";
                            gData[ tar.pid ][ gNode.guiT ][ i ].failoverEnable = 0;
                            if (parseInt( gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction ) == 0) {
                                gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction = 2;
                            }
                        }
                    }
                    break;
                case 'lan':
                    delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
                    delete gCache[ tar.pid ].interfaces[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ];
                    break;
                case 'vlan_interfaces':
                    delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
                    gCache[ tar.pid ].interface[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ].splice( gCache[ tar.pid ].interface[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interface ].indexOf( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vid ) ), 1);
                    break;
                case 'zone':
                    delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
    
                    if ( gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ] ) {
                        for (var i=0, len=gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ].length; i<len; i++) 
                        {
                            if (gCache.wans[ parseInt( gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ][ i ] ) ]) {
                                gCache[ tar.pid ].member[ gCache[ tar.pid ].wanId ].push( gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ][ i ] );
                            }else {
                                gCache[ tar.pid ].member[ gCache[ tar.pid ].lanId ].push( gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ][ i ] );
                            }
                        }
                        delete gCache[ tar.pid ].member[ parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid ) ];
                    }
                    break;
                }
    
                // row 
                if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0 ) {
                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 3;
                }else {
                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = -1;
                }
                break;
            }
        });
    
        tar.guiT  = [];
    
        switch( tar.pid )
        {
        case 'wan_settings':
            tar.aliasT = [];
            tar.dhcpT = [];
            tar.pppoecT = [];
            tar.staticipT = [];
            tar.staticip6T = [];
            for (var i=0, len=gData[ tar.pid ][ gNode.guiT ].length; i<len; i++)
            {
                if (gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction == -1)
                    continue;
                tar.guiT.push( gData[ tar.pid ][ gNode.guiT ][ i ] );
                tar.aliasT.push( gData[ tar.pid ][ gNode.aliasT ][ i ] );
                tar.dhcpT.push( gData[ tar.pid ][ gNode.dhcpT ][ i ] );
                tar.pppoecT.push( gData[ tar.pid ][ gNode.pppoecT ][ i ] );
                tar.staticipT.push( gData[ tar.pid ][ gNode.staticipT ][ i ] );
                tar.staticip6T.push( gData[ tar.pid ][ gNode.staticip6T ][ i ] );
            }
            gData[ tar.pid ][ gNode.guiT ] = tar.guiT;
            gData[ tar.pid ][ gNode.aliasT ] = tar.aliasT;
            gData[ tar.pid ][ gNode.dhcpT ] = tar.dhcpT;
            gData[ tar.pid ][ gNode.pppoecT ] = tar.pppoecT;
            gData[ tar.pid ][ gNode.staticipT ] = tar.staticipT;
            gData[ tar.pid ][ gNode.staticip6T ] = tar.staticip6T;
            break;
        case 'lan':
            tar.aliasT = [];
            tar.dhcpT = [];
    
            for (var i=0, len=gData[ tar.pid ][ gNode.guiTNum ]; i<len; i++)
            {
                if (gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction == -1)
                    continue;
                tar.guiT.push( gData[ tar.pid ][ gNode.guiT ][ i ] );
                tar.aliasT.push( gData[ tar.pid ][ gNode.aliasT ][ i ] );
                tar.dhcpT.push( gData[ tar.pid ][ gNode.dhcpT ][ i ] );
            }
            gData[ tar.pid ][ gNode.guiT ] = tar.guiT;
            gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
            gData[ tar.pid ][ gNode.aliasT ] = tar.aliasT;
            gData[ tar.pid ][ gNode.aliasTTNum ] = gData[ tar.pid ][ gNode.aliasT ].length;
            gData[ tar.pid ][ gNode.dhcpT ] = tar.dhcpT;
            gData[ tar.pid ][ gNode.dhcpTNum ] = gData[ tar.pid ][ gNode.dhcpT ].length;
            break;
        case 'vlan_interfaces':
            tar.aliasT = [];
            tar.dhcpT = [];
        
            for (var i=0, len=gData[ tar.pid ][ gNode.guiTNum ]; i<len; i++)
            {
                if (gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction == -1)
                    continue;
                tar.guiT.push( gData[ tar.pid ][ gNode.guiT ][ i ] );
                tar.aliasT.push( gData[ tar.pid ][ gNode.aliasT ][ i ] );
                tar.dhcpT.push( gData[ tar.pid ][ gNode.dhcpT ][ i ] );
            }
            gData[ tar.pid ][ gNode.guiT ] = tar.guiT;
            gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
            gData[ tar.pid ][ gNode.aliasT ] = tar.aliasT;
            gData[ tar.pid ][ gNode.aliasTTNum ] = gData[ tar.pid ][ gNode.aliasT ].length;
            gData[ tar.pid ][ gNode.dhcpT ] = tar.dhcpT;
            gData[ tar.pid ][ gNode.dhcpTNum ] = gData[ tar.pid ][ gNode.dhcpT ].length;
            break;
        case 'zone':
            for (var i=0, len=gData[ tar.pid ][ gNode.guiTNum ]; i<len; i++)
            {
                if (gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction == -1)
                    continue;
                tar.guiT.push( gData[ tar.pid ][ gNode.guiT ][ i ] );
            }
            gData[ tar.pid ][ gNode.guiT ] = tar.guiT;
            gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
            break;
        }
        refreshInterface( tar.pid );
    }
    
    function saveInterface(pid) {
    
        switch(pid)
        {
        case 'ports':
            for (var i=0, len=gData[ pid ][ gNode.reservT ].length; i<len; i++) 
            {
                if (gData[ pid ][ gNode.reservT ][ i ].gid < 0)
                    gData[ pid ][ gNode.reservT ][ i ].gid = 0;
            }
            break;
        case 'lan':
            for (var i=0, len=gData[ pid ][ gNode.reservT ].length; i<len; i++)
            {
                if (gData[ pid ][ gNode.reservT ][ i ].gid < 0) {
                    for (var j=0; j<gData[ pid ][ gNode.guiTNum ]; j++)
                    {
                        if ((parseInt( gData[ pid ][ gNode.guiT ][ j ].gid ) < 0) && (gData[ pid ][ gNode.reservT ][ i ].ifId == gData[ pid ][ gNode.guiT ][ j ].gid)) {
                            gData[ pid ][ gNode.reservT ][ i ].ifId = "";
                            gData[ pid ][ gNode.reservT ][ i ].refIfName = gData[ pid ][ gNode.guiT ][ j ].name;
                        }
                    }
                    gData[ pid ][ gNode.reservT ][ i ].gid = 0;
                }
            }

            for (var i=0, len=parseInt(gData[ pid ][ gNode.guiTNum ]); i<len; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) == 3) 
                    continue;
                
                gData[ pid ][ gNode.guiT ][ i ].interfaces = gCache[ pid ].interfaces[ gData[ pid ][ gNode.guiT ][ i ].gid ].join(';');

                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) < 0) 
                    gData[ pid ][ gNode.guiT ][ i ].gid = 0;
    
                if ( gCache[ pid ].cache[ gData[ pid ][ gNode.guiT ][ i ].gid ] && gCache[ pid ].interfaces[ gData[ pid ][ gNode.guiT ][ i ].gid ] ) {
                    // existing
                    if ( gCache[ pid ].cache[ gData[ pid ][ gNode.guiT ][ i ].gid ].length == gCache[ pid ].interfaces[ gData[ pid ][ gNode.guiT ][ i ].gid ].length ) {
                        for (var j=0, jlen=gCache[ pid ].cache[ gData[ pid ][ gNode.guiT ][ i ].gid ].length; j<jlen; j++)
                        {
                            if ( gCache[ pid ].cache[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ][ j ] != gCache[ pid ].interfaces[ gData[ pid ][ gNode.guiT ][ i ].gid ][ j ] ) {
                                gData[ pid ][ gNode.guiT ][ i ].cgiAction = 2;
                                break;
                            }
                        }
                    }else {
                        gData[ pid ][ gNode.guiT ][ i ].cgiAction = 2;
                    }
                }
            }
            break;
        case 'vlan_interfaces':
            for (var i=0, len=gData[ pid ][ gNode.reservT ].length; i<len; i++)
            {
                if (gData[ pid ][ gNode.reservT ][ i ].gid < 0) {
                    for (var j=0; j<gData[ pid ][ gNode.guiTNum ]; j++)
                    {
                        if ((gData[ pid ][ gNode.guiT ][ j ].gid < 0) && (gData[ pid ][ gNode.reservT ][ i ].ifId == gData[ pid ][ gNode.guiT ][ j ].gid)) {
                            gData[ pid ][ gNode.reservT ][ i ].ifId = "";
                            gData[ pid ][ gNode.reservT ][ i ].refIfName = gData[ pid ][ gNode.guiT ][ j ].name;
                        }
                    }
                    gData[ pid ][ gNode.reservT ][ i ].gid = 0;
                }
            }

            for (var i=0, len=parseInt(gData[ pid ][ gNode.guiTNum ]); i<len; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) == 3) 
                    continue;
                
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) < 0) {
                    gData[ pid ][ gNode.guiT ][ i ].gid = 0; 
                }
            }
            break;
        case 'zone':
            for (var i=0, len=parseInt(gData[ pid ][ gNode.guiTNum ]); i<len; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) == 3) {
                    continue;
                }
                
                if ( gCache[ pid ].cache[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ] && gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ] ) {
                    // existing 
                    if ( gCache[ pid ].cache[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ].length == gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ].length ) {
                        for (var j=0, jlen=gCache[ pid ].cache[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ].length; j<jlen; j++)
                        {
                            if ( gCache[ pid ].cache[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ][ j ] != gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ][ j ] ) {
                                gData[ pid ][ gNode.guiT ][ i ].cgiAction = 2;
                                break;
                            }
                        }
                    }else {
                        gData[ pid ][ gNode.guiT ][ i ].cgiAction = 2;
                    }
                }
    
                if (gCache[ pid ].vpnId === parseInt( gData[ pid ][ gNode.guiT ][ i ].gid )) {
                    gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ] = gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ].concat( gCache[ pid ].vpn );
                }
    
                gData[ pid ][ gNode.guiT ][ i ].member = gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ].join(';');
                gData[ pid ][ gNode.guiT ][ i ].memberCnt = gCache[ pid ].member[ parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) ].length;
    
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) < 0) {
                    gData[ pid ][ gNode.guiT ][ i ].gid = 0; 
                }
            }
            break;
        case 'wan_settings':
            for (var i=0; i<gData[ pid ][ gNode.guiT ].length; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) == 3) {
                    continue;
                }
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) < 0) {
                    gData[ pid ][ gNode.guiT ][ i ].gid = 0; 
                }
            }
            break;
        case 'default_dns_settings':
            if (interfaceChecker(null, pid)) {
                gData[ pid ].defaultDNS1 = $('#defaultDNS1').val();
                gData[ pid ].defaultDNS2 = $('#defaultDNS2').val();
            } else {
                return false;
            }
            break;
        case 'multiwan_settings':
            if (interfaceChecker(null, pid)) {
    
                if ($('#mode-0').is(':checked')) {
                    gData[ pid ].mode = 0;
                    gData[ pid ].period = $('#period').val();
                    gData[ pid ].count = $('#count').val();
                    gIf.rtMode = false;
                } else {
                    gData[ pid ].mode = 1;
                    gIf.rtMode = true;
                }
            } else {
                return false;
            }
            break;
        }
    
        loadingToggle( true );
        $.post('cgi-bin/' + (('object' === typeof gNode.url.post)? gNode.url.post[ pid ] : gNode.url.post) + '.cgi', gY.JSON.stringify(gData[ pid ]), function( poster ) {
            gIf.alter = false;
            if (parseInt(poster.status) == 0) {
                if (poster.duration) {
                    gObj.loading = poster.duration;
                    gIf.loading = true;
                } else {
                    loadingToggle( false );
                    getCgiList(gObj.active.pid);
                }
            }else {
                loadingToggle( false );
                if (!$('#popPlus').exists())
                    $('#popBase').append('<div id="popPlus"></div>');
                $('#popPlus').html('<div class="plusForm"><p class="plusMsg"></p></div>');
                $('#popPlus').dialog({
                    width: 300,
                    height:200,
                    position: "center",
                    resizable: false,
                    modal: true,
                    buttons: {
                        Ok: function() {
                            $( this ).dialog( "close" );
                        },
                        Cancel: function() {
                            $( this ).dialog( "close" );
                        }
                    },
                    close: function(event, ui) {
                        $(this).dialog('destroy').remove();
                    }
                });
                switch(parseInt(poster.status))
                {
                default:
                    $('.plusMsg').html( poster.msg );
                }
            }
        });
    }
    
    function genNetworking(pid) {
        var tmp = '';
    
        switch(gNode.ext)
        {
        case 'cgi':
            switch(gNode.tag)
            {
            case 'div':
                switch(gNode.type)
                {
                case 'form':
                    if (gIf.power) {
                        $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                        gY.one('#pgSave').on('click', function(e) {
                            saveNetworking(pid);
                        });
                    };
    
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div id="div-' + pid + '"></div></div>');
    
                    $.ajax({
                        url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                        dataType: 'json',
                        success: function(data) {
                            gData[ pid ] = data;
                            gData[ gNode.url.get ] = data;
                            switch( pid )
                            {
                            case 'routing':
                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    tmp += '<div id="div-' + gNode.col[ i ].tab + '">';
                                    tmp += '<ul>';
                                    tmp += '<li><h2>' + gNode.col[ i ].label + '</h2></li>';
                                    for (var x in gNode.col[ i ].option)
                                    {
                                        tmp += '<li><span><input type="radio" name="' + gNode.col[ i ].tab + '" id="' + gNode.col[ i ].tab + '-' + x + '" value="' + x + '" />&nbsp;<label for="' + gNode.col[ i ].tab + '-' + x + '">' + gNode.col[ i ].option[ x ] + '</label></span></li>';
                                    }
                                    tmp += '</ul>';
                                    tmp += '</div>';
                                }

                                $('#div-' + pid).html( tmp );
    
                                $('input[name=routeMode]').each( function() {
                                    if ( parseInt($(this).val()) == parseInt(data.routeMode) )
                                        $(this).click();
                                });
    
                                $('input[name=protoType]').each( function() {
                                    if ( parseInt($(this).val()) == parseInt(data.protoType) )
                                        $(this).click();
                                });

                                if (!gIf.power) {
                                    $('input[name=routeMode]').prop('disabled', true);
                                    $('input[name=protoType]').prop('disabled', true);
                                }

                                break;
                            }
                        }
                    });
                    break;
                }
                break;
            case 'table':
                switch(gNode.type)
                {
                case 'table':
                    if (gIf.power) {
                        $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                        gY.one('#pgSave').on('click', function(e) {
                            saveNetworking(pid);
                        });
                    };
    
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"></div>');
    
                    // cache for name 
                    gCache.uniq[ pid ] = {};
                    gCache[ pid ] = {};
                    gCache[ pid ].gid = 0;
    
                    if ('static_routing' == pid) {
                        gCache[ pid ].dstIpId = [];
                        gIf.hasDefaultRt = false;
                        gIf.wasDefaultRt = false;
                        gIf.isDefaultRt = false;
                    }
    
                    $.ajax({
                        url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                        dataType: 'json',
                        success: function(data) {
                            gData[ pid ] = data;
                            gData[ gNode.url.get ] = data;
    
                            gObj.btn = gNode.rowAction.split(' ');
                            tmp = '<div id="div-' + pid + '" class="tableDiv">';
                            tmp += '<table id="table-' + pid + '" class="' + gNode.tblAction + '">';
                            tmp += '<thead>';
                            tmp += '<tr>';
                            for (var i=0, len=gNode.col.length; i<len; i++)
                            {
                                tmp += '<th id="' + pid + '-' + gNode.col[ i ].tab + '" class="ui-state-default" style="width: ' + gNode.col[ i ].wiz + '">';
                                tmp += gNode.col[ i ].label;
                                tmp += '</th>';
                            }
    
                            tmp += '</thead>';
                            tmp += '<tbody></tbody>';
                            tmp += '</div>';
                            $('.templateDiv').append(tmp);
    
                            for (var i=0, len=parseInt(data[ gNode.guiTNum ]); i<len; i++)
                            {
                                tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                for (var j=0, jlen=gNode.col.length; j<jlen; j++) 
                                {
                                    switch (gNode.col[ j ].tab)
                                    {
                                    case 'checkbox':
                                        tmp += '<td>';
                                        if (parseInt( data[ gNode.guiT ][ i ].userDefined ) != 0 && gIf.power) {
                                            tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ j ].tab + '-' + i + '" />';
                                        } else {
                                            tmp += '';
                                        }
                                        tmp += '</td>';
                                        break;
                                    case 'action':
                                        tmp += '<td>'; 
                                        if (gIf.power) {
                                            for (var k=0, klen=gObj.btn.length; k<klen; k++)
                                            {
                                                if ( !( 'Delete' === gObj.btn[ k ] && 0 === parseInt( data[ gNode.guiT ][ i ].userDefined ) ) ) {
                                                    tmp += '<button class="' + gObj.btn[ k ] + '" id="' + gObj.btn[ k ] + '-' + pid + '-' + i + '" title="' + gObj.btn[ k ] + '"><span class="ui-icon" ></span></button>';
                                                }
                                            }
                                        } else {
                                            tmp += '';
                                        }
                                        tmp += '</td>';
                                        break;
                                    case 'destinatedNetwork':
                                        tmp += '<td id="' + gNode.col[ j ].tab + '-' + i + '">'; 
                                        if (1 === parseInt( data[ gNode.guiT ][ i ].isDefaultRt )) {
                                            tmp += 'default' ;
                                            gIf.hasDefaultRt = true;
                                        } else {
                                            tmp += gCache.address[ parseInt( data[ gNode.guiT ][ i ].dstIpId ) ];
                                            gCache[ pid ].dstIpId.push( parseInt( data[ gNode.guiT ][ i ].dstIpId ) );
                                        }
                                        tmp += '</td>'; 
                                        break;
                                    case 'nextHop':
                                        tmp += '<td id="' + gNode.col[ j ].tab + '-' + i + '">'; 
                                        switch( parseInt(data[ gNode.guiT ][ i ].nhType) )
                                        {
                                        case 0:
                                            tmp += gCache.name[ parseInt( data[ gNode.guiT ][ i ].nhIfId ) ];
                                            break;
                                        case 1:
                                            tmp += gCache.address[ parseInt( data[ gNode.guiT ][ i ].nhIpId ) ];
                                            break;
                                        }
                                        tmp += '</td>';
                                        break;
                                    case 'cipher':
                                    case 'hash':
                                    case 'dhgroup':
                                    case 'pfsgroup':
                                        tmp += '<td id="' + gNode.col[ j ].tab + '-' + i + '">' + gRef[ gNode.url.get ][ gNode.col[ j ].tab ][ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] + '</td>';
                                        break;
                                    case 'name':
                                        gCache.uniq[ pid ][ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] = true;
                                        tmp += '<td id="' + gNode.col[ j ].tab + '-' + i + '">' + data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] + '</td>'; 
                                        break;
                                    default:
                                        tmp += '<td id="' + gNode.col[ j ].tab + '-' + i + '">' + data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] + '</td>'; 
                                    }
                                }
                                tmp += '</tr>';
                                $('#table-' + pid + ' tbody').append(tmp);
                            }
                            if (gIf.power) {
                                if (gNode.tblAction)
                                    genTblAction( pid );
                                if ( gLimit[ gNode.url.get ] ) {
                                    if ( parseInt( data[ gNode.guiTNum ] ) < parseInt( gLimit[ gNode.url.get ].rows ) )
                                        $('#Create-' + pid).prop('disabled', false);
                                    else 
                                        $('#Create-' + pid).prop('disabled', true);
                                }
                            }
                        }
                    });
                    break;
                case 'tables':
                    if (gIf.power) {
                        $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                        gY.one('#pgSave').on('click', function(e) {
                            saveNetworking(pid);
                        });
                    };
                    gCache.uniq[ pid ] = {};
                    gCache[ pid ] = {};
                    gCache[ pid ].gid = 0;
        
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"></div>');
                    $.ajax({
                        url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                        dataType: 'json',
                        success: function(data) {
                            gData[ pid ] = data;

                            switch(pid)
                            {
                            case 'dns_forwarder':
                                gObj.btn = gNode.rowAction.split(' ');
                                tmp = '<div id="div-' + pid + '" class="tableDiv">';
                                tmp += '<table id="table-' + pid + '" class="' + gNode.tblAction + '">';
                                tmp += '<thead>';
                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    tmp += '<tr>';
                                    if ('general_configuration' == gNode.col[ i ].tab) {
                                        tmp += '<td colspan="3">';
                                        tmp += '<div id="div-' + pid + '-' + gNode.col[ i ].tab + '">';
                                        tmp += '<table id="table-' + pid + '-' + gNode.col[ i ].tab + '">';
                                        for (var j=0, jlen=gNode.col[ i ].col.length; j<jlen; j++)
                                        {
                                            tmp += '<tr>';
                                            tmp += '<th class="alignLeft BT100">';
                                            tmp += gNode.col[ i ].col[ j ].label;
                                            tmp += '</th>';
                                            tmp += '<td class="alignLeft">';
                                            if ('radio' == gNode.col[ i ].col[ j ].type) {
                                                for (var x in gNode.col[ i ].col[ j ].option)
                                                {
                                                    tmp += '<input type="radio" name="' + gNode.col[ i ].col[ j ].tab + '" id="' + pid + '-' + gNode.col[ i ].col[ j ].tab + '-' + x + '" value="' + x + '" />&nbsp;<label for="' + pid + '-' + gNode.col[ i ].col[ j ].tab + '-' + x + '">' + gNode.col[ i ].col[ j ].option[ x ] + '</label>&nbsp;' ;
                                                }
                                            } else {
                                                tmp += '<input type="text" id="' + pid + '-' + gNode.col[ i ].col[ j ].tab + '" />';
                                            }
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                        }
                                        tmp += '</table>';
                                        tmp += '</div>';
                                        tmp += '</td>';
                                    } else {
                                        for (var j=0, jlen=gNode.col[ i ].col.length; j<jlen; j++)
                                        {
                                            tmp += '<th class="ui-state-default" style="width:' + gNode.col[ i ].col[ j ].wiz + '">';
                                            tmp += gNode.col[ i ].col[ j ].label;
                                            tmp += '</th>';
                                        }
                                    }
                                    tmp += '</tr>';
                                }
                                tmp += '</thead>';
                                tmp += '<tbody>';
                                tmp += '</tbody>';
                                tmp += '</table>';
                                tmp += '</div>';
                                $('.templateDiv').append(tmp);
                                
                                
                                $('input[name=enableCache]').change( function() {
                                    switch(parseInt( $(this).val() ))
                                    {
                                    case 0:
                                        $('#' + pid + '-cacheSize').prop('disabled', true);
                                        break;
                                    case 1:
                                        $('#' + pid + '-cacheSize').prop('disabled', false);
                                        break;
                                    }
                                });

                                $('input[name=enableStaticDNS]').change( function() {
                                    switch(parseInt( $(this).val() ))
                                    {
                                    case 0:
                                        $('#table-' + pid + ' button').prop('disabled', true); 
                                        $('#Create-' + pid).prop('disabled', true); 
                                        $('#Remove-' + pid).prop('disabled', true); 
                                        break;
                                    case 1:
                                        $('#table-' + pid + ' button').prop('disabled', false); 
                                        $('#Create-' + pid).prop('disabled', false); 
                                        $('#Remove-' + pid).prop('disabled', false); 
                                        break;
                                    }
                                });

                                for (var i=0, len=data[ gNode.guiT ].length; i<len; i++)
                                {
                                    tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                    for (var j=0, jlen=gNode.col[ 1 ].col.length; j<jlen; j++)
                                    {
                                        tmp += '<td>';
                                        if ('action' == gNode.col[ 1 ].col[ j ].tab) {
                                            if (gIf.power) {
                                                for (var z=0, zlen=gObj.btn.length; z<zlen; z++)
                                                {
                                                    tmp += '<button class="' + gObj.btn[ z ] + '" id="' + gObj.btn[ z ] + '-' + pid + '-' + i + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon" ></span></button>';
                                                }
                                            } else {
                                                tmp += '';
                                            }
                                        } else if ( 'index' == gNode.col[ 1 ].col[ j ].tab ) {
                                            if (gIf.power) {
                                                tmp += '<input type="checkbox" id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '" value="' + i + '" />';
                                            } else {
                                                tmp += '';
                                            }
                                        } else {
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ];
                                        }
                                        tmp += '</td>';
                                    }
                                    tmp += '</tr>';
                                    $('#table-' + pid + ' > tbody').append( tmp );
                                }

                                if (gReg.cacheSize.test( data.cacheSize ))
                                    $('#' + pid + '-cacheSize').val( data.cacheSize );
                                else
                                    $('#' + pid + '-cacheSize').val( 5000 );

                                if (1 === parseInt( data.enableCache ))
                                    $('#' + pid + '-enableCache-1').click().trigger('change');
                                else
                                    $('#' + pid + '-enableCache-0').click().trigger('change');

                                if ( gIf.power ) {
                                    genTblAction( pid );
                                
                                    if ( gLimit[ gNode.url.get ] ) {
                                        if ( parseInt( data[ gNode.guiT ].length ) < parseInt( gLimit[ gNode.url.get ].rows ) )
                                            $('#Create-' + pid).prop('disabled', false);
                                        else
                                            $('#Create-' + pid).prop('disabled', true);
                                    }

                                    if (1 === parseInt( data.enableStaticDNS ))
                                        $('#' + pid + '-enableStaticDNS-1').click().trigger('change');
                                    else
                                        $('#' + pid + '-enableStaticDNS-0').click().trigger('change');
                                } else {
                                    $('#table-' + pid + ' input').prop('disabled', true);
                                }

                                break;
                            case 'ipsec_policies':
                                gData[ gNode.url.get ] = data;
                                gOrig[ pid ] = data;
                                gObj.btn = gNode.rowAction.split(' ');
                                tmp = '<div id="div-' + pid + '" class="tableDiv">';
                                tmp += '<table id="table-' + pid + '" class="' + gNode.tblAction + '">';
                                tmp += '<thead>';
                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    tmp += '<tr>';
                                    if (gNode.col[ i ].tab == 's2svpnEnable') {
                                        tmp += '<th class="alignLeft" colspan="2"><div id="div-' + gNode.col[ i ].tab + '"><input type="checkbox" id="' + gNode.col[ i ].tab + '" />&nbsp;<label for="' + gNode.col[ i ].tab + '">' + gNode.col[ i ].label + '</label></div></th>';
                                        tmp += '<td colspan="' + (gNode.col[ i + 1 ].col.length -2) + '">';
                                    }else {
                                        for (var j=0, jlen=gNode.col[ i ].col.length; j<jlen; j++)
                                        {
                                            tmp += '<th id="' + pid + '-' + gNode.col[ i ].col[ j ].tab + '" class="ui-state-default" ';
                                            if (gNode.col[ i ].col[ j ].wiz)
                                                tmp += 'style="width: ' + gNode.col[ i ].col[ j ].wiz;
                                            tmp += '">';
                                            tmp += gNode.col[ i ].col[ j ].label;
                                            tmp += '</th>';
                                        } 
                                        break;
                                    }
                                    tmp += '</tr>';
                                }
                                tmp += '</thead>';
                                tmp += '<tbody></tbody>';
                                tmp += '</table>';
                                tmp += '</div>';
                                $('.templateDiv').append(tmp);
    
                                for (var i=0, len=parseInt(data[ gNode.guiTNum ]); i<len; i++)
                                {
                                    tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                    for (var j=0, jlen=gNode.col[ 1 ].col.length; j<jlen; j++) 
                                    {
                                        if (gNode.col[ 1 ].col[ j ].tab == 'checkbox') {
                                            tmp += '<td class="checkboxTD">';
                                            if (gIf.power) {
                                                tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '" />';
                                            } else {
                                                tmp += '';
                                            }
                                            tmp += '</td>';
                                        } else if (gNode.col[ 1 ].col[ j ].tab == 'action') {
                                            tmp += '<td class="buttonTD">';
                                            if (gIf.power) {
                                                for (var z=0, zlen=gObj.btn.length; z<zlen; z++)
                                                {
                                                    tmp += '<button class="' + gObj.btn[ z ] + '" id="' + gObj.btn[ z ] + '-' + pid + '-' + i + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon" ></span></button>';
                                                }
                                            } else {
                                                tmp += '';
                                            }
                                            tmp += '</td>';
                                        } else if (gNode.col[ 1 ].col[ j ].tab == 'name') {
                                            gCache.uniq[ pid ][ data[ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ] = true;
                                            tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + data[ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] + '</td>'; 
                                        } else if (gNode.col[ 1 ].col[ j ].tab == 'ikePolicyId') {
                                            for (var z=0, zlen=parseInt(gCache.list.ipsecike.guiIpsecikeTNum); z<zlen; z++) 
                                            {
                                                if (parseInt( gCache.list.ipsecike.guiIpsecikeT[ z ].gid ) == parseInt( data[ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ))
                                                    tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gCache.list.ipsecike.guiIpsecikeT[ z ].name + '</td>'; 
                                            }
                                        } else if (gNode.col[ 1 ].col[ j ].tab == 'transformPolicyId') {
                                            for (var z=0, zlen=parseInt(gCache.list.ipsectransform.guiIpsectransformTNum); z<zlen; z++) 
                                            {
                                                if (parseInt( gCache.list.ipsectransform.guiIpsectransformT[ z ].gid ) == parseInt( data[ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ))
                                                    tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gCache.list.ipsectransform.guiIpsectransformT[ z ].name + '</td>'; 
                                            }
                                        } else if (gNode.col[ 1 ].col[ j ].tab == 'wanId') 
                                            tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gCache.name[ parseInt( data[ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ) ] + '</td>'; 
                                        else if (gNode.col[ 1 ].col[ j ].tab == 'localNetworkId' || gNode.col[ 1 ].col[ j ].tab == 'remoteNetworkId') 
                                            tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gCache.address[ parseInt( data[ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ) ] + '</td>'; 
                                        else if (gNode.col[ 1 ].col[ j ].tab == 'enable') 
                                            tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gRef[ gNode.url.get ][ gNode.col[ 1 ].col[ j ].tab ][ data[ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ] + '</td>'; 
                                        else if (gNode.col[ 1 ].col[ j ].tab == 'infoStatus') 
                                            tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gRef[ gNode.url.get ][ gNode.col[ 1 ].col[ j ].tab ][ data[ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ]+ '</td>'; 
                                        else 
                                            tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + data[ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] + '</td>'; 
                                    }
                                    tmp += '</tr>';
                                    $('#table-' + pid + ' tbody').append(tmp);
    
                                    if (gIf.power) {
                                        $('#Disconnect-' + pid + '-' + i).prop('disabled', true);
                                        $('#Connect-' + pid + '-' + i).prop('disabled', true);

                                        if ( 1 === parseInt( data.s2svpnEnable ) ) {
                                            switch( parseInt( data[ gNode.guiT ][ i ].enable ) )
                                            {
                                            case 1:
                                                switch ( parseInt(data[ gNode.guiT ][ i ].infoStatus) ) 
                                                { 
                                                case 0:
                                                    $('#Connect-' + pid + '-' + i).prop('disabled', false);
                                                    break;
                                                case 1:
                                                    $('#Disconnect-' + pid + '-' + i).prop('disabled', false);
                                                    break;
                                                }
                                                break;
                                            }
                                        }
    
                                        for (var j=0, jlen=data[ gNode.guiTNum ]; j<jlen; j++)
                                        {
                                            if (data[ gNode.guiT ][ i ].name == data[ gNode.guiT ][ j ].backupPolicyName) {
                                                $('#Disconnect-' + pid + '-' + i).prop('disabled', true);
                                                $('#Connect-' + pid + '-' + i).prop('disabled', true);
                                            }
                                        }
                                    }
                                }

                                $('#s2svpnEnable').change( function() {
                                    if ($(this).is(':checked')) {
                                        for (var i=0, len=parseInt(data[ gNode.guiTNum ]); i<len; i++)
                                        {
                                            switch( parseInt( data[ gNode.guiT ][ i ].enable ) )
                                            {
                                            case 0:
                                                $('#Connect-' + pid + '-' + i).prop('disabled', true);
                                                $('#Disconnect-' + pid + '-' + i).prop('disabled', true);
                                                break;
                                            case 1:
                                                switch( parseInt( data[ gNode.guiT ][ i ].infoStatus) )
                                                {
                                                case 0:
                                                    $('#Connect-' + pid + '-' + i).prop('disabled', false);
                                                    $('#Disconnect-' + pid + '-' + i).prop('disabled', true);
                                                    break;
                                                case 1:
                                                    $('#Connect-' + pid + '-' + i).prop('disabled', true);
                                                    $('#Disconnect-' + pid + '-' + i).prop('disabled', false);
                                                    break;
                                                case 2:
                                                    $('#Connect-' + pid + '-' + i).prop('disabled', true);
                                                    $('#Disconnect-' + pid + '-' + i).prop('disabled', true);
                                                    break;
                                                }
                                            }
                                        }
                                    }else {
                                        $('.Connect').prop('disabled', true);
                                        $('.disconnect').prop('disabled', true);
                                    }
                                });

                                if (1 === parseInt( data.s2svpnEnable ))
                                    $('#s2svpnEnable').click();

                                if (gIf.power) {
                                    if (gNode.tblAction)
                                        genTblAction( pid );
                                    if ( parseInt( data[ gNode.guiTNum ] ) < parseInt( gLimit.s2svpn.rows ))
                                        $('#Create-ipsec_policies').prop('disabled', false);
                                    else 
                                        $('#Create-ipsec_policies').prop('disabled', true);
                                } else {
                                    $('#s2svpnEnable').prop('disabled', true);
                                }
                                break;
                            }
                        }
                    });
                    break;
                }
                break;
            }
            break;
        }
    }
    
    function refreshNetworking(pid) {
    
        var tableID = '#table-' + pid;
        var tableBD = tableID + ' > tbody';
        $(tableBD).empty();
        gObj.btn = gNode.rowAction.split(' ');
        var trNo = 0;
        switch(pid)
        {
        case 'ike_policy':
        case 'transform_policy':
        case 'static_routing':
            for (var i=0; i<parseInt( gData[ pid ][ gNode.guiTNum ] ); i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) == 3) 
                    continue;
                tmp = '<tr class="' + ((trNo%2==0)? 'even' : 'odd') + '">';
                for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                {
                    switch (gNode.col[ j ].tab)
                    { 
                    case 'checkbox':
                        tmp += '<td class="checkboxTD">';
                        if (gIf.power && 1 === parseInt( gData[ pid ][ gNode.guiT ][ i ].userDefined )) {
                            tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ j ].tab + '-' + i + '" />';
                        } else {
                            tmp += '';
                        }
                        tmp += '</td>';
                        break;
                    case 'action':
                        tmp += '<td class="buttonTD">';
                        if (gIf.power) {
                            for (var z=0, zlen=gObj.btn.length; z<zlen; z++) 
                            {
                                if ( !( 'Delete' === gObj.btn[ z ] && 0 === parseInt( gData[ pid ][ gNode.guiT ][ i ].userDefined ) ) ) {
                                    tmp += '<button class="' + gObj.btn[ z ] + '" id="' + gObj.btn[ z ] + '-' + pid + '-' + i + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon" ></span></button>';
                                }
                            }
                        } else {
                            tmp += '';
                        }
                        tmp += '</td>';
                        break;
                    case 'destinatedNetwork':
                        tmp += '<td id="' + gNode.col[ j ].tab + '-' + i + '">'; 
                        if (parseInt( gData[ pid ][ gNode.guiT ][ i ].isDefaultRt ) == 1) {
                            tmp += 'default' ;
                            gIf.hasDefaultRt = true;
                        } else {
                            tmp += gCache.address[ parseInt( gData[ pid ][ gNode.guiT ][ i ].dstIpId ) ];
                        }
                        tmp += '</td>'; 
                        break;
                    case 'nextHop':
                        tmp += '<td id="' + gNode.col[ j ].tab + '-' + i + '">'; 
                        switch( parseInt(gData[ pid ][ gNode.guiT ][ i ].nhType) )
                        {
                        case 0:
                            tmp += gCache.name[ parseInt( gData[ pid ][ gNode.guiT ][ i ].nhIfId ) ];
                            break;
                        case 1:
                            tmp += gCache.address[ parseInt( gData[ pid ][ gNode.guiT ][ i ].nhIpId ) ];
                            break;
                        }
                        tmp += '</td>';
                        break;
                    case 'cipher':
                    case 'hash':
                    case 'dhgroup':
                    case 'pfsgroup':
                        tmp += '<td id="' + gNode.col[ j ].tab + '-' + i + '">' + gRef[ gNode.url.get ][ gNode.col[ j ].tab ][ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] + '</td>';
                        break;
                    default:
                        tmp += '<td id="' + gNode.col[ j ].tab + '-' + i + '">' + gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] + '</td>'; 
                    }
                }
                tmp += '</tr>';
                $('#table-' + pid + ' tbody').append(tmp);
                trNo++;
            }

            if (gIf.power) {
                if ( parseInt( gData[ pid ][ gNode.guiTNum ] ) < parseInt( gLimit[ gNode.url.get ].rows ))
                    $('#Create-' + pid).prop('disabled', false);
                else 
                    $('#Create-' + pid).prop('disabled', true);
            }
            break;
        case 'dns_forwarder':
            for (var i=0, len=gData[ pid ][ gNode.guiT ].length; i<len; i++)
            {
                if (3 === parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) ) 
                    continue;
                tmp = '<tr class="' + ((trNo%2==0)? 'even' : 'odd') + '">';
                for (var j=0, jlen=gNode.col[ 1 ].col.length; j<jlen; j++)
                {
                    tmp += '<td>';
                    if ('action' == gNode.col[ 1 ].col[ j ].tab) {
                        if (gIf.power) {
                            for (var z=0, zlen=gObj.btn.length; z<zlen; z++)
                            {
                                tmp += '<button class="' + gObj.btn[ z ] + '" id="' + gObj.btn[ z ] + '-' + pid + '-' + i + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon" ></span></button>';
                            }
                        } else {
                            tmp += '';
                        }
                    } else if ('index' == gNode.col[ 1 ].col[ j ].tab) {
                        if (gIf.power) {
                            tmp += '<input type="checkbox" id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '" value="' + i + '" />';
                        } else {
                            tmp += '';
                        }
                    } else {
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ];
                    }
                    tmp += '</td>';
                }
                tmp += '</tr>';
                $('#table-' + pid + ' > tbody').append( tmp );
                trNo++;
            }

            if ($('#' + pid + '-enableStaticDNS-0').is(':checked')) {
                $('#table-' + pid + ' button').prop('disabled', true);
            }
            break;
        case 'ipsec_policies':

            for (var i=0, len=parseInt( gData[ pid ][ gNode.guiTNum ] ); i<len; i++)
            {
                if (3 === parseInt( gData[ pid ][ gNode.guiT ][ i ].cgiAction ) ) 
                    continue;
                tmp = '<tr class="' + ((trNo%2==0)? 'even' : 'odd') + '">';
                for (var j=0, jlen=gNode.col[ 1 ].col.length; j<jlen; j++)
                {
                    if (gNode.col[ 1 ].col[ j ].tab == 'checkbox') {
                        tmp += '<td class="checkboxTD">';
                        if (gIf.power) {
                            tmp += '<input type="checkbox" value="' + i + '" id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '" />';
                        } else {
                            tmp += '';
                        } 
                        tmp += '</td>';
                    } else if (gNode.col[ 1 ].col[ j ].tab == 'action') {
                        tmp += '<td class="buttonTD">';
                        if (gIf.power) {
                            for (var z=0, zlen=gObj.btn.length; z<zlen; z++) 
                            {
                                tmp += '<button class="' + gObj.btn[ z ] + '" id="' + gObj.btn[ z ] + '-' + pid + '-' + i + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon" ></span></button>';
                            }
                        } else {
                            tmp += '';
                        } 
                        tmp += '</td>';
                    } else if (gNode.col[ 1 ].col[ j ].tab == 'ikePolicyId') {
                        for (var z=0, zlen=parseInt(gCache.list.ipsecike.guiIpsecikeTNum); z<zlen; z++) 
                        {
                            if (parseInt( gCache.list.ipsecike.guiIpsecikeT[ z ].gid ) == parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ))
                                tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gCache.list.ipsecike.guiIpsecikeT[ z ].name + '</td>';             
                        }
                    } else if (gNode.col[ 1 ].col[ j ].tab == 'transformPolicyId') {
                        for (var z=0, zlen=parseInt(gCache.list.ipsectransform.guiIpsectransformTNum); z<zlen; z++) 
                        {
                            if (parseInt( gCache.list.ipsectransform.guiIpsectransformT[ z ].gid ) == parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ))
                                tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gCache.list.ipsectransform.guiIpsectransformT[ z ].name + '</td>';             
                        }
                    } else if (gNode.col[ 1 ].col[ j ].tab == 'wanId')
                        tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gCache.name[ parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ) ] + '</td>';
                    else if (gNode.col[ 1 ].col[ j ].tab == 'localNetworkId' || gNode.col[ 1 ].col[ j ].tab == 'remoteNetworkId') 
                        tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gCache.address[ parseInt( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ) ] + '</td>'; 
                    else if (gNode.col[ 1 ].col[ j ].tab == 'enable') 
                        tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gRef[ gNode.url.get ][ gNode.col[ 1 ].col[ j ].tab ][ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ] + '</td>'; 
                    else if (gNode.col[ 1 ].col[ j ].tab == 'infoStatus') 
                        tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gRef[ gNode.url.get ][ gNode.col[ 1 ].col[ j ].tab ][ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] ]+ '</td>'; 
                    else
                        tmp += '<td id="' + gNode.col[ 1 ].col[ j ].tab + '-' + i + '">' + gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ 1 ].col[ j ].tab ] + '</td>';
                }
                tmp += '</tr>';
                $(tableBD).append(tmp);
    
                if (gIf.power) {
                    $('#Disconnect-' + pid + '-' + i).prop('disabled', true);
                    $('#Connect-' + pid + '-' + i).prop('disabled', true);

                    //if ( 1 === parseInt( gData[ pid ].s2svpnEnable ) ) {
                    if ( 1 === parseInt( gData[ pid ].s2svpnEnable ) && 1 === parseInt( gOrig[ pid ].s2svpnEnable ) ) {
                        switch ( parseInt( gData[ pid ][ gNode.guiT ][ i ].enable ) )
                        {
                        case 1:
                            switch ( parseInt( gData[ pid ][ gNode.guiT ][ i ].infoStatus) )
                            {
                            case 0:
                                $('#Connect-' + pid + '-' + i).prop('disabled', false);
                                break;
                            case 1:
                                $('#Disconnect-' + pid + '-' + i).prop('disabled', false);
                                break;
                            }
                            break;
                        }
                    } 
        
                    for (var j=0, jlen=gData[ pid ][ gNode.guiTNum ]; j<jlen; j++)
                    {
                        if (gData[ pid ][ gNode.guiT ][ i ].name == gData[ pid ][ gNode.guiT ][ j ].backupPolicyName) {
                            $('#Disconnect-' + pid + '-' + i).prop('disabled', true);
                            $('#Connect-' + pid + '-' + i).prop('disabled', true);
                        }
                    }
                }
    
                trNo++;
            }
    
            if (gIf.power) {
                if ( parseInt( gData[ pid ][ gNode.guiTNum ] ) < parseInt( gLimit.s2svpn.rows ) ) {
                    $('#Create-ipsec_policies').prop('disabled', false);
                } else {
                    $('#Create-ipsec_policies').prop('disabled', true);
                }
    
                if (!$('#s2svpnEnable').is(':checked')) {
                    $('.Connect').prop('disabled', true);
                    $('.Disconnect').prop('disabled', true);
                }
            } else {
                $('#s2svpnEnable').prop('disabled', true);
            }
            break;
        }
    
    }
    
    function deleteNetworking(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        tar.thisNo = tar.id.split(gReg.isDash)[2];
    
        switch( tar.pid )
        {
        case 'ike_policy':
        case 'transform_policy':
            delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
            break;
        case 'ipsec_policies':
            delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
            for (var i=0, len=gData[ tar.pid ][ gNode.guiTNum ]; i<len; i++)
            {
                if (gData[ tar.pid ][ gNode.guiT ][ i ].backupPolicyName == gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name && gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction != 3) {
                    gData[ tar.pid ][ gNode.guiT ][ i ].backupPolicyEnable = 0;
                    gData[ tar.pid ][ gNode.guiT ][ i ].backupPolicyName = "";
                    if ( gData[ tar.pid ][ gNode.guiT ][ i ].gid > 0 ) {
                        gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction = 2;
                    }
                }
            }
            break;
        case 'static_routing':
            if ( 1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].isDefaultRt ) ) {
                gIf.hasDefaultRt = false;
            }
            break;
        }
    
        if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0 ) {
            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 3;
        }else {
            if (tar.pid != 'dns_forwarder')
                gData[ tar.pid ][ gNode.guiTNum ]--;
            gData[ tar.pid ][ gNode.guiT ].splice(tar.thisNo,1);
        }
    
        refreshNetworking( tar.pid );
    
    }
    
    function removeNetworking(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        $('#table-' + tar.pid + ' tr').each(function() {
            tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
            switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
            {
            case true:
                // backup policy 
    
                switch( tar.pid )
                {
                case 'ike_policy':
                case 'transform_policy':
                    delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
                    break;
                case 'ipsec_policies':
                    delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
                    for (var i=0, len=gData[ tar.pid ][ gNode.guiTNum ]; i<len; i++)
                    {
                        if (gData[ tar.pid ][ gNode.guiT ][ i ].backupPolicyName == gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name && gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction != 3) {
                            gData[ tar.pid ][ gNode.guiT ][ i ].backupPolicyName = "";
                            if ( gData[ tar.pid ][ gNode.guiT ][ i ].gid > 0 ) {
                                gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction = 2;
                            }
                        }
                    }
                    break;
                case 'static_routing':
                    if ( 1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].isDefaultRt ) ) {
                        gIf.hasDefaultRt = false;
                    }
                    break;
                }
    
                // row 
                if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0 ) {
                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 3;
                }else {
                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = -1;
                }
                break;
            }
        });
    
        tar.data = [];
    
        if (tar.pid == 'dns_forwarder') {
            for (var i=0, len=gData[ tar.pid ][ gNode.guiT ].length; i<len; i++)
            {
                if (gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction == -1)
                    continue;
                tar.data.push( gData[ tar.pid ][ gNode.guiT ][ i ] );
            }
            gData[ tar.pid ][ gNode.guiT ] = tar.data;
        } else {
            for (var i=0, len=gData[ tar.pid ][ gNode.guiTNum ]; i<len; i++)
            {
                if (gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction == -1)
                    continue;
                tar.data.push( gData[ tar.pid ][ gNode.guiT ][ i ] );
            }
            gData[ tar.pid ][ gNode.guiT ] = tar.data;
            gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
        }
      
        refreshNetworking( tar.pid );
    }
    
    function createNetworking(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        tar.w = 600;
        tar.h = 480;
    
        var tmp;
        switch(tar.pid)
        {
        case 'ike_policy':
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"></div></div>');
    
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                tmp += '<tr>';
                tmp += '<td class="BT80"><img src="' + gNode.editor[ i ].icon + '"/></td>';
                tmp += '<th class="alignLeft" style="width: ' + gNode.editor[ i ].wiz + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label></th>';
                tmp += '<td class="alignLeft">';
                switch( gNode.editor[ i ].tag )
                {
                case 'input':
                    tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" ' + ((gNode.editor[ i ].size)? 'size="' + gNode.editor[ i ].size + '"' : '' )+ '/>';
                    if ( gNode.editor[ i ].note )
                        tmp += '&nbsp;' + gNode.editor[ i ].note;
                    break;
                case 'select':
                    tmp += '<select id="Editor-' + gNode.editor[ i ].tab + '" >';
                    for (var x in gNode.editor[ i ].option)
                    {
                        tmp += '<option value="' + x + '">' + gNode.editor[ i ].option[ x ] + '</option>';
                    }
                    tmp += '</select>';
                    break;
                }
                tmp += '</td>';
                tmp += '</tr>';
            }
            tmp += '</table>';
            $('#Editor-div-' + tar.pid).append( tmp );
    
            $('#Editor-lifetime').val( 86400 );
            $('#Editor-name').focus();
            break;
        case 'transform_policy':
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"></div></div>');
    
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<td class="BT80"><img src="' + gNode.editor[ i ].icon + '"/></td>';
                tmp += '<th class="alignLeft" style="width: ' + gNode.editor[ i ].wiz + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label></th>';
                tmp += '<td class="alignLeft">';
                switch( gNode.editor[ i ].tag )
                {
                case 'input':
                    tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" ' + ((gNode.editor[ i ].size)? 'size="' + gNode.editor[ i ].size + '"' : '' )+ '/>';
                    if ( gNode.editor[ i ].note )
                        tmp += '&nbsp;' + gNode.editor[ i ].note;
                    break;
                case 'select':
                    tmp += '<select id="Editor-' + gNode.editor[ i ].tab + '" >';
                    for (var x in gNode.editor[ i ].option)
                    {
                        tmp += '<option value="' + x + '">' + gNode.editor[ i ].option[ x ] + '</option>';
                    }
                    tmp += '</select>';
                    break;
                }
                tmp += '</td>';
                tmp += '</tr>';
            }
            tmp += '</table>';
            $('#Editor-div-' + tar.pid).append( tmp );
    
            $('#Editor-lifetime').val( 3600 );
            $('#Editor-name').focus();
            break;
        case 'ipsec_policies':
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
    
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ i ].tab + '"><a href="#panel-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ i ].tab + '"><div id="div-' + gNode.editor[ i ].tab + '"><table id="table-' + gNode.editor[ i ].tab + '"></table></div></div>');
                
                for (var j=0, jlen=gNode.editor[ i ].col.length; j<jlen; j++)
                {
                    switch( gNode.editor[ i ].col[ j ].tag )
                    {
                    case 'input':
                        switch( gNode.editor[ i ].col[ j ].type )
                        {
                        case 'text':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto') + '"><label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">' + gNode.editor[ i ].col[ j ].label + '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : 'Left') + '">';
                            tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '"  />';
                            if ( gNode.editor[ i ].col[ j ].note )
                                tmp += '&nbsp' + gNode.editor[ i ].col[ j ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'radio':
                            var cnt = 0;
                            var rows = 0;
                            for (var x in gNode.editor[ i ].col[ j ].option)
                                rows++;
                            for (var x in gNode.editor[ i ].col[ j ].option)
                            {
                                tmp = '<tr>';
                                if (0 === cnt) {
                                    tmp += '<th ' + ((rows > 1)? 'rowspan="' + rows + '"' : "") + 'class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto') + '">';
                                    tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">' + gNode.editor[ i ].col[ j ].label;
                                    tmp += '</th>';
                                }else {
                                    tmp += '<td></td>';
                                }
                                tmp += '<td class="alignLeft">';
                                tmp += '<input type="radio" name="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '" value="' + x + '"  />';
                                tmp += '&nbsp; <label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '">' + gNode.editor[ i ].col[ j ].option[ x ].label + '</label>';
                                if ( gNode.editor[ i ].col[ j ].option[ x ].col ) {
                                    tmp += '&nbsp; <input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].col.tab + '" />';
                                    if ( gNode.editor[ i ].col[ j ].option[ x ].col.note ) {
                                        tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col.note; 
                                    }
                                }
                                tmp += '</td>';
                                tmp += '</tr>';
                                cnt++;
                            }
                            break;
                        case 'checkbox':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto') + '">';
                            tmp += '<input type="checkbox" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" value="' + gNode.editor[ i ].col[ j ].val + '"  />';
                            tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">&nbsp;' + gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : 'Left') + '"></td>';
                            tmp += '</tr>';
                            
                            if ( gNode.editor[ i ].col[ j ].col ) {
                                tmp += '<tr>';
                                tmp += '<td colspan="2" class="alignLeft colspan2">';
                                tmp += '<table id="table-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                                for (var k=0, klen=gNode.editor[ i ].col[ j ].col.length; k<klen; k++)
                                {
                                    tmp += '<tr>';
                                    tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].col[ k ].align)? gNode.editor[ i ].col[ j ].col[ k ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].col[ j ].col[ k ].wiz)? gNode.editor[ i ].col[ j ].col[ k ].wiz : 'auto') + '">';
                                    tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col[ k ].tab + '">' + gNode.editor[ i ].col[ j ].col[ k ].label + '</label>';
                                    tmp += '</td>';
                                    tmp += '<td class="align' + (( gNode.editor[ i ].col[ j ].col[ k ].align )? gNode.editor[ i ].col[ j ].col[ k ].align[ 1 ] : 'Left') + '">';
                                    switch( gNode.editor[ i ].col[ j ].col[ k ].type )
                                    {
                                    case 'select':
                                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col[ k ].tab + '" >';
                                        if ('object' === typeof gNode.editor[ i ].col[ j ].col[ k ].option) {
                                            for (var x in gNode.editor[ i ].col[ j ].col[ k ].option)
                                            {
                                                tmp += '<option value="' + x + '"  >' + gNode.editor[ i ].col[ j ].col[ k ].option[ x ] + '</option>';
                                            }
                                        }
                                        tmp += '</select>';
                                        break;
                                    case 'text':
                                        tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col[ k ].tab + '" size="8" />';
                                        if ( gNode.editor[ i ].col[ j ].col[ k ].note )
                                            tmp += '&nbsp' + gNode.editor[ i ].col[ j ].col[ k ].note;
                                        break;
                                    }
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }
                                tmp += '</table>';
                                tmp += '</td>';
                                tmp += '</tr>';
                            }
                            break;
                        }
                        break;
                    case 'select':
                        tmp = '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto') + '"><label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">' + gNode.editor[ i ].col[ j ].label + '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : 'Left') + '">';
                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" >';
                        if ('object' === typeof gNode.editor[ i ].col[ j ].option) {
                            for (var x in gNode.editor[ i ].col[ j ].option)
                            {
                                tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                            }
                        }
                        tmp += '</select>';
                        tmp += '</td>';
                        tmp += '</tr>';
                        if ( gNode.editor[ i ].col[ j ].col ) {
                            tmp += '<tr id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-NE-0">';
                            tmp += '<td class="alignLeft"></td>';
                            tmp += '<td class="alignLeft">';
                            tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.tab + '">&nbsp;' + gNode.editor[ i ].col[ j ].col.label + '</label>';
                            tmp += '&nbsp;<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.tab + '" />';
                            if ( gNode.editor[ i ].col[ j ].col.note )
                                tmp += '&nbsp' + gNode.editor[ i ].col[ j ].col.note;
                            tmp += '</td>';
                            tmp += '</tr>';
                        }
                        break;
                    case 'table':
                        tmp = '<thead>';
                        tmp += '<tr>';
                        for (var k=0, klen=gNode.editor[ i ].col[ j ].col.length; k<klen; k++)
                        {
                            tmp += '<th style="width: ' + gNode.editor[ i ].col[ j ].col[ k ].wiz + '" class="ui-state-default" >' + gNode.editor[ i ].col[ j ].col[ k ].label  + '</th>';
                        }
                        tmp += '</tr>';
                        
                        tmp += '</thead>';
                        tmp += '<tbody>';
                        for (var k=0, klen=gCache.list.common_zoneIf_list.guiZoneIfTNum; k<klen; k++)
                        {
                            tmp += '<tr class="' + ((0 === k%2)? 'even': 'odd' ) + '">';
                            for (var m=0, mlen=gNode.editor[ i ].col[ j ].col.length; m<mlen; m++) 
                            {
                                tmp += '<td>';
                                if ('p' === gNode.editor[ i ].col[ j ].col[ m ].tag) {
                                    tmp += '<p id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col[ m ].tab + '-' + k + '">' + gCache.list.common_zoneIf_list.guiZoneIfT[ k ].name + '</p>';
                                }else {
                                    tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col[ m ].tab + '-' + k + '">';
                                    for (var x in gNode.editor[ i ].col[ j ].col[ m ].option)
                                    {
                                        tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].col[ m ].option[ x ] + '</option>';
                                    }
                                    tmp += '</select>';
                                }
                                tmp += '</td>';
                            }
                            tmp += '</tr>';
                        }
                        tmp += '</tbody>';
                        break;
                    }
                    $('#table-' + gNode.editor[ i ].tab).append( tmp );
                }
            }
    
            gObj.tab = $('.tabs').tabs({
                activate: function( event, ui ) {
                    switch( parseInt( ui.newTab.index() ) )
                    {
                    case 0:
                        $('#basic_settings-name').focus();
                        break;
                    case 1:
                        $('#advance_settings-pfsEnable').focus();
                        break;
                    case 2:
                        $('#vpn_failover-wanFailoverEnable').focus();
                        break;
                    }
                }
            });
    
            $('#basic_settings-remoteGwType').change( function() {
                switch(parseInt( $(this).val() ))
                {
                case 0:
                    $('#basic_settings-remoteGw').prop('disabled', true);
                    break;
                default: 
                    $('#basic_settings-remoteGw').prop('disabled', false);
                }
            });
    
            $('#basic_settings-localNetworkId').change( function() {
                if (0 === parseInt($(this).val())) {
                    gObj.tab.tabs("enable", 3);
                }else {
                    gObj.tab.tabs({"disabled": [3]});
                }
            });
    
            $('#advance_settings-dpdEnable').change( function() {
                if ($(this).is(':checked')) {
                    $('#advance_settings-dpddelay').prop('disabled', false);
                    $('#advance_settings-dpdtimeout').prop('disabled', false);
                    $('#advance_settings-dpdaction').prop('disabled', false);
                }else {
                    $('#advance_settings-dpddelay').prop('disabled', true);
                    $('#advance_settings-dpdtimeout').prop('disabled', true);
                    $('#advance_settings-dpdaction').prop('disabled', true);
                }
            });
    
            $('#vpn_failover-backupPolicyEnable').change( function() {
                if ($(this).is(':checked')) {
                    $('#vpn_failover-backupPolicyName').prop('disabled', false);
                    $('#vpn_failover-fallbackTime').prop('disabled', false);
                }else {
                    $('#vpn_failover-backupPolicyName').prop('disabled', true);
                    $('#vpn_failover-fallbackTime').prop('disabled', true);
                }
            });
    
            gObj.tab.tabs({"disabled": [3]});
    
            $('#basic_settings-remoteGwType').val( 0 ).trigger('change');
    
            cgiSelectOption( 'basic_settings-wanId');
            cgiSelectOption( 'basic_settings-localNetworkId');
            cgiSelectOption( 'basic_settings-remoteNetworkId');
    
            $('#advance_settings-dpdEnable').attr('checked', true);
            $('#advance_settings-dpddelay').val(10);
            $('#advance_settings-dpdtimeout').val(30);
            $('#advance_settings-dpdaction').val(3).trigger('change');
    
            cgiSelectOption( 'advance_settings-ikePolicyId');
            cgiSelectOption( 'advance_settings-transformPolicyId');
            genSelector( 'vpn_failover-backupPolicyName' );
    
            $('#vpn_failover-fallbackTime').val( 5 );
    
            $('#vpn_failover-backupPolicyName').prop('disabled', true);
            $('#vpn_failover-fallbackTime').prop('disabled', true);
    
            $('input[name=basic_settings-phase1AuthType]').val(0).trigger('click');
    
            $('#table-access_control tbody tr td select').each( function() {
                $(this).val(1);
            });
    
            break;
        case 'dns_forwarder':
            tar.w = 360;
            tar.h = 200;
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"></div></div>');
    
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<th class="alignLeft BT100">';
                tmp += gNode.editor[ i ].label;
                tmp += '</th>';
                tmp += '<td class="alignLeft">';
                tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" />';
                tmp += '</td>';
                tmp += '</tr>';
            }
            $('#Editor-div-' + tar.pid).append( tmp );
            break;
        case 'static_routing':
            tar.w = 660;
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"></div></div>');
    
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<th class="alignLeft" style="width: ' + gNode.editor[ i ].wiz + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label></th>';
                tmp += '<td class="alignLeft">';
                switch( gNode.editor[ i ].tag )
                {
                case 'input':
                    switch( gNode.editor[ i ].type )
                    {
                    case 'checkbox':
                        tmp += '<input type="checkbox" id="Editor-' + gNode.editor[ i ].tab + '" value="' + gNode.editor[ i ].val + '"/>';
                        if ( gNode.editor[ i ].note ) {
                            tmp += '&nbsp;<label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].note + '</label>';
                        }
                        break;
                    case 'radio':
                        tmp += '<table id="Editor-table-' + gNode.editor[ i ].tab + '">';
                        for (var x in gNode.editor[ i ].option)
                        {
                            tmp += '<tr>';
                            tmp += '<td class="alignLeft BT100">';
                            tmp += '<input type="radio" name="Editor-' + gNode.editor[ i ].tab + '" id="Editor-' + gNode.editor[ i ].option[ x ].tab  + '" value="' + x + '"  />';
                            tmp += '&nbsp;<label for="Editor-' + gNode.editor[ i ].option[ x ].tab + '">' + gNode.editor[ i ].option[ x ].label + '</label>';
                            tmp += '</td>';
                            tmp += '<td class="alignLeft">';
                            if ( gNode.editor[ i ].option[ x ].col ) {
                                tmp += '&nbsp;<select id="Editor-' + gNode.editor[ i ].option[ x ].col.tab + '" ></select>';
                            }
                            tmp += '</td>';
                            tmp += '</tr>';
                        }
                        tmp += '</table>';
                        break;
                    default:
                        tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" size="8"/>';
                        if ( gNode.editor[ i ].note )
                            tmp += '&nbsp;' + gNode.editor[ i ].note;
                    }
                    break;
                case 'select':
                    tmp += '<select id="Editor-' + gNode.editor[ i ].tab + '" ></select>';
                    break;
                }
                tmp += '</td>';
                tmp += '</tr>';
            }
            tmp += '</table>';
    
            $('#Editor-div-' + tar.pid).append( tmp );
    
            $('input[name=Editor-nhType]').change( function() {
                switch( parseInt( $(this).val() ) )
                {
                case 0:
                    $('#Editor-nhIfId').prop('disabled', false);
                    $('#Editor-nhIpId').prop('disabled', true);
                    break;
                case 1:
                    $('#Editor-nhIfId').prop('disabled', true);
                    $('#Editor-nhIpId').prop('disabled', false);
                    break;
                }
            }).eq( 0 ).trigger('click');

            $('#Editor-isDefaultRt').change( function() {
                if ($(this).is(':checked')) {
                    $('#Editor-dstIpId').prop('disabled', true);
                    gIf.isDefaultRt = true;
                } else {
                    $('#Editor-dstIpId').prop('disabled', false);
                    gIf.isDefaultRt = false;
                }
                cgiSelectOption( 'Editor-nhIfId', $('#Editor-nhIfId').val());
            });
    
            if (!gIf.rtMode) {
                $('#Editor-isDefaultRt').prop('disabled', true);
            }else if (gIf.hasDefaultRt) {
                $('#Editor-isDefaultRt').prop('disabled', true);
            }
    
            $('#Editor-metric').val(0);
    
            cgiSelectOption( 'Editor-dstIpId');
            cgiSelectOption( 'Editor-nhIfId');
            cgiSelectOption( 'Editor-nhIpId');
    
            break;
        }
    
        networkingEditor(e, tar.w, tar.h);
    }
    
    function editNetworking(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
    
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        tar.thisNo = tar.id.split(gReg.isDash)[2];
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        tar.w = 600;
        tar.h = 480;
    
        var tmp;
        switch(tar.pid)
        {
        case 'ike_policy':
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"></div></div>');
    
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                tmp += '<tr>';
                tmp += '<td class="BT80"><img src="' + gNode.editor[ i ].icon + '"/></td>';
                tmp += '<th class="alignLeft" style="width: ' + gNode.editor[ i ].wiz + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label></th>';
                tmp += '<td class="alignLeft">';
                switch( gNode.editor[ i ].tag )
                {
                case 'input':
                    tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" ' + ((gNode.editor[ i ].size)? 'size="' + gNode.editor[ i ].size + '"' : '' )+ '/>';
                    if ( gNode.editor[ i ].note )
                        tmp += '&nbsp;' + gNode.editor[ i ].note;
                    break;
                case 'select':
                    tmp += '<select id="Editor-' + gNode.editor[ i ].tab + '" >';
                    for (var x in gNode.editor[ i ].option)
                    {
                        tmp += '<option value="' + x + '">' + gNode.editor[ i ].option[ x ] + '</option>';
                    }
                    tmp += '</select>';
                    break;
                }
                tmp += '</td>';
                tmp += '</tr>';
            }
            tmp += '</table>';
            $('#Editor-div-' + tar.pid).append( tmp );
    
            $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name );
            $('#Editor-cipher').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cipher );
            $('#Editor-hash').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].hash );
            $('#Editor-dhgroup').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dhgroup );
            $('#Editor-lifetime').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].lifetime );
            $('#Editor-name').focus();
            break;
        case 'transform_policy':
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"></div></div>');
    
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<td class="BT80"><img src="' + gNode.editor[ i ].icon + '"/></td>';
                tmp += '<th class="alignLeft" style="width: ' + gNode.editor[ i ].wiz + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label></th>';
                tmp += '<td class="alignLeft">';
                switch( gNode.editor[ i ].tag )
                {
                case 'input':
                    tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" ' + ((gNode.editor[ i ].size)? 'size="' + gNode.editor[ i ].size + '"' : '' )+ '/>';
                    if ( gNode.editor[ i ].note )
                        tmp += '&nbsp;' + gNode.editor[ i ].note;
                    break;
                case 'select':
                    tmp += '<select id="Editor-' + gNode.editor[ i ].tab + '" >';
                    for (var x in gNode.editor[ i ].option)
                    {
                        tmp += '<option value="' + x + '">' + gNode.editor[ i ].option[ x ] + '</option>';
                    }
                    tmp += '</select>';
                    break;
                }
                tmp += '</td>';
                tmp += '</tr>';
            }
            tmp += '</table>';
            $('#Editor-div-' + tar.pid).append( tmp );
    
            $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name );
            $('#Editor-cipher').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cipher );
            $('#Editor-hash').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].hash );
            $('#Editor-pfsgroup').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].pfsgroup );
            $('#Editor-lifetime').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].lifetime );
            $('#Editor-name').focus();
            break;
        case 'ipsec_policies':
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
    
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ i ].tab + '"><a href="#panel-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ i ].tab + '"><div id="div-' + gNode.editor[ i ].tab + '"><table id="table-' + gNode.editor[ i ].tab + '"></table></div></div>');
                
                for (var j=0, jlen=gNode.editor[ i ].col.length; j<jlen; j++)
                {
                    switch( gNode.editor[ i ].col[ j ].tag )
                    {
                    case 'input':
                        switch( gNode.editor[ i ].col[ j ].type )
                        {
                        case 'text':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto') + '"><label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">' + gNode.editor[ i ].col[ j ].label + '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : 'Left') + '">';
                            tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" ' + ((gNode.editor[ i ].col[ j ].size)? 'size="' + gNode.editor[ i ].col[ j ].size + '"' : '' ) + '/>';
                            if ( gNode.editor[ i ].col[ j ].note )
                                tmp += '&nbsp' + gNode.editor[ i ].col[ j ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'radio':
                            var cnt = 0;
                            var rows = 0;
                            for (var x in gNode.editor[ i ].col[ j ].option)
                                rows++;
                            for (var x in gNode.editor[ i ].col[ j ].option)
                            {
                                tmp = '<tr>';
                                if (0 === cnt) {
                                    tmp += '<th ' + ((rows > 1)? 'rowspan="' + rows + '"' : "") + 'class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto') + '">';
                                    tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">' + gNode.editor[ i ].col[ j ].label;
                                    tmp += '</th>';
                                }else {
                                    tmp += '<td></td>';
                                }
                                tmp += '<td class="alignLeft">';
                                tmp += '<input type="radio" name="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '" value="' + x + '"  />';
                                tmp += '&nbsp; <label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].tab + '">' + gNode.editor[ i ].col[ j ].option[ x ].label + '</label>';
                                if ( gNode.editor[ i ].col[ j ].option[ x ].col ) {
                                    tmp += '&nbsp; <input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].option[ x ].col.tab + '" />';
                                    if ( gNode.editor[ i ].col[ j ].option[ x ].col.note ) {
                                        tmp += '&nbsp;' + gNode.editor[ i ].col[ j ].option[ x ].col.note; 
                                    }
                                }
                                tmp += '</td>';
                                tmp += '</tr>';
                                cnt++;
                            }
                            break;
                        case 'checkbox':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto') + '">';
                            tmp += '<input type="checkbox" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" value="' + gNode.editor[ i ].col[ j ].val + '" />';
                            tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">' + gNode.editor[ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : 'Left') + '"></td>';
                            tmp += '</tr>';
                            
                            if ( gNode.editor[ i ].col[ j ].col ) {
                                tmp += '<tr>';
                                tmp += '<td colspan="2" class="alignLeft colspan2">';
                                tmp += '<table id="table-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">';
                                for (var k=0, klen=gNode.editor[ i ].col[ j ].col.length; k<klen; k++)
                                {
                                    tmp += '<tr>';
                                    tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].col[ k ].align)? gNode.editor[ i ].col[ j ].col[ k ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].col[ j ].col[ k ].wiz)? gNode.editor[ i ].col[ j ].col[ k ].wiz : 'auto') + '">';
                                    tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col[ k ].tab + '">' + gNode.editor[ i ].col[ j ].col[ k ].label + '</label>';
                                    tmp += '</td>';
                                    tmp += '<td class="align' + (( gNode.editor[ i ].col[ j ].col[ k ].align )? gNode.editor[ i ].col[ j ].col[ k ].align[ 1 ] : 'Left') + '">';
                                    switch( gNode.editor[ i ].col[ j ].col[ k ].type )
                                    {
                                    case 'select':
                                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col[ k ].tab + '" >';
                                        if ('object' === typeof gNode.editor[ i ].col[ j ].col[ k ].option) {
                                            for (var x in gNode.editor[ i ].col[ j ].col[ k ].option)
                                            {
                                                tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].col[ k ].option[ x ] + '</option>';
                                            }
                                        }
                                        tmp += '</select>';
                                        break;
                                    case 'text':
                                        tmp += '<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col[ k ].tab + '" size="8"/>';
                                        if ( gNode.editor[ i ].col[ j ].col[ k ].note )
                                            tmp += '&nbsp' + gNode.editor[ i ].col[ j ].col[ k ].note;
                                        break;
                                    }
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }
                                tmp += '</table>';
                                tmp += '</td>';
                                tmp += '</tr>';
                            }
                            break;
                        }
                        break;
                    case 'select':
                        tmp = '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].col[ j ].wiz)? gNode.editor[ i ].col[ j ].wiz : 'auto') + '"><label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '">' + gNode.editor[ i ].col[ j ].label + '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].col[ j ].align)? gNode.editor[ i ].col[ j ].align[ 1 ] : 'Left') + '">';
                        tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '" >';
                        if ('object' === typeof gNode.editor[ i ].col[ j ].option) {
                            for (var x in gNode.editor[ i ].col[ j ].option)
                            {
                                tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                            }
                        }
                        tmp += '</select>';
                        tmp += '</td>';
                        tmp += '</tr>';
                        if ( gNode.editor[ i ].col[ j ].col ) {
                            tmp += '<tr id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].tab + '-NE-0">';
                            tmp += '<td class="alignLeft"></td>';
                            tmp += '<td class="alignLeft">';
                            tmp += '<label for="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.tab + '">' + gNode.editor[ i ].col[ j ].col.label + '</label>';
                            tmp += '&nbsp;<input type="text" id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col.tab + '"  />';
                            if ( gNode.editor[ i ].col[ j ].col.note )
                                tmp += '&nbsp' + gNode.editor[ i ].col[ j ].col.note;
                            tmp += '</td>';
                            tmp += '</tr>';
                        }
                        break;
                    case 'table':
                        tmp = '<thead>';
                        tmp += '<tr>';
                        for (var k=0, klen=gNode.editor[ i ].col[ j ].col.length; k<klen; k++)
                        {
                            tmp += '<th style="width: ' + gNode.editor[ i ].col[ j ].col[ k ].wiz + '" class="ui-state-default" >' + gNode.editor[ i ].col[ j ].col[ k ].label  + '</th>';
                        }
                        tmp += '</tr>';
    
                        tmp += '</thead>';
                        tmp += '<tbody>';
                        for (var k=0, klen=gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vpnaclTNum; k<klen; k++)
                        {
                            tmp += '<tr class="' + ((0 === k%2)? 'even': 'odd' ) + '">';
                            for (var m=0, mlen=gNode.editor[ i ].col[ j ].col.length; m<mlen; m++)
                            {
                                tmp += '<td>';
                                if ('p' === gNode.editor[ i ].col[ j ].col[ m ].tag) {
                                    tmp += '<p id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col[ m ].tab + '-' + k + '">' + gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vpnaclT[ k ][ gNode.editor[ i ].col[ j ].col[ m ].tab ] + '</p>';
                                }else {
                                    tmp += '<select id="' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].col[ j ].col[ m ].tab + '-' + k + '">';
                                    for (var x in gNode.editor[ i ].col[ j ].col[ m ].option)
                                    {
                                        tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ j ].col[ m ].option[ x ] + '</option>';
                                    }
                                    tmp += '</select>';
                                }
                                tmp += '</td>';
                            }
                            tmp += '</tr>';
                        }
                        tmp += '</tbody>';
                        break;
                    }
                    $('#table-' + gNode.editor[ i ].tab).append( tmp );
                }
            }
    
            gObj.tab = $('.tabs').tabs({
                activate: function( event, ui ) {
                    switch( parseInt( ui.newTab.index() ) )
                    {
                    case 0:
                        $('#basic_settings-name').focus();
                        break;
                    case 1:
                        $('#advance_settings-pfsEnable').focus();
                        break;
                    case 2:
                        $('#vpn_failover-wanFailoverEnable').focus();
                        break;
                    }
                }
            });
    
            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].enable )) {
                $('#basic_settings-enable').click();
            }
    
            $('#basic_settings-remoteGwType').change( function() {
                switch(parseInt( $(this).val() ))
                {
                case 0:
                    $('#basic_settings-remoteGw').prop('disabled', true);
                    break;
                default: 
                    $('#basic_settings-remoteGw').prop('disabled', false);
                }
            });
    
            $('#basic_settings-localNetworkId').change( function() {
                if (0 === parseInt($(this).val())) {
                    gObj.tab.tabs("enable", 3);
                }else {
                    gObj.tab.tabs({"disabled": [3]});
                }
            });
    
            $('#advance_settings-dpdEnable').change( function() {
                if ($(this).is(':checked')) {
                    $('#advance_settings-dpddelay').prop('disabled', false);
                    $('#advance_settings-dpdtimeout').prop('disabled', false);
                    $('#advance_settings-dpdaction').prop('disabled', false);
                }else {
                    $('#advance_settings-dpddelay').prop('disabled', true);
                    $('#advance_settings-dpdtimeout').prop('disabled', true);
                    $('#advance_settings-dpdaction').prop('disabled', true);
                }
            });
    
            $('#vpn_failover-backupPolicyEnable').change( function() {
                if ($(this).is(':checked')) {
                    $('#vpn_failover-backupPolicyName').prop('disabled', false);
                    $('#vpn_failover-fallbackTime').prop('disabled', false);
                }else {
                    $('#vpn_failover-backupPolicyName').prop('disabled', true);
                    $('#vpn_failover-fallbackTime').prop('disabled', true);
                }
            });
    
            gObj.tab.tabs({"disabled": [3]});
    
            $('#basic_settings-name').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name );
    
            $('#basic_settings-remoteGw').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].remoteGw );
            $('#basic_settings-remoteGwType').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].remoteGwType ).trigger('change');
    
            $('#basic_settings-localId').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].localId );
            $('#basic_settings-remoteId').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].remoteId );

            cgiSelectOption( 'basic_settings-wanId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanId );
            cgiSelectOption( 'basic_settings-localNetworkId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].localNetworkId );
            cgiSelectOption( 'basic_settings-remoteNetworkId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].remoteNetworkId );
    
            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpdEnable )) {
                $('#advance_settings-dpdEnable').attr('checked', true).trigger('change');
            }else {
                $('#advance_settings-dpdEnable').attr('checked', true).trigger('change');
            }
            $('#advance_settings-dpddelay').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpddelay );
            $('#advance_settings-dpdtimeout').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpdtimeout );
            $('#advance_settings-dpdaction').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpdaction );
    
            cgiSelectOption( 'advance_settings-ikePolicyId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ikePolicyId );
            cgiSelectOption( 'advance_settings-transformPolicyId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].transformPolicyId);
            genSelector( 'vpn_failover-backupPolicyName', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupPolicyName, gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name );
    
            $('#vpn_failover-fallbackTime').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].fallbackTime );
    
            $('input[name=basic_settings-phase1AuthType]').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].phase1AuthType ).trigger('click');
            $('#basic_settings-presharedkey').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].presharedkey );
    
            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupPolicyEnable )) {
                $('#vpn_failover-backupPolicyEnable').click();
            }else {
                $('#vpn_failover-backupPolicyName').prop('disabled', true);
                $('#vpn_failover-fallbackTime').prop('disabled', true);
            }
    
            for (var i=0; i<gData[ tar.pid ][ gNode.guiTNum ]; i++)
            {
                if (gData[ tar.pid ][ gNode.guiT ][ i ].backupPolicyName == gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name) {
                    $('#vpn_failover-backupPolicyEnable').prop('disabled', true);
                    $('#vpn_failover-backupPolicyName').prop('disabled', true);
                    $('#vpn_failover-fallbackTime').prop('disabled', true);
                }
            }
    
            for (var i=0; i<gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vpnaclTNum; i++)
            {
                if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vpnaclT[ i ].actionType )) {
                    $('#access_control-actionType-' + i).val(1);
                }
            }
    
            break;
        case 'dns_forwarder':
            tar.w = 360;
            tar.h = 200;
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"></div></div>');
   
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<th class="alignLeft BT100">';
                tmp += gNode.editor[ i ].label;
                tmp += '</th>';
                tmp += '<td class="alignLeft">';
                tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" />';
                tmp += '</td>';
                tmp += '</tr>';
            }
            $('#Editor-div-' + tar.pid).append( tmp );

            $('#Editor-domain').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].domain );
            $('#Editor-ipAddr').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipAddr );

            break;
        case 'static_routing':
            tar.w = 660;
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"><table id="Editor-table-' + tar.pid + '"></table></div></div>');
    
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp = '<tr>';
                tmp += '<th class="alignLeft" style="width: ' + gNode.editor[ i ].wiz + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label></th>';
                tmp += '<td class="alignLeft">';
                switch( gNode.editor[ i ].tag )
                {
                case 'input':
                    switch( gNode.editor[ i ].type )
                    {
                    case 'checkbox':
                        tmp += '<input type="checkbox" id="Editor-' + gNode.editor[ i ].tab + '" value="' + gNode.editor[ i ].val + '"/>';
                        if ( gNode.editor[ i ].note )
                            tmp += '&nbsp;<label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].note + '</label>';
                        break;
                    case 'radio':
                        tmp += '<table id="Editor-table-' + gNode.editor[ i ].tab + '">';
                        tmp += '<tr>';
                        tmp += '<td class="alignLeft BT100">';
                        tmp += '<input type="radio" name="Editor-' + gNode.editor[ i ].tab + '" id="Editor-' + gNode.editor[ i ].tab + '-0' + '" value="0"  />';
                        tmp += '&nbsp;<label for="Editor-' + gNode.editor[ i ].tab + '-0' + '">' + gNode.editor[ i ].option[ 0 ].label + '</label>';
                        tmp += '</td>';
                        tmp += '<td class="alignLeft">';
                        tmp += '&nbsp;<select id="Editor-' + gNode.editor[ i ].option[ 0 ].col.tab + '" >';
                        tmp += '</td>';
                        tmp += '</tr>';
                        tmp += '<tr>';
                        tmp += '<td class="alignLeft BT100">';
                        tmp += '<input type="radio" name="Editor-' + gNode.editor[ i ].tab + '" id="Editor-' + gNode.editor[ i ].tab + '-1' + '" value="1"  />';
                        tmp += '&nbsp;<label for="Editor-' + gNode.editor[ i ].tab + '-1' + '">' + gNode.editor[ i ].option[ 1 ].label + '</label>';
                        tmp += '</td>';
                        tmp += '<td class="alignLeft">';
                        tmp += '&nbsp;<select id="Editor-' + gNode.editor[ i ].option[ 1 ].col.tab + '" >';
                        tmp += '</td>';
                        tmp += '</tr>';
                        tmp += '</table>';
                        break;
                    default:
                        tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" size="8" />';
                        if ( gNode.editor[ i ].note )
                            tmp += '&nbsp;' + gNode.editor[ i ].note;
                    }
                    break;
                case 'select':
                    tmp += '<select id="Editor-' + gNode.editor[ i ].tab + '" ></select>';
                    break;
                }
                tmp += '</td>';
                tmp += '</tr>';
                $('#Editor-table-' + tar.pid).append( tmp );
            }
    
            $('input[name=Editor-nhType]').change( function() {
                switch( parseInt( $(this).val() ) )
                {
                case 0:
                    $('#Editor-nhIfId').prop('disabled', false);
                    $('#Editor-nhIpId').prop('disabled', true);
                    break;
                case 1:
                    $('#Editor-nhIfId').prop('disabled', true);
                    $('#Editor-nhIpId').prop('disabled', false);
                    break;
                }
            }).eq( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].nhType ).trigger('click');
    
            $('#Editor-isDefaultRt').change( function() {
                if ($(this).is(':checked')) {
                    $('#Editor-dstIpId').prop('disabled', true);
                } else {
                    $('#Editor-dstIpId').prop('disabled', false);
                }
                cgiSelectOption( 'Editor-nhIfId', $('#Editor-nhIfId').val());
            });
    
            if (!gIf.rtMode) {
                if ( 1 === parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].isDefaultRt) ) {
                    $('#Editor-isDefaultRt').attr('checked', true);
                    $('#Editor-dstIpId').prop('disabled', true);
                    gIf.wasDefaultRt = true;
                }
                $('#Editor-isDefaultRt').prop('disabled', true);
            } else if (gIf.hasDefaultRt) {
                if ( 1 === parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].isDefaultRt) ) {
                    $('#Editor-isDefaultRt').attr('checked', true);
                    $('#Editor-dstIpId').prop('disabled', true);
                    gIf.isDefaultRt = true;
                }else {
                    $('#Editor-isDefaultRt').prop('disabled', true);
                    gIf.isDefaultRt = false;
                }
            }
    
            $('#Editor-metric').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].metric );
    
            cgiSelectOption( 'Editor-dstIpId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dstIpId);
            cgiSelectOption( 'Editor-nhIfId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].nhIfId);
            cgiSelectOption( 'Editor-nhIpId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].nhIpId);
    
            break;
        }
    
        networkingEditor(e, tar.w, tar.h);
    }
    
    function networkingEditor(e, w, h) {
        var tar = {};
    
        if (gObj.active.h5Index == 'NA') {
            //gNode = gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index];
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label;
        }else {
            //gNode = gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index].panel[gObj.active.h5Index];
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].label;
        }
    
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[1];
    
        $('#popForm').dialog({
            width: w || 800,
            height: h || 600,
            position: "center",
            resizable: false,
            modal: true,
            title: tar.title + ' > ' + gTerm[ gObj.lang ][ tar.type ],
            buttons: {
                OK: function() {
                    if (networkingChecker(e)) {
                        gIf.alter = true;
                        switch( tar.pid )
                        {
                        case 'ike_policy':
                            if (tar.type == 'Create') {
                                gCache[ tar.pid ].gid--;
                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                gData[ tar.pid ][ gNode.guiTNum ]++;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = {};
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].userDefined = 1;
                            }else {
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                                delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] ;
                            }
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#Editor-name').val();
                            gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cipher = $('#Editor-cipher').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].hash = $('#Editor-hash').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dhgroup = $('#Editor-dhgroup').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].lifetime = $('#Editor-lifetime').val();
                            if ( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid > 0 )
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                            else
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                            break;
                        case 'transform_policy':
                            if (tar.type == 'Create') {
                                gCache[ tar.pid ].gid--;
                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                gData[ tar.pid ][ gNode.guiTNum ]++;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = {};
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].userDefined = 1;
                            }else {
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                                delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] ;
                            }
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#Editor-name').val();
                            gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cipher = $('#Editor-cipher').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].hash = $('#Editor-hash').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].pfsgroup = $('#Editor-pfsgroup').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].lifetime = $('#Editor-lifetime').val();
                            if ( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid > 0 )
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                            else
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                            break;
                        case 'ipsec_policies':
                            if (tar.type == 'Create') {
                                gCache[ tar.pid ].gid--;
                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gTmpl.s2svpn.guiRulesT);
                                gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].infoStatus = 2;
                            }else {
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                                delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].infoStatus = 2;
                            }
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#basic_settings-name').val();
                            gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ] = true;
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].type = 0;
                            if ($('#basic_settings-enable').is(':checked')) 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].enable = 1;
                            else 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].enable = 0;
                            
                            if ($('#basic_settings-wanId').val() != 'NA') 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanId = $('#basic_settings-wanId').val();
                            else 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanId = "";
                            
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].remoteGwType = $('#basic_settings-remoteGwType').val();
                            if (0 === parseInt($('#basic_settings-remoteGwType').val())) 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].remoteGw = "";
                            else 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].remoteGw = $('#basic_settings-remoteGw').val();
                            
                            $('input[name=basic_settings-phase1AuthType]').each(function() {
                                if ($(this).is(':checked')) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].phase1AuthType = $(this).val();
                                    if (0 === parseInt($(this).val()))
                                        gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].presharedkey = $('#basic_settings-presharedkey').val();
                                    else 
                                        gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].presharedkey = "";
                                }
                            });
                            
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].localId = $('#basic_settings-localId').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].remoteId = $('#basic_settings-remoteId').val();

                            if ($('#basic_settings-localNetworkId').val() != 'NA') 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].localNetworkId = $('#basic_settings-localNetworkId').val();
                            else 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].localNetworkId = "";
                            
                            if ($('#basic_settings-remoteNetworkId').val() != 'NA') 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].remoteNetworkId = $('#basic_settings-remoteNetworkId').val();
                            else 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].remoteNetworkId = "";
                            
                            if ($('#advance_settings-pfsEnable').is(':checked'))
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].pfsEnable = 1;
                            else
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].pfsEnable = 0;
                                
                            if ($('#advance_settings-dpdEnable').is(':checked')) {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpdEnable = 1;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpddelay = $('#advance_settings-dpddelay').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpdtimeout = $('#advance_settings-dpdtimeout').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpdaction = $('#advance_settings-dpdaction').val();
                            }else{
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpdEnable = 0;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpddelay = 10;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpdtimeout = 30;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dpdaction = 3;
                            }
                            
                            if ($('#advance_settings-ikePolicyId').val() != 'NA') 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ikePolicyId = $('#advance_settings-ikePolicyId').val();
                            else 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ikePolicyId = "";
                            
                            if ($('#advance_settings-transformPolicyId').val() != 'NA') 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].transformPolicyId = $('#advance_settings-transformPolicyId').val();
                            else 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].transformPolicyId = "";
                            
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vpnaclT = [];
                            $('#table-access_control tbody tr').each( function( index ) {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vpnaclT.push({"zoneName": $(this).find('td p').html(), "actionType": $(this).find('td select').val() });
    
                            });
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vpnaclTNum = gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].vpnaclT.length;;
                            
                            if ($('#vpn_failover-wanFailoverEnable').is(':checked'))
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanFailoverEnable = 1;
                            else
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanFailoverEnable = 0;
                                
                            if ($('#vpn_failover-backupPolicyEnable').is(':checked')) {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupPolicyEnable = 1;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupPolicyName = $('#vpn_failover-backupPolicyName').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].fallbackTime = $('#vpn_failover-fallbackTime').val();
                            }else {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupPolicyEnable = 0;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].backupPolicyName = "";
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].fallbackTime = 5;
                            }
                             
                            if (gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid > 0) {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                            }else {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                            }
                            break;
                        case 'dns_forwarder':
                            if (tar.type == 'Create') {
                                gCache[ tar.pid ].gid--;
                                tar.thisNo = gData[ tar.pid ][ gNode.guiT ].length;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gJson.dnssetting.staticDnsT[ 0 ]);
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                            }else {
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                                if ( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid > 0)
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                            }

                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].domain = $('#Editor-domain').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipAddr = $('#Editor-ipAddr').val();
                            break;
                        case 'static_routing':
                            if (tar.type == 'Create') {
                                gCache[ tar.pid ].gid--;
                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gTmpl.staticRoute.guiStaticRouteT);
                                gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                            }else {
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                                delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name ];
                            }
    
                            if ( gCache[ tar.pid ].dstIpId.length > 0 )
                                gCache[ tar.pid ].dstIpId.splice( gCache[ tar.pid ].dstIpId.indexOf( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dstIpId ) ), 1);
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dstIpId = $('#Editor-dstIpId').val();
                            if ( gCache[ tar.pid ].dstIpId.length > 0 )
                                gCache[ tar.pid ].dstIpId.push( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dstIpId) );
    
                            if ($('#Editor-nhType-0').is(':checked')) {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].nhType = 0;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].nhIfId = $('#Editor-nhIfId').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].nhIpId = "";
                            }else {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].nhType = 1;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].nhIfId = "";
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].nhIpId = $('#Editor-nhIpId').val();
                            }
    
                            if ($('#Editor-isDefaultRt').is(':checked')) {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].isDefaultRt = 1;
                                gIf.hasDefaultRt = true;
                            }else {
                                if ( 1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].isDefaultRt ) ) {
                                    gIf.hasDefaultRt = false;
                                }
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].isDefaultRt = 0;
                            }
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].metric = $('#Editor-metric').val();
    
                            if (gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid > 0) {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                            }else {
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                            }
                            break;
                        }
                        refreshNetworking( tar.pid );
                        $( this ).dialog( "close" );
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });

        if (gIf.wasDefaultRt) {
            remindAlert( gError[ gObj.lang ].defaultRoute );
            gIf.wasDefaultRt = false;
        }

    }
    
    function networkingChecker(e, pid) {
    
        var tar = {};
    
        if (pid) {
            tar.pid = pid;
            tar.type = 'Save';
        }else {
            tar.id = $(e.currentTarget).attr('id');
            if (!tar.id)
                return false;
            tar.type  = tar.id.split(gReg.isDash)[0];
    
            tar.pid  = tar.id.split(gReg.isDash)[1];
    
            if (tar.type == 'Create')
                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
            else 
                tar.thisNo = tar.id.split(gReg.isDash)[2];
        }
    
        var pass = true;
        var msg = '';
        switch(tar.pid)
        {
        case 'ike_policy':
        case 'transform_policy':
            switch( tar.type )
            {
            case 'Create':
                if ( gCache.uniq[ tar.pid ][ $('#Editor-name').val() ] || !gReg.ascii.default.test( $('#Editor-name').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName63 + '</p>';
                }
                break;
            case 'Edit':
                if ( ( $('#Editor-name').val() != gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name && gCache.uniq[ tar.pid ][ $('#Editor-name').val() ] ) || !gReg.ascii.default.test( $('#Editor-name').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName63 + '</p>';
                }
                break;
            }
    
            if ( !gReg.lifetime.test( $('#Editor-lifetime').val() ) ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].lifetime + '</p>';
            }
    
            break;
        case 'ipsec_policies':
            switch( tar.type )
            {
            case 'Create':
                if ( gCache.uniq[ tar.pid ][ $('#basic_settings-name').val() ] || !gReg.ascii.default.test( $('#basic_settings-name').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName63 + '</p>';
                }
    
                for (var i=0, len=gData[ tar.pid ][ gNode.guiTNum ]; i<len; i++) 
                {
                    if (parseInt( gData[ tar.pid ][ gNode.guiT ][ i ].localNetworkId ) === parseInt( $('#basic_settings-localNetworkId').val() ) && parseInt( gData[ tar.pid ][ gNode.guiT ][ i ].remoteNetworkId ) === parseInt( $('#basic_settings-remoteNetworkId').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].ipsecPolicies + '</p>';
                    }
                }
    
                break;
            case 'Edit':
                if ( ( $('#basic_settings-name').val() != gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name && gCache.uniq[ tar.pid ][ $('#basic_settings-name').val() ] ) || !gReg.ascii.default.test( $('#basic_settings-name').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName63 + '</p>';
                }
    
                for (var i=0, len=gData[ tar.pid ][ gNode.guiTNum ]; i<len; i++) 
                {
                    if ( i != tar.thisNo && parseInt( gData[ tar.pid ][ gNode.guiT ][ i ].localNetworkId ) === parseInt( $('#basic_settings-localNetworkId').val() ) && parseInt( gData[ tar.pid ][ gNode.guiT ][ i ].remoteNetworkId ) === parseInt( $('#basic_settings-remoteNetworkId').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].ipsecPolicies + '</p>';
                    }
                }
    
                break;
            }
    
            if (0 === parseInt( $('#basic_settings-remoteGwType').val() ) ) {
                if ( !gReg.ascii.remoteGw.test( $('#basic_settings-remoteGw').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].remoteGateway + '</p>';
                }
            }
    
            if ($('#basic_settings-phase1AuthType-0').is(':checked')) {
                if ( !gReg.ascii.presharedkey.test( $('#basic_settings-presharedkey').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].presharedkey + '</p>';
                }
            }
    
            if (isNaN( parseInt( $('#basic_settings-localNetworkId').val()) ) ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].localNetworkIdNeed + '</p>';
            }
    
            if (isNaN( parseInt( $('#basic_settings-remoteNetworkId').val()) ) ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].remoteNetworkIdNeed + '</p>';
            }
    
            if ($('#advance_settings-dpdEnable').is(':checked')) {
                if ( !gReg.dpddelay.test( $('#advance_settings-dpddelay').val() ) ) { 
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].dpddelay + '</p>';
                }
    
                if ( !gReg.dpdtimeout.test( $('#advance_settings-dpdtimeout').val() ) ) { 
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].dpdtimeout + '</p>';
                }
            }
    
            if ($('#vpn_failover-backupPolicyEnable').is(':checked')) {
                if ( 'NA' === $('#vpn_failover-backupPolicyName').val() ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].backupPolicyName + '</p>';
                }
    
                if ( !gReg.fallbackTime.test( $('#vpn_failover-fallbackTime').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].fallbackTime + '</p>';
                }
            }
    
            break;
        case 'static_routing':
            if (!$('#Editor-isDefaultRt').is(':checked') && $('#Editor-dstIpId').val() == 'NA') {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].destinatedNetworkNeed + '</p>';
            }
    
            if ($('#Editor-nhType-0').is(':checked')) {
                if ($('#Editor-nhIfId').val() == 'NA') {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].nextHopNeed + '</p>';
                }
            }else if ($('#Editor-nhIpId').val() == 'NA') {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].nextHopNeed + '</p>';
            }
    
            if (isNaN( parseInt( $('#Editor-metric').val() ) ) || parseInt( $('#Editor-metric').val() ) < 0 || parseInt( $('#Editor-metric').val() ) > 255 ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].metricRange + '</p>';
            }
            break;
        case 'dns_forwarder':
            if (gReg.domainName.test( $('#Editor-domain').val())) {
                for (var i=0, len=gData[ tar.pid ][ gNode.guiT ].length; i<len; i++)
                {
                    if (3 === parseInt( gData[ tar.pid ][ gNode.guiT ][ i ].cgiAction )) {
                        continue;
                    }
                    
                    if ($('#Editor-domain').val() == gData[ tar.pid ][ gNode.guiT ][ i ].domain) {
                        if (!( 'Edit' == tar.type && i == tar.thisNo)) {
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].uniqDomain + '</p>';
                        }
                    }
                }
            } else {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].domainName + '</p>';
            }

            if (!gReg.ipv4.test( $('#Editor-ipAddr').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].ip + '</p>';
            }
            break;
        }
    
        if (!pass) {
            errorAlert( msg );
        }
        return pass;
    }
    
    function saveNetworking(pid) {
        var pass = true;    
        var msg = '';

        switch(pid)
        {
        case 'routing':
            gData[ pid ].routeMode = parseInt( $('input[name=routeMode]:checked').val() );
            gData[ pid ].protoType = parseInt( $('input[name=protoType]:checked').val() );
            gObj.routing.protoType = gData[ pid ].protoType;
            break;
        case 'dns_forwarder':
            gData[ pid ].enableCache = ($('#' + pid + '-enableCache-1').is(':checked'))? 1 : 0;
            if (!gReg.cacheSize.test( $('#' + pid + '-cacheSize').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].cacheSize + '</p>';
            }
            gData[ pid ].cacheSize = $('#' + pid + '-cacheSize').val();
            gData[ pid ].enableStaticDNS = ($('#' + pid + '-enableStaticDNS-1').is(':checked'))? 1 : 0;
            for ( var i=0; i<gData[ pid ][ gNode.guiT ].length; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) < 0) {
                    gData[ pid ][ gNode.guiT ][ i ].gid = 0;
                }
            }
            break;
        case 'ike_policy':
        case 'transform_policy':
            for ( var i=0; i<gData[ pid ][ gNode.guiTNum ]; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) < 0) {
                    gData[ pid ][ gNode.guiT ][ i ].gid = 0;
                }
            }
            break;
        case 'ipsec_policies':
            gData[ pid ].s2svpnEnable = ($('#s2svpnEnable').is(':checked'))? 1 : 0;
            for ( var i=0; i<gData[ pid ][ gNode.guiTNum ]; i++)
            {
                if (parseInt( gData[ pid ][ gNode.guiT ][ i ].gid ) < 0) {
                    gData[ pid ][ gNode.guiT ][ i ].gid = 0;
                }
            }
            break;
        }

        if (!pass) {
            errorAlert( msg );
            return false;
        }
    
        loadingToggle( true );
        $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(gData[ pid ]), function( poster ) {
            gIf.alter = false;
            if (parseInt(poster.status) == 0) {
                if (poster.duration) {
                    gObj.loading = poster.duration;
                    gIf.loading = true;
                } else {
                    loadingToggle( false );
                    getCgiList(gObj.active.pid);
                }
            }else {
                loadingToggle( false );
                if (!$('#popPlus').exists())
                    $('#popBase').append('<div id="popPlus"></div>');
                $('#popPlus').html('<div class="plusForm"><p class="plusMsg"></p></div>');
                $('#popPlus').dialog({
                    width: 300,
                    height:200,
                    position: "center",
                    resizable: false,
                    modal: true,
                    buttons: {
                        Ok: function() {
                            $( this ).dialog( "close" );
                        },
                        Cancel: function() {
                            $( this ).dialog( "close" );
                        }
                    },
                    close: function(event, ui) {
                        $(this).dialog('destroy').remove();
                    }
                });
                switch(parseInt(poster.status))
                {
                default:
                    $('.plusMsg').html( poster.msg );
                }
            }
        });
    
    }
    
    function genFirewall(pid) {
    
        switch(gNode.ext)
        {
        case 'cgi':
            switch(gNode.tag)
            {
            case 'div':
                switch(gNode.type)
                {
                case 'tabs':
                    switch(gNode.tab)
                    {
                    case 'rules':
                        if (gIf.power) {
                            $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                            gY.one('#pgSave').on('click', function(e) {
                                gObj.tabIndex = gObj.tabber.tabs('option', 'selected');
                                if (gObj.tabber.tabs('option', 'selected') == 0)
                                    saveFirewall('rule');
                                else 
                                    saveFirewall('default_policy');
                            });
                        };
        
                        gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"></div>');

                        if ( gNode.columns ) {
                            gColumns[ gNode.tab ] = {};
                            $('div.templateDiv').append('<div id="div-columns" style="display: none"></div>');
                        }

                        $('div.templateDiv').append('<div class="tabber"><ul></ul></div>');
        
                        for (var y in gNode.url.get)
                        {
                            gY.one('.tabber ul').append('<li id="tab-' + y + '"><a href="#panel-' + y + '">' + gNode.tabs[ y ] + '</a></li>');
                            gY.one('.tabber').append('<div id="panel-' + y + '"></div>');
        
                            $.ajax({
                                url: 'cgi-bin/' + gNode.url.get[ y ] + '.' + gNode.ext,
                                dataType: 'json',
                                success: function(data) {
                                    var x = (data.guiDefaultPolicyT)? 'default_policy' : 'rule';
                                    var tmp = '';
                                    gData[ x ] = data;
                                    gColumns[ gNode.tab ][ x ] = {};
                                    switch(pid)
                                    {
                                    case 'rules':
                                        if (gNode.query[ x ])
                                            tmp += '<div class="queryDiv"></div>';
                                        tmp += '<div id="div-' + x + '" class="tableDiv">';
                                        tmp += '<table id="table-' + x + '"';
                                        if (gNode.tblAction[ x ])
                                            tmp += 'class="' + gNode.tblAction[ x ] + '"';
                                        tmp += '>';
                                        tmp += '<thead>';
                                        tmp += '<tr>';
                                        for (var i=0, len=gNode.col[ x ].length; i<len; i++)
                                        {
                                            var wiz = (gNode.col[ x ][ i ].wiz)? gNode.col[ x ][ i ].wiz : 'auto';
                                            tmp += '<th id="' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ i ].tab + '" class="ui-state-default ' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ i ].tab + '" style="width: ' + wiz + ';';
                                            if ( gNode.columns ) {
                                                if ( gNode.col[ x ][ i ].display ) {
                                                    gColumns[ gNode.tab ][ x ][ gNode.col[ x ][ i ].tab ] = true;
                                                } else {
                                                    tmp += ' display: none;';
                                                }
                                            }
                                            tmp += '">';
                                            tmp += gNode.col[ x ][ i ].label;
                                            if (gNode.col[ x ][ i ].tab == 'action') 
                                                gObj.btn = gNode.rowAction[ x ].split(' ');
                                            tmp += '</th>';
                                        }
                                        tmp += '</tr>';
                                        tmp += '</thead>';
                                        tmp += '<tbody></tbody>';
                                        tmp += '</div>';
                                        gY.one('#panel-' + x).set('innerHTML', tmp);
        
                                        switch(x)
                                        {
                                        case 'rule':
                                            var trNo = 0;
                                            gRef.rules.move = [];
                                            gCache.rule = {};
                                            gCache.rule.gid = 0;
                                            for (var i=0, len=gNode.guiTNum[ x ].length; i<len; i++)
                                            {
                                                for (var j=0, jlen=parseInt(data[ gNode.guiTNum[ x ][ i ] ]); j<jlen; j++) 
                                                {
                                                    tmp = '<tr class="' + ((trNo % 2 == 0)? 'even' : 'odd') + '">';
                                                    for (var k=0, klen=gNode.col[ x ].length; k< klen; k++)
                                                    {
                                                        tmp += '<td id="' + gNode.col[ x ][ k ].tab + '-' + trNo + '"';
                                                        tmp += ' class="' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ k ].tab + '"';
                                                        if ( gNode.columns ) {
                                                            if ( !gNode.col[ x ][ k ].display ) {
                                                                tmp += ' style="display: none;"';
                                                            }
                                                        }
                                                        tmp += '>';
                                                        if (gNode.col[ x ][ k ].tab == 'priority')
                                                            tmp += (trNo + 1);
                                                        else if (gNode.col[ x ][ k ].tab == 'checkbox') {
                                                            if (gNode.guiT[ x ][ i ] == 'guiRulesT' && gIf.power) 
                                                                tmp += '<input type="checkbox" value="' + trNo + '" />';
                                                            else 
                                                                tmp += '';
                                                        } else if (gNode.col[ x ][ k ].tab == 'action') {
                                                            if (gNode.guiT[ x ][ i ] == 'guiRulesT' && gIf.power) {
                                                                for (var z=0, zlen=gObj.btn.length; z<zlen; z++)
                                                                {
                                                                    tmp += '<button id="' + gObj.btn[z] + '-' + x + '-' + trNo + '" class="' + gObj.btn[z] + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon" ></span></button>';
                                                                }
                                                            }else 
                                                                tmp += '';
                                                        } else if (gNode.col[ x ][ k ].tab == 'matchAction') 
                                                            tmp += gRef.rules[ gNode.col[ x ][ k ].tab ][ data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ] ];
                                                        else if (gNode.col[ x ][ k ].tab == 'service_application_url') {
                                                            if (parseInt(data[ gNode.guiT[ x ][ i ] ][ j ].service) > 0) 
                                                                tmp += gCache.service[ parseInt( data[ gNode.guiT[ x ][ i ] ][ j ].service ) ];
                                                            else 
                                                                tmp += '';
                                                        } else if (gNode.col[ x ][ k ].tab == 'enabled') 
                                                            tmp += gRef[ pid ][ gNode.col[ x ][ k ].tab ][ data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ] ];
                                                        else if (gNode.col[ x ][ k ].tab == 'log') 
                                                            tmp += gRef[ pid ][ gNode.col[ x ][ k ].tab ][ data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ] ];
                                                        else if (gNode.col[ x ][ k ].tab == 'sourceAddress') {
                                                            if (parseInt( data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ]) == 0 )
                                                                tmp += gTerm[ gObj.lang ].Any;
                                                            else 
                                                                tmp += gCache.address[ data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ] ];
                                                        } else if (gNode.col[ x ][ k ].tab == 'destinationAddress') {
                                                            if (parseInt( data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ]) == 0 )
                                                                tmp += gTerm[ gObj.lang ].Any;
                                                            else 
                                                                tmp += gCache.address[ data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ] ];
                                                        } else if (gNode.col[ x ][ k ].tab == 'fromZone') {
                                                            if (parseInt( data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ]) == 0 )
                                                                tmp += gTerm[ gObj.lang ].Any;
                                                            else 
                                                                tmp += gCache.name[ data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ] ];
                                                        } else if (gNode.col[ x ][ k ].tab == 'toZone') {
                                                            if (parseInt( data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ]) == 0 )
                                                                tmp += gTerm[ gObj.lang ].Any;
                                                            else 
                                                                tmp += gCache.name[ data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ] ];
                                                        } else if (gNode.col[ x ][ k ].tab == 'schedule') {
                                                            if (parseInt( data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ]) == 0 )
                                                                tmp += '';
                                                            else 
                                                                tmp += gCache.schedule[ data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ] ];
                                                        } else
                                                            tmp += data[ gNode.guiT[ x ][ i ] ][ j ][ gNode.col[ x ][ k ].tab ];
                                                        tmp += '</td>';
                                                    }
                                                    tmp += '</tr>';
                                                    if (gNode.guiT[ x ][ i ] == 'guiRulesT') {
                                                        gRef.rules.move.push( j );
                                                    }
                                                    $('#table-' + x + ' tbody').append( tmp );
                                                    trNo++;
                                                }
                                            }
                                            if (gNode.tblAction[ x ] && gIf.power) {
                                                genTblAction( x );
                                                if ( parseInt( gData[ x ][ gNode.guiTNum[ x ][ 0 ] ] ) < parseInt( gLimit.rules.rows ) ) {
                                                    $('#Create-rule').prop('disabled', false);
                                                } else {
                                                    $('#Create-rule').prop('disabled', true);
                                                }
                                            }
                                            if (gNode.query[ x ] )
                                                cgiQuery(x);
                                            break;
                                        case 'default_policy':
                                            for (var i=0, len=parseInt(data[ gNode.guiTNum[ x ] ]); i<len; i++) 
                                            {
                                                tmp = '<tr class="' + ((i % 2 == 0)? 'even' : 'odd') + '">';
                                                for (var j=0, jlen=gNode.col[ x ].length; j<jlen; j++)
                                                {
                                                    tmp += '<td id="' + gNode.col[ x ][ j ].tab + '-' + i + '"';
                                                    tmp += ' class="' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ j ].tab + '"';
                                                    if ( gNode.columns ) {
                                                        if ( !gNode.col[ x ][ j ].display ) {
                                                            tmp += ' style="display: none;"';
                                                        }
                                                    }
                                                    tmp += ' class="' + gNode.tab + '-' + x + '-' + gNode.col[ x ][ j ].tab;
                                                    if (gNode.col[ x ][ j ].tab == 'policy') {
                                                        tmp += ' selectTD">';
                                                        tmp += '<select id="' + x + '-' + gNode.col[ x ][ j ].tab + '-' + i + '">';
                                                        tmp += genSelectOption(gNode.col[ x ][ j ].tab);
                                                        tmp += '</select>';
                                                    }else {
                                                        tmp += '">';
                                                        tmp += gCache.name[ data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] ];
                                                    }
                                                    tmp += '</td>';
                                                }
                                                tmp += '</tr>';
                                                $('#table-' + x + ' tbody').append( tmp );
                                                $('#' + x + '-policy-' + i).val( data[ gNode.guiT[ x ] ][ i ].policy );
                                                if (!gIf.power)
                                                    $('#' + x + '-policy-' + i).prop( 'disabled', true );
                                            }
                                            break;
                                        }
                                        break;
                                    }
                                }
                            });
                        }

                        gObj.tabber = $('.tabber').tabs({
                            create: function( event, ui ) {
                                gObj.tabIndexId = ui.tab[ 0 ].id.split('-').pop();
                            },
                            activate: function( event, ui ) {
                                gObj.tabIndexId = ui.newTab[ 0 ].id.split('-').pop();
                                btnColumns( false );
                            }
                        });

                        break;
                    case 'dynamic_pat':
                        if ( gIf.power ) {
                            $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                            gY.one('#pgSave').on('click', function(e) {
                                gObj.tabIndex = gObj.tabber.tabs('option', 'selected');
                                saveFirewall( gNode.tab );
                            });
                        }
        
                        gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div class="tabber"><ul></ul></div></div>');
        
                        $.ajax({
                            url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                            dataType: 'json',
                            success: function(data) {
                                var tmp = '';
                                gData[ pid ] = data;
    
                                for (var x in gNode.tabs)
                                {
                                    gY.one('.tabber ul').append('<li id="tab-' + x + '"><a href="#panel-' + x + '">' + gNode.tabs[ x ] + '</a></li>');
                                    gY.one('.tabber').append('<div id="panel-' + x + '"></div>');
                                
                                    tmp = '<table id="table-' + x + '">';
                                    tmp += '<thead>';
                                    tmp += '<tr>';
                                    for (var i=0, len=gNode.col[ x ].length; i<len; i++)
                                    {
                                        tmp += '<th id="' + x + '-' + gNode.col[ x ][ i ].tab + '"';
                                        if (gNode.col[ x ][ i ].tab == 'action') {
                                            tmp += 'class="ui-state-default"';
                                            gObj.btn = gNode.rowAction[ x ].split(' ');
                                        }else if (gNode.col[ x ][ i ].tab == 'checkbox') {
                                            tmp += 'class="ui-state-default"';
                                        }else
                                            tmp += 'class="ui-state-default"';
                                        tmp += 'style="width: ' + gNode.col[ x ][ i ].tab + '"';
                                        tmp += '>';
                                        tmp += gNode.col[ x ][ i ].label;
                                        tmp += '</th>';
                                    }
                                    tmp += '</tr>';
                                    tmp += '</thead>';
                                    tmp += '<tbody></tbody>';
                                    tmp += '</div>';
    
                                    $('#panel-' + x ).append( tmp );
    
                                    for (var i=0; i<parseInt( data[ gNode.guiTNum[ x ] ] ); i++)
                                    {                            
                                        gIf.ignore = false;
                                        tmp = '<tr class="' + ((0 === i%2)? 'even' : 'odd') + '">';                            
                                        for (var j=0; j<gNode.col[ x ].length; j++)
                                        {
                                            if ( 'action' == gNode.col[ x ][ j ].tab ) {
                                                tmp += '<td class="buttonTD">';
                                                if (gIf.power) {
                                                    tmp += '<button id="Edit-' + x + '-' + i + '" class="Edit"><span class="ui-icon"  title="Edit"></span></button>';
                                                } else {
                                                    tmp += '';
                                                }
                                                tmp += '</td>';
                                            } else if ( 'checkbox' == gNode.col[ x ][ j ].type ) {
                                                tmp += '<td><input type="checkbox" id="' + gNode.col[ x ][ j ].tab + '-' + i + '" value="1" /></td>';
                                            } else if ( 'mode' == gNode.col[ x ][ j ].tab ) {
                                                tmp += '<td>' + gRef[ gNode.url.get ][ gNode.col[ x ][ j ].tab ][ data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] ] + '</td>';
                                            } else if ( 'address' == gNode.col[ x ][ j ].tab ) {
                                                if ( gReg.isHide.test( data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] ) ) {
                                                    gIf.ignore = true;
                                                }
                                                tmp += '<td>' + data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] + '</td>';
                                            } else if ( 'addressId' == gNode.col[ x ][ j ].tab ) {
                                                tmp += '<td>';
                                                for (var k=0; k<parseInt(gCache.list.common_addr_list.guiAddrTNum); k++)
                                                {
                                                    if ( parseInt(gCache.list.common_addr_list.guiAddrT[ k ].gid) == parseInt( data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] ) ) {
                                                        tmp += gCache.list.common_addr_list.guiAddrT[ k ].name;
                                                    }
                                                }
                                                tmp += '</td>';
                                            } else if ( 'wanName' == gNode.col[ x ][ j ].tab ) {
                                                //isWan[ data[ cgiT ][ i ][ thID ] ] = true;
                                                tmp += '<td>' + data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] + '</td>';
                                            } else {
                                                tmp += '<td>' + data[ gNode.guiT[ x ] ][ i ][ gNode.col[ x ][ j ].tab ] + '</td>';
                                            }
                                        }
                                        tmp += '</tr>';
                                        if (!gIf.ignore) 
                                            $('#table-' + x + ' tbody').append(tmp);
    
                                        if ('pat_settings' == x) {
                                            if (!gIf.ignore) {
                                                for (var j=1; j<7; j++)
                                                {
                                                    if (1 === parseInt(data[ gNode.guiT[ x ] ][ i ][ "enableWan" + j ]))
                                                        $('#enableWan' + j + '-' + i).attr('checked', true); 
                                                    if (! gCache.wanAlias[ 'WAN' + j ] || !gIf.power )
                                                        $('#enableWan' + j + '-' + i).prop('disabled', true); 
                                                }
                                            }
                                        }
                                    }
                                }
                                gObj.tabber = $('.tabber').tabs({ active: gObj.tabIndex });
                            }
                        });
                        break;
                    }
    
                    break;
                case 'form':
                    if ( gIf.power ) {
                        $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                        gY.one('#pgSave').on('click', function(e) {
                            saveFirewall(pid);
                        });
                    }
    
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"></div>');
    
                    $.ajax({
                        url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                        dataType: 'json',
                        success: function(data) {
                            var tmp;
                            gData[ pid ] = data;
                            switch( pid ) 
                            {
                            case 'alg':
                                tmp = '<div id="div-' + pid + '">';
                                tmp += '<ul>';
                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    tmp += '<li><input type="checkbox" id="' + gNode.col[ i ].tab + '" />&nbsp;<label for="' + gNode.col[ i ].tab + '">' + gNode.col[ i ].label + '</label></li>';
                                }
//                                tmp += '<li><input type="checkbox" id="sipEnabled" value="1" />&nbsp;<label for="sipEnabled">SIP Protocol Support</label></li>';
//                                tmp += '<li><input type="checkbox" id="h323Enabled" value="1" />&nbsp;<label for="h323Enabled">H.323 Support</label></li>';
//                                tmp += '<li><input type="checkbox" id="ftpEnabled" value="1" />&nbsp;<label for="ftpEnabled">FTP Enable</label></li>';
                                tmp += '</ul>';
                                tmp += '</div>';
                                $('.templateDiv').append( tmp );

                                if (parseInt(data.sipEnabled) == 1)
                                    $('#sipEnabled').click();
                                if (parseInt(data.h323Enabled) == 1)
                                    $('#h323Enabled').click();
                                if (parseInt(data.ftpEnabled) == 1)
                                    $('#ftpEnabled').click();
                                if ( !gIf.power ) {
                                    $('#' + gNode.col[ 0 ].tab).prop( 'disabled', true );
                                    $('#' + gNode.col[ 1 ].tab).prop( 'disabled', true );
                                    $('#' + gNode.col[ 2 ].tab).prop( 'disabled', true );
                                }
                                break;
                            case 'vpn_passthrough':
                                tmp = '<div id="div-' + pid + '">';
                                tmp += '<ul>';
                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    tmp += '<li><input type="checkbox" id="' + gNode.col[ i ].tab + '" />&nbsp;<label for="' + gNode.col[ i ].tab + '">' + gNode.col[ i ].label + '</label></li>';
                                }
                                //tmp += '<li><input type="checkbox" id="l2tpEnabled" value="1" />&nbsp;<label for="l2tpEnabled">L2TP Enable</label></li>';
                                //tmp += '<li><input type="checkbox" id="pptpEnabled" value="1" />&nbsp;<label for="pptpEnabled">PPTP Enable</label></li>';
                                //tmp += '<li><input type="checkbox" id="ipsecEnabled" value="1" />&nbsp;<label for="ipsecEnabled">IPSEC Enable</label></li>';
                                tmp += '</ul>';
                                tmp += '</div>';

                                $('.templateDiv').append( tmp );
                                if (parseInt(data.l2tpEnabled) == 1)
                                    $('#l2tpEnabled').click();
                                if (parseInt(data.pptpEnabled) == 1)
                                    $('#pptpEnabled').click();
                                if (parseInt(data.ipsecEnabled) == 1)
                                    $('#ipsecEnabled').click();

                                if ( !gIf.power ) {
                                    $('#' + gNode.col[ 0 ].tab).prop( 'disabled', true );
                                    $('#' + gNode.col[ 1 ].tab).prop( 'disabled', true );
                                    $('#' + gNode.col[ 2 ].tab).prop( 'disabled', true );
                                }
                                break;
                            case 'session_settings':
                                tmp =  '<div id="div-' + pid + '">';
                                tmp +=   '<div id="div-tcp_udp">';
                                tmp +=     '<div id="div-tcp">';
                                tmp +=       '<span id="label-' + gNode.col[ 0 ].tab + '" class="alignLeft"><label for="' + gNode.col[ 0 ].tab + '" >' + gNode.col[ 0 ].label + '</label></span>'; 
                                tmp +=       '<span id="input-' + gNode.col[ 0 ].tab + '" class="alignLeft"><input type="text" id="' + gNode.col[ 0 ].tab + '" size="8"/>&nbsp;' + gNode.col[ 0 ].note + '</span>'; 
                                tmp +=     '</div>';
                                tmp +=     '<div id="div-udp">';
                                tmp +=       '<span id="label-' + gNode.col[ 1 ].tab + '" class="alignLeft"><label for="' + gNode.col[ 1 ].tab + '" >' + gNode.col[ 1 ].label + '</label></span>'; 
                                tmp +=       '<span id="input-' + gNode.col[ 1 ].tab + '" class="alignLeft"><input type="text" id="' + gNode.col[ 1 ].tab + '" size="8"/>&nbsp;' + gNode.col[ 1 ].note + '</span>'; 
                                tmp +=     '</div>';
                                tmp +=   '</div>';
                                tmp +=   '<div id="div-other">';
                                tmp +=     '<span id="label-' + gNode.col[ 2 ].tab + '" class="alignLeft"><label for="' + gNode.col[ 2 ].tab + '" >' + gNode.col[ 2 ].label + '</label></span>'; 
                                tmp +=     '<span id="input-' + gNode.col[ 2 ].tab + '" class="alignLeft"><input type="text" id="' + gNode.col[ 2 ].tab + '" size="8"/>' + gNode.col[ 2 ].note + '</span>'; 
                                tmp +=   '</div>';
                                tmp += '</div>';
                                $('.templateDiv').append( tmp );
                                
                                $('#' + gNode.col[ 0 ].tab).val( data[ gNode.col[ 0 ].tab ]);
                                $('#' + gNode.col[ 1 ].tab).val( data[ gNode.col[ 1 ].tab ]);
                                $('#' + gNode.col[ 2 ].tab).val( data[ gNode.col[ 2 ].tab ]);
                                if ( !gIf.power ) {
                                    $('#' + gNode.col[ 0 ].tab).prop( 'disabled', true );
                                    $('#' + gNode.col[ 1 ].tab).prop( 'disabled', true );
                                    $('#' + gNode.col[ 2 ].tab).prop( 'disabled', true );
                                }
                                break;
                            case 'attack_protection':
                                tmp = '<div id="div-' + pid + '">';
                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    tmp += '<div id="div-' + gNode.col[ i ].tab + '">';
                                    tmp += '<table id="table-' + gNode.col[ i ].tab + '" class="noBorder">';
                                    tmp += '<caption>' + gNode.col[ i ].label + '</caption>';
                                    
                                    tmp += '<tr>';
                                    for (var j=0, jlen=gNode.col[ i ].col.length; j<jlen; j++)
                                    {
                                        switch( gNode.col[ i ].col[ j ].type )
                                        {
                                        case 'text':
                                            tmp += '<td class="alignLeft"><label for="' + gNode.col[ i ].col[ j ].tab + '">' + gNode.col[ i ].col[ j ].label + '</label></br><input type="text" id="' + gNode.col[ i ].col[ j ].tab + '" size="8"/>&nbsp;' + gNode.col[ i ].col[ j ].note + '</td>';
                                            break;
                                        case 'checkbox':
                                            tmp += '<td class="alignLeft"><input type="checkbox" id="' + gNode.col[ i ].col[ j ].tab + '" value="' + gNode.col[ i ].col[ j ].val + '" />&nbsp;<label for="' + gNode.col[ i ].col[ j ].tab + '">' + gNode.col[ i ].col[ j ].label + '</label></td>';
                                            break;
                                        }
                                    }
                                    tmp += '</tr>';
                                    tmp += '</table>';
                                    tmp += '</div>';
                                }
                                tmp += '</div>';
                                $('.templateDiv').append( tmp );
    
                                for (var x in data)
                                {
                                    if (gReg.isEnabled.test( x )) {
                                        if (parseInt( data[ x ] ) == 1) {
                                            $('#' + x).click();
                                        }
                                    }else {
                                        $('#' + x).val( data[ x ] );
                                    }
                                    if (!gIf.power)
                                        $('#' + x).prop('disabled', true);
                                }
    
                                break;
                            }
                        }
                    });
                    break;
                }
                break;
            case 'table':
                if (gIf.power ) {
                    $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                    gY.one('#pgSave').on('click', function(e) {
                        saveFirewall(pid);
                    });
                };
    
                gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div id="div-' + pid + '"></div></div>');
                if ( gNode.columns ) {
                    gColumns[ gNode.tab ] = {};
                    $('div.templateDiv').append('<div id="div-columns" style="display: none"></div>');
                }
    
                gCache[ pid ] = {};
                gCache[ pid ].gid = 0;
    
                $.ajax({
                    url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                    dataType: 'json',
                    success: function(data) {
                        var tmp;
                        gData[ pid ] = data;
    
                        tmp = '<table id="table-' + pid + '">';
                        tmp += '<thead>';
                        tmp += '<tr>';
                        for (var i=0, len=gNode.col.length; i<len; i++)
                        {
                            if (gNode.col[ i ].tab == 'action') 
                                gObj.btn = gNode.rowAction.split(' ');
                            var stl = '';
                            var cls = '';
                            if ( gNode.columns ) {
                                cls = gNode.tab + '-' + gNode.col[ i ].tab;
                                if ( gNode.col[ i ].display ) {
                                    gColumns[ gNode.tab ][ gNode.col[ i ].tab ] = true;
                                } else {
                                    stl = ' style="display: none;"';
                                }
                            }
                            tmp += '<th id="' + pid + '-' + gNode.col[ i ].tab + '" class="ui-state-default ' + cls + '" style="width: ' + ((gNode.col[ i ].wiz)? gNode.col[ i ].wiz : 'auto') + ';' + stl + '">';
                            tmp += gNode.col[ i ].label;
                            tmp += '</th>';
                        }
                        tmp += '</tr>';
                        tmp += '</thead>';
                        tmp += '<tbody></tbody>';
                        tmp += '</div>';
    
                        $('#div-' + pid ).append( tmp );
    
                        for (var i=0; i<parseInt( data[ gNode.guiTNum ] ); i++)
                        {                            
                            tmp = '<tr class="' + ((0 === i%2)? 'even' : 'odd') + '">';                            
                            for (var j=0; j<gNode.col.length; j++)
                            {
                                var stl = '';
                                var cls = '';
                                var clss = '';
                                if ( gNode.columns ) {
                                    cls = gNode.tab + '-' + gNode.col[ j ].tab;
                                    clss = ' class="' + gNode.tab + '-' + gNode.col[ j ].tab + '"';
                                    if ( !gNode.col[ j ].display ) {
                                        stl = ' style="display: none;"';
                                    }
                                }
                                switch( gNode.col[ j ].type )
                                {
                                case 'checkbox':
                                    tmp += '<td class="checkTD ' + cls + '" ' + stl + '>';
                                    if ( gIf.power ) {
                                        tmp += '<input type="checkbox" value="' + i + '" />';
                                    } else {
                                        tmp += '</td>';
                                    } 
                                    break;
                                default :
                                    switch( gNode.col[ j ].tab )
                                    {
                                    case 'action':
                                        tmp += '<td class="buttonTD ' + cls + '" ' + stl + '>';
                                        if (gIf.power) {
                                            tmp += '<button id="Edit-' + pid + '-' + i + '" class="Edit"><span class="ui-icon"  title="Edit"></span></button>';
                                            tmp += '<button id="Delete-' + pid + '-' + i + '" class="Delete"><span class="ui-icon"  title="Edit"></span></button>';
                                        } else {
                                            tmp += '';
                                        } 
                                        tmp += '</td>';
                                        break;
                                    case 'index':
                                    case 'seq':
                                        tmp += '<td ' + stl + clss + '>' + (i+1) + '</td>';
                                        break;
                                    case 'originalService':
                                    case 'translatedService':
                                    case 'openedService':
                                    case 'triggerService':
                                        tmp += '<td ' + stl + clss + '>' + gCache.service[ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] + '</td>';
                                        break;
                                    case 'wanIpId':
                                        tmp += '<td ' + stl + clss + '>' + ((gCache.ipName[ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ])? gCache.ipName[ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] : '') + '</td>';
                                        break;
                                    case 'publicIp':
                                    case 'privateIp':
                                    case 'originalSrc':
                                    case 'originalDst':
                                    case 'translatedSrc':
                                    case 'translatedDst':
                                        tmp += '<td ' + stl + clss + '>' + gCache.address[ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] + '</td>';
                                        break;
                                    case 'enabled':
                                        tmp += '<td ' + stl + clss + '>' + gRef.advancedNat[ gNode.col[ j ].tab ][ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] + '</td>';
                                        break;
                                    case 'wan':
                                        tmp += '<td ' + stl + clss + '>' + gRef.wan.interfaces[ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] + '</td>';
                                        break;
                                    case 'fromIf':
                                    case 'toIf':
                                        tmp += '<td ' + stl + clss + '>' + gCache.name[ data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] + '</td>';
                                        break;
                                    default:
                                        tmp += '<td ' + stl + clss + '>' + data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ] + '</td>';
                                    }
                                }
                            }
                            tmp += '</tr>';
                            $('#table-' + pid + ' tbody').append(tmp);
                        }
    
                        if (gNode.tblAction && gIf.power) {
                            genTblAction( pid );
                            if ( parseInt( gData[ pid ][ gNode.guiTNum ] ) < parseInt( gLimit[ gNode.url.get ].rows ) ) {
                                $('#Create-' + pid).prop('disabled', false);
                            } else {
                                $('#Create-' + pid).prop('disabled', true);
                            }
                        }
                    }
                });
                break;
            }
            break;
        }
    }
    
    function refreshFirewall(pid) {
    
        var tableID = '#table-' + pid;
        var tableBD = tableID + ' > tbody';
        var tmp = '';
        switch(pid)
        {
        case 'rule':
            $(tableBD).empty();
            var trNo = 0;
            for (var i=0, len=gNode.guiTNum[ pid ].length; i<len; i++)
            {
                if (gNode.guiT[ pid ][ i ] == 'guiRulesT') {
                    gRef.rules.move = [];
                }
                if (gIf.query) {
                    if (gNode.guiT[ pid ][ i ] == 'guiDefaultRulesT' && !$('#query-default').is(':checked'))
                        continue;
                    else if (gNode.guiT[ pid ][ i ] == 'guiVpnRulesT' && !$('#query-vpn').is(':checked'))
                        continue;
                    else if (gNode.guiT[ pid ][ i ] == 'guiNatRulesT' && !$('#query-nat').is(':checked'))
                        continue;
                }
    
                for (var j=0, jlen=parseInt(gData[ pid ][ gNode.guiTNum[ pid ][ i ] ]); j<jlen; j++)
                {   
                    if (parseInt(gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ].cgiAction) == 3) 
                        continue;
                    if (gIf.query) {
                        if ($('#query-fromZone').val() != 'NA') {
                            if ( parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ].fromZone ) != 0 && parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ].fromZone ) != parseInt( $('#query-fromZone').val() ) )
                                continue;
                        }
                        if ($('#query-toZone').val() != 'NA') {
                            if ( parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ].toZone ) != 0 && parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ].toZone ) != parseInt( $('#query-toZone').val() ) )
                                continue;
                        }
                    }
    
                    tmp = '<tr class="' + ((trNo % 2 == 0)? 'even' : 'odd') + '">';
                    for (var k=0, klen=gNode.col[ pid ].length; k< klen; k++)
                    {
                        tmp += '<td id="' + gNode.col[ pid ][ k ].tab + '-' + trNo + '"';
                        if (!gColumns[ gNode.tab ][ pid ][ gNode.col[ pid ][ k ].tab ]) {
                            tmp += ' class="' + gNode.tab + '-' + pid + '-' + gNode.col[ pid ][ k ].tab + '"';
                            tmp += ' style="display: none;"';
                        }
                        tmp += '>';
                        if (gNode.col[ pid ][ k ].tab == 'priority')
                            tmp += (trNo + 1);
                        else if (gNode.col[ pid ][ k ].tab == 'checkbox') {
                            if (gNode.guiT[ pid ][ i ] == 'guiRulesT' && gIf.power)
                                tmp += '<input type="checkbox" value="' + j + '" />';
                            else
                                tmp += '';
                        }else if (gNode.col[ pid ][ k ].tab == 'action') {
                            if (gNode.guiT[ pid ][ i ] == 'guiRulesT' && gIf.power) {
                                for (var z=0, zlen=gObj.btn.length; z<zlen; z++)
                                {
                                    tmp += '<button id="' + gObj.btn[z] + '-' + pid + '-' + j + '" class="' + gObj.btn[z] + '" title="' + gObj.btn[ z ] + '"><span class="ui-icon" ></span></button>';
                                }
                            }else
                                tmp += '';
                        } else if (gNode.col[ pid ][ k ].tab == 'matchAction') 
                            tmp += gRef.rules[ gNode.col[ pid ][ k ].tab ][ gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ] ];
                        else if (gNode.col[ pid ][ k ].tab == 'service_application_url') {
                            if (parseInt(gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ].service) > 0)
                                tmp += gCache.service[ gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ].service ];
                            else
                                tmp += '';
                        } else if (gNode.col[ pid ][ k ].tab == 'enabled')
                            tmp += gRef.rules[ gNode.col[ pid ][ k ].tab ][ gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ] ];
                        else if (gNode.col[ pid ][ k ].tab == 'log')
                            tmp += gRef.rules[ gNode.col[ pid ][ k ].tab ][ gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ] ];
                        else if (gNode.col[ pid ][ k ].tab == 'sourceAddress') {
                            if (parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ] ) == 0 )
                                tmp += gTerm[ gObj.lang ].Any;
                            else
                                tmp += gCache.address[ parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ] ) ];
                        } else if (gNode.col[ pid ][ k ].tab == 'destinationAddress') {
                            if (isNaN( parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ]) ) || parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ]) == 0 )
                                tmp += gTerm[ gObj.lang ].Any;
                            else
                                tmp += gCache.address[ parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ] ) ];
                        } else if (gNode.col[ pid ][ k ].tab == 'fromZone') {
                            if (isNaN( parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ]) ) || parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ]) == 0 )
                                tmp += gTerm[ gObj.lang ].Any;
                            else
                                tmp += gCache.name[ gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ] ];
                        } else if (gNode.col[ pid ][ k ].tab == 'toZone') {
                            if (parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ]) == 0 )
                                tmp += gTerm[ gObj.lang ].Any;
                            else
                                tmp += gCache.name[ gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ] ];
                        } else if (gNode.col[ pid ][ k ].tab == 'schedule') {
                            if (parseInt( gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ]) == 0 )
                                tmp += '';
                            else
                                tmp += gCache.schedule[ gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ] ];
                        } else
                            tmp += gData[ pid ][ gNode.guiT[ pid ][ i ] ][ j ][ gNode.col[ pid ][ k ].tab ];
                        tmp += '</td>';
                    }
                    tmp += '</tr>';
                    if (gNode.guiT[ pid ][ i ] == 'guiRulesT') {
                        gRef.rules.move.push( trNo );
                    }
                    trNo++;
                    $(tableBD).append(tmp);
                }
            }
            if ( parseInt( gData[ pid ][ gNode.guiTNum[ pid ][ 0 ] ] ) < parseInt( gLimit.rules.rows ) ) {
                $('#Create-rule').prop('disabled', false);
            } else {
                $('#Create-rule').prop('disabled', true);
            }
            break;
        case 'wan_address_settings':
            $('#table-' + pid + ' tbody').empty();
            for (var i=0; i<parseInt( gData.dynamic_pat[ gNode.guiTNum[ pid ] ] ); i++)
            {
                tmp = '<tr class="' + ((0 === i%2)? 'even' : 'odd') + '">';
                for (var j=0; j<gNode.col[ pid ].length; j++)
                {
                    if ( 'action' == gNode.col[ pid ][ j ].tab ) {
                        tmp += '<td class="buttonTD">';
                        if (gIf.power) {
                            tmp += '<button id="Edit-' + pid + '-' + i + '" class="Edit"><span class="ui-icon"  title="Edit"></span></button>';
                        } else {
                            tmp += '';
                        }
                        tmp += '</td>';
                    } else if ( 'mode' == gNode.col[ pid ][ j ].tab ) {
                        tmp += '<td>' + gRef[ gNode.url.get ][ gNode.col[ pid ][ j ].tab ][ gData.dynamic_pat[ gNode.guiT[ pid ] ][ i ][ gNode.col[ pid ][ j ].tab ] ] + '</td>';
                    } else if ( 'addressId' == gNode.col[ pid ][ j ].tab ) {
                        tmp += '<td>';
                        for (var k=0; k<parseInt(gCache.list.common_addr_list.guiAddrTNum); k++)
                        {
                            if ( parseInt(gCache.list.common_addr_list.guiAddrT[ k ].gid) == parseInt( gData.dynamic_pat[ gNode.guiT[ pid ] ][ i ][ gNode.col[ pid ][ j ].tab ] ) ) {
                                tmp += gCache.list.common_addr_list.guiAddrT[ k ].name;
                            }
                        }
                        tmp += '</td>';
                    } else if ( 'wanName' == gNode.col[ pid ][ j ].tab ) {
                        tmp += '<td>' + gData.dynamic_pat[ gNode.guiT[ pid ] ][ i ][ gNode.col[ pid ][ j ].tab ] + '</td>';
                    }
                }
                tmp += '</tr>';
                $('#table-' + pid + ' tbody').append(tmp);
            }
            
            break;
        case 'static_nat':
        case 'port_forwarding':
        case 'port_trigger':
        case 'advanced_nat':
            $('#table-' + pid + ' tbody').empty();
            for (var i=0; i<parseInt( gData[ pid ][ gNode.guiTNum ] ); i++)
            {
                if (parseInt(gData[ pid ][ gNode.guiT ][ i ].cgiAction) == 3) 
                    continue;
                tmp = '<tr class="' + ((0 === i%2)? 'even' : 'odd') + '">';
                for (var j=0; j<gNode.col.length; j++)
                {
                    var stl = '';
                    var cls = '';
                    var clss = '';
                    if (gNode.columns) {
                        if (!gColumns[ gNode.tab ][ gNode.col[ j ].tab ]) {
                            stl = ' style="display: none;"';
                        }
                        cls = gNode.tab + '-' + gNode.col[ j ].tab;
                        clss = ' class="' + gNode.tab + '-' + gNode.col[ j ].tab + '"';
                    }
                    switch( gNode.col[ j ].type )
                    {
                    case 'checkbox':
                        tmp += '<td class="checkTD ' + cls + '"' + stl + '>';
                        if (gIf.power) {
                            tmp += '<input type="checkbox" value="' + i + '" />';
                        } else {
                            tmp += '';
                        }
                        tmp += '</td>';
                        break;
                    default :
                        switch( gNode.col[ j ].tab )
                        {
                        case 'action':
                            tmp += '<td class="buttonTD ' + cls + '"' + stl + '>';
                            if (gIf.power) {
                                tmp += '<button id="Edit-' + pid + '-' + i + '" class="Edit"><span class="ui-icon"  title="Edit"></span></button>';
                                tmp += '<button id="Delete-' + pid + '-' + i + '" class="Delete"><span class="ui-icon"  title="Edit"></span></button>';
                            } else {
                                tmp += '';
                            }
                            tmp += '</td>';
                            break;
                        case 'index':
                        case 'seq':
                            tmp += '<td ' + clss + stl + '>' + (i+1) + '</td>';
                            break;
                        case 'originalService':
                        case 'translatedService':
                        case 'openedService':
                        case 'triggerService':
                            tmp += '<td ' + clss + stl + '>';
                            if ( gCache.service[ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] )
                                tmp += gCache.service[ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] ;
                            else 
                                tmp += '';
                            tmp += '</td>';
                            break;
                        case 'wanIpId':
                            tmp += '<td ' + clss + stl + '>' + ((gCache.ipName[ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ])? gCache.ipName[ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] : '') + '</td>';
                            break;
                        case 'publicIp':
                        case 'privateIp':
                        case 'originalSrc':
                        case 'originalDst':
                        case 'translatedSrc':
                        case 'translatedDst':
                            tmp += '<td ' + clss + stl + '>';
                            if ( gCache.address[ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] )
                                tmp += gCache.address[ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ];
                            else 
                                tmp += '';
                            tmp += '</td>';
                            break;
                        case 'enabled':
                            tmp += '<td ' + clss + stl + '>';
                            if ( gRef.advancedNat[ gNode.col[ j ].tab ][ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] )
                                tmp += gRef.advancedNat[ gNode.col[ j ].tab ][ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] ;
                            else 
                                tmp += '';
                            tmp += '</td>';
                            break;
                        case 'wan':
                            tmp += '<td ' + clss + stl + '>';
                            if ( gRef.wan.interfaces[ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] )
                                tmp += gRef.wan.interfaces[ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] ;
                            else 
                                tmp += '';
                            tmp += '</td>';
                            break;
                        case 'fromIf':
                        case 'toIf':
                            tmp += '<td ' + clss + stl + '>';
                            if ( gCache.name[ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] )
                                tmp += gCache.name[ gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] ] ;
                            else 
                                tmp += '';
                            tmp += '</td>';
                            break;
                        default:
                            tmp += '<td ' + clss + stl + '>';
                            if ( gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ] )
                                tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                            else 
                                tmp += '';
                            tmp += '</td>';
                        }
                    }
                }
                tmp += '</tr>';
                $('#table-' + pid + ' tbody').append(tmp);
            }
            if ( parseInt( gData[ pid ][ gNode.guiTNum ] ) < parseInt( gLimit[ gNode.url.get ].rows ) ) {
                $('#Create-' + pid).prop('disabled', false);
            } else {
                $('#Create-' + pid).prop('disabled', true);
            }
            break;
        }
    
    }
    
    function createFirewall(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        tar.w = 480;
        tar.h = 320;
    
        var tmp;
    
        switch( tar.pid )
        {
        case 'rule':
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
    
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                switch( gNode.editor[ i ].tag )
                {
                case 'p':
                    tmp += '<tr>';
                    tmp += '<th class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].wiz)? gNode.editor[ i ].wiz : 'auto') + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 1 ] : 'Left') + '">';
                    tmp += '<p id="Editor-' + gNode.editor[ i ].tab + '"></p>';
                    if ( gNode.editor[ i ].col ) {
                        for (var j=0; j<gNode.editor[ i ].col.length; j++)
                        {
                            if ( gNode.editor[ i ].col[ j ].tag == 'select' ) {
                                tmp += '<select id="Editor-' + gNode.editor[ i ].col[ j ].tab + '" >';
                                if ('object' === typeof gNode.editor[ i ].col[ j ].option) {
                                    for (var x in gNode.editor[ i ].col[ j ].option)
                                    {
                                        tmp += '<option value="' + x + '"  >' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                                    }
                                }
                                tmp += '</select>';
                            }
                        }
                    }
                    tmp += '</td>';
                    tmp += '</tr>';
                    break;
                case 'input':
                    switch( gNode.editor[ i ].type )
                    {
                    case 'text':
                        tmp += '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].wiz)? gNode.editor[ i ].wiz : 'auto') + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 1 ] : 'Left') + '">';
                        tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" size="8" />';
                        if ( gNode.editor[ i ].note )
                            tmp += '&nbsp' + gNode.editor[ i ].note;
                        tmp += '</td>';
                        tmp += '</tr>';
                        break;
                    case 'radio':
                        var cnt = 0;
                        var rows = 0;
                        for (var x in gNode.editor[ i ].option)
                            rows++;
                        for (var x in gNode.editor[ i ].option)
                        {
                            tmp += '<tr>';
                            if (0 === cnt) {
                                tmp += '<th ' + ((rows > 1)? 'rowspan="' + rows + '"' : "") + 'class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].wiz)? gNode.editor[ i ].wiz : 'auto') + '">';
                                tmp += '<label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label>';
                                tmp += '</th>';
                            }else {
                                tmp += '<td></td>';
                            }
                            tmp += '<td class="alignLeft">';
                            tmp += '<input type="radio" name="Editor-' + gNode.editor[ i ].tab + '" id="Editor-' + gNode.editor[ i ].tab + '-' + x + '" value="' + x + '"  />';
                            tmp += '&nbsp;<label for="Editor-' + gNode.editor[ i ].option[ x ].tab + '-' + x + '">' + gNode.editor[ i ].option[ x ].label + '</label>';
                            tmp += '&nbsp;<select id="Editor-' + gNode.editor[ i ].option[ x ].tab + '"></select>';
                            tmp += '</td>';
                            tmp += '</tr>';
                            cnt++;
                        }
                        break;
                    case 'checkbox':
                        tmp += '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].wiz)? gNode.editor[ i ].wiz : 'auto') + '">';
                        tmp += '<input type="checkbox" id="Editor-' + gNode.editor[ i ].tab + '" value="' + gNode.editor[ i ].val + '"  />';
                        tmp += '<label for="Editor-' + gNode.editor[ i ].tab + '">&nbsp;' + gNode.editor[ i ].label + '</label>';
                        tmp += '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 1 ] : 'Left') + '"></td>';
                        tmp += '</tr>';
                        
                        break;
                    }
                    break;
                case 'select':
                    tmp += '<tr>';
                    tmp += '<th class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].wiz)? gNode.editor[ i ].wiz : 'auto') + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 1 ] : 'Left') + '">';
                    tmp += '<select id="Editor-' + gNode.editor[ i ].tab + '" >';
                    if ('object' === typeof gNode.editor[ i ].option) {
                        for (var x in gNode.editor[ i ].option)
                        {
                            tmp += '<option value="' + x + '">' + gNode.editor[ i ].option[ x ] + '</option>';
                        }
                    }
                    tmp += '</select>';
                    tmp += '</td>';
                    tmp += '</tr>';
                    break;
                case 'table':
                    tmp += '<thead>';
                    tmp += '<tr>';
                    for (var k=0, klen=gNode.editor[ i ].col.length; k<klen; k++)
                    {
                        tmp += '<th style="width: ' + gNode.editor[ i ].col[ k ].wiz + '" class="ui-state-default" >' + gNode.editor[ i ].col[ k ].label  + '</th>';
                    }
                    tmp += '</tr>';
                    
                    tmp += '</thead>';
                    tmp += '<tbody>';
                    for (var k=0, klen=gCache.list.common_zoneIf_list.guiZoneIfTNum; k<klen; k++)
                    {
                        tmp += '<tr class="' + ((0 === k%2)? 'even': 'odd' ) + '">';
                        for (var m=0, mlen=gNode.editor[ i ].col.length; m<mlen; m++) 
                        {
                            tmp += '<td>';
                            if ('p' === gNode.editor[ i ].col[ m ].tag) {
                                tmp += '<p id="Editor-' + gNode.editor[ i ].col[ m ].tab + '-' + k + '">' + gCache.list.common_zoneIf_list.guiZoneIfT[ k ].name + '</p>';
                            }else {
                                tmp += '<select id="Editor-' + gNode.editor[ i ].col[ m ].tab + '-' + k + '">';
                                for (var x in gNode.editor[ i ].col[ m ].option)
                                {
                                    tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ m ].option[ x ] + '</option>';
                                }
                                tmp += '</select>';
                            }
                            tmp += '</td>';
                        }
                        tmp += '</tr>';
                    }
                    tmp += '</tbody>';
                    break;
                }
            }
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
    
            $('#Editor-service_app_url-0').attr("checked", true).trigger("click");
    
            cgiSelectOption( 'Editor-fromZone' );
            cgiSelectOption( 'Editor-toZone' );
            cgiSelectOption( 'Editor-service' );
            cgiSelectOption( 'Editor-sourceAddress' );
            cgiSelectOption( 'Editor-destinationAddress' );
            cgiSelectOption( 'Editor-schedule' );
    
            $('#Editor-matchAction').val( 0 );
            break;
        case 'static_nat':
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width:' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '" ><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                tmp += '</tr>';
            }
/*
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT100">WAN Interface</th>';
            tmp += '<td class="alignLeft"><select id="Editor-wanInterface"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT100">Public IP</th>';
            tmp += '<td class="alignLeft"><select id="Editor-publicIp"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT100">Private IP</th>';
            tmp += '<td class="alignLeft"><select id="Editor-privateIp"></select></td>';
            tmp += '</tr>';
*/
            tmp += '</table>';
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
    
            $('#Editor-wanInterface').change( function() {
                cgiSelectOption( 'Editor-publicIp' );
            });
    
            $('#Editor-wanInterface').append( genSelectOption( 'Editor-wanInterface' ) ).val( 'WAN1' );
            cgiSelectOption( 'Editor-privateIp' );
            cgiSelectOption( 'Editor-publicIp' );
    
            break;
        case 'port_forwarding':
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width:' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                if (gNode.editor[ i ].col) {
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + ' BT80"><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '" ><span id="span-wanIpId"><select id="Editor-wanIpId"></select></span></td>';
                } else {
                    if (gNode.editor[ i ].tag == 'input') {
                        tmp += '<td colspan="2" class="align' + gNode.editor[ i ].align[ 1 ] + '" ><input id="Editor-' + gNode.editor[ i ].tab + '" /></td>';
                    } else {
                        tmp += '<td colspan="2" class="align' + gNode.editor[ i ].align[ 1 ] + '" ><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                    }
                }
                tmp += '</tr>';
            }
/*
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT150">Service</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-originalService"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT150">Translated Service</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-translatedService"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT150">Translated Private IP</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-privateIp"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT150">WAN</th>';
            tmp += '<td class="alignLeft BT80"><select id="Editor-wan"></select></td>';
            tmp += '<td class="alignLeft"><span id="span-wanIpId"><label for="Editor-wanIpId">IP&nbsp;</label><select id="Editor-wanIpId"></select></span></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT150">Description</th>';
            tmp += '<td colspan="2" class="alignLeft"><input type="text" id="Editor-description" /></td>';
            tmp += '</tr>';
*/
            tmp += '</table>';
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
    
            $('#Editor-wan').change( function() {
                if ( 0 === parseInt( $(this).val() ) ) {
                    $('#span-wanIpId').hide();
                } else {
                    $('#span-wanIpId').show();
                    cgiSelectOption( 'Editor-wanIpId' );
                }
            });
    
            $('#Editor-wan').append( genSelectOption( 'Editor-wan' ) ).val( 0 ).trigger('change');
            cgiSelectOption( 'Editor-privateIp' );
            cgiSelectOption( 'Editor-wanIpId' );
            cgiSelectOption( 'Editor-originalService' );
            cgiSelectOption( 'Editor-translatedService' );
            break;
        case 'port_trigger':
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width:' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                switch (gNode.editor[ i ].type)
                {
                case 'text':
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '"><input type="text" id="Editor-' + gNode.editor[ i ].tab + '" /></td>';
                    break;
                default: 
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '"><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                }
                tmp += '</tr>';
            }
/*
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT120">Enable</th>';
            tmp += '<td colspan="2" class="alignLeft"><input type="checkbox" id="Editor-enable" value="1" /></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT120">Trigger Service</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-triggerService"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT120">Opened Service</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-openedService"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT120">Description</th>';
            tmp += '<td colspan="2" class="alignLeft"><input type="text" id="Editor-description" /></td>';
            tmp += '</tr>';
*/
            tmp += '</table>';
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
            cgiSelectOption( 'Editor-triggerService' );
            cgiSelectOption( 'Editor-openedService' );
            break;
        case 'advanced_nat':
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                if (gNode.editor[ i ].type == 'checkbox') {
                    tmp += '<th colspan="3" class="align' + gNode.editor[ i ].align[ 0 ] + '"><input type="checkbox" id="Editor-' + gNode.editor[ i ].tab + '" value="' + gNode.editor[ i ].val + '" /><label for="Editor-' + gNode.editor[ i ].tab + '">&nbsp;' + gNode.editor[ i ].label + '</label></th>';
                } else {
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width:' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td colspan="2" class="align' + gNode.editor[ i ].align[ 1 ] + '"><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                }
                tmp += '</tr>';
            }
/*
            tmp += '<tr>';
            tmp += '<th colspan="3" class="alignLeft"><input type="checkbox" id="Editor-enable" value="1" /><label for="Editor-enable">&nbsp;Enable</label></th>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">From</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-fromIf"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">To</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-toIf"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Original Source Address</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-originalSrc"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Original Destination Address</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-originalDst"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Original Services</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-originalService"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Translated Source Address</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-translatedSrc"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Translated Destination Address</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-translatedDst"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Translated Services</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-translatedService"></select></td>';
            tmp += '</tr>';
*/
            tmp += '</table>';        
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
    
            cgiSelectOption( 'Editor-fromIf' );
            cgiSelectOption( 'Editor-toIf' );
            cgiSelectOption( 'Editor-originalSrc' );
            cgiSelectOption( 'Editor-originalDst' );
            cgiSelectOption( 'Editor-originalService' );
            cgiSelectOption( 'Editor-translatedSrc' );
            cgiSelectOption( 'Editor-translatedDst' );
            cgiSelectOption( 'Editor-translatedService' );
            break;
        }
    
        firewallEditor(e, tar.w, tar.h);
    }
    
    function editFirewall(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        tar.thisNo = tar.id.split(gReg.isDash)[2];
    
        tar.w = 480;
        tar.h = 320;
    
        var tmp;
    
        switch(tar.pid)
        {
        case 'rule':
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
    
            for (var i=0, len=gNode.editor.length; i<len; i++) 
            {
                switch( gNode.editor[ i ].tag )
                {
                case 'p':
                    tmp += '<tr>';
                    tmp += '<th class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].wiz)? gNode.editor[ i ].wiz : 'auto') + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 1 ] : 'Left') + '">';
                    tmp += '<p id="Editor-' + gNode.editor[ i ].tab + '"></p>';
                    if ( gNode.editor[ i ].col ) {
                        for (var j=0; j<gNode.editor[ i ].col.length; j++)
                        {
                            if ( gNode.editor[ i ].col[ j ].tag == 'select' ) {
                                tmp += '<select id="Editor-' + gNode.editor[ i ].col[ j ].tab + '" >';
                                if ('object' === typeof gNode.editor[ i ].col[ j ].option) {
                                    for (var x in gNode.editor[ i ].col[ j ].option)
                                    {
                                        tmp += '<option value="' + x + '"  >' + gNode.editor[ i ].col[ j ].option[ x ] + '</option>';
                                    }
                                }
                                tmp += '</select>';
                            }
                        }
                    }
                    tmp += '</td>';
                    tmp += '</tr>';
                    break;
                case 'input':
                    switch( gNode.editor[ i ].type )
                    {
                    case 'text':
                        tmp += '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].wiz)? gNode.editor[ i ].wiz : 'auto') + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 1 ] : 'Left') + '">';
                        tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" size="8" />';
                        if ( gNode.editor[ i ].note )
                            tmp += '&nbsp' + gNode.editor[ i ].note;
                        tmp += '</td>';
                        tmp += '</tr>';
                        break;
                    case 'radio':
                        var cnt = 0;
                        var rows = 0;
                        for (var x in gNode.editor[ i ].option)
                            rows++;
                        for (var x in gNode.editor[ i ].option)
                        {
                            tmp += '<tr>';
                            if (0 === cnt) {
                                tmp += '<th ' + ((rows > 1)? 'rowspan="' + rows + '"' : "") + 'class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].wiz)? gNode.editor[ i ].wiz : 'auto') + '">';
                                tmp += '<label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label>';
                                tmp += '</th>';
                            }else {
                                tmp += '<td></td>';
                            }
                            tmp += '<td class="alignLeft">';
                            tmp += '<input type="radio" name="Editor-' + gNode.editor[ i ].tab + '" id="Editor-' + gNode.editor[ i ].tab + '-' + x + '" value="' + x + '"  />';
                            tmp += '&nbsp;<label for="Editor-' + gNode.editor[ i ].option[ x ].tab + '-' + x + '">' + gNode.editor[ i ].option[ x ].label + '</label>';
                            tmp += '&nbsp;<select id="Editor-' + gNode.editor[ i ].option[ x ].tab + '"></select>';
                            tmp += '</td>';
                            tmp += '</tr>';
                            cnt++;
                        }
                        break;
                    case 'checkbox':
                        tmp += '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].wiz)? gNode.editor[ i ].wiz : 'auto') + '">';
                        tmp += '<input type="checkbox" id="Editor-' + gNode.editor[ i ].tab + '" value="' + gNode.editor[ i ].val + '"  />';
                        tmp += '<label for="Editor-' + gNode.editor[ i ].tab + '">&nbsp;' + gNode.editor[ i ].label + '</label>';
                        tmp += '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 1 ] : 'Left') + '"></td>';
                        tmp += '</tr>';
                        break;
                    }
                    break;
                case 'select':
                    tmp += '<tr>';
                    tmp += '<th class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 0 ] : 'Left') + '" style="width: ' + ((gNode.editor[ i ].wiz)? gNode.editor[ i ].wiz : 'auto') + '"><label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + ((gNode.editor[ i ].align)? gNode.editor[ i ].align[ 1 ] : 'Left') + '">';
                    tmp += '<select id="Editor-' + gNode.editor[ i ].tab + '" >';
                    if ('object' === typeof gNode.editor[ i ].option) {
                        for (var x in gNode.editor[ i ].option)
                        {
                            tmp += '<option value="' + x + '">' + gNode.editor[ i ].option[ x ] + '</option>';
                        }
                    }
                    tmp += '</select>';
                    tmp += '</td>';
                    tmp += '</tr>';
                    if ( gNode.editor[ i ].col ) {
                        tmp += '<tr id="Editor-' + gNode.editor[ i ].col[ j ].tab + '-NE-0">';
                        tmp += '<td class="alignLeft"></td>';
                        tmp += '<td class="alignLeft">';
                        tmp += '<label for="Editor-' + gNode.editor[ i ].col.tab + '">' + gNode.editor[ i ].col.label + '</label>';
                        tmp += '&nbsp;<input type="text" id="Editor-' + gNode.editor[ i ].col.tab + '" size="8"/>';
                        if ( gNode.editor[ i ].col.note )
                            tmp += '&nbsp' + gNode.editor[ i ].col.note;
                        tmp += '</td>';
                        tmp += '</tr>';
                    }
                    break;
                case 'table':
                    tmp += '<thead>';
                    tmp += '<tr>';
                    for (var k=0, klen=gNode.editor[ i ].col.length; k<klen; k++)
                    {
                        tmp += '<th style="width: ' + gNode.editor[ i ].col[ k ].wiz + '" class="ui-state-default" >' + gNode.editor[ i ].col[ k ].label  + '</th>';
                    }
                    tmp += '</tr>';
                    
                    tmp += '</thead>';
                    tmp += '<tbody>';
                    for (var k=0, klen=gCache.list.common_zoneIf_list.guiZoneIfTNum; k<klen; k++)
                    {
                        tmp += '<tr class="' + ((0 === k%2)? 'even': 'odd' ) + '">';
                        for (var m=0, mlen=gNode.editor[ i ].col.length; m<mlen; m++) 
                        {
                            tmp += '<td>';
                            if ('p' === gNode.editor[ i ].col[ m ].tag) {
                                tmp += '<p id="Editor-' + gNode.editor[ i ].col[ m ].tab + '-' + k + '">' + gCache.list.common_zoneIf_list.guiZoneIfT[ k ].name + '</p>';
                            }else {
                                tmp += '<select id="Editor-' + gNode.editor[ i ].col[ m ].tab + '-' + k + '">';
                                for (var x in gNode.editor[ i ].col[ m ].option)
                                {
                                    tmp += '<option value="' + x + '">' + gNode.editor[ i ].col[ m ].option[ x ] + '</option>';
                                }
                                tmp += '</select>';
                            }
                            tmp += '</td>';
                        }
                        tmp += '</tr>';
                    }
                    tmp += '</tbody>';
                    break;
                }
            }
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
    
            if (1 === parseInt(gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].enabled))
                $('#Editor-enabled').click();
    
            if (1 === parseInt(gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].log))
                $('#Editor-log').click();
            $('#Editor-service_app_url-0').attr("checked", true).trigger("click");
    
            cgiSelectOption( 'Editor-fromZone', gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].fromZone );
            cgiSelectOption( 'Editor-toZone', gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].toZone );
            cgiSelectOption( 'Editor-service', gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].service );
            cgiSelectOption( 'Editor-sourceAddress', gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].sourceAddress );
            cgiSelectOption( 'Editor-destinationAddress', gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].destinationAddress );
            cgiSelectOption( 'Editor-schedule', gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].schedule );
            $('#Editor-matchAction').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].matchAction );
            break;
        case 'wan_address_settings':
    
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';

            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                if ( gNode.editor[ tar.pid ][ i ].tag == 'p' ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">' + gNode.editor[ tar.pid ][ i ].label + '</th>';
                    tmp += '<td colspan="2" class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '"><p id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '">' + gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ][ gNode.editor[ tar.pid ][ i ].tab ] + '</p></td>';
                    tmp += '</tr>';
                } else {
                    for (var x in gNode.editor[ tar.pid ][ i ].option)
                    {
                        tmp += '<tr>';
                        if (gNode.editor[ tar.pid ][ i ].option[ x ].col) {
                            tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '"></th>';
                            tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ x ].wiz + '"><input type="radio" name="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + x + '" value="' + x + '" /><label for="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + x + '">&nbsp;' + gNode.editor[ tar.pid ][ i ].option[ x ].label + '</label></td>';
                            tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ x ].col.align[ 0 ] + '">&nbsp;' + gNode.editor[ tar.pid ][ i ].option[ x ].col.label + '&nbsp;<select id="Editor-' + gNode.editor[ tar.pid ][ i ].option[ x ].col.tab + '"></select></td>';
                        } else {
                            tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">' + gNode.editor[ tar.pid ][ i ].label + '</th>';
                            tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ x ].wiz + '"><input type="radio" name="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + x + '" value="' + x + '" /><label for="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + x + '">&nbsp;' + gNode.editor[ tar.pid ][ i ].option[ x ].label + '</label></td><td></td>';
                        }
                        tmp += '</tr>';
                    }
                }
            }

/*
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT100">WAN Interface</th>';
            tmp += '<td colspan="2" class="alignLeft"><p id="Editor-wanName"></p></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT100">Mode</th>';
            tmp += '<td class="alignLeft BT60">';
            tmp += '<input type="radio" name="Editor-mode" id="Editor-mode-0" value="0" />&nbsp;';
            tmp += '<label for="Editor-mode-0">Auto</label>';
            tmp += '</td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT100"></th>';
            tmp += '<td class="alignLeft BT60">';
            tmp += '<input type="radio" name="Editor-mode" id="Editor-mode-1" value="1" />&nbsp;';
            tmp += '<label for="Editor-mode-1">Manual</label>';
            tmp += '</td>';
            tmp += '<td class="alignLeft">';
            tmp += '&nbsp;IP Address&nbsp;<select id="Editor-addressId">';
            tmp += '</td>';
            tmp += '</tr>';
*/
            tmp += '</table>';
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
    
            $('input[name=Editor-mode]').change( function(){
                if ( 1 === parseInt($(this).val())) {
                    $('#Editor-addressId').prop('disabled', false);
                } else {
                    $('#Editor-addressId').prop('disabled', true);
                }
            });
    
            if (1 === parseInt( gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mode ))
                $('#Editor-mode-1').attr('checked', true).trigger('click');
            else
                $('#Editor-mode-0').attr('checked', true).trigger('click');
    
            //$('#Editor-wanName').html( gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ].wanName );
            cgiSelectOption( 'Editor-addressId', gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ].addressId );
            break;
        case 'static_nat':
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width:' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '" ><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                tmp += '</tr>';
            }
/*
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT100">WAN Interface</th>';
            tmp += '<td class="alignLeft"><select id="Editor-wanInterface"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT100">Public IP</th>';
            tmp += '<td class="alignLeft"><select id="Editor-publicIp"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT100">Private IP</th>';
            tmp += '<td class="alignLeft"><select id="Editor-privateIp"></select></td>';
            tmp += '</tr>';
*/
            tmp += '</table>';
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
    
            $('#Editor-wanInterface').change( function() {
                cgiSelectOption( 'Editor-publicIp' );
            });
    
            $('#Editor-wanInterface').append( genSelectOption( 'Editor-wanInterface' ) ).val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanInterface );
            cgiSelectOption( 'Editor-privateIp', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].privateIp );
            cgiSelectOption( 'Editor-publicIp', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].publicIp );
            break;
        case 'port_forwarding':
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width:' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                if (gNode.editor[ i ].col) {
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + ' BT80" ><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '" ><span id="span-wanIpId"><select id="Editor-wanIpId"></select></span></td>';
                } else {
                    if (gNode.editor[ i ].tag == 'input') {
                        tmp += '<td colspan="2" class="align' + gNode.editor[ i ].align[ 1 ] + '" ><input id="Editor-' + gNode.editor[ i ].tab + '" /></td>';
                    } else {
                        tmp += '<td colspan="2" class="align' + gNode.editor[ i ].align[ 1 ] + '" ><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                    }
                }
                tmp += '</tr>';
            }
/*
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT150">Service</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-originalService"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT150">Translated Service</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-translatedService"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT150">Translated Private IP</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-privateIp"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT150">WAN</th>';
            tmp += '<td class="alignLeft BT80"><select id="Editor-wan"></select></td>';
            tmp += '<td class="alignLeft"><span id="span-wanIpId"><label for="Editor-wanIpId">IP&nbsp;</label><select id="Editor-wanIpId"></select></span></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT150">Description</th>';
            tmp += '<td colspan="2" class="alignLeft"><input type="text" id="Editor-description" /></td>';
            tmp += '</tr>';
*/
            tmp += '</table>';
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
            $('#Editor-wan').change( function() {
                if ( 0 === parseInt( $(this).val() ) ) {
                    $('#span-wanIpId').hide();
                } else {
                    $('#span-wanIpId').show();
                    cgiSelectOption( 'Editor-wanIpId' );
                }
            });
    
            $('#Editor-wan').append( genSelectOption( 'Editor-wan' )).val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wan ).trigger('change');
    
            cgiSelectOption( 'Editor-privateIp', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].privateIp );
            cgiSelectOption( 'Editor-wanIpId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanIpId );
            cgiSelectOption( 'Editor-originalService', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].originalService );
            cgiSelectOption( 'Editor-translatedService', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].translatedService );
    
            $('#Editor-description').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].description );
            break;
        case 'port_trigger':
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width:' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                switch (gNode.editor[ i ].type)
                {
                case 'text':
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '"><input type="text" id="Editor-' + gNode.editor[ i ].tab + '" /></td>';
                    break;
                default:
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '"><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                }
                tmp += '</tr>';
            }
/*
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT120">Enable</th>';
            tmp += '<td colspan="2" class="alignLeft"><input type="checkbox" id="Editor-enable" value="1" /></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT120">Trigger Service</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-triggerService"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT120">Opened Service</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-openedService"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT120">Description</th>';
            tmp += '<td colspan="2" class="alignLeft"><input type="text" id="Editor-description" /></td>';
            tmp += '</tr>';
*/
            tmp += '</table>';
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
    
            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].enable ))
                $('#Editor-enable').attr('checked', true);
    
            $('#Editor-description').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].description );
            cgiSelectOption( 'Editor-triggerService', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].triggerService );
            cgiSelectOption( 'Editor-openedService', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].openedService );
            break;
        case 'advanced_nat':
            tmp = '<table id="Editor-table-' + tar.pid + '" class="noBorder">';
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                if (gNode.editor[ i ].type == 'checkbox') {
                    tmp += '<th colspan="3" class="align' + gNode.editor[ i ].align[ 0 ] + '"><input type="checkbox" id="Editor-' + gNode.editor[ i ].tab + '" value="' + gNode.editor[ i ].val + '" /><label for="Editor-' + gNode.editor[ i ].tab + '">&nbsp;' + gNode.editor[ i ].label + '</label></th>';
                } else {
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width:' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td colspan="2" class="align' + gNode.editor[ i ].align[ 1 ] + '"><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                }
                tmp += '</tr>';
            }
/*
            tmp += '<tr>';
            tmp += '<th colspan="3" class="alignLeft"><input type="checkbox" id="Editor-enabled" value="1" /><label for="Editor-enabled">&nbsp;Enable</label></th>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">From</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-fromIf"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">To</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-toIf"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Original Source Address</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-originalSrc"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Original Destination Address</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-originalDst"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Original Services</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-originalService"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Translated Source Address</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-translatedSrc"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Translated Destination Address</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-translatedDst"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT180">Translated Services</th>';
            tmp += '<td colspan="2" class="alignLeft"><select id="Editor-translatedService"></select></td>';
            tmp += '</tr>';
*/
            tmp += '</table>';        
            $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '">' + tmp + '</div></div>');
    
            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].enabled ))
                $('#Editor-enabled').attr('checked', true);
            cgiSelectOption( 'Editor-fromIf', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].fromIf );
            cgiSelectOption( 'Editor-toIf', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].toIf );
            cgiSelectOption( 'Editor-originalSrc', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].originalSrc );
            cgiSelectOption( 'Editor-originalDst', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].originalDst );
            cgiSelectOption( 'Editor-originalService', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].originalService );
            cgiSelectOption( 'Editor-translatedSrc', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].translatedSrc );
            cgiSelectOption( 'Editor-translatedDst', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].translatedDst );
            cgiSelectOption( 'Editor-translatedService', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].translatedService );
    
            break;
        }
        firewallEditor(e, tar.w, tar.h);
    }
    
    function deleteFirewall(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        tar.thisNo = tar.id.split(gReg.isDash)[2];
    
        switch( tar.pid )
        {
        case 'rule':
            gRef.rules.move.splice( gRef.rules.move.indexOf( tar.thisNo ), 1);
            if (parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].gid) != 0 ) {
                gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].cgiAction = "3";
            }else {
                gData[ tar.pid ][ gNode.guiTNum[ tar.pid ][ 0 ] ]--;
                gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ].splice(tar.thisNo,1);
            }
            break;
        case 'static_nat':
        case 'port_forwarding':
        case 'port_trigger':
        case 'advanced_nat':
            if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) != 0 ) {
                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = "3";
            }else {
                gData[ tar.pid ][ gNode.guiTNum ]--;
                gData[ tar.pid ][ gNode.guiT ].splice(tar.thisNo,1);
            }
            break;
        }
        refreshFirewall(tar.pid);
    }
    
    function removeFirewall(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        switch( tar.pid )
        {
        case 'rule':
            tar.guiT = gNode.guiT[ tar.pid ][ 0 ];
            tar.guiTNum = gNode.guiTNum[ tar.pid ][ 0 ];
            break;
        case 'static_nat':
        case 'port_forwarding':
        case 'port_trigger':
        case 'advanced_nat':
            tar.guiT = gNode.guiT;
            tar.guiTNum = gNode.guiTNum;
            break;
        }
    
        $('#table-' + tar.pid + ' tr').each(function() {
            switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
            {
            case true:
                // backup policy 
                tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
    
                // row 
                switch( tar.pid )
                {
                case 'rule':
                    gRef.rules.move.splice( gRef.rules.move.indexOf( tar.thisNo ), 1);
                    break;
                }
    
                if (parseInt( gData[ tar.pid ][ tar.guiT ][ tar.thisNo ].gid) > 0 ) {
                    gData[ tar.pid ][ tar.guiT ][ tar.thisNo ].cgiAction = 3;
                }else {
                    gData[ tar.pid ][ tar.guiT ][ tar.thisNo ].cgiAction = -1;
                }
                break;
            }
        });
    
        tar.data = [];
    
        for (var i=0, len=gData[ tar.pid ][ tar.guiTNum ]; i<len; i++)
        {
            if (gData[ tar.pid ][ tar.guiT ][ i ].cgiAction == -1)
                continue;
            tar.data.push( gData[ tar.pid ][ tar.guiT ][ i ] );
        }
        gData[ tar.pid ][ tar.guiT ] = tar.data;
        gData[ tar.pid ][ tar.guiTNum ] = gData[ tar.pid ][ tar.guiT ].length;
        refreshFirewall( tar.pid );
    }
    
    function firewallEditor(e, w, h) {
        var tar = {};
    
        if (gObj.active.h5Index == 'NA') {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label;
        }else {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].label;
        }
    
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[1];
    
        $('#popForm').dialog({
            width: w || 800,
            height: h || 600,
            position: "center",
            resizable: false,
            modal: true,
            title: tar.title + ' > ' + ((tar.pid == 'wan_address_settings')? gNode.tabs[ tar.pid ] + ' > ' : '') + gTerm[ gObj.lang ][ tar.type ],
            buttons: {
                OK: function() {
                    if (firewallChecker(e)) {
                        gIf.alter = true;
                        switch( tar.pid )
                        {
                        case 'rule':
                            if (tar.type == 'Create') {
                                gCache[ tar.pid ].gid--;
                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum[ tar.pid ][ 0 ] ] );
                                gData[ tar.pid ][ gNode.guiTNum[ tar.pid ][ 0 ] ]++;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ] = $.extend({}, gTmpl.rules.guiRulesT);
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                            }else {
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                            }
    
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].enabled = ($('#Editor-enabled').is(':checked'))? 1 : 0;
    
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].fromZone = ( $('#Editor-fromZone').val() == 'NA' )? 0 : $('#Editor-fromZone').val();
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].toZone = ( $('#Editor-toZone').val() == 'NA' )? 0 : $('#Editor-toZone').val();
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].sourceAddress = ( $('#Editor-sourceAddress').val() == 'NA' )? 0 : $('#Editor-sourceAddress').val();
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].sourceUser ="";
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].destinationAddress = ( $('#Editor-destinationAddress').val() == 'NA' )? 0 : $('#Editor-destinationAddress').val();
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].destinationUser = "";
                            $('input[name=Editor-service_app_url]').each( function() {
                                switch($(this).is(':checked'))
                                {
                                case true:
                                    switch( parseInt($(this).val()) )
                                    {
                                    case 2:
                                        gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].service = 0;
                                        gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].application = 0;
                                        gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].url = 0;
                                        break;
                                    case 3:
                                        gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].service = 0;
                                        gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].application = 0;
                                        gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].url = 0;
                                        break;
                                    default:
                                        gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].service = ( $('#Editor-service').val() == 'NA' )? 0 : $('#Editor-service').val();
                                        gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].application = 0;
                                        gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].url = 0;
                                    }
                                    break;
                                }
                            });
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].schedule = ( $('#Editor-schedule').val() == 'NA' )? 0 : $('#Editor-schedule').val();
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].hitCount = 0;
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].enabled = ($('#Editor-enabled').is(':checked'))? 1 : 0;
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].log = ($('#Editor-log').is(':checked'))? 1 : 0;
    
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].matchAction = $('#Editor-matchAction').val();
                           
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].cgiAction = (parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ][ 0 ] ][ tar.thisNo ].gid ) > 0 )? 2 : 1;
    
                            gRef.rules.move.push( tar.thisNo );
                            
                            break;
                        case 'wan_address_settings':
                            tar.thisNo = tar.id.split(gReg.isDash)[2];
                            if ( gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mode != $('input[name=Editor-mode]:checked').val() || gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ].addressId != $('#Editor-addressId').val() ) {
                                gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiAction = 2;
                            }
    
                            gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mode = $('input[name=Editor-mode]:checked').val();
                            if (1 === parseInt( gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mode ))
                                gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ].addressId = $('#Editor-addressId').val();
                            else
                                gData.dynamic_pat[ gNode.guiT[ tar.pid ] ][ tar.thisNo ].addressId = 0;
                            break;
                        case 'static_nat':
                            if (tar.type == 'Create') {
                                gCache[ tar.pid ].gid--;
                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                gData[ tar.pid ][ gNode.guiTNum ]++;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gTmpl.staticNat.guiStaticNatT);
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                            }else {
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                            }
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanInterface = $('#Editor-wanInterface').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].publicIp = $('#Editor-publicIp').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].privateIp = $('#Editor-privateIp').val();
                            if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0)
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                            else
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                            break;
                        case 'port_forwarding':
                            if (tar.type == 'Create') {
                                gCache[ tar.pid ].gid--;
                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                gData[ tar.pid ][ gNode.guiTNum ]++;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gTmpl.portForwarding.guiPortForwardingT);
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                            }else {
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                            }
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].description = $('#Editor-description').val() || "";
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].originalService = $('#Editor-originalService').val();
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].translatedService = $('#Editor-translatedService').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].privateIp = $('#Editor-privateIp').val();
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wan = $('#Editor-wan').val();
    
                            switch(parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wan ))
                            {
                            case 0:
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanIpId = "";
                                break;
                            default:
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].wanIpId = $('#Editor-wanIpId').val();
                            }
                            if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0)
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                            else
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                            break;
                        case 'port_trigger':
                            if (tar.type == 'Create') {
                                gCache[ tar.pid ].gid--;
                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                gData[ tar.pid ][ gNode.guiTNum ]++;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gTmpl.portTrigger.guiPortTriggerT);
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                            }else {
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                            }
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].enable = ($('#Editor-enable').is(':checked'))? 1 : 0;
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].description = $('#Editor-description').val() || "";
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].triggerService = $('#Editor-triggerService').val();
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].openedService = $('#Editor-openedService').val();
                            if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0)
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                            else
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                            break;
                        case 'advanced_nat':
                            if (tar.type == 'Create') {
                                gCache[ tar.pid ].gid--;
                                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
                                gData[ tar.pid ][ gNode.guiTNum ]++;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gTmpl.advancedNat.guiAdvancedNatT);
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache[ tar.pid ].gid;
                            }else {
                                tar.thisNo = tar.id.split(gReg.isDash)[2];
                            }
    
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].enabled = ($('#Editor-enabled').is(':checked'))? 1 : 0;
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].fromIf = ( isNaN( parseInt( $('#Editor-fromIf').val() ) ) )? "" : $('#Editor-formIf').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].toIf = ( isNaN( parseInt( $('#Editor-toIf').val() ) ) )? "" : $('#Editor-toIf').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].originalSrc = ( isNaN( parseInt( $('#Editor-originalSrc').val() ) ) )? "" : $('#Editor-originalSrc').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].originalDst = ( isNaN( parseInt( $('#Editor-originalDst').val() ) ) )? "" : $('#Editor-originalDst').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].originalService = ( isNaN( parseInt( $('#Editor-originalService').val() ) ) )? "" : $('#Editor-originalService').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].translatedSrc = ( isNaN( parseInt( $('#Editor-translatedSrc').val() ) ) )? "" : $('#Editor-translatedSrc').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].translatedDst = ( isNaN( parseInt( $('#Editor-translatedDst').val() ) ) )? "" : $('#Editor-translatedDst').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].translatedService = ( isNaN( parseInt( $('#Editor-translatedService').val() ) ) )? "" : $('#Editor-translatedService').val();

                            if (parseInt(gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid) > 0)
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                            else
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 1;
                            break;
                        }
                        refreshFirewall( tar.pid );
                        $( this ).dialog( "close" );
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });
    }
    
    function firewallChecker(e, pid) {
    
        var tar = {};
    
        if (pid) {
            tar.pid = pid;
            tar.type = 'Save';
        }else {
    
            tar.id = $(e.currentTarget).attr('id');
            if (!tar.id)
                return false;
            tar.type  = tar.id.split(gReg.isDash)[0];
    
            tar.pid  = tar.id.split(gReg.isDash)[1];
    
            if (tar.type == 'Create') {
                if (tar.pid == 'rule')
                    tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum[ tar.pid ][ 0 ] ] );
                else
                    tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
            } else 
                tar.thisNo = tar.id.split(gReg.isDash)[2];
        }
    
        var pass = true;
        var msg = '';
        switch(tar.pid)
        {
        case 'rule':
            if (0 === $('input[name=service_app_url]:checked').val()) {
                if (isNaN( parseInt( $('#Editor-service').val() ) )) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].serviceNeed + '</p>';
                }
            }
            break;
        case 'static_nat':
            if (isNaN( parseInt( $('#Editor-privateIp').val() ) )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].privateIpNeed + '</p>';
            }
            break;
        case 'port_forwarding':
            if (isNaN( parseInt( $('#Editor-originalService').val() ) )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].origServiceNeed + '</p>';
            }

            if (isNaN( parseInt( $('#Editor-translatedService').val() ) )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].transServiceNeed + '</p>';
            }

            if (pass) {
                if (gCache.type[ parseInt( $('#Editor-originalService').val() ) ] != gCache.type[ parseInt( $('#Editor-translatedService').val() ) ] ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].forwardingServiceTypeMatch + '</p>';
                }
            }

            if (isNaN( parseInt( $('#Editor-privateIp').val() ) )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].transPrivateIpNeed + '</p>';
            }
            
            if ( !gReg.description.test( $('#Editor-privateIp').val() ) ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].descriptionLength + '</p>';
            }

            break;
        case 'port_trigger':
            if (isNaN( parseInt( $('#Editor-triggerService').val() ) )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].triggerServiceNeed + '</p>';
            }

            if (isNaN( parseInt( $('#Editor-openedService').val() ) )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].openedServiceNeed + '</p>';
            }

            if (pass) {
                if (gCache.type[ parseInt( $('#Editor-triggerService').val() ) ] != gCache.type[ parseInt( $('#Editor-openedService').val() ) ] ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].triggerServiceTypeMatch + '</p>';
                }
            }

            break;
        case 'advanced_nat':
            var pairs = false;

            if ( !isNaN( parseInt( $('#Editor-originalSrc').val() ) ) ) {
                if ( isNaN( parseInt( $('#Editor-translatedSrc').val() ) ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].srcAddressSelect + '</p>';
                } else {
                    pairs = true;
                }
            } else if ( isNaN( parseInt( $('#Editor-originalSrc').val() ) ) ) {
                if ( !isNaN( parseInt( $('#Editor-translatedSrc').val() ) ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].srcAddressSelect + '</p>';
                }
            }


            if ( !isNaN( parseInt( $('#Editor-originalDst').val() ) ) ) {
                if ( isNaN( parseInt( $('#Editor-translatedDst').val() ) ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].dstAddressSelect + '</p>';
                } else {
                    pairs = true;
                    if (!isNaN( parseInt( $('#Editor-toIf').val() ) )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].toIfSelect + '</p>';
                    }
                }
            } else if ( isNaN( parseInt( $('#Editor-originalDst').val() ) ) ) {
                if ( !isNaN( parseInt( $('#Editor-translatedDst').val() ) ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].dstAddressSelect + '</p>';
                }
            }


            if ( !isNaN( parseInt( $('#Editor-originalService').val() ) ) ) {
                if ( isNaN( parseInt( $('#Editor-translatedService').val() ) ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].natServiceSelect + '</p>';
                } else {
                    if (isNaN( parseInt( $('#Editor-originalDst').val() ) ) || isNaN( parseInt( $('#Editor-translatedDst').val() ) )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].natAddressSelect + '</p>';
                    }
                    if (gCache.type[ parseInt( $('#Editor-originalService').val() ) ] != gCache.type[ parseInt( $('#Editor-translatedService').val() ) ] ) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].natServiceTypeMatch + '</p>';
                    }
                    pairs = true;
                }
            } else if ( isNaN( parseInt( $('#Editor-originalService').val() ) ) ) {
                if ( !isNaN( parseInt( $('#Editor-translatedService').val() ) ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].natServiceSelect + '</p>';
                }
            }

            if (pass && !pairs) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].ruleNull + '</p>';
            }

            break;
        case 'session_settings':
            if (!gReg.timeout.test($('#tcpTimeout').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].tcpTimeoutRange + '</p>';
            }
    
            if (!gReg.timeout.test($('#udpTimeout').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].udpTimeoutRange + '</p>';
            }
    
            if (!gReg.timeout.test($('#otherTimeout').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].otherTimeoutRange + '</p>';
            }
            break;
        case 'attack_protection':
            if (!gReg.threshold.test($('#synFloodThreshold').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].synFloodThresholdRange + '</p>';
            }
    
            if (!gReg.threshold.test($('#echoStormThreshold').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].echoStormThresholdRange + '</p>';
            }
    
            if (!gReg.threshold.test($('#icmpFloodThreshold').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].icmpFloodThresholdRange + '</p>';
            }
            break;
        }
    
        if (!pass) {
            errorAlert( msg );
        }
        return pass;
    }
    
    function saveFirewall(pid) {
    
        var cgiID = gNode.url.post;
        switch(pid)
        {
        case 'rule':
            cgiID = 'rules';
            break;
        case 'dynamic_pat':
            for (var i=0; i<gData[ pid ][ gNode.guiTNum[ 'pat_settings' ] ]; i++)
            {
                for (var j=1; j<7; j++)
                {
                    if ($('#enableWan' + j + '-' + i).is(':checked')) {
                        if (0 === parseInt( gData[ pid ][ gNode.guiT[ 'pat_settings' ] ][ i ][ "enableWan" + j ] ) )
                            gData[ pid ][ gNode.guiT[ 'pat_settings' ] ][ i ].cgiAction = 2;
                        gData[ pid ][ gNode.guiT[ 'pat_settings' ] ][ i ][ "enableWan" + j ] = 1;
                    } else {
                        if (1 === parseInt( gData[ pid ][ gNode.guiT[ 'pat_settings' ] ][ i ][ "enableWan" + j ] ) )
                            gData[ pid ][ gNode.guiT[ 'pat_settings' ] ][ i ].cgiAction = 2;
                        gData[ pid ][ gNode.guiT[ 'pat_settings' ] ][ i ][ "enableWan" + j ] = 0;
                    }
                }
            }
    
            cgiID = 'dynamicPat';
            break;
        case 'default_policy':
            var trNo = 0;
            $('#table-' + pid + ' tbody tr').each(function() {
                if (parseInt( gData[ pid ].guiDefaultPolicyT[ trNo ].policy ) != parseInt( $('#' + pid + '-policy-' + trNo).val() ) ) {
                    gData[ pid ].guiDefaultPolicyT[ trNo ].policy = $('#' + pid + '-policy-' + trNo).val();
                    gData[ pid ].guiDefaultPolicyT[ trNo ].cgiAction = "2";
                }
                trNo++;
            });
            cgiID = 'defaultPolicy';
            break;
        case 'alg':
            gData[ pid ].sipEnabled = ($('#sipEnabled').is(':checked'))? 1 : 0;
            gData[ pid ].h323Enabled = ($('#h323Enabled').is(':checked'))? 1 : 0;
            gData[ pid ].ftpEnabled = ($('#ftpEnabled').is(':checked'))? 1 : 0;
            break;
        case 'vpn_passthrough':
            gData[ pid ].l2tpEnabled = ($('#l2tpEnabled').is(':checked'))? 1 : 0;
            gData[ pid ].pptpEnabled = ($('#pptpEnabled').is(':checked'))? 1 : 0;
            gData[ pid ].ipsecEnabled = ($('#ipsecEnabled').is(':checked'))? 1 : 0;
            break;
        case 'session_settings':
            cgiID = 'sessionSettings';
            if (firewallChecker(null, pid)) {
                gIf.alter = false;
                gData[ pid ].tcpTimeout = $('#tcpTimeout').val();
                gData[ pid ].udpTimeout = $('#udpTimeout').val();
                gData[ pid ].otherTimeout = $('#otherTimeout').val();
            } else {
                return false;
            } 
            break;
        case 'attack_protection':
            cgiID = 'attackProtection';
            if (firewallChecker(null, pid)) {
                gIf.alter = false;
                for (var x in gData[ pid ])
                {
                    if (gReg.isEnabled.test( x )) {
                        if ($('#' + x).is(':checked')) {
                            gData[ pid ][ x ] = $('#' + x).val();
                        } else {
                            gData[ pid ][ x ] = 0;
                        }
                    } else {
                        gData[ pid ][ x ] = $('#' + x).val();
                    }
                }
            } else {
                return false;
            } 
            break;
        }
        
        loadingToggle( true );
        $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData[ pid ]), function( poster ) {
            gIf.alter = false;
            if (parseInt(poster.status) == 0) {
                if (poster.duration) {
                    gObj.loading = poster.duration;
                    gIf.loading = true;
                } else {
                    loadingToggle( false );
                    getCgiList(gObj.active.pid);
                }
            }else {
                loadingToggle( false );
                if (!$('#popPlus').exists())
                    $('#popBase').append('<div id="popPlus"></div>');
                $('#popPlus').html('<div class="plusForm"><p class="plusMsg"></p></div>');
                $('#popPlus').dialog({
                    width: 300,
                    height:200,
                    position: "center",
                    resizable: false,
                    modal: true,
                    buttons: {
                        Ok: function() {
                            $( this ).dialog( "close" );
                        },
                        Cancel: function() {
                            $( this ).dialog( "close" );
                        }
                    },
                    close: function(event, ui) {
                        $(this).dialog('destroy').remove();
                    }
                });
                switch(parseInt(poster.status))
                {
                default:
                    $('.plusMsg').html( poster.msg );
                }
            }
        });
    }
    
    function genSecurity(pid) {
        var tmp;
    
        switch(gNode.ext)
        {
        case 'cgi':
            switch(gNode.tag)
            {
            case 'div':
                switch(gNode.type)
                {
                case 'tables':
                    switch(pid)
                    {
                    case 'ip_mac_binding':
                        gCache[ pid ] = {};
                        gIf.searched = false;
                        if (gIf.power) {
                            $('#main_ft').html( gHtml.pgImport + gHtml.pgExport2 + gHtml.pgSave + gHtml.pgCancel );
                            gY.one('#pgSave').on('click', function(e) {
                                saveSecurity( pid );
                            });
                        }

                        $('#main_bd').html('<div class="templateDiv"><div id="div-' + pid + '-group"><div class="searchDiv"></div><div id="div-' + pid + '-global"><table id="table-' + pid + '-global"><tr></tr></table></div><div id="div-' + pid + '"><table id="table-' + pid + '"></table></div></div></div>');

                        $.ajax({
                            url: 'cgi-bin/ipMacBinding.cgi',
                            dataType: 'json',
                            success: function(data) {
                                gData[ pid ] = data;

                                cgiSearch( pid );

                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    switch( gNode.col[ i ].type )
                                    {
                                    case 'table':
                                        tmp = '<thead>';
                                        tmp += '<tr>';
                                        for (var j=0, jlen=gNode.col[ i ].col.length; j<jlen; j++)
                                        {
                                            tmp += '<th id="' + gNode.col[ i ].col[ j ].tab + '" class="ui-state-default " style="width: ' + gNode.col[ i ].col[ j ].wiz + '">';
                                            if (gNode.col[ i ].col[ j ].sortable) {
                                                tmp += '<div id="div-' + gNode.tab + '-' + gNode.col[ i ].col[ j ].tab + '" class=" sortable">' + gNode.col[ i ].col[ j ].label + '<span id="span-' + gNode.tab + '-' + gNode.col[ i ].col[ j ].tab + '" class="sortable" ></span></div>';
                                            } else {
                                                tmp += gNode.col[ i ].col[ j ].label;
                                            }
                                            tmp += '</th>';
                                        }
                                        tmp += '</tr>';
                                        tmp += '</thead>';
                                        tmp += '<tbody>';
                                        tmp += '</tbody>';
                                        $('#table-' + pid ).html( tmp );
                                        if (gNode.tblAction && gIf.power) {
                                            genTblAction( pid );

                                            switch( data[ gNode.guiT ].length )
                                            {
                                            case 0:
                                                $('#Remove-' + pid ).prop('disabled', true);
                                                break;
                                            case gRows[ gNode.url.get ]:
                                                $('#Create-' + pid ).prop('disabled', true);
                                                break;
                                            default:
                                                $('#Create-' + pid ).prop('disabled', false);
                                                $('#Remove-' + pid ).prop('disabled', false);
                                            }
                                        }
                                        break;
                                    case 'checkbox':
                                        tmp = '<td class="alignCenter BT40">';
                                        tmp += '<input type="checkbox" id="' + gNode.col[ i ].tab + '" value="1" />';
                                        tmp += '</td>';
                                        tmp += '<td class="alignLeft BT40">';
                                        tmp += '<label for="' + gNode.col[ i ].tab + '">' + gNode.col[ i ].label + '</label>';
                                        tmp += '</td>';
                                        tmp += '<td class="alignCenter BT10">|</td>';
                                        $('#table-' + pid + '-global tr').append( tmp );
                                        break;
                                    case 'select':
                                        tmp = '<td class="alignLeft BT40">';
                                        tmp += gNode.col[ i ].label;
                                        tmp += '</td>';
                                        tmp += '<td class="alignLeft">';
                                        tmp += '<select id="' + gNode.col[ i ].tab + '">';
                                        for (var x in gNode.col[ i ].option)
                                        {
                                            tmp += '<option value="' + x + '">' + gNode.col[ i ].option[ x ] + '</option>';
                                        }
                                        tmp += '</select>';
                                        tmp += '</td>';
                                        $('#table-' + pid + '-global tr').append( tmp );
                                        break;
                                    }
                                }
                                if ( 1 === parseInt( data.enable ) )
                                    $('#enable').click();
                                $('#mode').val( parseInt( data.mode ) );
                                for (var i=0, len=data[ gNode.guiT ].length; i<len; i++)
                                {
                                    tmp = '<tr class="' + ((i%2 == 0)? 'odd' : 'even') + '">>';
                                    for (var j=0, jlen=gNode.col[ 2 ].col.length; j<jlen; j++)
                                    {
                                        switch( gNode.col[ 2 ].col[ j ].tab )
                                        {
                                        case 'checkbox':
                                            tmp += '<td class="checkboxTD">';
                                            tmp += '<input type="checkbox" id="' + pid + '-' + i + '" value="' + i + '" />';
                                            tmp += '</td>';
                                            break;
                                        case 'index':
                                            tmp += '<td>';
                                            tmp += (i+1);
                                            tmp += '</td>';
                                            break;
                                        case 'action':
                                            tmp += '<td class="buttonTD">';
                                            if (gIf.power) {
                                                tmp += '<button id="Edit-' + pid + '-' + i + '" class="Edit"><span class="ui-icon"  title="Edit"></span></button>';
                                                tmp += '<button id="Delete-' + pid + '-' + i + '" class="Delete"><span class="ui-icon"  title="Edit"></span></button>';
                                            } else {
                                                tmp += '';
                                            }
                                            tmp += '</td>';
                                            break;
                                        default:
                                            tmp += '<td>';
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ 2 ].col[ j ].tab ];
                                            tmp += '</td>';
                                        }
                                    }
                                    tmp += '</tr>';
                                    $('#table-' + pid).append( tmp );
                                }
                            }
                        });
                        break;
                    }
                    break;
                case 'chainTabs':
                    switch(pid) 
                    {
                    case 'antivirus':
                        gCache[ pid ] = {};
                        if (gIf.power) {
                            $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                            gY.one('#pgSave').on('click', function(e) {
                                saveSecurity('antivirus');
                            });
                        }
    
                        gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div class="tabber"><ul></ul></div></div>');
                        // cache if alter 
                        gCache.tabber = {};
                        for (var x in gNode.url.get)
                        {
                            gY.one('.tabber ul').append('<li id="tab-' + x + '"><a href="#panel-' + x + '">' + gNode.tabs[ x ] + '</a></li>');
                            gY.one('.tabber').append('<div id="panel-' + x + '"><div id="div-' + x + '"><table id="table-' + x + '"></table></div></div>');
                            $.ajax({
                                url: 'cgi-bin/' + gNode.url.get[ x ] + '.' + gNode.ext,
                                dataType: 'json',
                                success: function(data) {
                                    var y;
                                    if (typeof data.selectedZonesT != 'undefined') {
                                        y = 'general_settings';
                                        gCache.uniq[ y ] = {};
                                        gCache.uniq[ y ].portListT = {};
                                        gCache.uniq[ y ].portList = {};
    
                                        $('#table-' + y).empty();
    
                                        tmp = '<tr>';
                                        tmp += '<td>';
                                        tmp += '<div id="div-enable_antivirus">';
                                        tmp += '<table id="table-enable_antivirus">';
                                        tmp += '<tr>';
                                        tmp += '<td class="BT10"></td>';
                                        tmp += '<th class="alignLeft">';
                                        tmp += '<input type="checkbox" id="enabled" value="1" />&nbsp;';
                                        tmp += '<label for="enabled">' + gNode.col[ y ][ 0 ].label + '</label>';
                                        tmp += '</th>';
                                        tmp += '</tr>';
                                        tmp += '</table>';
                                        tmp += '</div>';
                                        tmp += '</th>';
                                        tmp += '</tr>';
    
                                        tmp += '<tr>';
                                        tmp += '<td>';
                                        tmp += '<div id="div-zone_to_scan">';
                                        tmp += '<table id="table-zone_to_scan">';
                                        tmp += '<caption>' + gNode.col[ y ][ 1 ].label + '</caption>';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignCenter BT200">';
                                        tmp += '<label for="selectedZonesTPool">' + gNode.col[ y ][ 1 ].multiple.pool.label + '</label>';
                                        tmp += '</th>';
                                        tmp += '<th class="alignCenter BT100">';
                                        tmp += '<label for="selectedZonesTButton"></label>';
                                        tmp += '</th>';
                                        tmp += '<th class="alignCenter BT200">';
                                        tmp += '<label for="selectedZonesT">' + gNode.col[ y ][ 1 ].multiple.pick.label + '</label>';
                                        tmp += '</th>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<td class="alignCenter">';
                                        tmp += '<select id="selectedZonesTPool" multiple size="10"></select>';
                                        tmp += '</td>';
                                        tmp += '<td class="alignCenter">';
                                        tmp += '<button id="Move2Del-selectedZonesT" class="Move2Del"><span class="ui-icon"></span></button>';
                                        tmp += '<button id="Move2Add-selectedZonesT" class="Move2Add"><span class="ui-icon"></span></button>';
                                        tmp += '</td>';
                                        tmp += '<td class="alignCenter">';
                                        tmp += '<select id="selectedZonesT" multiple size="10"></select>';
                                        tmp += '</td>';
                                        tmp += '</tr>';
                                        tmp += '</table>';
                                        tmp += '</div>';
                                        tmp += '</td>';
                                        tmp += '</tr>';
    
                                        tmp += '<tr>';
                                        tmp += '<td>';
                                        tmp +=   '<div id="div-application_to_scan">';
                                        tmp +=     '<table id="table-application_to_scan">';
                                        tmp +=       '<caption>' + gNode.col[ y ][ 2 ].label + '</caption>';
                                        tmp +=       '<tr>';
                                        tmp +=         '<td>';
                                        tmp +=           '<div id="div-http">';
                                        tmp +=             '<table id="table-http">';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<th colspan="3" class="alignLeft">';
                                        tmp +=                   '<p>' + gNode.col[ y ][ 2 ].col[ 0 ].label + '</p>';
                                        tmp +=                 '</th>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="httpEnable">' + gNode.col[ y ][ 2 ].col[ 0 ].col[ 0 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="httpEnable" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="httpEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="httpLog">' + gNode.col[ y ][ 2 ].col[ 0 ].col[ 1 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="httpLog" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="httpEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="httpAct">' + gNode.col[ y ][ 2 ].col[ 0 ].col[ 2 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<select id="httpAct"></select>';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="httpEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="httpPortList-0">' + gNode.col[ y ][ 2 ].col[ 0 ].col[ 3 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="text" id="httpPortList-0" size="3" />';
                                        tmp +=                   '<input type="text" id="httpPortList-1" size="3" />';
                                        tmp +=                   '<input type="text" id="httpPortList-2" size="3" />';
                                        tmp +=                   '<input type="text" id="httpPortList-3" size="3" />';
                                        tmp +=                   '<input type="text" id="httpPortList-4" size="3" />';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=             '</table>';
                                        tmp +=           '</div>';
                                        tmp +=         '</td>';
                                        tmp +=         '<td>';
                                        tmp +=           '<div id="div-ftp">';
                                        tmp +=             '<table id="table-ftp">';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<th colspan="3" class="alignLeft">';
                                        tmp +=                   '<p>' + gNode.col[ y ][ 2 ].col[ 1 ].label + '</p>';
                                        tmp +=                 '</th>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="ftpEnable">' + gNode.col[ y ][ 2 ].col[ 1 ].col[ 0 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="ftpEnable" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="ftpEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="ftpLog">' + gNode.col[ y ][ 2 ].col[ 1 ].col[ 1 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="ftpLog" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="ftpEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="ftpAct">' + gNode.col[ y ][ 2 ].col[ 1 ].col[ 2 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<select id="ftpAct"></select>';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="ftpEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="ftpPortList-0">' + gNode.col[ y ][ 2 ].col[ 1 ].col[ 3 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="text" id="ftpPortList-0" size="3" />';
                                        tmp +=                   '<input type="text" id="ftpPortList-1" size="3" />';
                                        tmp +=                   '<input type="text" id="ftpPortList-2" size="3" />';
                                        tmp +=                   '<input type="text" id="ftpPortList-3" size="3" />';
                                        tmp +=                   '<input type="text" id="ftpPortList-4" size="3" />';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=             '</table>';
                                        tmp +=           '</div>';
                                        tmp +=         '</td>';
                                        tmp +=       '</tr>';

                                        tmp +=       '<tr>';
                                        tmp +=         '<td>';
                                        tmp +=           '<div id="div-smtp">';
                                        tmp +=             '<table id="table-smtp">';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<th colspan="3" class="alignLeft">';
                                        tmp +=                   '<p>' + gNode.col[ y ][ 2 ].col[ 2 ].label + '</p>';
                                        tmp +=                 '</th>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="smtpEnable">' + gNode.col[ y ][ 2 ].col[ 2 ].col[ 0 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="smtpEnable" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="smtpEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="smtpLog">' + gNode.col[ y ][ 2 ].col[ 2 ].col[ 1 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="smtpLog" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="smtpEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="smtpAct">' + gNode.col[ y ][ 2 ].col[ 2 ].col[ 2].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<select id="smtpAct"></select>';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="smtpEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="smtpPortList-0">' + gNode.col[ y ][ 2 ].col[ 2 ].col[ 3 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="text" id="smtpPortList-0" size="3" />';
                                        tmp +=                   '<input type="text" id="smtpPortList-1" size="3" />';
                                        tmp +=                   '<input type="text" id="smtpPortList-2" size="3" />';
                                        tmp +=                   '<input type="text" id="smtpPortList-3" size="3" />';
                                        tmp +=                   '<input type="text" id="smtpPortList-4" size="3" />';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=             '</table>';
                                        tmp +=           '</div>';
                                        tmp +=         '</td>';
                                        tmp +=         '<td>';
                                        tmp +=           '<div id="div-pop3">';
                                        tmp +=             '<table id="table-pop3">';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<th colspan="3" class="alignLeft">';
                                        tmp +=                   '<p>' + gNode.col[ y ][ 2 ].col[ 3 ].label + '</p>';
                                        tmp +=                 '</th>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="pop3Enable">' + gNode.col[ y ][ 2 ].col[ 3 ].col[ 0 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="pop3Enable" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="pop3Enable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="pop3Log">' + gNode.col[ y ][ 2 ].col[ 3 ].col[ 1 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="pop3Log" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="pop3Enable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="pop3Act">' + gNode.col[ y ][ 2 ].col[ 3 ].col[ 2 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<select id="pop3Act"></select>';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="pop3Enable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="pop3PortList-0">' + gNode.col[ y ][ 2 ].col[ 3 ].col[ 3 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="text" id="pop3PortList-0" size="3" />';
                                        tmp +=                   '<input type="text" id="pop3PortList-1" size="3" />';
                                        tmp +=                   '<input type="text" id="pop3PortList-2" size="3" />';
                                        tmp +=                   '<input type="text" id="pop3PortList-3" size="3" />';
                                        tmp +=                   '<input type="text" id="pop3PortList-4" size="3" />';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=             '</table>';
                                        tmp +=           '</div>';
                                        tmp +=         '</td>';
                                        tmp +=       '</tr>';

                                        tmp +=       '<tr>';
                                        tmp +=         '<td>';
                                        tmp +=           '<div id="div-cifs">';
                                        tmp +=             '<table id="table-cifs">';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<th colspan="3" class="alignLeft">';
                                        tmp +=                   '<p>' + gNode.col[ y ][ 2 ].col[ 4 ].label + '</p>';
                                        tmp +=                 '</th>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="cifsEnable">' + gNode.col[ y ][ 2 ].col[ 4 ].col[ 0 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="cifsEnable" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="cifsEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="cifsLog">' + gNode.col[ y ][ 2 ].col[ 4 ].col[ 1 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="cifsLog" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="cifsEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="cifsAct">' + gNode.col[ y ][ 2 ].col[ 4 ].col[ 2 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<select id="cifsAct"></select>';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=             '</table>';
                                        tmp +=           '</div>';
                                        tmp +=         '</td>';
                                        tmp +=         '<td>';
/*

                                        tmp +=           '<div id="div-imap">';
                                        tmp +=             '<table id="table-imap">';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<th colspan="3" class="alignLeft">';
                                        tmp +=                   '<p>' + gNode.col[ y ][ 2 ].col[ 5 ].label + '</p>';
                                        tmp +=                 '</th>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr>';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="imapEnable">' + gNode.col[ y ][ 2 ].col[ 5 ].col[ 0 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="imapEnable" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="imapEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="imapLog">' + gNode.col[ y ][ 2 ].col[ 5 ].col[ 1 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="checkbox" id="imapLog" value="1">';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="imapEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="imapAct">' + gNode.col[ y ][ 2 ].col[ 5 ].col[ 2 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<select id="imapAct"></select>';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=               '<tr class="imapEnable">';
                                        tmp +=                 '<td class="alignLeft BT40">';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft BT60">';
                                        tmp +=                   '<label for="imapPortList-0">' + gNode.col[ y ][ 2 ].col[ 5 ].col[ 3 ].label + '</label>';
                                        tmp +=                 '</td>';
                                        tmp +=                 '<td class="alignLeft">';
                                        tmp +=                   '<input type="text" id="imapPortList-0" size="3" />';
                                        tmp +=                   '<input type="text" id="imapPortList-1" size="3" />';
                                        tmp +=                   '<input type="text" id="imapPortList-2" size="3" />';
                                        tmp +=                   '<input type="text" id="imapPortList-3" size="3" />';
                                        tmp +=                   '<input type="text" id="imapPortList-4" size="3" />';
                                        tmp +=                 '</td>';
                                        tmp +=               '</tr>';
                                        tmp +=             '</table>';
                                        tmp +=           '</div>';
*/
                                        tmp +=         '</td>';
                                        tmp +=       '</tr>';
                                        tmp +=     '</table>';
                                        tmp +=   '</div>';
                                        tmp += '</td>';
                                        tmp += '</tr>';
    
                                        tmp += '<tr>';
                                        tmp += '<td>';
                                        tmp += '<div id="div-maximumFile">';
                                        tmp += '<table id="table-maximumFile">';
                                        tmp += '<caption>' + gNode.col[ y ][ 3 ].label + '</caption>';
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft BT100">';
                                        tmp += '<input type="text" id="maxFileSize" size="8"/>';
                                        tmp += '</td>';
                                        tmp += '<th class="alignLeft">';
                                        tmp += '<label for="maxFileSize">' + gNode.col[ y ][ 3 ].note + '</label>';
                                        tmp += '</th>';
                                        tmp += '</tr>';
                                        tmp += '</table>';
                                        tmp += '</div>';
                                        tmp += '</td>';
                                        tmp += '</tr>';
    
                                        $('#table-general_settings').html( tmp );
    
                                        // listen to change
                                        $('#table-' + y + ' input').change( function(){
                                            gCache.tabber[ 0 ] = true;
                                        });
    
                                        $('#table-' + y + ' select').change( function(){
                                            gCache.tabber[ 0 ] = true;
                                        });
    
                                        $('#enabled').change(function() {
                                            if ($(this).is(':checked')) {
                                                for (var i=0; i<Object.size(gNode.tabs); i++)
                                                    gObj.tabber.tabs("enable", i);
                                                $('#table-zone_to_scan button').prop('disabled', false);
                                                $('#table-zone_to_scan select').prop('disabled', false);
                                                $('#table-maximumFile input').prop('disabled', false);
                            
                                                if ($('#signature-autoUpdate').is(':checked'))
                                                    $('.signature-autoUpdate-checked select').prop('disabled', false);
                                                else
                                                    $('.signature-autoUpdate-checked select').prop('disabled', true);

                                                $('#httpEnable').prop('disabled', false);
                                                if ($('#httpEnable').is(':checked')) {
                                                    $('.httpEnable input').prop('disabled', false);
                                                    $('.httpEnable select').prop('disabled', false);
                                                } 

                                                $('#ftpEnable').prop('disabled', false);
                                                if ($('#ftpEnable').is(':checked')) {
                                                    $('.ftpEnable input').prop('disabled', false);
                                                    $('.ftpEnable select').prop('disabled', false);
                                                } 

                                                $('#smtpEnable').prop('disabled', false);
                                                if ($('#smtpEnable').is(':checked')) {
                                                    $('.smtpEnable input').prop('disabled', false);
                                                    $('.smtpEnable select').prop('disabled', false);
                                                } 

                                                $('#pop3Enable').prop('disabled', false);
                                                if ($('#pop3Enable').is(':checked')) {
                                                    $('.pop3Enable input').prop('disabled', false);
                                                    $('.pop3Enable select').prop('disabled', false);
                                                } 

                                                $('#imapEnable').prop('disabled', false);
                                                if ($('#imapEnable').is(':checked')) {
                                                    $('.imapEnable input').prop('disabled', false);
                                                    $('.imapEnable select').prop('disabled', false);
                                                } 

                                                $('#cifsEnable').prop('disabled', false);
                                                if ($('#cifsEnable').is(':checked')) {
                                                    $('.cifsEnable input').prop('disabled', false);
                                                    $('.cifsEnable select').prop('disabled', false);
                                                } 

                                            }else {
                                                gObj.tabber.tabs({"disabled": [1,2,3,4,5,6,7]});
                                                $('#table-zone_to_scan button').prop('disabled', true);
                                                $('#table-zone_to_scan select').prop('disabled', true);
                                                $('#table-application_to_scan input').prop('disabled', true);
                                                $('#table-application_to_scan select').prop('disabled', true);
                                                $('#table-maximumFile input').prop('disabled', true);
                                            }
                                        });
    
                                        // bind double click event
                                        $('#selectedZonesTPool').dblclick(function(e) {
                                            var vSel = $('#selectedZonesTPool option:selected');
                                            vSel.clone().appendTo('#selectedZonesT');
                                            vSel.remove();
                                        });
                                
                                        $('#selectedZonesT').dblclick(function(e) {
                                            var vSel = $('#selectedZonesT option:selected');
                                            vSel.clone().appendTo('#selectedZonesTPool');
                                            vSel.remove();
                                        });

                                        $('#httpEnable').on('click', function(e) {
                                            if ($(this).is(':checked')) {
                                                $('.httpEnable input').prop('disabled', false);
                                                $('.httpEnable select').prop('disabled', false);
                                            } else {
                                                $('.httpEnable input').prop('disabled', true);
                                                $('.httpEnable select').prop('disabled', true);
                                            }
                                        });

                                        $('#ftpEnable').on('click', function(e) {
                                            if ($(this).is(':checked')) {
                                                $('.ftpEnable input').prop('disabled', false);
                                                $('.ftpEnable select').prop('disabled', false);
                                            } else {
                                                $('.ftpEnable input').prop('disabled', true);
                                                $('.ftpEnable select').prop('disabled', true);
                                            }
                                        });

                                        $('#smtpEnable').on('click', function(e) {
                                            if ($(this).is(':checked')) {
                                                $('.smtpEnable input').prop('disabled', false);
                                                $('.smtpEnable select').prop('disabled', false);
                                            } else {
                                                $('.smtpEnable input').prop('disabled', true);
                                                $('.smtpEnable select').prop('disabled', true);
                                            }
                                        });

                                        $('#pop3Enable').on('click', function(e) {
                                            if ($(this).is(':checked')) {
                                                $('.pop3Enable input').prop('disabled', false);
                                                $('.pop3Enable select').prop('disabled', false);
                                            } else {
                                                $('.pop3Enable input').prop('disabled', true);
                                                $('.pop3Enable select').prop('disabled', true);
                                            }
                                        });

                                        $('#imapEnable').on('click', function(e) {
                                            if ($(this).is(':checked')) {
                                                $('.imapEnable input').prop('disabled', false);
                                                $('.imapEnable select').prop('disabled', false);
                                            } else {
                                                $('.imapEnable input').prop('disabled', true);
                                                $('.imapEnable select').prop('disabled', true);
                                            }
                                        });

                                        $('#cifsEnable').on('click', function(e) {
                                            if ($(this).is(':checked')) {
                                                $('.cifsEnable input').prop('disabled', false);
                                                $('.cifsEnable select').prop('disabled', false);
                                            } else {
                                                $('.cifsEnable input').prop('disabled', true);
                                                $('.cifsEnable select').prop('disabled', true);
                                            }
                                        });

                                        for (var node in data)
                                        {
                                            switch(node)
                                            {
                                            case 'selectedZoneNum':
                                            case 'enable':
                                                break;
                                            case 'licensed':
                                                switch( parseInt( data[ node ] ) )
                                                {
                                                case 2:
                                                case 3:
                                                    if (parseInt( data.enable ) == 1)
                                                        $('#enabled').attr('checked', true);
                                                    else {
                                                        gObj.tabber.tabs({"disabled": [1,2,3,4,5,6,7]});
                                                        $('#table-zone_to_scan button').prop('disabled', true);
                                                        $('#table-zone_to_scan select').prop('disabled', true);
                                                        $('#table-application_to_scan input').prop('disabled', true);
                                                        $('#table-application_to_scan select').prop('disabled', true);
                                                        $('#table-maximumFile input').prop('disabled', true);
                                                    }
                                                    break;
                                                default:
                                                    gObj.tabber.tabs({"disabled": [1,2,3,4,5,6,7]});
                                                    $('#table-general_settings input').prop('disabled', true);
                                                    $('#table-general_settings select').prop('disabled', true);
                                                    $('#table-general_settings button').prop('disabled', true);
                                                    $('#pgSave').prop('disabled', true);
                                                    $('#pgCancel').prop('disabled', true);
                                                }
                                                break;
                                            case 'httpPortNum':
                                            case 'ftpPortNum':
                                            case 'smtpPortNum':
                                            case 'pop3PortNum':
                                                break;
                                            case 'httpPortListT':
                                            case 'ftpPortListT':
                                            case 'smtpPortListT':
                                            case 'pop3PortListT':
                                                for (var i=0, len=parseInt( data[ node.replace('ListT', 'Num') ]); i<len; i++)
                                                {
                                                    $('#' + node.replace('T', '-') + i).val( data[ node ][ i ].port ); 
                                                    gCache.uniq[ y ].portListT[ parseInt( data[ node ][ i ].port ) ] = node.replace('PortListT', '');
                                                    gCache.uniq[ y ].portList[ parseInt( data[ node ][ i ].port ) ] = true;
                                                }
                                                break;
                                            case 'selectedZonesT':
                                                for (var i=0, len=parseInt(gCache.list.common_zoneIf_list.guiZoneIfTNum); i < len; i++)
                                                {
                                                    var pool = true;
                                                    for (var j=0, jlen=parseInt(data.selectedZonesNum); j<jlen; j++)
                                                    {
                                                        if (parseInt(gCache.list.common_zoneIf_list.guiZoneIfT[ i ].gid) == parseInt(data.selectedZonesT[ j ].gid)) {
                                                            pool = false;
                                                            $('#selectedZonesT').append('<option value="' + gCache.list.common_zoneIf_list.guiZoneIfT[ i ].gid + '">' + gCache.list.common_zoneIf_list.guiZoneIfT[ i ].name + '</option>');
                                                            break;
                                                        }
                                                    }
                                                    if (pool) {
                                                        $('#selectedZonesTPool').append('<option value="' + gCache.list.common_zoneIf_list.guiZoneIfT[ i ].gid + '">' + gCache.list.common_zoneIf_list.guiZoneIfT[ i ].name + '</option>');
                                                    }
                                                }
                                                break;
                                            case 'maxFileSize':
                                                $('#' + node).val( data[ node ] );
                                                break;
                                            case 'httpAct':
                                            case 'ftpAct':
                                            case 'smtpAct':
                                            case 'pop3Act':
                                            case 'imapAct':
                                            case 'cifsAct':
                                                $('#' + node).append( genSelectOption( node ) ).val( data[ node ] );
                                                break;
                                            case 'httpEnable':
                                            case 'ftpEnable':
                                            case 'smtpEnable':
                                            case 'pop3Enable':
                                            case 'imapEnable':
                                            case 'cifsEnable':
                                                if ( 1 === parseInt( data[ node ] ) )
                                                    $('#' + node).attr('checked', true);
                                                else {
                                                    $('.' + node + ' input').prop('disabled', true);   
                                                    $('.' + node + ' select').prop('disabled', true);   
                                                }
                                                break;
                                            default:
                                                if ( 1 === parseInt( data[ node ] ) )
                                                    $('#' + node).attr('checked', true);
                                            }
                                        }

                                        if (!gIf.power) {
                                            $('#table-' + y + ' button').prop('disabled', true);
                                            $('#table-' + y + ' input').prop('disabled', true);
                                            $('#table-' + y + ' select').prop('disabled', true);
                                            $('#table-' + y + ' textarea').prop('disabled', true);
                                        }
                                    }else if (typeof data.httpNotify != 'undefined') {
                                        y = 'http_notification';
                                        $('#table-' + y).empty();
                                        tmp = '<tr>';
                                        tmp += '<th colspan="2" class="alignLeft">' + gNode.col[ y ][ 0 ].label + '</th>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<td colspan="2" class="alignLeft"><textarea id="httpNotify" cols="100" rows="20"></textarea></td>';
                                        tmp += '</tr>';
                                        $('#table-' + y).html( tmp );
                                        $('#httpNotify').val(data.httpNotify);
                                        // listen to change
                                        $('#table-' + y + ' textarea').change( function(){
                                            gCache.tabber[ 1 ] = true;
                                        });
                                        if (!gIf.power) {
                                            $('#table-' + y + ' button').prop('disabled', true);
                                            $('#table-' + y + ' input').prop('disabled', true);
                                            $('#table-' + y + ' select').prop('disabled', true);
                                            $('#table-' + y + ' textarea').prop('disabled', true);
                                        }
                                    }else if (typeof data.mailStatus != 'undefined') {
                                        y = 'email_notification';
                                        $('#table-' + y).empty();
                                        tmp = '<tr>';
                                        tmp += '<th class="alignRight BT150">' + gNode.col[ y ][ 0 ].label + '</th>';
                                        tmp += '<td class="alignLeft"><p id="mailStatus"></p></td>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignRight BT150">' + gNode.col[ y ][ 1 ].label + '</th>';
                                        tmp += '<td class="alignLeft"><p id="fromMail"></p></td>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignRight BT150">' + gNode.col[ y ][ 2 ].label + '</th>';
                                        tmp += '<td class="alignLeft"><p id="smtpServer"></p></td>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignRight BT150">' + gNode.col[ y ][ 3 ].label + '</th>';
                                        tmp += '<td class="alignLeft"><p id="smtpAuth"></p></td>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignRight BT150">' + gNode.col[ y ][ 4 ].label + '</th>';
                                        tmp += '<td class="alignLeft"><input type="text" id="mailTag" /></td>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignRight BT150">' + gNode.col[ y ][ 5 ].label + '</th>';
                                        tmp += '<td class="alignLeft"><textarea id="mailContent" cols="100" rows="20"></textarea></td>';
                                        tmp += '</tr>';
    
                                        $('#table-' + y).html( tmp );
                                        $('#mailStatus').html(data.mailStatus);
                                        $('#fromMail').html(data.fromMail);
                                        $('#smtpServer').html(data.smtpServer);
                                        $('#smtpAuth').html(data.smtpAuth);
                                        $('#mailTag').val(data.mailTag);
                                        $('#mailContent').val(data.mailContent);
                                        // listen to change
                                        $('#table-' + y + ' input').change( function(){
                                            gCache.tabber[ 2 ] = true;
                                        });
    
                                        $('#table-' + y + ' textarea').change( function(){
                                            gCache.tabber[ 2 ] = true;
                                        });
                                        if (!gIf.power) {
                                            $('#table-' + y + ' button').prop('disabled', true);
                                            $('#table-' + y + ' input').prop('disabled', true);
                                            $('#table-' + y + ' select').prop('disabled', true);
                                            $('#table-' + y + ' textarea').prop('disabled', true);
                                        }
                                    }else if (typeof data.guiAddrFilterT != 'undefined') {
                                        y = 'address_exceptions';
                                        gCache[ pid ][ y ] = {};
                                        gCache[ pid ][ y ].gid = 0;
                                        $('#table-' + y).empty();
                                        tmp = '<thead>';
                                        tmp += '<tr>';
                                        tmp += '<th id="enable">' + gNode.col[ y ][ 0 ].label + '</th>';
                                        tmp += '<th id="sAddrId">' + gNode.col[ y ][ 1 ].label + '</th>';
                                        tmp += '<th id="dAddrId">' + gNode.col[ y ][ 2 ].label + '</th>';
                                        tmp += '<th id="logEnable">' + gNode.col[ y ][ 3 ].label + '</th>';
                                        tmp += '<th class="Edit Delete">' + gNode.col[ y ][ 4 ].label + '</th>';
                                        tmp += '</tr>';
                                        tmp += '</thead>';
                                        $('#table-' + y).html( tmp );
    
                                        $('#table-' + y).addClass('Create');
    
                                        $('#table-' + y + ' thead tr th').each( function(index) {
                                            $(this).addClass('ui-state-default');
                                        });
                                        $('#table-' + y).append('<tbody>');
                                        for (var i=0, len=parseInt(data.guiAddrFilterNum); i<len; i++)
                                        {
                                            if (parseInt( data.guiAddrFilterT[ i ].features ) == 1) {
                                                tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                                tmp += '<td id="enable-' + i + '">' + gRef.antivirus.enable[ data.guiAddrFilterT[ i ].enable ] + '</td>';
                                                tmp += '<td id="sAddrId-' + i + '">';
                                                if (parseInt(data.guiAddrFilterT[ i ].sAddrId) == 0)
                                                    tmp += gTerm[ gObj.lang ].Any;
                                                else 
                                                    tmp += gCache.address[ parseInt( data.guiAddrFilterT[ i ].sAddrId ) ];
                                                tmp += '</td>';
                                                tmp += '<td id="dAddrId-' + i + '">';
                                                if (parseInt(data.guiAddrFilterT[ i ].dAddrId) == 0)
                                                    tmp += gTerm[ gObj.lang ].Any;
                                                else 
                                                    tmp += gCache.address[ parseInt( data.guiAddrFilterT[ i ].dAddrId ) ];
                                                tmp += '</td>';
                                                tmp += '<td id="logEnable-' + i + '">' + gRef.antivirus.logEnable[ data.guiAddrFilterT[ i ].logEnable ] + '</td>';
                                                tmp += '<td class="buttonTD">';
                                                tmp += '<button id="Edit-address_exceptions-' + i + '" class="Edit" title="Edit"><span class="ui-icon" ></span></button>';
                                                tmp += '<button id="Delete-address_exceptions-' + i + '" class="Delete" title="Delete"><span class="ui-icon" ></span></button>';
                                                tmp += '</td>';
                                                tmp += '</tr>';
                                                $('#table-' + y + ' tbody').append( tmp );
                                            }
                                        }
                                        if (!gIf.power) {
                                            $('#table-' + y + ' button').prop('disabled', true);
                                            $('#table-' + y + ' input').prop('disabled', true);
                                            $('#table-' + y + ' select').prop('disabled', true);
                                            $('#table-' + y + ' textarea').prop('disabled', true);
                                        } else {
                                            genTblAction( pid, y);
                                        }
                                    }else if (typeof data.fileExcepT != 'undefined') {
                                        y = 'file_exceptions';
                                        $('#table-' + y).empty();
    
                                        tmp = '<tr>';
                                        tmp += '<td class="alignLeft BT350">';
                                        tmp += '<div id="div-mime" >';
                                        tmp += '<table id="table-mime" class="Create">';
                                        tmp += '<caption>' + gNode.col[ y ][ 0 ].label + '</caption>';
                                        tmp += '<thead>';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignCenter BT240" id="mime">' + gNode.col[ y ][ 0 ].col[ 0 ].label + '</th>';
                                        tmp += '<th class="Edit Delete">' + gNode.col[ y ][ 0 ].col[ 1 ].label + '</th>';
                                        tmp += '</tr>';
                                        tmp += '</thead>';
                                        tmp += '</table>';
                                        tmp += '</div>';
                                        tmp += '</td>';
                                        tmp += '<td class="alignLeft BT350">';
                                        tmp += '<div id="div-file_extension">';
                                        tmp += '<table id="table-file_extension" class="Create">';
                                        tmp += '<caption>' + gNode.col[ y ][ 1 ].label + '</caption>';
                                        tmp += '<thead>';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignCenter BT240" id="fileExt">' + gNode.col[ y ][ 1 ].col[ 0 ].label + '</th>';
                                        tmp += '<th class="Edit Delete">' + gNode.col[ y ][ 1 ].col[ 1 ].label + '</th>';
                                        tmp += '</tr>';
                                        tmp += '</thead>';
                                        tmp += '</table>';
                                        tmp += '</div>';
                                        tmp += '</td>';
                                        tmp += '</tr>';
    
                                        $('#table-' + y).html( tmp );
    
                                        $('#table-mime thead tr th').each( function(index) {
                                            $(this).addClass('ui-state-default');
                                        });
                                        $('#table-mime').append('<tbody>');
                                        for (var i=0, len=parseInt(data.mimeExcepNum); i<len; i++)
                                        {
                                            tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                            tmp += '<td id="mime-' + i + '">' + data.mimeExcepT[ i ].mime + '</td>';
                                            tmp += '<td class="buttonTD">';
                                            tmp += '<button id="Edit-mime-' + i + '" class="Edit" title="Edit"><span class="ui-icon" ></span></button>';
                                            tmp += '<button id="Delete-mime-' + i + '" class="Delete" title="Delete"><span class="ui-icon" ></span></button>';
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                            $('#table-mime tbody').append( tmp );
                                        }
    
                                        $('#table-file_extension thead tr th').each( function(index) {
                                            $(this).addClass('ui-state-default');
                                        });
    
                                        $('#table-file_extension').append('<tbody>');
    
                                        var limit;

                                        for (var i=0, len=parseInt(data.fileExcepNum); i<len; i++)
                                        {
                                            tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                            tmp += '<td id="fileExt-' + i + '">' + data.fileExcepT[ i ].fileExt + '</td>';
                                            tmp += '<td class="buttonTD">';
                                            tmp += '<button id="Edit-file_extension-' + i + '" class="Edit"><span class="ui-icon"  title="Edit"></span></button>';
                                            tmp += '<button id="Delete-file_extension-' + i + '" class="Delete"><span class="ui-icon"  title="Delete"></span></button>';
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                            $('#table-file_extension tbody').append( tmp );
                                            limit = i;
                                        }

                                        if (!gIf.power) {
                                            $('#table-' + y + ' button').prop('disabled', true);
                                            $('#table-' + y + ' input').prop('disabled', true);
                                            $('#table-' + y + ' select').prop('disabled', true);
                                            $('#table-' + y + ' textarea').prop('disabled', true);
                                        } else {
                                            if (limit >= gLimit[ gNode.url.get[ y ] ].rows) {
                                                $('#Create-mime').prop('disabled', true);
                                                $('#Create-file_extension').prop('disabled', true);
                                            } 
                                            genTblAction( pid, ['mime', 'file_extension'], y);
    
                                        }
                                    }else if (typeof data.expiration_days != 'undefined') {
                                        y = 'blacklist';
    
                                        gCheckbox.blacklist = {};
                                        gCache.blacklist = [];
                                        gObj.stamper = new Date().getTime();

                                        tmp = '<thead>';
                                        tmp += '<tr>';
                                        tmp += '<td colspan="8">';
                                        tmp += '<div id="div-expiration_duration">';
                                        tmp += '<table id="table-expirtaion_duration">';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignLeft BT150">' + gNode.col[ y ][ 0 ].col[ 0 ].label + '</th>';
                                        tmp += '<td class="alignLeft BT180">' + gNode.col[ y ][ 0 ].col[ 1 ].label + '&nbsp;<input type="text" id="expiration_days" size="8"/> ' + gNode.col[ y ][ 0 ].col[ 1 ].note + '</td>';
                                        tmp += '<td class="alignLeft">' + gNode.col[ y ][ 0 ].col[ 2 ].label + '&nbsp;<input type="text" id="expiration_hours" size="8"/> ' + gNode.col[ y ][ 0 ].col[ 2 ].note + '</td>';
                                        tmp += '</tr>';
                                        tmp += '</table>';
                                        tmp += '</div>';
                                        tmp += '</td>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignCenter BT30 ui-state-default"><input type="checkbox" id="blacklist_all" value="1" /></th>';
                                        tmp += '<th class="alignCenter BT40 ui-state-default">' + gNode.col[ y ][ 1 ].col[ 1 ].label + '</th>';
                                        tmp += '<th class="alignCenter BT80 ui-state-default">' + gNode.col[ y ][ 1 ].col[ 2 ].label + '</th>';
                                        tmp += '<th class="alignCenter BT100 ui-state-default">' + gNode.col[ y ][ 1 ].col[ 3 ].label + '</th>';
                                        tmp += '<th class="alignCenter BT100 ui-state-default">' + gNode.col[ y ][ 1 ].col[ 4 ].label + '</th>';
                                        tmp += '<th class="alignCenter ui-state-default">' + gNode.col[ y ][ 1 ].col[ 5 ].label + '</th>';
                                        tmp += '<th class="alignCenter BT120 ui-state-default">' + gNode.col[ y ][ 1 ].col[ 6 ].label + '</th>';
                                        tmp += '<th class="alignCenter BT100 ui-state-default">' + gNode.col[ y ][ 1 ].col[ 7 ].label + '</th>';
                                        tmp += '</tr>'
                                        tmp += '</thead>';
                                        tmp += '<tbody>';
                                        tmp += '</tbody>';
    
                                        $('#table-' + y).html( tmp );
    
                                        var expires;

                                        for (var i=0, len=parseInt(data.number); i<len; i++)
                                        {
                                            tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                            tmp += '<td class="checkboxTD">';
                                            tmp += '<input class="blacklistCheckbox" id="' + y + '-' + i + '" type="checkbox" value="' + i + '">';
                                            tmp += '</td>';
                                            tmp += '<td >';
                                            tmp += (i + 1 );
                                            tmp += '</td>';
                                            tmp += '<td id="blacklist-virusID-' + i + '">' + data.urlT[ i ].virusID + '</td>';
                                            tmp += '<td id="blacklist-virusName-' + i + '">' + data.urlT[ i ].virusName + '</td>';
                                            tmp += '<td id="blacklist-type-' + i + '">' + data.urlT[ i ].type + '</td>';
                                            tmp += '<td id="blacklist-url-' + i + '">' + data.urlT[ i ].url + '</td>';
                                            tmp += '<td id="blacklist-expiration-' + i + '">';
                                            expires = new Date( gObj.stamper + data.urlT[ i ].expiration*1000 );
                                            tmp += expires.getFullYear() + '-' + (expires.getMonth() + 1) + '-' + expires.getDate() + ' ' + expires.getHours() + ':' + expires.getMinutes() + ':' + expires.getSeconds();
                                            tmp += '</td>';
                                            tmp += '<td class="buttonTD">';
                                            tmp += '<button id="Move2White-blacklist-' + i + '" class="Move2White" title="Move to Whitelist"><span class="ui-icon" ></span></button>';
                                            tmp += '<button id="Delete-blacklist-' + i + '" class="Delete" title="Delete"><span class="ui-icon" ></span></button>';
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                            $('#table-blacklist > tbody').append( tmp );
                                        }
    
                                        $('#expiration_days').blur( function() {
                                            gCache.tabber[ 5 ] = true;
                                        });
    
                                        $('#expiration_hours').blur( function() {
                                            gCache.tabber[ 5 ] = true;
                                        });
    
                                        $('#expiration_days').val( data.expiration_days );
                                        $('#expiration_hours').val( data.expiration_hours );
                                        if (!gIf.power) {
                                            $('#table-' + y + ' button').prop('disabled', true);
                                            $('#table-' + y + ' input').prop('disabled', true);
                                            $('#table-' + y + ' select').prop('disabled', true);
                                            $('#table-' + y + ' textarea').prop('disabled', true);
                                        } else {
                                            genTblAction( pid, y );
                                        } 
                                    }else if (typeof data.urlT != 'undefined') {
                                        y = 'whitelist';
                                        tmp = '<thead>';
                                        tmp += '<tr>';
                                        tmp += '<th class="alignCenter BT50 ui-state-default"><input type="checkbox" id="whitelist_all" value="1" /></th>';
                                        tmp += '<th class="alignCenter BT50 ui-state-default">' + gNode.col[ y ][ 0 ].col[ 1 ].label + '</th>';
                                        tmp += '<th class="alignCenter BT100 ui-state-default">' + gNode.col[ y ][ 0 ].col[ 2 ].label + '</th>';
                                        tmp += '<th class="alignCenter ui-state-default">' + gNode.col[ y ][ 0 ].col[ 3 ].label + '</th>';
                                        tmp += '<th class="alignCenter BT100 ui-state-default">' + gNode.col[ y ][ 0 ].col[ 4 ].label + '</th>';
                                        tmp += '</tr>';
                                        tmp += '</thead>';
                                        tmp += '<tbody>';
                                        tmp += '</tbody>';
    
                                        $('#table-' + y).html( tmp );
    
                                        gCheckbox.whitelist = {};
                                        gCache.whitelist = [];

                                        for (var i=0, len=parseInt(data.number); i<len; i++)
                                        {
                                            gCache.whitelist.push( parseInt( data.urlT[ i ].virusID ) );
                                            tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                            tmp += '<td class="checkboxTD">';
                                            tmp += '<input class="whitelistCheckbox" id="' + y + '-' + i + '" type="checkbox" value="' + i + '">';
                                            tmp += '</td>';
                                            tmp += '<td >';
                                            tmp += (i + 1);
                                            tmp += '</td>';
                                            tmp += '<td id="whitelist-virusID' + i + '">' + data.urlT[ i ].virusID + '</td>';
                                            tmp += '<td id="whitelist-virusName' + i + '">' + data.urlT[ i ].virusName + '</td>';
                                            tmp += '<td class="buttonTD">';
                                            tmp += '<button id="History-whitelist-' + i + '" class="History" title="History"><span class="ui-icon" ></span></button>';
                                            tmp += '<button id="Delete-whitelist-' + i + '" class="Delete" title="Delete"><span class="ui-icon" ></span></button>';
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                            $('#table-whitelist tbody').append( tmp );
                                        }
                                        if (!gIf.power) {
                                            $('#table-' + y + ' button').prop('disabled', true);
                                            $('#table-' + y + ' input').prop('disabled', true);
                                            $('#table-' + y + ' select').prop('disabled', true);
                                            $('#table-' + y + ' textarea').prop('disabled', true);
                                        } else { 
                                            genTblAction( pid, y );
                                        }
    
                                    }else if (typeof data.version != 'undefined') {
    
                                        y = 'signature';
                                        $('#panel-signature').html('<div id="div-signatures"></div>');
                                        tmp = '<h2><b>' + gNode.col[ y ][ 0 ].label + '</b></h2>';
                                        tmp += '<div id="div-signature">';
                                        tmp += '<table id="table-signature">';
                                        tmp += '<caption>' + gNode.col[ y ][ 0 ].col[ 0 ].label + '</caption>';
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft BT150"><label for="signature-startUpdate">' + gNode.col[ y ][ 0 ].col[ 0 ].col[ 0 ].label + '</td>';
                                        tmp += '<td class="alignCenter BT40"><button class="Update" id="signature-startUpdate"><span class="ui-icon"></span></td>';
                                        tmp += '<td class="alignLeft "></td>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft BT150"><label for="signature-autoUpdate">' + gNode.col[ y ][ 0 ].col[ 0 ].col[ 1 ].label + '</td>';
                                        tmp += '<td class="alignCenter BT40"><input type="checkbox" id="signature-autoUpdate" value="1" /></td>';
                                        tmp += '<td class="alignLeft "><label for="signature-type">' + gNode.col[ y ][ 0 ].col[ 0 ].col[ 1 ].col[ 0 ].label + '</label>&nbsp;<select id="signature-type"></select>&nbsp;<label for="signature-number">' + gNode.col[ y ][ 0 ].col[ 0 ].col[ 1 ].col[ 1 ].label + '</label>&nbsp;<select id="signature-number"></select></td>';
                                        tmp += '</tr>';
                                        tmp += '</table>';
                                        tmp += '</div>';
    
                                        tmp += '<div id="div-version">';
                                        tmp += '<table id="table-version">';
                                        tmp += '<caption>' + gNode.col[ y ][ 0 ].col[ 1 ].label + '</caption>';
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft BT150"><label for="signature-version">' + gNode.col[ y ][ 0 ].col[ 1 ].col[ 0 ].label + '</td>';
                                        tmp += '<td class="alignLeft "><p id="signature-version"></p></td>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft BT150"><label for="signature-ptnNum">' + gNode.col[ y ][ 0 ].col[ 1 ].col[ 1 ].label + '</td>';
                                        tmp += '<td class="alignLeft "><p id="signature-ptnNum"></p></td>';
                                        tmp += '</tr>';
                                        tmp += '</table>';
                                        tmp += '</div>';
    
                                        tmp += '<div id="div-check_record">';
                                        tmp += '<table id="table-last_check">';
                                        tmp += '<caption>' + gNode.col[ y ][ 0 ].col[ 2 ].label + '</caption>';
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft BT150"><label for="signature-lastChecked">' + gNode.col[ y ][ 0 ].col[ 2 ].col[ 0 ].label + '</td>';
                                        tmp += '<td class="alignLeft "><p id="signature-lastChecked"></p></td>';
                                        tmp += '</tr>';
                                        tmp += '<tr>';
                                        tmp += '<td class="alignLeft BT150"><label for="signature-lastUpdated">' + gNode.col[ y ][ 0 ].col[ 2 ].col[ 1 ].label + '</td>';
                                        tmp += '<td class="alignLeft "><p id="signature-lastUpdated"></p></td>';
                                        tmp += '</tr>';
                                        tmp += '</table>';
                                        tmp += '</div>'; 

                                        $('#div-signatures').append(tmp);
    
                                        y = 'signature';
                                        // listen to change
                                        $('#' + y + '-autoUpdate').change( function(){
                                            gCache.tabber[ 7 ] = true;
                                        });
    
                                        $('#' + y + '-type').change( function(){
                                            gCache.tabber[ 7 ] = true;
                                            $('#signature-number').empty();
                                            $('#signature-number').append( genSelectOption( 'signature-number-' + $(this).val() ) );
                                        });
    
                                        $('#' + y + '-number').change( function(){
                                            gCache.tabber[ 7 ] = true;
                                        });
    
                                        $('#' + y + '-autoUpdate').change( function() {
                                            if ($(this).is(':checked')) {
                                                $('#signature-type').prop('disabled', false);
                                                $('#signature-number').prop('disabled', false);
                                            } else {
                                                $('#signature-type').prop('disabled', true);
                                                $('#signature-number').prop('disabled', true);
                                            } 
                                        });
    
                                        for (var node in data)
                                        {
                                            switch(node)
                                            {
                                            case 'autoUpdate':
                                                if ( parseInt( data[ node ] ) == 1) {
                                                    $('#' + y + '-' + node).click();
                                                    $('#signature-type').prop('disabled', false);
                                                    $('#signature-number').prop('disabled', false);
                                                } else {
                                                    $('#signature-type').prop('disabled', true);
                                                    $('#signature-number').prop('disabled', true);
                                                }
                                                break;
                                            case 'type':
                                                $('#signature-' + node).append( genSelectOption('signature-' + node) ).val( data[ node ]);
                                                break;
                                            case 'number':
                                                $('#signature-' + node).append( genSelectOption('signature-' + node + '-' + data.type) ).val( data[ node ]);
                                                break;
                                            case 'version':
                                                gObj.sigVer = Number( ( isNaN( parseFloat( data.version ) )? 0 : parseFloat( data.version ) ) + ( ( isNaN( parseFloat( data.md5Version ) )? 1 : parseFloat( data.md5Version ) ) - 1) ).toFixed(3) ;
                                                $('#signature-version').html( gObj.sigVer );
                                                break;
                                            case 'md5Version':
                                                // dealed by version
                                                break;
                                            case 'ptnNum':
                                                $('#signature-ptnNum').html( data.ptnNum + data.md5PtnNum );
                                                break;
                                            case 'md5PtnNum':
                                                // dealed by ptnNum
                                                break;
                                            default:
                                                $('#' + y + '-' + node).html( data[ node ] );
                                            }
                                        }
    
                                        if (!gIf.power) {
                                            $('#table-' + y + ' button').prop('disabled', true);
                                            $('#table-' + y + ' input').prop('disabled', true);
                                            $('#table-' + y + ' select').prop('disabled', true);
                                            $('#table-' + y + ' textarea').prop('disabled', true);
                                        }
                                    }
    
                                    gData[ y ] = data;

                                }
                            });
                        }
                        gObj.tabber = $('.tabber').tabs();
                        break;
                    }
                    break;
                }
                break;
            }
            break;
        }
    }
    
    function refreshSecurity(pid) {
        var tmp = '';
        var tbody = $('#table-' + pid + '> tbody');
        tbody.empty();
        switch( pid )
        {
        case 'blacklist':
            gObj.stamper = new Date().getTime();
            var expires;
            for (var i=0; i<gData[ pid ].number; i++)
            {
                tmp = '<tr class="' + ((i%2 == 0)? 'even' : 'odd') + '">';
                tmp += '<td class="checkboxTD">';
                tmp += '<input id="' + pid + '-' + i + '" class="blacklistCheckbox" type="checkbox" value="' + i + '">';
                tmp += '</td>';
                tmp += '<td >';
                tmp += (i + 1);
                tmp += '</td>';
                tmp += '<td id="blacklist-virusID-' + i + '">' + gData[ pid ].urlT[ i ].virusID + '</td>';
                tmp += '<td id="blacklist-virusName-' + i + '">' + gData[ pid ].urlT[ i ].virusName + '</td>';
                tmp += '<td id="blacklist-type-' + i + '">' + gData[ pid ].urlT[ i ].type + '</td>';
                tmp += '<td id="blacklist-url-' + i + '">' + gData[ pid ].urlT[ i ].url + '</td>';
                tmp += '<td id="blacklist-expiration-' + i + '">';
                expires = new Date( gObj.stamper + gData[ pid ].urlT[ i ].expiration*1000 );
                tmp += expires.getFullYear() + '-' + ( expires.getMonth() + 1 ) + '-' + expires.getDate() + ' ' + expires.getHours() + ':' + expires.getMinutes() + ':' + expires.getSeconds();
                tmp += '</td>'; 
                tmp += '<td class="buttonTD">';
                tmp += '<button id="Move2White-blacklist-' + i + '" class="Move2White" title="Move to Whitelist"><span class="ui-icon" ></span></button>';
                tmp += '<button id="Delete-blacklist-' + i + '" class="Delete" title="Delete"><span class="ui-icon" ></span></button>';
                tmp += '</td>';
                tmp += '</tr>';
                tbody.append( tmp );
                if (gCheckbox[ pid ][ pid + '-' + i ])
                    $('#' + pid + '-' + i).attr('checked', true);
            }
    
            refreshSecurity( 'whitelist' );
            break;
        case 'whitelist':
            for (var i=0; i<gData.whitelist.number; i++)
            {
                tmp = '<tr class="' + ((i%2 == 0)? 'even' : 'odd') + '">';
                tmp += '<td class="checkboxTD">';
                tmp += '<input id="' + pid + '-' + i + '" class="whitelistCheckbox" type="checkbox" value="' + i + '">';
                tmp += '</td>';
                tmp += '<td >';
                tmp += (i + 1);
                tmp += '</td>';
                tmp += '<td id="whitelist-virusID-' + i + '">' + gData[ pid ].urlT[ i ].virusID + '</td>';
                tmp += '<td id="whitelist-virusName-' + i + '">' + gData[ pid ].urlT[ i ].virusName + '</td>';
                tmp += '<td class="buttonTD">';
                tmp += '<button id="History-whitelist-' + i + '" class="History" title="History"><span class="ui-icon" ></span></button>';
                tmp += '<button id="Delete-whitelist-' + i + '" class="Delete" title="Delete"><span class="ui-icon" ></span></button>';
                tmp += '</td>';
                tmp += '</tr>';
                tbody.append( tmp );
                if (gCheckbox[ pid ][ pid + '-' + i ])
                    $('#' + pid + '-' + i).attr('checked', true);
            }
            break;
        case 'mime':
            for (var i=0; i<gData.file_exceptions.mimeExcepNum; i++)
            {
                tmp = '<tr class="' + ((i%2 == 0)? 'even' : 'odd') + '">';
                tmp += '<td >';
                tmp += gData.file_exceptions.mimeExcepT[ i ].mime
                tmp += '</td>';
                tmp += '<td class="buttonTD">';
                tmp += '<button id="Edit-mime-' + i + '" class="Edit" title="Edit"><span class="ui-icon" ></span></button>';
                tmp += '<button id="Delete-mime-' + i + '" class="Delete" title="Delete"><span class="ui-icon" ></span></button>';
                tmp += '</td>';
                tmp += '</tr>';
                tbody.append( tmp );
            }
            break;
        case 'file_extension':
            for (var i=0; i<gData.file_exceptions.fileExcepNum; i++)
            {
                tmp = '<tr class="' + ((i%2 == 0)? 'even' : 'odd') + '">';
                tmp += '<td >';
                tmp += gData.file_exceptions.fileExcepT[ i ].fileExt
                tmp += '</td>';
                tmp += '<td class="buttonTD">';
                tmp += '<button id="Edit-file_extension-' + i + '" class="Edit" title="Edit"><span class="ui-icon" ></span></button>';
                tmp += '<button id="Delete-file_extension-' + i + '" class="Delete" title="Delete"><span class="ui-icon" ></span></button>';
                tmp += '</td>';
                tmp += '</tr>';
                tbody.append( tmp );
            }
            break;
        case 'address_exceptions':
            for (var i=0; i<gData[ pid ].guiAddrFilterNum; i++)
            {
                if ( 3 === parseInt( gData[ pid ].guiAddrFilterT[ i ].cgiAction ) ) {
                    continue;
                }
                tmp = '<tr class="' + ((i%2 == 0)? 'even' : 'odd') + '">';
                tmp += '<td >';
                tmp += gRef.antivirus.enable[ gData[ pid ].guiAddrFilterT[ i ].enable ];
                tmp += '</td>';
                tmp += '<td >';
                tmp += gCache.address[ gData[ pid ].guiAddrFilterT[ i ].sAddrId ];
                tmp += '</td>';
                tmp += '<td >';
                tmp += gCache.address[ gData[ pid ].guiAddrFilterT[ i ].dAddrId ];
                tmp += '</td>';
                tmp += '<td >';
                tmp += gRef.antivirus.logEnable[ gData[ pid ].guiAddrFilterT[ i ].logEnable ];
                tmp += '</td>';
                tmp += '<td class="buttonTD">';
                tmp += '<button id="Edit-address_exceptions-' + i + '" class="Edit" title="Edit"><span class="ui-icon" ></span></button>';
                tmp += '<button id="Delete-address_exceptions-' + i + '" class="Delete" title="Delete"><span class="ui-icon" ></span></button>';
                tmp += '</td>';
                tmp += '</tr>';
                tbody.append( tmp );
            }
            break;
        case 'ip_mac_binding':
            for (var i=0, len=gData[ pid ][ gNode.guiT ].length; i<len; i++)
            {
                tmp = '<tr class="' + ((i%2 == 0)? 'odd' : 'even') + '">>';
                for (var j=0, jlen=gNode.col[ 2 ].col.length; j<jlen; j++)
                {
                    switch( gNode.col[ 2 ].col[ j ].tab )
                    {
                    case 'checkbox':
                        tmp += '<td class="checkboxTD">';
                        tmp += '<input type="checkbox" id="' + pid + '-' + i + '" value="' + i + '" />';
                        tmp += '</td>';
                        break;
                    case 'index':
                        tmp += '<td>';
                        tmp += (i+1);
                        tmp += '</td>';
                        break;
                    case 'action':
                        tmp += '<td class="buttonTD">';
                        if (gIf.power) {
                            tmp += '<button id="Edit-' + pid + '-' + i + '" class="Edit"><span class="ui-icon"  title="Edit"></span></button>';
                            tmp += '<button id="Delete-' + pid + '-' + i + '" class="Delete"><span class="ui-icon"  title="Edit"></span></button>';
                        } else {
                            tmp += '';
                        }
                        tmp += '</td>';
                        break;
                    default:
                        tmp += '<td>';
                        tmp += gData[ pid ][ gNode.guiT ][ i ][ gNode.col[ 2 ].col[ j ].tab ];
                        tmp += '</td>';
                    }
                }
                tmp += '</tr>';
                $('#table-' + pid).append( tmp );
            }
            break;
        }
    }
    
    function createSecurity(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"><table id="Editor-table-' + tar.pid + '"></table></div>');
    
        var tmp;
        tar.w = 360;
        tar.h = 240;
        switch(tar.pid)
        {
        case 'mime':
            tar.w = 560;
            tmp = '<tr>';
            tmp += '<th class="alignLeft BT60">' + gNode.editor[ tar.pid ][ 0 ].label + '</th>';
            tmp += '<td class="alignLeft"><select id="Editor-type"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT60">' + gNode.editor[ tar.pid ][ 1 ].label + '</th>';
            tmp += '<td class="alignLeft"><select id="Editor-sub"></select></td>';
            tmp += '</tr>';
            $('#Editor-table-' + tar.pid).append( tmp );
            genSelector( 'Editor-type' );
            genSelector( 'Editor-sub' );
            break;
        case 'file_extension':
            tmp = '<tr>';
            tmp += '<th class="alignLeft BT80">' + gNode.editor[ tar.pid ][ 0 ].label + '</th>';
            tmp += '<td class="alignLeft"><input type="text" id="Editor-fileExt" /></td>';
            tmp += '</tr>';
            $('#Editor-table-' + tar.pid).append( tmp );
            break;
        case 'address_exceptions':
            tmp = '<tr>';
            tmp += '<td class="alignCenter BT10"><input type="checkbox" id="Editor-enable" /></td>';
            tmp += '<th class="alignLeft"><label for="Editor-enable">' + gNode.editor[ tar.pid ][ 0 ].label + '</label></th>';
            tmp += '<td></td>';
            tmp += '</tr>';
    
            tmp += '<tr>';
            tmp += '<th colspan="2" class="alignLeft BT140">' + gNode.editor[ tar.pid ][ 1 ].label + '</th>';
            tmp += '<td class="alignLeft"><select id="Editor-sAddrId"></select></td>';
            tmp += '</tr>';
    
            tmp += '<tr>';
            tmp += '<th colspan="2" class="alignLeft BT140">' + gNode.editor[ tar.pid ][ 2 ].label + '</th>';
            tmp += '<td class="alignLeft"><select id="Editor-dAddrId"></select></td>';
            tmp += '</tr>';
    
            tmp += '<tr>';
            tmp += '<td class="alignCenter BT10"><input type="checkbox" id="Editor-logEnable" /></td>';
            tmp += '<th class="alignLeft"><label for="Editor-logEnable">' + gNode.editor[ tar.pid ][ 3 ].label + '</label></th>';
            tmp += '<td></td>';
            tmp += '</tr>';
            $('#Editor-table-' + tar.pid).append( tmp );
    
            cgiSelectOption( 'Editor-sAddrId' );
            cgiSelectOption( 'Editor-dAddrId' );
    
            break;
            break;
        case 'ip_mac_binding':
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                if ('checkbox' == gNode.editor[ i ].type) {
                    tmp += '<th colspan="2" class="alignLeft">';
                    tmp += '<input type="checkbox" id="Editor-' + gNode.editor[ i ].tab + '" />';
                    tmp += '&nbsp;<label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label>';
                    tmp += '</th>';
                } else {
                    tmp += '<th class="alignLeft BT100">';
                    tmp += gNode.editor[ i ].label;
                    tmp += '</th>';
                    tmp += '<td class="alignLeft">';
                    tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" />';
                    tmp += '</td>';
                }
                tmp += '</tr>';
            }
            $('#Editor-table-' + tar.pid).append( tmp );
            break;
        }
        
        securityEditor(e, tar.w, tar.h);
    }
    
    function editSecurity(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        tar.thisNo   = tar.id.split(gReg.isDash)[2];
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"><table id="Editor-table-' + tar.pid + '"></table></div>');
    
        var tmp;
        tar.w = 360;
        tar.h = 240;
        switch(tar.pid)
        {
        case 'mime':
            tar.w = 560;
            tmp = '<tr>';
            tmp += '<th class="alignLeft BT60">' + gNode.editor[ tar.pid ][ 0 ].label + '</th>';
            tmp += '<td class="alignLeft"><select id="Editor-type"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT60">' + gNode.editor[ tar.pid ][ 1 ].label + '</th>';
            tmp += '<td class="alignLeft"><select id="Editor-sub"></select></td>';
            tmp += '</tr>';
            $('#Editor-table-' + tar.pid).append( tmp );
    
            var arr = gData.file_exceptions.mimeExcepT[ tar.thisNo ].mime.split('/');
            var type = arr.shift();
            var sub = arr.join('/');
    
            genSelector( 'Editor-type', type );
                 
            for (var i=0; i<gRef.mime.length; i++)
            {
    
                if (type == gRef.mime[ i ].tab) {
                    sub = gRef.mime[ i ].types.indexOf( sub );
                }
            }
            genSelector( 'Editor-sub', sub, type );
            break;
        case 'file_extension':
            tmp = '<tr>';
            tmp += '<th class="alignLeft BT80">' + gNode.editor[ tar.pid ][ 0 ].label + '</th>';
            tmp += '<td class="alignLeft"><input type="text" id="Editor-fileExt" /></td>';
            tmp += '</tr>';
            $('#Editor-table-' + tar.pid).append( tmp );
            $('#Editor-fileExt').val( gData.file_exceptions.fileExcepT[ tar.thisNo ].fileExt );
            break;
        case 'address_exceptions':
            tmp = '<tr>';
            tmp += '<td class="alignCenter BT10"><input type="checkbox" id="Editor-enable" /></td>';
            tmp += '<th class="alignLeft"><label for="Editor-enable">' + gNode.editor[ tar.pid ][ 0 ].label + '</th>';
            tmp += '<td></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th colspan="2" class="alignLeft BT140">' + gNode.editor[ tar.pid ][ 1 ].label + '</th>';
            tmp += '<td class="alignLeft"><select id="Editor-sAddrId"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<th colspan="2" class="alignLeft BT140">' + gNode.editor[ tar.pid ][ 2 ].label + '</th>';
            tmp += '<td class="alignLeft"><select id="Editor-dAddrId"></select></td>';
            tmp += '</tr>';
            tmp += '<tr>';
            tmp += '<td class="alignCenter BT10"><input type="checkbox" id="Editor-logEnable" /></td>';
            tmp += '<th class="alignLeft"><label for="Editor-logEnable">' + gNode.editor[ tar.pid ][ 3 ].label + '</th>';
            tmp += '<td></td>';
            tmp += '</tr>';
            $('#Editor-table-' + tar.pid).append( tmp );

            if ( 1 === parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].enable ) ) {
                $('#Editor-enable').click();
            }
            cgiSelectOption( 'Editor-sAddrId', gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].sAddrId );
            cgiSelectOption( 'Editor-dAddrId', gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].dAddrId );
            if ( 1 === parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].logEnable ) ) {
                $('#Editor-logEnable').click();
            }
            break;
        case 'ip_mac_binding':
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                tmp += '<tr>';
                if ('checkbox' == gNode.editor[ i ].type) {
                    tmp += '<th colspan="2" class="alignLeft">';
                    tmp += '<input type="checkbox" id="Editor-' + gNode.editor[ i ].tab + '" />';
                    tmp += '&nbsp;<label for="Editor-' + gNode.editor[ i ].tab + '">' + gNode.editor[ i ].label + '</label>';
                    tmp += '</th>';
                } else {
                    tmp += '<th class="alignLeft BT100">';
                    tmp += gNode.editor[ i ].label;
                    tmp += '</th>';
                    tmp += '<td class="alignLeft">';
                    tmp += '<input type="text" id="Editor-' + gNode.editor[ i ].tab + '" />';
                    tmp += '</td>';
                }
                tmp += '</tr>';
            }

            $('#Editor-table-' + tar.pid).append( tmp );

            if (1 === parseInt( gData[ gNode.tab ][ gNode.guiT ][ tar.thisNo ].enable ))
                $('#Editor-enable').click();
            $('#Editor-dscrpt').val( gData[ gNode.tab ][ gNode.guiT ][ tar.thisNo ].dscrpt );
            $('#Editor-ipAddr').val( gData[ gNode.tab ][ gNode.guiT ][ tar.thisNo ].ipAddr );
            $('#Editor-macAddr').val( gData[ gNode.tab ][ gNode.guiT ][ tar.thisNo ].macAddr );

            break;
        }
        
        securityEditor(e, tar.w, tar.h);
    
    }
    
    function deleteSecurity(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
    
        tar.pid   = tar.id.split(gReg.isDash)[1];
        tar.thisNo = tar.id.split(gReg.isDash)[2];
    
        switch( tar.pid )
        {
        case 'blacklist':
            if (!$('#popError').exists())
                $('#popBase').append('<div id="popError"></div>');
    
            $('#popError').html('<div class="errorForm"><p class="errorMsg"></p></div>');
            $('#popError').dialog({
                width: 300,
                height:200,
                position: "center",
                resizable: false,
                modal: true,
                title: gTerm[ gObj.lang ].moveAlert,
                buttons: {
                    okay: function() {
                        tar.blacklist = [];
                        for (var i=0, len=parseInt( gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ] ); i<len; i++)
                        {
                            if ( parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].virusID ) === parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ].virusID ) ) {
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ].act = 1;
                                gCache[ tar.pid ].push( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ] );
                            } else {
                                tar.blacklist.push( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ] );
                            }
                        }

                        gData[ tar.pid ][ gNode.guiT[ tar.pid ] ] = tar.blacklist;
                        gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ] = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length;
                        gCache.tabber[ 5 ] = true;
                        gCheckbox[ tar.pid ] = {};
                        $('#blacklist_all').attr('checked', false);
                        refreshSecurity( tar.pid );

                        $( this ).dialog( "close" );
                    },
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                close: function(event, ui) {
                    $(this).dialog('destroy').remove();
                }
            });

            $('.errorMsg').html( gError[ gObj.lang ].delete_black_or_white );
            break;
        case 'whitelist':
            gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ]--;
            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].splice(tar.thisNo,1);
            gCache.tabber[ 6 ] = true;
            gCheckbox[ tar.pid ] = {};
            $('#whitelist_all').attr('checked', false);
            refreshSecurity( tar.pid );
            break;
        case 'address_exceptions':
            gIf.alter = true;
            if (gData[ tar.pid ].guiAddrFilterT[ tar.thisNo ].gid > 0) {
                gData[ tar.pid ].guiAddrFilterT[ tar.thisNo ].cgiAction = 3;
            }else {
                gData[ tar.pid ].guiAddrFilterNum--;
                gData[ tar.pid ].guiAddrFilterT.splice(tar.thisNo,1);
            }
            gCache.tabber[ 3 ] = true;
            refreshSecurity( tar.pid );
            break;
        case 'mime':
            gIf.alter = true;
            gData.file_exceptions.mimeExcepNum--;
            gData.file_exceptions.mimeExcepT.splice(tar.thisNo,1);
            gCache.tabber[ 4 ] = true;
            refreshSecurity( tar.pid );
            break;
        case 'file_extension':
            gIf.alter = true;
            gData.file_exceptions.fileExcepNum--;
            gData.file_exceptions.fileExcepT.splice(tar.thisNo,1);
            gCache.tabber[ 4 ] = true;
            refreshSecurity( tar.pid );
            break;
        }
    }
    
    function removeSecurity(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        tar.avs   = [];
        tar.arr   = [];

        switch( tar.pid )
        {
        case 'blacklist':
            if (!$('#popError').exists())
                $('#popBase').append('<div id="popError"></div>');
    
            $('#popError').html('<div class="errorForm"><p class="errorMsg"></p></div>');
            $('#popError').dialog({
                width: 300,
                height:200,
                position: "center",
                resizable: false,
                modal: true,
                title: gTerm[ gObj.lang ].moveAlert,
                buttons: {
                    okay: function() {
                        $('#table-' + tar.pid + ' tr').each(function() {
                            tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
                            if ($(this).find('td:eq(0) input:checkbox').is(':checked')) {
                                gIf.alter = true;
                                if (tar.avs.indexOf( parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].virusID ) ) == -1) {
                                    tar.avs.push( parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].virusID ) );
                                }
                                gCache.tabber[ 5 ] = true;
                            }
                        });

                        for (var i=0, len=gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length; i<len; i++)
                        {
                            if ( tar.avs.indexOf( parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ].virusID ) ) != -1) {
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ].act = 1;
                                gCache.blacklist.push( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ] );
                            } else {
                                tar.arr.push( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ] );
                            }
                        }

                        gData[ tar.pid ][ gNode.guiT[ tar.pid ] ] = tar.arr;
                        gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ] = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length;
                        $('#blacklist_all').attr('checked', false);
                        gCheckbox[ tar.pid ] = {};
                        refreshSecurity( tar.pid );

                        $( this ).dialog( "close" );
                    },
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                close: function(event, ui) {
                    $(this).dialog('destroy').remove();
                }
            });

            $('.errorMsg').html( gError[ gObj.lang ].delete_black_or_white );
            break;
        case 'whitelist':
            $('#table-' + tar.pid + ' tr').each(function() {
                tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
                if ($(this).find('td:eq(0) input:checkbox').is(':checked')) {
                    gIf.alter = true;
                    tar.avs.push( parseInt(tar.thisNo) );
                    gCache.tabber[ 6 ] = true;
                }
            });

            for (var i=0; i<gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ]; i++)
            {
                if (tar.avs.indexOf( i ) != -1)
                   continue;
                tar.arr.push( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ] );
            }
  
            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ] = tar.arr;
            gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ] = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length;
            $('#whitelist_all').attr('checked', false);
            gCheckbox[ tar.pid ] = {};
            refreshSecurity( tar.pid );
            break;
        }
    }
    
    function securityEditor( e, w, h ) {
        var tar = {};
    
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[1];
        tar.thisNo  = tar.id.split(gReg.isDash)[2];
    
        if (gObj.active.h5Index == 'NA') {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ((gNode.tabs)? ' > ' + (( gNode.tabs[ tar.pid ] )? gNode.tabs[ tar.pid ] : tar.pid ) : '');
        }else {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].label + ((gNode.tabs)? ' > ' + ((gNode.tabs[ tar.pid ])? gNode.tabs[ tar.pid ] : tar.pid ) : '');
        }
    
        $('#popForm').dialog({
            width: w || 800,
            height: h || 600,
            position: "center",
            resizable: false,
            modal: true,
            title: tar.title + ' > ' + gTerm[ gObj.lang ][ tar.type ],
            buttons: {
                OK: function() {
                    if (securityChecker(e)) {
                        gIf.alter = true;
                        switch( tar.pid )
                        {
                        case 'mime':
                            if ('Create' == tar.type) {
                                gData.file_exceptions.mimeExcepNum++;
                                gData.file_exceptions.mimeExcepT.push( {'mime' : $('#Editor-type').val() + '/' + $('#Editor-sub option:selected').text()} );
                            } else {
                                gData.file_exceptions.mimeExcepT[ tar.thisNo ] = {'mime' : $('#Editor-type').val() + '/' + $('#Editor-sub option:selected').text() };
                            }
                            gCache.tabber[ 4 ] = true;
                            break;
                        case 'file_extension':
                            if ('Create' == tar.type) {
                                gData.file_exceptions.fileExcepNum++;
                                gData.file_exceptions.fileExcepT.push( {'fileExt' : $('#Editor-fileExt').val() } );
                            } else {
                                gData.file_exceptions.fileExcepT[ tar.thisNo ] = {'fileExt' : $('#Editor-fileExt').val() };
                            }
                            gCache.tabber[ 4 ] = true;
                            break;
                        case 'address_exceptions':
                            if ('Create' == tar.type) {
                                gCache.antivirus.address_exceptions.gid --;
                                gData[ tar.pid ].guiAddrFilterNum++;
                                gData[ tar.pid ].guiAddrFilterT.push( {'gid': gCache.antivirus.address_exceptions.gid, 'enable': (($('#Editor-enable').is(':checked'))? 1 : 0), 'sAddrId': $('#Editor-sAddrId').val(), 'dAddrId': $('#Editor-dAddrId').val(), 'logEnable': (($('#Editor-logEnable').is(':checked'))? 1 : 0), 'features' : 1, 'cgiAction': 1} );
                            } else {
                                if ( gData[ tar.pid ].guiAddrFilterT[ tar.thisNo ].gid > 0 )
                                    gData[ tar.pid ].guiAddrFilterT[ tar.thisNo ].cgiAction = 2;
                                gData[ tar.pid ].guiAddrFilterT[ tar.thisNo ].enable = ($('#Editor-enable').is(':checked'))? 1 : 0 ;
                                gData[ tar.pid ].guiAddrFilterT[ tar.thisNo ].sAddrId = $('#Editor-sAddrId').val();
                                gData[ tar.pid ].guiAddrFilterT[ tar.thisNo ].dAddrId = $('#Editor-dAddrId').val();
                                gData[ tar.pid ].guiAddrFilterT[ tar.thisNo ].logEnable = ($('#Editor-logEnable').is(':checked'))? 1 : 0 ;
                            }
                            gCache.tabber[ 3 ] = true;
                            break;
                        case 'ip_mac_binding':
                            if ('Create' == tar.type) {
                                gCache.ip_mac_binding.gid --;
                                gData[ tar.pid ].ipMacBindingT.push( {'gid': gCache.ip_mac_binding.gid, 'enable': (($('#Editor-enable').is(':checked'))? 1 : 0), 'dscrpt': $('#Editor-dscrpt').val(), 'ipAddr': $('#Editor-ipAddr').val(), 'macAddr': $('#Editor-macAddr').val(), 'cgiAction': 1} );
                            } else {
                                if ( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid > 0 )
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].enable = ($('#Editor-enable').is(':checked'))? 1 : 0 ;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].dscrpt = $('#Editor-dscrpt').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].ipAddr = $('#Editor-ipAddr').val();
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].macAddr = $('#Editor-macAddr').val();
                            }
                            break;
                        }
                        refreshSecurity( tar.pid );
                        $( this ).dialog( "close" );
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });
    }
    
    function securityChecker( pid ) {
        var pass = true;
        var flag = false;
        var msg = '';
        switch( pid ) 
        {
        case 'antivirus':
            // general setting
            var cnt = 0;
            flag = false;
            if ($('#enabled').is(':checked')) {
                cnt = 0;
                $('#selectedZonesT option').each(function() {
                    flag = true;
                });
        
                if (!flag) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].zoneNeed + '</p>';
                }
            }
    
            cnt = 0;
            flag = false;
            for (var i=0; i<5; i++)
            {
                if (gReg.portList.test($('#httpPortList-' + i).val())) {            
                    cnt++;
                } else if ( $('#httpPortList-' + i).val().length > 0 ) {
                    flag = true;
                }
            }
        
            if (flag || 0 === cnt) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].httpPortNeed + '</p>';
            }
    
            cnt = 0;
            flag = false;
            for (var i=0; i<5; i++)
            {
                if (gReg.portList.test($('#ftpPortList-' + i).val())) {            
                    cnt++;
                } else if ( $('#ftpPortList-' + i).val().length > 0 ) {
                    flag = true;
                }
            }
    
            if (flag || 0 === cnt) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].ftpPortNeed + '</p>';
            }
    
            cnt = 0;
            flag = false;
            for (var i=0; i<5; i++)
            {
                if (gReg.portList.test($('#smtpPortList-' + i).val())) {            
                    cnt++;
                } else if ( $('#smtpPortList-' + i).val().length > 0 ) {
                    flag = true;
                }
            }
    
            if (flag || 0 === cnt) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].smtpPortNeed + '</p>';
            }
    
            cnt = 0;
            flag = false;
            for (var i=0; i<5; i++)
            {
                if (gReg.portList.test($('#pop3PortList-' + i).val())) {            
                    cnt++;
                } else if ( $('#pop3PortList-' + i).val().length > 0 ) {
                    flag = true;
                }
            }
    
            if (flag || 0 === cnt) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].pop3PortNeed + '</p>';
            }
    
            if (!gReg.maxFileSize.test( $('#maxFileSize').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].maxFileSizeRange + '</p>';
            }
    
            // blacklist
            if (gCache.tabber[ 5 ]) {
                if (gReg.expDay.test( $('#expiration_days').val() ) && gReg.expHour.test( $('#expiration_hours').val() )) {
                    var exps = parseInt( $('#expiration_days').val() ) * 24 + parseInt( $('#expiration_hours').val() ); 
                    if ( !gReg.blacklist.test( exps ) ) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].expireRange + '</p>';
                    }
                } else {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].expireRange + '</p>';
                } 
            }

            break;
        }
    
        if (!pass) {
            errorAlert( msg );
        }
    
        return pass;
    }
    
    function saveSecurity(pid) {
        switch( pid )
        {
        case 'antivirus':
            // deal alter tabs 
            if (securityChecker( pid )) {
                loadingToggle( true );
                gObj.loading = 10;
                gIf.loading = true;
                if (gCache.tabber[ 1 ]) {
                    gData.http_notification.httpNotify = $('#httpNotify').val();
                    cgiID = 'av_http_notify';
                    $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData.http_notification), function( poster ) {
                        delete gCache.tabber[ 1 ];
                    });
                }
    
                if (gCache.tabber[ 2 ]) {
                    gData.email_notification.mailTag = $('#mailTag').val();
                    gData.email_notification.mailContent = $('#mailContent').val();
                    cgiID = 'av_email_notify';
    
                    $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData.email_notification), function( poster ) {
                        delete gCache.tabber[ 2 ];
                    });
                }
    
                if (gCache.tabber[ 3 ]) {
                    cgiID = 'addr_filter';
                    $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData.address_exceptions), function( poster ) {
                        delete gCache.tabber[ 3 ];
                    });
                }
    
                if (gCache.tabber[ 4 ]) {
                    cgiID = 'av_file_exception';
                    $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData.file_exceptions), function( poster ) {
                        delete gCache.tabber[ 4 ];
                    });
                }
    
                if (gCache.tabber[ 5 ]) {
                    cgiID = 'av_blacklist';
                    gData.blacklist.urlT = gCache.blacklist;
                    gData.blacklist.number = gData.blacklist.urlT.length;
                    gData.blacklist.expiration_days = $('#expiration_days').val();
                    gData.blacklist.expiration_hours = $('#expiration_hours').val();
                    $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData.blacklist), function( poster ) {
                        delete gCache.tabber[ 5 ];
                    });
                }
    
                if (gCache.tabber[ 6 ]) {
                    cgiID = 'av_whitelist';
                    $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData.whitelist), function( poster ) {
                        delete gCache.tabber[ 6 ];
                    });
                }
    
                if (gCache.tabber[ 7 ]) {
                    if ($('#signature-autoUpdate').is(':checked'))
                        gData.signature.autoUpdate = 1;
                    else
                        gData.signature.autoUpdate = 0;
                    gData.signature.type = $('#signature-type').val();
                    gData.signature.number = $('#signature-number').val();
                    gData.signature.startUpdate = 0;
                    cgiID = 'av_sig';
                    $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData.signature), function( poster ) {
                        delete gCache.tabber[ 7 ];
                    });
                }

                if (gCache.tabber[ 0 ]) {
                    gData.general_settings.enable = ($('#enabled').is(':checked'))? 1 : 0;
                    gData.general_settings.selectedZonesT = [];
                    $('#selectedZonesT option').each(function() {
                        gData.general_settings.selectedZonesT.push( {"gid": $(this).val() } );
                    });
    
                    var arrs = [];
                    for (var i=0; i<5; i++)
                    {
                        if (gReg.portList.test($('#httpPortList-' + i).val())) {
                            arrs.push({'port': $('#httpPortList-' + i).val() });
                        }
                    }
                    gData.general_settings.httpPortListT = arrs;
                    gData.general_settings.httpPortNum = arrs.length;
    
                    arrs = [];
                    for (var i=0; i<5; i++)
                    {
                        if (gReg.portList.test($('#ftpPortList-' + i).val())) {
                            arrs.push({'port': $('#ftpPortList-' + i).val() });
                        }
                    }
                    gData.general_settings.ftpPortListT = arrs;
                    gData.general_settings.ftpPortNum = arrs.length;
    
                    arrs = [];
                    for (var i=0; i<5; i++)
                    {
                        if (gReg.portList.test($('#smtpPortList-' + i).val())) {
                            arrs.push({'port': $('#smtpPortList-' + i).val() });
                        }
                    }
                    gData.general_settings.smtpPortListT = arrs;
                    gData.general_settings.smtpPortNum = arrs.length;
    
                    arrs = [];
                    for (var i=0; i<5; i++)
                    {
                        if (gReg.portList.test($('#pop3PortList-' + i).val())) {
                            arrs.push({'port': $('#pop3PortList-' + i).val() });
                        }
                    }
                    gData.general_settings.pop3PortListT = arrs;
                    gData.general_settings.pop3PortNum = arrs.length;
    
                    gData.general_settings.selectedZonesNum = gData.general_settings.selectedZonesT.length;
                    gData.general_settings.httpEnable = ($('#httpEnable').is(':checked'))? 1 : 0;
                    gData.general_settings.httpLog = ($('#httpLog').is(':checked'))? 1 : 0;
                    gData.general_settings.httpAct = $('#httpAct').val();
                    gData.general_settings.ftpAct = $('#ftpAct').val();
                    gData.general_settings.ftpEnable = ($('#ftpEnable').is(':checked'))? 1 : 0;
                    gData.general_settings.ftpLog = ($('#ftpLog').is(':checked'))? 1 : 0;
                    gData.general_settings.smtpEnable = ($('#smtpEnable').is(':checked'))? 1 : 0;
                    gData.general_settings.smtpLog = ($('#smtpLog').is(':checked'))? 1 : 0;
                    gData.general_settings.smtpAct = $('#smtpAct').val();
                    gData.general_settings.pop3Enable = ($('#pop3Enable').is(':checked'))? 1 : 0;
                    gData.general_settings.pop3Log = ($('#pop3Log').is(':checked'))? 1 : 0;
                    gData.general_settings.pop3Act = $('#pop3Act').val();
                    gData.general_settings.cifsEnable = ($('#cifsEnable').is(':checked'))? 1 : 0;
                    gData.general_settings.cifsLog = ($('#cifsLog').is(':checked'))? 1 : 0;
                    gData.general_settings.cifsAct = $('#cifsAct').val();
                    //gData.general_settings.imapEnable = ($('#imapEnable').is(':checked'))? 1 : 0;
                    //gData.general_settings.imapLog = ($('#imapLog').is(':checked'))? 1 : 0;
                    //gData.general_settings.imapAct = $('#imapAct').val();
                    gData.general_settings.maxFileSize = $('#maxFileSize').val();
                    cgiID = 'av_general';
                    $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData.general_settings)).done( function() {
                        delete gCache.tabber[ 0 ];
                    });
                }
    
                gIf.alter = false;
            }
            break;
        case 'ip_mac_binding':

            if ($('#enable').is(':checked'))
                gData[ pid ].enable = 1;
            else
                gData[ pid ].enable = 0;
            gData[ pid ].mode = $('#mode').val();
            $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(gData[ pid ]), function( poster ) {
                gIf.alter = false;
                genSecurity( pid );
            });

            break;
        }
    }
    
    function genUsers(pid) {
        var tmp = '';
    
        switch(gNode.ext)
        {
        case 'cgi':
            switch(gNode.tag)
            {
            case 'div':
                switch(gNode.type)
                {
                case 'tabs':
                    switch(pid)
                    {
                    case 'users_and_groups':
                        gObj.tabIndex = gObj.tabIndexed;
                        if (gIf.power) {
                            $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                            gY.one('#pgSave').on('click', function(e) {
                                gObj.tabIndex = gObj.tabber.tabs('option', 'selected');
                                if (gObj.tabber.tabs('option', 'selected') == 0)
                                    saveUsers('group');
                                else
                                    saveUsers('user');
                            });
                        }
    
                        gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div class="tabber"><ul></ul></div></div>');
    
                        // for gid might be 0 if never saved, cache uniq name instead 
                        gCache.uniq.group = {};
                        gCache.uniq.user = {};
                        //gCache.uniq.user[ gObj.adminName ] = true;
                        gCache.group = {};
                        gCache.user = {};
                        gCache.groupId = 0;
                        gCache.defaultGid = 0;
    
                        var y = 'group';
    
                        $.ajax({
                            url: 'cgi-bin/' + gNode.url.get[ y ] + '.' + gNode.ext,
                            dataType: 'json',
                            success: function(data) {
                                gData[ y ] = data;
                                gY.one('.tabber ul').append('<li id="tab-' + y + '"><a href="#panel-' + y + '">' + gNode.tabs[ y ] + '</a></li>');
                                gY.one('.tabber').append('<div id="panel-' + y + '"></div>');
    
                                tmp = '<div id="div-' + y + '" class="tableDiv">';
    
                                tmp += '<div id="div-' + y + '">';
                                tmp += '<div id="div-header-' + y + '">';
                                tmp += '<table id="table-header-' + y + '">';
                                tmp += '<thead>';
                                for (var i=0, len=gNode.col[ y ].length; i<len; i++)
                                {
                                    tmp += '<th id="' + y + '-' + gNode.col[ y ][ i ].tab + '"';
                                    if (gNode.col[ y ][ i ].tab == 'action') {
                                        tmp += 'class="ui-state-default rowAction"';
                                        gObj.btn = gNode.rowAction[ y ].split(' ');
                                    }else if (gNode.col[ y ][ i ].tab == 'checkbox') {
                                        tmp += 'class="ui-state-default checkTD"';
                                    }else
                                        tmp += 'class="ui-state-default"';
                                    tmp += ' style="width: ' + gNode.col[ y ][ i ].wiz + '" ';
                                    tmp += '>';
                                    tmp += gNode.col[ y ][ i ].label;
                                    tmp += '</th>';
                                }
                                tmp += '</thead>';
                                tmp += '</table>';
                                tmp += '</div>';
                                tmp += '<div id="div-bodyer-' + y + '">';
                                tmp += '<table id="table-bodyer-' + y + '">';
                                tmp += '</table>';
                                tmp += '</div>';
                                tmp += '<div id="div-footer-' + y + '">';
                                tmp += '<table id="table-footer-' + y + '">';
                                tmp += '</table>';
                                tmp += '</div>';
                                tmp += '</div>';
                                gY.one('#panel-' + y).set('innerHTML', tmp);
                                for (var i=0, len=data[ gNode.guiT[ y ] ].length; i<len; i++)
                                {
                                    gData.group.groupListT[ i ].gid = parseInt( gData.group.groupListT[ i ].gid );
                                    gCache.uniq[ y ][ data[ gNode.guiT[ y ] ][ i ].name ] = true;
                                    // declair group's gid array 
                                    gCache[ y ][ parseInt( data.groupListT[ i ].gid ) ] = [];
                                }
                            }
                        }).done( function() {
                            y = 'user';
                            $.ajax({
                                url: 'cgi-bin/' + gNode.url.get[ y ] + '.' + gNode.ext,
                                dataType: 'json',
                                success: function(data) {
                                    gData[ y ] = data;
                                    gY.one('.tabber ul').append('<li id="tab-' + y + '"><a href="#panel-' + y + '">' + gNode.tabs[ y ] + '</a></li>');
                                    gY.one('.tabber').append('<div id="panel-' + y + '"></div>');
    
                                    tmp = '<div id="div-' + y + '" class="tableDiv">';
                                    tmp += '<div id="div-header-' + y + '">';
                                    tmp += '<table id="table-header-' + y + '">';
                                    tmp += '<thead>';
                                    for (var i=0, len=gNode.col[ y ].length; i<len; i++)
                                    {
                                        tmp += '<th id="' + y + '-' + gNode.col[ y ][ i ].tab + '"';
                                        if (gNode.col[ y ][ i ].tab == 'action') {
                                            tmp += 'class="ui-state-default rowAction"';
                                            gObj.btn = gNode.rowAction[ y ].split(' ');
                                        }else if (gNode.col[ y ][ i ].tab == 'checkbox') {
                                            tmp += 'class="ui-state-default checkTD"';
                                        }else
                                            tmp += 'class="ui-state-default"';
                                        tmp += ' style="width: ' + gNode.col[ y ][ i ].wiz + '" ';
                                        tmp += '>';
                                        tmp += gNode.col[ y ][ i ].label;
                                        tmp += '</th>';
                                    }
                                    tmp += '</thead>';
                                    tmp += '</table>';
                                    tmp += '</div>';
                                    tmp += '<div id="div-bodyer-' + y + '">';
                                    tmp += '<table id="table-bodyer-' + y + '">';
                                    tmp += '</table>';
                                    tmp += '</div>';
                                    tmp += '<div id="div-footer-' + y + '">';
                                    tmp += '<table id="table-footer-' + y + '">';
                                    tmp += '</table>';
                                    tmp += '</div>';
                                    tmp += '</div>';
                                    gY.one('#panel-' + y).set('innerHTML', tmp);
    
                                    for (var i=0, len=data[ gNode.guiT[ y ] ].length; i<len; i++)
                                    { 
                                        gData.user.userListT[ i ].gid = parseInt( gData.user.userListT[ i ].gid );
                                        gData.user.userListT[ i ].groupId = parseInt( gData.user.userListT[ i ].groupId );
                                        gCache.uniq[ y ][ data[ gNode.guiT[ y ] ][ i ].name ] = true;
                                    } 
                                } 
                            }).done( function() {
                                gObj.tabber = $('.tabber').tabs({ active: gObj.tabIndex });
                                // user 
    
                                for (var i=0, len=gData[ y ][ gNode.guiT[ y ] ].length; i<len; i++) 
                                {
                                    tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                    for (var j=0, jlen=gNode.col[ y ].length; j<jlen; j++)
                                    {
                                        tmp += '<td style="width: ' + gNode.col[ y ][ j ].wiz + '" class="align' + gNode.col[ y ][ j ].align + '">';
                                        if (gNode.col[ y ][ j ].tab == 'checkbox') {
                                            if (gIf.power) {
                                                tmp += '<input type="checkbox" id="' + y + '-' + i + '" value="' + i + '" />';
                                            } else {
                                                tmp += '';
                                            }
                                        }else if (gNode.col[ y ][ j ].tab == 'action') {
                                            if (gIf.power) {
                                                tmp += '<button id="Edit-' + y + '-' + i + '" class="Edit"><span class="ui-icon"  title="Edit"></span></button>';
                                                //tmp += '<button id="Duplicate-' + y + '-' + i + '" class="Duplicate"><span class="ui-icon" ></span></button>';
                                                tmp += '<button id="Delete-' + y + '-' + i + '" class="Delete"><span class="ui-icon"  title="Delete"></span></button>';
                                            } else {
                                                tmp += '';
                                            }
                                        }else if (gNode.col[ y ][ j ].tab == 'groupId') {
                                            for (var k in gData.group.groupListT)
                                            {
                                                if (parseInt( gData.group.groupListT[ k ].gid ) == gData[ y ][ gNode.guiT[ y ] ][ i ][ gNode.col[ y ][ j ].tab ]) 
                                                    tmp += gData.group.groupListT[ k ].name;
                                            }
                                        }else if (gNode.col[ y ][ j ].tab == 'name') {
                                            tmp += '<label for="' + y + '-' + i + '">' + gData[ y ][ gNode.guiT[ y ] ][ i ][ gNode.col[ y ][ j ].tab ] + '</label>';
                                        }
                                        tmp += '</td>';
                                    }
                                    tmp += '</tr>';
                                    $('#table-bodyer-' + y ).append(tmp);
                                }

                                if (gIf.power) {
                                    tmp = '<div class="tblAction">';
                                    var arr = gNode.tblAction[ y ].split(' ');
                                    for (var i=0; i<arr.length; i++)
                                        tmp += '<button id="' + arr[ i ] + '-' + y + '" class="' + arr[ i ] + '" title="' + arr[ i ] + '"><span class="ui-icon"></span></button>';
                                    tmp += '</div>';
                                    $('#table-footer-' + y ).append( tmp );

                                    $('#table-bodyer-' + y + ' tr').bind('click', function(e) {
                                    });

                                    switch (gData[ y ][ gNode.guiT[ y ] ].length)
                                    {
                                    case 0:
                                        $('#Remove-' + y).prop('disabled', true);
                                        break;
                                    case gRows.maxUser:
                                        $('#Create-' + y).prop('disabled', true);
                                        break;
                                    }
                                }
    
                                // group 
                                y = 'group'; 
                                for (var i=0, len=gData[ y ][ gNode.guiT[ y ] ].length; i<len; i++) 
                                {
                                    tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                    for (var j=0, jlen=gNode.col[ y ].length; j<jlen; j++)
                                    {
                                        tmp += '<td style="width: ' + gNode.col[ y ][ j ].wiz + '" class="align' + gNode.col[ y ][ j ].align + '">';
                                        if (gNode.col[ y ][ j ].tab == 'checkbox') {
                                            if (gData[ y ][ gNode.guiT[ y ] ][ i ].name == 'default') {
                                                gCache.defaultGid = parseInt( gData[ y ][ gNode.guiT[ y ] ][ i ].gid );
                                                tmp += '';
                                            } else if (gIf.power) {
                                                tmp += '<input type="checkbox" id="' + y + '-' + i + '" value="' + i + '" />';
                                            } else {
                                                tmp += '';
                                            }
                                        }else if (gNode.col[ y ][ j ].tab == 'action') {
                                            if (gIf.power) {
                                                tmp += '<button id="Edit-' + y + '-' + i + '" class="Edit"><span class="ui-icon"  ></span></button>';
                                                if (gData[ y ][ gNode.guiT[ y ] ][ i ].name != 'default') {
                                                    //tmp += '<button id="Duplicate-' + y + '-' + i + '" class="Duplicate"><span class="ui-icon" ></span></button>';
                                                    tmp += '<button id="Delete-' + y + '-' + i + '" class="Delete"><span class="ui-icon" ></span></button>';
                                                }
                                            } else {
                                                tmp += '';
                                            }
                                        }else if (gNode.col[ y ][ j ].tab == 'cgiSetListId') {
                                            gIf.tag = false;
                                            for (var k=0, klen=gData.user.userListT.length; k<klen; k++) 
                                            {
                                                if ( parseInt(gData.user.userListT[ k ].groupId) == parseInt( gData[ y ][ gNode.guiT[ y ] ][ i ].gid ) ) {
                                                    // cache user's groupId 
                                                    gCache.user[ parseInt( gData.user.userListT[ k ].gid ) ] = parseInt( gData[ y ][ gNode.guiT[ y ] ][ i ].gid );
                                                    if (gIf.tag) 
                                                        tmp += ';';
                                                    tmp += gData.user.userListT[ k ].name;
                                                    gIf.tag = true;
                                                }
                                            }
                                        }else if (gNode.col[ y ][ j ].tab == 'services') {
                                            tmp += 'Web Login: ' + gRef.group.webLoginPriv[ gData[ y ][ gNode.guiT[ y ] ][ i ].webLoginPriv ];
                                        }else if (gNode.col[ y ][ j ].tab == 'name') {
                                            tmp += '<label for="' + y + '-' + i + '">' + gData[ y ][ gNode.guiT[ y ] ][ i ][ gNode.col[ y ][ j ].tab ] + '</label>';
                                        }
                                        tmp += '</td>';
                                    }
                                    tmp += '</tr>';
                                    $('#table-bodyer-' + y).append(tmp);
                                }
                                if (gIf.power) {
                                    tmp = '<div class="tblAction">';
                                    var arr = gNode.tblAction[ y ].split(' ');
                                    for (var i=0; i<arr.length; i++)
                                        tmp += '<button id="' + arr[ i ] + '-' + y + '" class="' + arr[ i ] + '" title="' + arr[ i ] + '"><span class="ui-icon"></span></button>';
                                    tmp += '</div>';
                                    $('#table-footer-' + y).append( tmp );
                                    switch( gData[ y ][ gNode.guiT[ y ] ].length )
                                    {
                                    case 0:
                                        $('#Remove-' + y).prop('disabled', true);
                                        break;
                                    case gRows.maxUserGroup:
                                        $('#Create-' + y).prop('disabled', true);
                                        break;
                                    }
                                }
                            });
                        });
                        break;
                    }
                    break;
                }
                break;
            }
            break;
        }
    }
    
    function refreshUsers(pid) {
        var tmp = '';
        var tableBD = $('#table-bodyer-' + pid);
        var cnt = 0;
        tableBD.empty();
        switch(pid)
        {
        case 'user':
            for (var i=0, len=gData[ pid ][ gNode.guiT[ pid ] ].length; i<len; i++)
            {
                if ( parseInt( gData[ pid ][ gNode.guiT[ pid ] ][ i ].cgiAction ) == 3 )
                    continue;
                tmp = '<tr class="' + ((cnt%2==0)? 'even' : 'odd') + '">';
                for (var j=0, jlen=gNode.col[ pid ].length; j<jlen; j++)
                {
                    tmp += '<td style="width: ' + gNode.col[ pid ][ j ].wiz + '" class="align' + gNode.col[ pid ][ j ].align + '">';
                    if (gNode.col[ pid ][ j ].tab == 'checkbox') {
                        tmp += '<input type="checkbox" value="' + i + '" />';
                    }else if (gNode.col[ pid ][ j ].tab == 'action') {
                        tmp += '<button id="Edit-' + pid + '-' + i + '" class="Edit"><span class="ui-icon"  title="Edit"></span></button>';
                        //tmp += '<button id="Duplicate-' + pid + '-' + i + '" class="Duplicate"><span class="ui-icon" ></span></button>';
                        tmp += '<button id="Delete-' + pid + '-' + i + '" class="Delete"><span class="ui-icon"  title="Delete"></span></button>';
                    }else if (gNode.col[ pid ][ j ].tab == 'groupId') {
                        for (var k in gData.group.groupListT)
                        {
                            if (parseInt( gData.group.groupListT[ k ].gid ) == gData[ pid ][ gNode.guiT[ pid ] ][ i ][ gNode.col[ pid ][ j ].tab ])
                                tmp += gData.group.groupListT[ k ].name
                        }
                    }else if (gNode.col[ pid ][ j ].tab == 'name') {
                        tmp += gData[ pid ][ gNode.guiT[ pid ] ][ i ][ gNode.col[ pid ][ j ].tab ];
                    }
                    tmp += '</td>';
                }
                tmp += '</tr>';
                $(tableBD).append(tmp);
                cnt++;
            }
    
            switch( gData[ pid ][ gNode.guiT[ pid ] ].length )
            {
            case 0:
                $('#Remove-' + pid).prop('disabled', true);
                break;
            case gRows.maxUser:
                $('#Create-' + pid).prop('disabled', true);
                break;
            default:
                $('#Remove-' + pid).prop('disabled', false);
                $('#Create-' + pid).prop('disabled', false);
            }   
            break;
        case 'group':
            for (var i=0, len=gData[ pid ][ gNode.guiT[ pid ] ].length; i<len; i++)
            {
                if ( parseInt( gData[ pid ][ gNode.guiT[ pid ] ][ i ].cgiAction ) == 3 ) 
                    continue;
                tmp = '<tr class="' + ((cnt%2==0)? 'even' : 'odd') + '">';
                for (var j=0, jlen=gNode.col[ pid ].length; j<jlen; j++)
                {
                    tmp += '<td style="width: ' + gNode.col[ pid ][ j ].wiz + '" class="align' + gNode.col[ pid ][ j ].align + '">';
                    if (gNode.col[ pid ][ j ].tab == 'checkbox') {
                        if (gData[ pid ][ gNode.guiT[ pid ] ][ i ].name == 'default')
                            tmp += '';
                        else  
                            tmp += '<input type="checkbox" value="' + i + '" />';
                    }else if (gNode.col[ pid ][ j ].tab == 'action') {
                        tmp += '<button id="Edit-' + pid + '-' + i + '" class="Edit"><span class="ui-icon"  title="Edit"></span></button>';
                        if (gData[ pid ][ gNode.guiT[ pid ] ][ i ].name != 'default') {
                            //tmp += '<button id="Duplicate-' + pid + '-' + i + '" class="Duplicate"><span class="ui-icon" ></span></button>';
                            tmp += '<button id="Delete-' + pid + '-' + i + '" class="Delete"><span class="ui-icon"  title="Delete"></span></button>';
                        }
                    }else if (gNode.col[ pid ][ j ].tab == 'cgiSetListId') {
                        gIf.tag = false;
                        for (var k=0, klen=gData.user.userListT.length; k<klen; k++) 
                        {
                            if ( parseInt(gData.user.userListT[ k ].groupId) == parseInt( gData[ pid ][ gNode.guiT[ pid ] ][ i ].gid ) ) {
                                if (gIf.tag) 
                                    tmp += ';';
                                tmp += '&nbsp;' + gData.user.userListT[ k ].name + '&nbsp;';
                                gIf.tag = true;
                            }
                        }
                    }else if (gNode.col[ pid ][ j ].tab == 'services') {
                        tmp += 'Web Login: ' + gRef.group.webLoginPriv[ gData[ pid ][ gNode.guiT[ pid ] ][ i ].webLoginPriv ];
                    }else if (gNode.col[ pid ][ j ].tab == 'name') {
                        tmp += gData[ pid ][ gNode.guiT[ pid ] ][ i ][ gNode.col[ pid ][ j ].tab ];
                    }
                    tmp += '</td>';
                }
                tmp += '</tr>';
                $(tableBD).append(tmp);
                cnt++;
            }

            switch( gData[ pid ][ gNode.guiT[ pid ] ].length )
            {                           
            case 0:                     
                $('#Remove-' + pid).prop('disabled', true);
                break;                      
            case gRows.maxUser:         
                $('#Create-' + pid).prop('disabled', true);
                break;                      
            default:
                $('#Remove-' + pid).prop('disabled', false);
                $('#Create-' + pid).prop('disabled', false);
            }  
        }
    }
    
    function createUsers(e, type) {
    
        var tmp = '';
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        tar.w = 640;
        tar.h = 480;
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        switch(tar.pid)
        {
        case 'user':
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ tar.pid ][ i ].tab + '"><a href="#panel-' + gNode.editor[ tar.pid ][ i ].tab + '">' + gNode.editor[ tar.pid ][ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ tar.pid ][ i ].tab + '"></div>');
                $('#panel-' + gNode.editor[ tar.pid ][ i ].tab).append('<table id="table-' + gNode.editor[ tar.pid ][ i ].tab + '"></table>');
                for (var j=0, jlen=gNode.editor[ tar.pid ][ i ].col.length; j<jlen; j++)
                {
                    switch (gNode.editor[ tar.pid ][ i ].col[ j ].tag)
                    {
                    case 'input':
                        switch(gNode.editor[ tar.pid ][ i ].col[ j ].type)
                        {
                        case 'text':
                        case 'password':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ tar.pid ][ i ].col[ j ].wiz)? gNode.editor[ tar.pid ][ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ tar.pid ][ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="' + gNode.editor[ tar.pid ][ i ].col[ j ].type + '" id="' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].col[ j ].tab + '" />';
                            if (gNode.editor[ tar.pid ][ i ].col[ j ].note)
                                tmp += '&nbsp;' + gNode.editor[ tar.pid ][ i ].col[ j ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        }
                        break;
                    case 'select':
                        switch(gNode.editor[ tar.pid ][ i ].col[ j ].type)
                        {
                        case 'select':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ tar.pid ][ i ].col[ j ].wiz)? gNode.editor[ tar.pid ][ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ tar.pid ][ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<select id="' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].col[ j ].tab + '">';
                            if ( gNode.editor[ tar.pid ][ i ].col[ j ].option ) {
                                for (var x in gNode.editor[ tar.pid ][ i ].col[ j ].option)
                                    tmp += '<option value="' + x + '">' + gNode.editor[ tar.pid ][ i ].col[ j ].option[ x ] + '</option>';
                            }
                            tmp += '</select>';
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        }
                        break;
                    }
                    $('#table-' + gNode.editor[ tar.pid ][ i ].tab).append( tmp );
                }
            }

            if (type) {
                tar.thisNo = tar.id.split(gReg.isDash)[2];
                cgiSelectOption('membership-groupId', gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].groupId);
                $('#account-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
            } else {
                cgiSelectOption('membership-groupId');
            }
            break;
        case 'group':
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++) 
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ tar.pid ][ i ].tab + '"><a href="#panel-' + gNode.editor[ tar.pid ][ i ].tab + '">' + gNode.editor[ tar.pid ][ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ tar.pid ][ i ].tab + '"></div>');
                $('#panel-' + gNode.editor[ tar.pid ][ i ].tab).append('<table id="table-' + gNode.editor[ tar.pid ][ i ].tab + '"></table>');
                for (var j=0, jlen=gNode.editor[ tar.pid ][ i ].col.length; j<jlen; j++)
                {
                    switch (gNode.editor[ tar.pid ][ i ].col[ j ].tag)
                    {
                    case 'input':
                        tmp = '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ tar.pid ][ i ].col[ j ].wiz)? gNode.editor[ tar.pid ][ i ].col[ j ].wiz : 'auto' ) + '" >';
                        tmp += gNode.editor[ tar.pid ][ i ].col[ j ].label;
                        tmp += '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 1 ] : "Left") + '">';
                        tmp += '<input type="' + gNode.editor[ tar.pid ][ i ].col[ j ].type + '" id="' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].col[ j ].tab + '" />';
                        if (gNode.editor[ tar.pid ][ i ].col[ j ].note)
                            tmp += '&nbsp;' + gNode.editor[ tar.pid ][ i ].col[ j ].note;
                        tmp += '</td>';
                        tmp += '</tr>';
                        break;
                    case 'select':
                        switch (gNode.editor[ tar.pid ][ i ].col[ j ].type)
                        {
                        case 'select':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ tar.pid ][ i ].col[ j ].wiz)? gNode.editor[ tar.pid ][ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ tar.pid ][ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<select id="' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].col[ j ].tab + '">';
                            if ( gNode.editor[ tar.pid ][ i ].col[ j ].option ) {
                                for (var x in gNode.editor[ tar.pid ][ i ].col[ j ].option)
                                    tmp += '<option value="' + x + '">' + gNode.editor[ tar.pid ][ i ].col[ j ].option[ x ] + '</option>';
                            }
                            tmp += '</select>';
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'multiple':
                            tmp = '<tr>';
                            tmp += '<td colspan="2">';
                            tmp += '<table id="' + gNode.editor[ tar.pid ][ i ].col[ j ].tab + '">';
            
                            tmp += '<tr>';
                            tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pool.wiz + '">';
                            tmp += gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pool.label;
                            tmp += '</th>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.del.wiz + '">';
                            tmp += '</th>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.add.wiz + '">';
                            tmp += '</th>';
                            tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pick.wiz + '">';
                            tmp += gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pick.label;
                            tmp += '</th>';
                            tmp += '</tr>';
            
                            tmp += '<tr>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pool.wiz + '">';
                            tmp += '<select id="pool" multiple size="10"></select>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.del.wiz + '">';
                            tmp += '<button class="Move2Del" id="Move2Del-users"><span class="ui-icon"></span></button>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.add.wiz + '">';
                            tmp += '<button class="Move2Add" id="Move2Add-users"><span class="ui-icon"></span></button>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pick.wiz + '">';
                            tmp += '<select id="pick" multiple size="10"></select>';
                            tmp += '</td>';
                            tmp += '</tr>';
            
                            tmp += '</table>';
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        }
                        break;
                    }
                    $('#table-' + gNode.editor[ tar.pid ][ i ].tab).append( tmp );
                }
            }
    
            genMultiSelector( tar.pid );
    
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxUserPerGroup ) {
                    errorAlert( '<p>member limit exceed</p>' );
                    return false;
                } else {
                    vSel.clone().appendTo('#pick');
                    vSel.remove();
                }
            });
    
            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });

            if (type) {
                tar.thisNo = tar.id.split(gReg.isDash)[2];
                $('#group_settings-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
    
                if ( gCache.defaultGid == parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid ) ) {
                    $('#group_settings-name').prop( 'disabled', true );
                }
    
                $('#group_settings-webLoginPriv').append( genSelectOption( 'group_settings-webLoginPriv') ).val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].webLoginPriv );
    
                cgiSelectOption('membership-groupId', gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].groupId);
    
                for (var i=0, len=gData.user.userListT.length; i<len; i++)
                {
                    if (parseInt( gData.user.userListT[ i ].groupId ) == parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid )) {
                        $('#pick').append('<option value="' + gData.user.userListT[ i ].gid + '">' + gData.user.userListT[ i ].name + '</option>');
                    } else {
                        $('#pool').append('<option value="' + gData.user.userListT[ i ].gid + '">' + gData.user.userListT[ i ].name + '</option>');
                    }
                }
            } else {
                $('#group_settings-webLoginPriv').append( genSelectOption( 'group_settings-webLoginPriv') ).val(1);;
                
                for (var i=0, len=gData.user.userListT.length; i<len; i++)
                    $('#pool').append('<option value="' + gData.user.userListT[ i ].gid + '">' + gData.user.userListT[ i ].name + '</option>');
            }
            break;
        }
    
        usersEditor(e, tar.w, tar.h);
    }
    
    function editUsers(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
    
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        tar.thisNo = tar.id.split(gReg.isDash)[2];
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        tar.w = 640;
        tar.h = 480;
    
        switch(tar.pid)
        {
        case 'user':
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ tar.pid ][ i ].tab + '"><a href="#panel-' + gNode.editor[ tar.pid ][ i ].tab + '">' + gNode.editor[ tar.pid ][ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ tar.pid ][ i ].tab + '"></div>');
                $('#panel-' + gNode.editor[ tar.pid ][ i ].tab).append('<table id="table-' + gNode.editor[ tar.pid ][ i ].tab + '"></table>');
                for (var j=0, jlen=gNode.editor[ tar.pid ][ i ].col.length; j<jlen; j++)
                {
                    switch (gNode.editor[ tar.pid ][ i ].col[ j ].tag)
                    {
                    case 'input':
                        switch(gNode.editor[ tar.pid ][ i ].col[ j ].type)
                        {
                        case 'text':
                        case 'password':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ tar.pid ][ i ].col[ j ].wiz)? gNode.editor[ tar.pid ][ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ tar.pid ][ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<input type="' + gNode.editor[ tar.pid ][ i ].col[ j ].type + '" id="' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].col[ j ].tab + '" />';
                            if (gNode.editor[ tar.pid ][ i ].col[ j ].note)
                                tmp += '&nbsp;' + gNode.editor[ tar.pid ][ i ].col[ j ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        }
                        break;
                    case 'select':
                        switch(gNode.editor[ tar.pid ][ i ].col[ j ].type)
                        {
                        case 'select':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ tar.pid ][ i ].col[ j ].wiz)? gNode.editor[ tar.pid ][ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ tar.pid ][ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<select id="' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].col[ j ].tab + '">';
                            if ( gNode.editor[ tar.pid ][ i ].col[ j ].option ) {
                                for (var x in gNode.editor[ tar.pid ][ i ].col[ j ].option)
                                    tmp += '<option value="' + x + '">' + gNode.editor[ tar.pid ][ i ].col[ j ].option[ x ] + '</option>';
                            }
                            tmp += '</select>';
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        }
                        break;
                    }
                    $('#table-' + gNode.editor[ tar.pid ][ i ].tab).append( tmp );
                }
            }
            cgiSelectOption('membership-groupId', gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].groupId);
            $('#account-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
            break;
        case 'group':
            $('#popForm').append('<div class="formDiv"><div class="tabs"><ul></ul></div></div>');
            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++) 
            {
                $('.tabs ul').append('<li id="tab-' + gNode.editor[ tar.pid ][ i ].tab + '"><a href="#panel-' + gNode.editor[ tar.pid ][ i ].tab + '">' + gNode.editor[ tar.pid ][ i ].label + '</a></li>');
                $('.tabs').append('<div id="panel-' + gNode.editor[ tar.pid ][ i ].tab + '"></div>');
                $('#panel-' + gNode.editor[ tar.pid ][ i ].tab).append('<table id="table-' + gNode.editor[ tar.pid ][ i ].tab + '"></table>');
                for (var j=0, jlen=gNode.editor[ tar.pid ][ i ].col.length; j<jlen; j++)
                {
                    switch (gNode.editor[ tar.pid ][ i ].col[ j ].tag)
                    {
                    case 'input':
                        tmp = '<tr>';
                        tmp += '<th class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ tar.pid ][ i ].col[ j ].wiz)? gNode.editor[ tar.pid ][ i ].col[ j ].wiz : 'auto' ) + '" >';
                        tmp += gNode.editor[ tar.pid ][ i ].col[ j ].label;
                        tmp += '</th>';
                        tmp += '<td class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 1 ] : "Left") + '">';
                        tmp += '<input type="' + gNode.editor[ tar.pid ][ i ].col[ j ].type + '" id="' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].col[ j ].tab + '" />';
                        if (gNode.editor[ tar.pid ][ i ].col[ j ].note)
                            tmp += '&nbsp;' + gNode.editor[ tar.pid ][ i ].col[ j ].note;
                        tmp += '</td>';
                        tmp += '</tr>';
                        break;
                    case 'select':
                        switch (gNode.editor[ tar.pid ][ i ].col[ j ].type)
                        {
                        case 'select':
                            tmp = '<tr>';
                            tmp += '<th class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 0 ] : "Left") + '" style="width: ' + ((gNode.editor[ tar.pid ][ i ].col[ j ].wiz)? gNode.editor[ tar.pid ][ i ].col[ j ].wiz : 'auto' ) + '" >';
                            tmp += gNode.editor[ tar.pid ][ i ].col[ j ].label;
                            tmp += '</th>';
                            tmp += '<td class="align' + ((gNode.editor[ tar.pid ][ i ].col[ j ].align)? gNode.editor[ tar.pid ][ i ].col[ j ].align[ 1 ] : "Left") + '">';
                            tmp += '<select id="' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].col[ j ].tab + '">';
                            if ( gNode.editor[ tar.pid ][ i ].col[ j ].option ) {
                                for (var x in gNode.editor[ tar.pid ][ i ].col[ j ].option)
                                    tmp += '<option value="' + x + '">' + gNode.editor[ tar.pid ][ i ].col[ j ].option[ x ] + '</option>';
                            }
                            tmp += '</select>';
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        case 'multiple':
                            tmp = '<tr>';
                            tmp += '<td colspan="2">';
                            tmp += '<table id="' + gNode.editor[ tar.pid ][ i ].col[ j ].tab + '">';
            
                            tmp += '<tr>';
                            tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pool.wiz + '">';
                            tmp += gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pool.label;
                            tmp += '</th>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.del.wiz + '">';
                            tmp += '</th>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.add.wiz + '">';
                            tmp += '</th>';
                            tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pick.wiz + '">';
                            tmp += gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pick.label;
                            tmp += '</th>';
                            tmp += '</tr>';
            
                            tmp += '<tr>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pool.wiz + '">';
                            tmp += '<select id="pool" multiple size="10"></select>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.del.wiz + '">';
                            tmp += '<button class="Move2Del" id="Move2Del-users"><span class="ui-icon"></span></button>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.add.wiz + '">';
                            tmp += '<button class="Move2Add" id="Move2Add-users"><span class="ui-icon"></span></button>';
                            tmp += '</td>';
                            tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].col[ j ].multiple.pick.wiz + '">';
                            tmp += '<select id="pick" multiple size="10"></select>';
                            tmp += '</td>';
                            tmp += '</tr>';
            
                            tmp += '</table>';
                            tmp += '</td>';
                            tmp += '</tr>';
                            break;
                        }
                        break;
                    }
                    $('#table-' + gNode.editor[ tar.pid ][ i ].tab).append( tmp );
                }
            }
    
            genMultiSelector( tar.pid );
    
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxUserPerGroup ) {
                    errorAlert( '<p>member limit exceed</p>' );
                    return false;
                } else {
                    vSel.clone().appendTo('#pick');
                    vSel.remove();
                }
            });
    
            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
    
            $('#group_settings-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
    
            if ( gCache.defaultGid == parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid ) ) {
                $('#group_settings-name').prop( 'disabled', true );
            }
    
            $('#group_settings-webLoginPriv').append( genSelectOption( 'group_settings-webLoginPriv') ).val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].webLoginPriv );
    
            cgiSelectOption('membership-groupId', gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].groupId);
                
            for (var i=0, len=gData.user.userListT.length; i<len; i++) 
            {
                if (parseInt( gData.user.userListT[ i ].groupId ) == parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid )) {
                    $('#pick').append('<option value="' + gData.user.userListT[ i ].gid + '">' + gData.user.userListT[ i ].name + '</option>');
                } else {
                    $('#pool').append('<option value="' + gData.user.userListT[ i ].gid + '">' + gData.user.userListT[ i ].name + '</option>');
                }
            }
            break;
        }
    
        usersEditor(e, tar.w, tar.h);
    }
    
    function usersEditor(e, w, h) {
        var tar = {};
    
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[1];
    
        if (gObj.active.h5Index == 'NA') {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ((gNode.tabs)? ' > ' + gNode.tabs[ tar.pid ] : '');
        }else {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].label + ((gNode.tabs)? ' > ' + gNode.tabs[ tar.pid ] : '');
        }
    
        $('#popForm').dialog({
            width: w || 800,
            height: h || 600,
            position: "center",
            resizable: false,
            modal: true,
            title: tar.title + ' > ' + gTerm[ gObj.lang ][  tar.type ],
            buttons: {
                OK: function() {
                    if (usersChecker(e)) {
                        gIf.alter = true;
                        switch( tar.pid )
                        {
                        case 'user':
                            switch (tar.type) 
                            {
                            case 'Create':
                            case 'Duplicate':
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].push({"gid":0,"name":$('#account-name').val(),"password": $('#account-password').val(),"groupId":$('#membership-groupId').val(), "cgiSetPwd":1,"cgiAction":1});
                                break;
                            case 'Edit':
                                tar.thisNo  = tar.id.split(gReg.isDash)[2];
                                delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name ];
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name = $('#account-name').val();
                                if (gIf.valid) {
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].password = $('#account-password').val();
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiSetPwd = 1;
                                }else {
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiSetPwd = 0;
                                }
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].groupId = $('#membership-groupId').val();
    
                                if (parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid ) > 0)
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiAction = 2;
                                break;
                            }
                            gCache.uniq[ tar.pid ][ $('#account-name').val() ] = true;
    
                            tar.tabDisabled = 0;
                            break;
                        case 'group':
                            var pick = [];
                            $('#pick option').each(function() {
                                pick.push(parseInt($(this).val()));
                            });
                            switch (tar.type) 
                            {
                            case 'Create':
                            case 'Duplicate':
                                // check if other group's member altered
                                gCache.groupId--;
                                for (var i=0, len=gData.user.userListT.length; i<len; i++)
                                {
                                    if (pick.indexOf( parseInt( gData.user.userListT[ i ].gid ) ) != -1)
                                        gData.user.userListT[ i ].groupId = gCache.groupId;
                                }
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].push({"gid": gCache.groupId, "name":$('#group_settings-name').val(), "webLoginPriv": $('#group_settings-webLoginPriv').val(), "portalPriv": 1, "cgiSetListId":"", "cgiAction":1});
                                break;
                            case 'Edit': 
                                tar.thisNo  = tar.id.split(gReg.isDash)[2];
                                delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name ];
                                
                                for (var i=0, len=gData.user.userListT.length; i<len; i++)
                                {
                                    if (pick.indexOf( parseInt( gData.user.userListT[ i ].gid ) ) != -1) {
                                        gData.user.userListT[ i ].groupId = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid;
                                    } else if ( gData.user.userListT[ i ].groupId == gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid ) {
                                        gData.user.userListT[ i ].groupId = gCache.defaultGid;
                                        // set default gid row to update
                                        gData.group.groupListT[ 0 ].cgiAction = 2;
                                    }
                                }
    
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name = $('#group_settings-name').val();
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].webLoginPriv = $('#group_settings-webLoginPriv').val();
                                // gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].portalPriv = $('#group_settings-portalPriv').val();
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiSetListId = "";
    
                                if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiAction != 1)
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiAction = 2;
                                break;
                            }
    
                            gCache.uniq[ tar.pid ][ $('#group_settings-name').val() ] = true;;

                            gCache[ tar.pid ][ gCache.groupId ] = [];
                            tar.tabDisabled = 1;
                            break;
                        }
                        gObj.tabber.tabs({"disabled": [ tar.tabDisabled ]});
                        refreshUsers( tar.pid );
                        $( this ).dialog( "close" );
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });
        gObj.tab = $('.tabs').tabs();

        $('#account-name').focus();
        $('#group_settings-name').focus();
    }
    
    function usersChecker(e, pid) {
    
        var tar = {};
    
        if (pid) {
            tar.pid = pid;
            tar.type = 'Save';
        }else {
    
            tar.id = $(e.currentTarget).attr('id');
            if (!tar.id)
                return false;
            tar.type  = tar.id.split(gReg.isDash)[0];
    
            tar.pid  = tar.id.split(gReg.isDash)[1];
    
            if (tar.type == 'Create')
                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
            else
                tar.thisNo = tar.id.split(gReg.isDash)[2];
        }
    
        var pass = true;
        var msg = '';
        switch(tar.pid)
        {
        case 'user':
            switch( tar.type )
            {
            case 'Create':
            case 'Duplicate':
                if ( gCache.uniq[ tar.pid ][ $('#account-name').val() ] || !gReg.ascii.user.test( $('#account-name').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName31 + '</p>';
                }
    
                if (!gReg.ascii.user.test( $('#account-password').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].password31 + '</p>';
                }
    
                if ($('#account-password').val() != $('#account-confirmNewPassword').val()) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].passwordMatch + '</p>';
                }
                break;
            case 'Edit':
                if ( ( $('#account-name').val() != gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name && gCache.uniq[ tar.pid ][ $('#account-name').val() ] ) || !gReg.ascii.user.test( $('#account-name').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName31 + '</p>';
                }
    
                gIf.valid = false;
                if ($('#account-password').val().length > 0 || $('#account-confirmNewPassword').val().length > 0) {
    
                    if (!gReg.ascii.user.test( $('#account-password').val() ) ) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].password31 + '</p>';
                    }
        
                    if ($('#account-password').val() != $('#account-confirmNewPassword').val()) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].passwordMatch + '</p>';
                    }
    
                    if (pass)
                        gIf.valid = true;
                }
                break;
            }
            break;
        case 'group':
            switch( tar.type )
            {
            case 'Create':
            case 'Duplicate':
                if ( gCache.uniq[ tar.pid ][ $('#group_settings-name').val() ] || !gReg.ascii.user.test( $('#group_settings-name').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName31 + '</p>';
                }
                break;
            case 'Edit':
                if ( ( $('#group_settings-name').val() != gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name && gCache.uniq[ tar.pid ][ $('#group_settings-name').val() ] ) || !gReg.ascii.user.test( $('#group_settings-name').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName31 + '</p>';
                }
    
                break;
            }
            break;
        }
    
        if (!pass) {
            errorAlert( msg );
        }
        return pass;
    }
    
    function deleteUsers(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        tar.thisTr = $(e.currentTarget).parents('tr:eq(0)');
        tar.thisNo = tar.thisTr.find('td:eq(0) input:checkbox').val();
        gIf.alter = true;
    
        switch( tar.pid )
        {
        case 'user':
            tar.tabDisabled = 0;
            break;
        case 'group':
            for (var i=0, len=gData.user.userListT.length; i<len; i++)
            {
                if (gData.user.userListT[ i ].groupId == gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid) {
                    gData.user.userListT[ i ].groupId = gCache.defaultGid;
                    // set default gid row to update
                    gData.group.groupListT[ 0 ].cgiAction = 2;
                }
            }
            tar.tabDisabled = 1;
            break;
        }
        delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name ];
        if ( parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid ) > 0) 
            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiAction = 3;
        else 
            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].splice(tar.thisNo,1);
        gObj.tabber.tabs({"disabled": [tar.tabDisabled]});
        refreshUsers(tar.pid);
    }
    
    function removeUsers(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        $('#table-bodyer-' + tar.pid + ' tr').each(function() {
            tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
            switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
            {
            case true:
                gIf.alter = true;
                switch( tar.pid )
                {
                case 'user':
                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiSetPwd = 0;
                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].password = "";
    
                    tar.tabDisabled = 0;
                    break;
                case 'group':
                    for (var i=0, len=gData.user.userListT.length; i<len; i++)
                    {
                        if (gData.user.userListT[ i ].groupId == gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid) {
                            gData.user.userListT[ i ].groupId = gCache.defaultGid;
                            // set default gid row to update
                            gData.group.groupListT[ 0 ].cgiAction = 2;
                        }
                    }
                    
                    tar.tabDisabled = 1;
                    break;
                }

                if ( parseInt( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid) > 0)
                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiAction = 3;
                else 
                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].cgiAction = -1;
   
                delete gCache.uniq[ tar.pid ][ gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name ];
                break;
            }
        });
    
        gCache.tmp = [];
    
        if (gIf.alter) {
            for (var i=0, len=gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length; i<len; i++)
            {
                if (gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ].cgiAction != -1)
                    gCache.tmp.push( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ] );
            }
    
            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ] = gCache.tmp;
    
            gObj.tabber.tabs({"disabled": [tar.tabDisabled]});
            refreshUsers(tar.pid);
        }
    }
    
    function saveUsers(pid) {
        switch(pid) 
        {
        case 'user':
            for (var i=0, len=gData.user.userListT.length; i<len; i++) 
            {
                if (gData.user.userListT[ i ].gid < 0)
                    gData.user.userListT[ i ].gid = 0;
            }
            cgiID = 'userList';
            gObj.tabIndexed = 1;
            break;
        case 'group':
            cgiID = 'groupList';
            for (var i=0, len=gData.user.userListT.length; i<len; i++) 
                gCache.group[ gData.user.userListT[ i ].groupId ].push( gData.user.userListT[ i ].gid );
    
            for (var i=0, len=gData.group.groupListT.length; i<len; i++)
            {
                if (gCache.group[ gData.group.groupListT[ i ].gid ].length > 0)
                    gData.group.groupListT[ i ].cgiSetListId = gCache.group[ gData.group.groupListT[ i ].gid ].join(';');
                if (gData.group.groupListT[ i ].gid < 0)
                    gData.group.groupListT[ i ].gid = 0;
            }
            gObj.tabIndexed = 0;
            break;
        }
    
        loadingToggle( true );
        $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData[ pid ])).done( function( poster ) {
            if (poster.duration) {
                gObj.loading = poster.duration;
                gIf.loading = true;
            } else {
                loadingToggle( false );
                getCgiList(gObj.active.pid);
            }
        });
    
        gObj.tabber.tabs("enable", 0);
        gObj.tabber.tabs("enable", 1);
        gIf.alter = false;
    }

    function genObject2(pid) {
        gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"></div>');
        switch( pid ) 
        {
        case 'addressObj':
            gY.one('.templateDiv').set('innerHTML', '<div class="tabber"><ul></ul></div>');

            for (var x in gNode.tabs)
            {
                gY.one('.tabber ul').append('<li id="tab-' + x + '"><a href="#panel-' + x + '">' + gNode.tabs[ x ] + '</a></li>');
                gY.one('.tabber').append('<div id="panel-' + x + '"><div id="div-' + x + '"><div class="div-hd" style="position: relative"></div><div class="div-bd" style="position: relative"></div><div id="div-ft" style="position: relative"></div></div></div>');
            }

            var addrGet = {
                timeout: 3000,
                on: {
                    success: function(x,o) {
                        gData[ 'address' ] = gY.JSON.parse(o.responseText);
                        gY.io('cgi-bin/common_gAddr_list.cgi', gAddrGet);
                    },
                    failure: function(x,o) {
                        errorAlert( '<p>' + gError[ gObj.lang ].fail2Get + '</p> ');
                    }
                }
            };

            var gAddrGet = {
                timeout: 3000,
                on: {
                    success: function(x,o) {
                        gData[ 'group_address' ] = gY.JSON.parse(o.responseText);
                        genInnerObject2( 'group_address' );
                        genInnerObject2( 'address' );
                    },
                    failure: function(x,o) {
                        errorAlert( '<p>' + gError[ gObj.lang ].fail2Get + '</p> ');
                    }
                }
            };

            gY.io('cgi-bin/common_addr_list.cgi', addrGet);

            if (gIf.power) {
                $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                gY.one('#pgSave').on('click', function(e) {
                    gObj.tabIndex = gObj.tabber.tabs('option', 'selected');
                    if (gObj.tabber.tabs('option', 'selected') == 0)
                        saveObject('group_address');
                    else
                        saveObject('address');
                });
            }
            gObj.tabber = $('.tabber').tabs();
            break;
        case 'serviceObj':
            gY.one('.templateDiv').set('innerHTML', '<div class="tabber"><ul></ul></div>');
            
            if (gIf.power) {
                $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                gY.one('#pgSave').on('click', function(e) {
                    gObj.tabIndex = gObj.tabber.tabs('option', 'selected');
                    if (gObj.tabber.tabs('option', 'selected') == 0)
                        saveObject('group_address');
                    else
                        saveObject('address');
                });
            }
            gObj.tabber = $('.tabber').tabs();
            break;
        case 'scheduleObj':
            gY.one('.templateDiv').set('innerHTML', '<div id="div-' + x + '"></div>');
            if (gIf.power) {
                $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                gY.one('#pgSave').on('click', function(e) {
                    saveObject('schedule');
                });
            }
            
            break;
        }
    }

    function genInnerObject2( pid ) {
        var i, j, len, jlen, tmp;
        switch( pid )
        {
        case 'address':
            tmp = '<ul>';
            for (i=0, len=gNode.col[ pid ].length; i<len; i++)
            {
                tmp += '<li class="rell"><span class="abss" style="width: ' + gNode.col[ pid ][ i ].wiz + ';">' + gNode.col[ pid ][ i ].label + '</span></li>';
            }
            tmp += '</ul>';
            gY.one('#div-' + pid + ' .div-hd').set('innerHTML', tmp);
            break;
        case 'group_address':
            tmp = '<ul>';
            for (i=0, len=gNode.col[ pid ].length; i<len; i++)
            {
                tmp += '<li class="rell"><span class="abss" style="width: ' + gNode.col[ pid ][ i ].wiz + ';">' + gNode.col[ pid ][ i ].label + '</span></li>';
            }
            tmp += '</ul>';
            gY.one('#div-' + pid + ' .div-hd').set('innerHTML', tmp);
            break;
        case 'service':
            break;
        case 'group_service':
            break;
        case 'schedule':
            break;
        }
    }

    function refreshObject2(pid) {
        switch(pid)
        {
        case 'address':
            
            break;
        case 'group_address':
            
            break;
        case 'service':
            
            break;
        case 'group_service':
            
            break;
        case 'schedule':
            
            break;
        }
    }
    
    function genObject(pid) {
        var tmp = '';
    
        switch(gNode.ext)
        {
        case 'cgi':
            switch(gNode.tag)
            {
            case 'div':
                switch(gNode.type)
                {
                case 'tabs':
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div class="tabber"><ul></ul></div></div>');

                    switch(pid)
                    {
                    case 'address':
                    case 'group_address':
                    case 'addressObj':
                        if (pid == 'address')
                            gObj.tabIndex = 1;
                        else
                            gObj.tabIndex = 0;
                        pid = 'addressObj';

                        gCache.address_gid = 0;
                        gCache.group_address_gid = 0;


                        if (gIf.power) {
                            $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                            gY.one('#pgSave').on('click', function(e) {
                                gObj.tabIndex = gObj.tabber.tabs('option', 'selected');
                                if (gObj.tabber.tabs('option', 'selected') == 0)
                                    saveObject('group_address');
                                else
                                    saveObject('address');
                            });
                        }
                        // for gid might be 0 if never saved, cache uniq name instead 
                        break;
                    case 'service':
                    case 'group_service':
                    case 'serviceObj':
                        if (pid == 'service')
                            gObj.tabIndex = 1;
                        else
                            gObj.tabIndex = 0;
                        pid = 'serviceObj';
    
                        gCache.service_gid = 0;
                        gCache.group_service_gid = 0;


                        if (gIf.power) {
                            $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                            gY.one('#pgSave').on('click', function(e) {
                                gObj.tabIndex = gObj.tabber.tabs('option', 'selected');
                                if (gObj.tabber.tabs('option', 'selected') == 0)
                                    saveObject('group_service');
                                else
                                    saveObject('service');
                            });
                        }
                        // for gid might be 0 if never saved, cache uniq name instead 
                        break;
                    }
    
                    for (var x in gNode.tabs)
                    {
                        gY.one('.tabber ul').append('<li id="tab-' + x + '"><a href="#panel-' + x + '">' + gNode.tabs[ x ] + '</a></li>');
                        gY.one('.tabber').append('<div id="panel-' + x + '"></div>');
                        
                        tmp = '<div id="div-' + x + '" class="tableDiv">';
    
                        tmp += '<table id="table-' + x + '"';
                        if (gNode.tblAction[ x ])
                            tmp += 'class="' + gNode.tblAction[ x ] + '"';
                        tmp += '>';
                        tmp += '<thead>';
                        for (var i=0; i<gNode.col[ x ].length; i++)
                        {
                            tmp += '<th id="' + x + '-' + gNode.col[ x ][ i ].tab + '"';
                            tmp += 'class="ui-state-default"';
                            if (gNode.col[ x ][ i ].tab == 'action') {
                                gObj.btn = gNode.rowAction.split(' ');
                            }
                            tmp += ' style="width: ' + ((gNode.col[ x ][ i ].wiz)? gNode.col[ x ][ i ].wiz : 'auto' ) + '"';
                            tmp += '>';
                            tmp += gNode.col[ x ][ i ].label;
                            tmp += '</th>';
                        }
                        tmp += '</thead>';
                        tmp += '<tbody></tbody>';
                        tmp += '</div>';
                        gY.one('#panel-' + x).set('innerHTML', tmp);

                        if (gIf.power) {
                            genTblAction( x );
                            if (gData[ x ][ gNode.guiTNum[ x ] ] >= gLimit[ gNode.url.get[ x ] ].rows)
                                $('#Create-' + x).prop('disabled', true);
                        }

                        for (var i=0; i<gData[ x ][ gNode.guiTNum[ x ] ]; i++)
                        {
                            tmp = '<tr class="' + ((i%2 == 0)? 'even' : 'odd') + '">';
                            tmp += '<td>';
                            if (0 != parseInt(gData[ x ][ gNode.guiT[ x ] ][ i ].userDefined) && gIf.power) {
                                tmp += '<input type="checkbox" value="' + i + '" />';
                            } else {
                                tmp += '';
                            }
                            tmp += '</td>';
                            tmp += '<td>' + (i+1) + '</td>';
                            switch( x )
                            {
                            case 'address':
                                tmp += '<td class="alignLeft">' + gData[ x ][ gNode.guiT[ x ] ][ i ].name + '</td>';
                                tmp += '<td class="alignLeft">';
                                tmp += gRef.address.type[ gData[ x ][ gNode.guiT[ x ] ][ i ].type ] + ': ';
                                switch( parseInt( gData[ x ][ gNode.guiT[ x ] ][ i ].type ) )
                                {
                                case 1:
                                    tmp += gData[ x ][ gNode.guiT[ x ] ][ i ].startIp;
                                    break;
                                case 2:
                                    tmp += gData[ x ][ gNode.guiT[ x ] ][ i ].startIp + '/' + gData[ x ][ gNode.guiT[ x ] ][ i ].netmask;
                                    break;
                                case 3:
                                    tmp += gData[ x ][ gNode.guiT[ x ] ][ i ].startIp + '-' + gData[ x ][ gNode.guiT[ x ] ][ i ].endIp;
                                    break;
                                case 4:
                                    tmp += gData[ x ][ gNode.guiT[ x ] ][ i ].mac;
                                    break;
                                }
                                tmp += '</td>';
                                tmp += '<td class="alignLeft">' + gRef.address.type[ gData[ x ][ gNode.guiT[ x ] ][ i ].type ] + '</td>';
                                tmp += '<td>';
                                if (gIf.power) {
                                    tmp += '<button id="Edit-address-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                                    //tmp += '<button id="Duplicate-address-' + i + '" class="Duplicate" title="Duplicate"><span class="ui-icon"></span></button>';
                                    if (0 != parseInt(gData[ x ][ gNode.guiT[ x ] ][ i ].userDefined)) {
                                        tmp += '<button id="Delete-address-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                                    }
                                } else {
                                    tmp += '';
                                }
                                tmp += '</td>';
                                break;
                            case 'group_address':
                                tmp += '<td class="alignLeft" colspan="3" id="' + x + '-name-' + i + '">';
                                tmp += '<div class="tooltipAccordion">';
                                tmp += '<h4><a href="#">' + gData[ x ][ gNode.guiT[ x ] ][ i ].name + '</h4>';
                                tmp += '<div id="div-' + x + '-name-' + i + '">';
                                tmp += tooltipTable( x, x + '-name-' + i, gData[ x ][ gNode.guiT[ x ] ][ i ].idList);
                                tmp += '</div>';
                                tmp += '</div>';
                                tmp += '</td>';
                                tmp += '<td>';
                                if (gIf.power) {
                                    tmp += '<button id="Edit-group_address-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                                    //tmp += '<button id="Duplicate-group_address-' + i + '" class="Duplicate" title="Duplicate"><span class="ui-icon"></span></button>';
                                    if (0 != parseInt(gData[ x ][ gNode.guiT[ x ] ][ i ].userDefined)) {
                                        tmp += '<button id="Delete-group_address-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                                    } 
                                } else {
                                    tmp += '';
                                }
                                tmp += '</td>';
                                break;
                            case 'service':
                                tmp += '<td class="alignLeft">' + gData[ x ][ gNode.guiT[ x ] ][ i ].name + '</td>';
                                tmp += '<td class="alignLeft">' + gRef[ x ].type[ gData[ x ][ gNode.guiT[ x ] ][ i ].type ]+ '</td>';
                                tmp += '<td>' + gData[ x ][ gNode.guiT[ x ] ][ i ].param1 + '</td>';
                                if ( parseInt( gData[ x ][ gNode.guiT[ x ] ][ i ].type ) < 3  ) 
                                    tmp += '<td>' + gData[ x ][ gNode.guiT[ x ] ][ i ].param2 + '</td>';
                                else 
                                    tmp += '<td>N/A</td>';
                                tmp += '<td>';
                                if (gIf.power) {
                                    tmp += '<button id="Edit-service-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                                    //tmp += '<button id="Duplicate-service-' + i + '" class="Duplicate" title="Duplicate"><span class="ui-icon"></span></button>';
                                    if (0 != parseInt(gData[ x ][ gNode.guiT[ x ] ][ i ].userDefined)) {
                                        tmp += '<button id="Delete-service-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                                    }
                                } else {
                                    tmp += '';
                                }
                                tmp += '</td>';
                                break;
                            case 'group_service':
                                tmp += '<td class="alignLeft" colspan="4" id="' + x + '-name-' + i + '">';
                                tmp +=   '<div class="tooltipAccordion">';
                                tmp +=     '<h4><a href="#">' + gData[ x ][ gNode.guiT[ x ] ][ i ].name + '</h4>';
                                tmp +=     '<div id="div-' + x + '-name-' + i + '">';
                                tmp +=       tooltipTable( x, x + '-name-' + i, gData[ x ][ gNode.guiT[ x ] ][ i ].idList);
                                tmp +=     '</div>';
                                tmp +=   '</div>';
                                tmp += '</td>';
                                tmp += '<td>';
                                if (gIf.power) {
                                    tmp += '<button id="Edit-group_service-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                                    //tmp += '<button id="Duplicate-group_service-' + i + '" class="Duplicate" title="Duplicate"><span class="ui-icon"></span></button>';
                                    if (0 != parseInt(gData[ x ][ gNode.guiT[ x ] ][ i ].userDefined)) {
                                        tmp += '<button id="Delete-group_service-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                                    }
                                } else {
                                    tmp += '';
                                }
                                tmp += '</td>';
                                break;
                            }
                            tmp += '</tr>';
                            $('#table-' + x + ' > tbody').append( tmp );
                        }
                    }
    
                    $('.tooltipAccordion').accordion({
                        collapsible:true,
                        active:false,
                        autoHeight: false
                    });
    
                    gObj.tabber = $('.tabber').tabs();
                    break;
                }
                break;
            case 'table':
                gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div id="div-schedule"></div></div>');
                if (gIf.power) {
                    $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                    gY.one('#pgSave').on('click', function(e) {
                        saveObject('schedule');
                    });
                }
    
                gCache.schedule_gid = 0;

                tmp = '<table id="table-schedule">';
                tmp += '<thead>';
                for (var i=0, len=gNode.col.length; i<len; i++)
                {
                    if (gNode.col[ i ].tab == 'action') 
                        gObj.btn = gNode.rowAction.split(' ');
                    tmp += '<th id="' + pid + '-' + gNode.col[ i ].tab + '" class="ui-state-default"  style="width: ' + gNode.col[ i ].wiz + '">';
                    tmp += gNode.col[ i ].label;
                    tmp += '</th>';
                }
                tmp += '</thead>';
                tmp += '<tbody></tbody>';
                tmp += '</table>';
                gY.one('#div-schedule').set('innerHTML', tmp);
    
                $.ajax({
                    url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                    dataType: 'json',
                    success: function(data) {
                        gData.schedule = data;
    
                        for (var i=0; i<gData.schedule[ gNode.guiTNum ]; i++)
                        {
                            tmp = '<tr class="' + ((i%2 == 0)? 'even' : 'odd') + '">';
                            tmp += '<td>';
                            if (gIf.power) {
                                tmp += '<input type="checkbox" value="' + i + '" />';
                            } else {
                                tmp += '';
                            }
                            tmp += '</td>';
                            tmp += '<td>' + (i+1) + '</td>';
                            tmp += '<td class="alignLeft">';
                            tmp += gData.schedule[ gNode.guiT ][ i ].name;
                            tmp += '</td>';
                            tmp += '<td>';
                            if (parseInt( gData.schedule[ gNode.guiT ][ i ].day ) > 0) {
                                var day = gData.schedule[ gNode.guiT ][ i ].day;
                                for (var j=0; j<7; j++)
                                {
                                    if ( day & 1 ) {
                                        tmp += gRef[ pid ].day[ Math.pow(2,j) ] + ';';
                                    }
                                    day = day >> 1;
                                }
                            }else {
                                tmp += gRef[ pid ].day[ "0" ];
                            }
                            tmp += '</td>';
                            tmp += '<td>';
                            tmp += gData.schedule[ gNode.guiT ][ i ].startHour + ':' + gData.schedule[ gNode.guiT ][ i ].startMin;
                            tmp += '</td>';
                            tmp += '<td>';
                            tmp += gData.schedule[ gNode.guiT ][ i ].endHour + ':' + gData.schedule[ gNode.guiT ][ i ].endMin;
                            tmp += '</td>';
                            tmp += '<td>';
                            if (gIf.power) {
                                tmp += '<button id="Edit-schedule-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                                //tmp += '<button id="Duplicate-schedule-' + i + '" class="Duplicate" title="Duplicate"><span class="ui-icon"></span></button>';
                                tmp += '<button id="Delete-schedule-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                            } else {
                                tmp += '';
                            }
                            tmp += '</td>';
                            tmp += '</tr>';
                            $('#table-schedule tbody').append( tmp );
                        }
                        
                        if (gIf.power) {
                            genTblAction( 'schedule' );
                            if (data[ gNode.guiTNum ] >= gLimit[ gNode.url.get ].rows)
                                $('#Create-' + gNode.tab).prop('disabled', true);
                        }
                    }
                });
                break;
            }
        }
    }
        
    function refreshObject( pid ) {
    
        $('#table-' + pid + ' tbody').empty();
        var cnt = 0;
        var tmp = '';

        switch( pid )
        {
        case 'address':
            for (var i=0; i<gData[ pid ][ gNode.guiTNum[ pid ] ]; i++)
            {
                if ( gData[ pid ][ gNode.guiT[ pid ] ][ i ].name == '' ) 
                    continue;
                cnt++;
                tmp = '<tr class="' + ((cnt%2 == 0)? 'odd' : 'even') + '">';
                tmp += '<td>';
                if (0 != parseInt(gData[ pid ][ gNode.guiT[ pid ] ][ i ].userDefined)) {
                    tmp += '<input type="checkbox" value="' + i + '" />';
                }
                tmp += '</td>';
                tmp += '<td>' + cnt + '</td>';
                tmp += '<td class="alignLeft">' + gData[ pid ][ gNode.guiT[ pid ] ][ i ].name + '</td>';
                tmp += '<td class="alignLeft">';
                tmp += gRef.address.type[ gData[ pid ][ gNode.guiT[ pid ] ][ i ].type ] + ': ';
                switch( parseInt( gData[ pid ][ gNode.guiT[ pid ] ][ i ].type ) )
                {
                case 1:
                    tmp += gData[ pid ][ gNode.guiT[ pid ] ][ i ].startIp;
                    break;
                case 2:
                    tmp += gData[ pid ][ gNode.guiT[ pid ] ][ i ].startIp + '/' + gData[ pid ][ gNode.guiT[ pid ] ][ i ].netmask;
                    break;
                case 3:
                    tmp += gData[ pid ][ gNode.guiT[ pid ] ][ i ].startIp + '-' + gData[ pid ][ gNode.guiT[ pid ] ][ i ].endIp;
                    break;
                case 4:
                    tmp += gData[ pid ][ gNode.guiT[ pid ] ][ i ].mac;
                    break;
                }
                tmp += '<td class="alignLeft">' + gRef.address.type[ gData[ pid ][ gNode.guiT[ pid ] ][ i ].type ] + '</td>';
                tmp += '<td>';
                tmp += '<button id="Edit-address-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                //tmp += '<button id="Duplicate-address-' + i + '" class="Duplicate" title="Duplicate"><span class="ui-icon"></span></button>';
                if (0 != parseInt(gData[ pid ][ gNode.guiT[ pid ] ][ i ].userDefined)) {
                    tmp += '<button id="Delete-address-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                }
                tmp += '</td>';
                tmp += '</tr>';
                $('#table-' + pid + ' > tbody').append( tmp );
            }

            if (gData[ pid ][ gNode.guiTNum[ pid ] ] < gLimit[ gNode.url.get[ pid ] ].rows)
                $('#Create-' + pid).prop('disabled', false);
            else
                $('#Create-' + pid).prop('disabled', true);

            break;
        case 'group_address':
            for (var i=0; i<gData[ pid ][ gNode.guiTNum[ pid ] ]; i++)
            {
                if ( gData[ pid ][ gNode.guiT[ pid ] ][ i ].name == '' ) 
                    continue;
                cnt++;
                tmp = '<tr class="' + ((cnt%2 == 0)? 'odd' : 'even') + '">';
                tmp += '<td>';
                if (0 != parseInt(gData[ pid ][ gNode.guiT[ pid ] ][ i ].userDefined)) {
                    tmp += '<input type="checkbox" value="' + i + '" />';
                }
                tmp += '</td>';
                tmp += '<td>' + cnt + '</td>';
                tmp += '<td class="alignLeft" colspan="3" id="' + pid + '-name-' + i + '">';
                tmp += '<div class="tooltipAccordion">';
                tmp += '<h4><a href="#">' + gData[ pid ][ gNode.guiT[ pid ] ][ i ].name + '</h4>';
                tmp += '<div id="div-' + pid + '-name-' + i + '">';
                tmp += tooltipTable( pid, pid + '-name-' + i, gData[ pid ][ gNode.guiT[ pid ] ][ i ].idList);
                tmp += '</div>';
                tmp += '</div>';
                tmp += '</td>';
                tmp += '<td>';
                tmp += '<button id="Edit-group_address-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                //tmp += '<button id="Duplicate-group_address-' + i + '" class="Duplicate" title="Duplicate"><span class="ui-icon"></span></button>';
                if (0 != parseInt(gData[ pid ][ gNode.guiT[ pid ] ][ i ].userDefined)) {
                    tmp += '<button id="Delete-group_address-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                }
                tmp += '</td>';
                tmp += '</tr>';
                $('#table-' + pid + ' > tbody').append( tmp );
            }

            $('.tooltipAccordion').accordion({
                collapsible:true,
                active:false,
                autoHeight: false
            });
            if (gData[ pid ][ gNode.guiTNum[ pid ] ] < gLimit[ gNode.url.get[ pid ] ].rows)
                $('#Create-' + pid).prop('disabled', false);
            else
                $('#Create-' + pid).prop('disabled', true);
            break;
        case 'service':
            for (var i=0; i<gData[ pid ][ gNode.guiTNum[ pid ] ]; i++)
            {
                if ( gData[ pid ][ gNode.guiT[ pid ] ][ i ].name == '' ) 
                    continue;
                cnt++;
                tmp = '<tr class="' + ((cnt%2 == 0)? 'odd' : 'even') + '">';
                tmp += '<td>';
                if (0 != parseInt(gData[ pid ][ gNode.guiT[ pid ] ][ i ].userDefined)) {
                    tmp += '<input type="checkbox" value="' + i + '" />';
                }
                tmp += '</td>';
                tmp += '<td>' + cnt + '</td>';
                tmp += '<td class="alignLeft">' + gData[ pid ][ gNode.guiT[ pid ] ][ i ].name + '</td>';
                tmp += '<td class="alignLeft">' + gRef[ pid ].type[ gData[ pid ][ gNode.guiT[ pid ] ][ i ].type ]+ '</td>';
                tmp += '<td>' + gData[ pid ][ gNode.guiT[ pid ] ][ i ].param1 + '</td>';
                if ( parseInt( gData[ pid ][ gNode.guiT[ pid ] ][ i ].type ) < 3  ) 
                    tmp += '<td>' + gData[ pid ][ gNode.guiT[ pid ] ][ i ].param2 + '</td>';
                else 
                    tmp += '<td>N/A</td>';
                tmp += '<td>';
                tmp += '<button id="Edit-service-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                //tmp += '<button id="Duplicate-service-' + i + '" class="Duplicate" title="Duplicate"><span class="ui-icon"></span></button>';
                if (0 != parseInt(gData[ pid ][ gNode.guiT[ pid ] ][ i ].userDefined)) {
                    tmp += '<button id="Delete-service-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                }
                tmp += '</td>';
                tmp += '</tr>';
                $('#table-' + pid + ' > tbody').append( tmp );
            }
            if (gData[ pid ][ gNode.guiTNum[ pid ] ] < gLimit[ gNode.url.get[ pid ] ].rows)
                $('#Create-' + pid).prop('disabled', false);
            else
                $('#Create-' + pid).prop('disabled', true);
            break;
        case 'group_service':
            for (var i=0; i<gData[ pid ][ gNode.guiTNum[ pid ] ]; i++)
            {
                if ( gData[ pid ][ gNode.guiT[ pid ] ][ i ].name == '' ) 
                    continue;
                cnt++;
                tmp = '<tr class="' + ((cnt%2 == 0)? 'odd' : 'even') + '">';
                tmp += '<td>';
                if (0 != parseInt(gData[ pid ][ gNode.guiT[ pid ] ][ i ].userDefined)) {
                    tmp += '<input type="checkbox" value="' + i + '" />';
                }
                tmp += '</td>';
                tmp += '<td>' + cnt + '</td>';
                tmp += '<td class="alignLeft" colspan="4" id="' + pid + '-name-' + i + '">';
                tmp += '<div class="tooltipAccordion">';
                tmp += '<h4><a href="#">' + gData[ pid ][ gNode.guiT[ pid ] ][ i ].name + '</h4>';
                tmp += '<div id="div-' + pid + '-name-' + i + '">';
                tmp += tooltipTable( pid, pid + '-name-' + i, gData[ pid ][ gNode.guiT[ pid ] ][ i ].idList);
                tmp += '</div>';
                tmp += '</div>';
                tmp += '</td>';
                tmp += '<td>';
                tmp += '<button id="Edit-group_service-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                //tmp += '<button id="Duplicate-group_service-' + i + '" class="Duplicate" title="Duplicate"><span class="ui-icon"></span></button>';
                if (0 != parseInt(gData[ pid ][ gNode.guiT[ pid ] ][ i ].userDefined)) {
                    tmp += '<button id="Delete-group_service-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                }
                tmp += '</td>';
                tmp += '</tr>';
                $('#table-' + pid + ' > tbody').append( tmp );
            }

            $('.tooltipAccordion').accordion({
                collapsible:true,
                active:false,
                autoHeight: false
            });
            if (gData[ pid ][ gNode.guiTNum[ pid ] ] < gLimit[ gNode.url.get[ pid ] ].rows)
                $('#Create-' + pid).prop('disabled', false);
            else
                $('#Create-' + pid).prop('disabled', true);
            break;
        case 'schedule':
            
            for (var i=0; i<gData[ pid ][ gNode.guiTNum ]; i++)
            {
                if ( gData[ pid ][ gNode.guiT ][ i ].name == '' ) 
                    continue;
                cnt++;
                tmp = '<tr class="' + ((cnt%2 == 0)? 'odd' : 'even') + '">';
                tmp += '<td><input type="checkbox" value="' + i + '" /></td>';
                tmp += '<td>' + cnt + '</td>';
                tmp += '<td class="alignLeft">';
                tmp += gData.schedule[ gNode.guiT ][ i ].name;
                tmp += '</td>';
                tmp += '<td>';
                if (parseInt( gData.schedule[ gNode.guiT ][ i ].day ) > 0) {
                    var day = gData.schedule[ gNode.guiT ][ i ].day;
                    for (var j=0; j<7; j++)
                    {
                        if ( day & 1 ) {
                            tmp += gRef[ pid ].day[ Math.pow(2,j) ] + ';';
                        }
                        day = day >> 1;
                    }
                }else {
                    tmp += gRef[ pid ].day[ "0" ];
                }
                tmp += '</td>';
                tmp += '<td>';
                tmp += gData.schedule[ gNode.guiT ][ i ].startHour + ':' + gData.schedule[ gNode.guiT ][ i ].startMin;
                tmp += '</td>';
                tmp += '<td>';
                tmp += gData.schedule[ gNode.guiT ][ i ].endHour + ':' + gData.schedule[ gNode.guiT ][ i ].endMin;
                tmp += '</td>';
                tmp += '<td>';
                tmp += '<button id="Edit-schedule-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                //tmp += '<button id="Duplicate-schedule-' + i + '" class="Duplicate" title="Duplicate"><span class="ui-icon"></span></button>';
                tmp += '<button id="Delete-schedule-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                tmp += '</td>';
                tmp += '</tr>';
                $('#table-' + pid + ' > tbody').append( tmp );
            }
            if (gData[ pid ][ gNode.guiTNum ] < gLimit[ gNode.url.get ].rows)
                $('#Create-' + pid).prop('disabled', false);
            else
                $('#Create-' + pid).prop('disabled', true);
            break;
        }
    }
    
    function createObject(e, type) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        if (type) 
            tar.thisNo = tar.id.split(gReg.isDash)[2];
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        tar.w = 600;
    
        var tmp;
    
        $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"><table id="Editor-table-' + tar.pid + '"></table></div></div>');
    
        switch( tar.pid )
        {
        case 'address':
            tar.h = 300;
            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                if ( 'input' == gNode.editor[ tar.pid ][ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">' + gNode.editor[ tar.pid ][ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '"><input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '" /></td>';
                    tmp += '</tr>';
                } else {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">' + gNode.editor[ tar.pid ][ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '"><select id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '"></select></td>';
                    tmp += '</tr>';
                    for (var j=0, jlen=gNode.editor[ tar.pid ][ i ].option.length; j<jlen; j++)
                    {
                        tmp += '<tr class="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '">';
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ j ].wiz + '"></td>';
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].align[ 1 ] + '" >';
                        tmp += '<table id="Editor-table-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '">';
                        for (var k=0, klen=gNode.editor[ tar.pid ][ i ].option[ j ].col.length; k<klen; k++)
                        {
                            tmp += '<tr class="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tab + '">';
                            if ('input' == gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tag) {
                                tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].wiz + '">';
                                tmp += gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].label;
                                tmp += '</td>';
                                tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 1 ] + '">';
                                tmp += '<input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tab + '" />';
                                tmp += '</td>';
                            } else if ('select' == gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tag) {
                                tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].wiz + '">';
                                tmp += gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].label;
                                tmp += '</td>';
                                tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 1 ] + '">';
                                tmp += '<select id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tab + '" ></select>';
                                tmp += '</td>';
                            } else {
                                tmp += '<td colspan="' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].colspan + '" class="alignLeft">' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].label + '</td>';
                            }
                            tmp += '</tr>';
                        }
                        tmp += '</table>';
                        tmp += '</td>';
                        tmp += '</tr>';
                    }
                }
            }

            $('#Editor-table-' + tar.pid).append(tmp);
    
            $('#Editor-type').change(function() {
                $('.Editor-type-1').hide();
                $('.Editor-type-2').hide();
                $('.Editor-type-3').hide();
                $('.Editor-type-4').hide();
                $('.Editor-type-' + $(this).val()).show();
            });
    
            $('#Editor-type-4-mac').change( function() {
                if ('macInput' == $(this).val())  {
                     $('.Editor-type-4-macInput').show();
                } else {
                     $('.Editor-type-4-macInput').hide();
                } 
            });

            if (type) {
                $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
    
                $('#Editor-type').append( genSelectOption( 'addressType1' ) ).val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].type ).trigger('change');
                $('#Editor-type-1-startIp').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].startIp );
                $('#Editor-type-2-startIp').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].startIp );
                $('#Editor-type-2-netmask').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].netmask );
                $('#Editor-type-3-startIp').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].startIp );
                $('#Editor-type-3-endIp').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].endIp );
    
                gIf.isMAC = false;
                // tell if mac in arp table
                for (var i=0, len=gCache.list.arpTable.guiArpTableTNum; i<len; i++)
                {
                    if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mac == gCache.list.arpTable.guiArpTableT[ i ].mac )
                        gIf.isMAC = true;
                }

                if (gIf.isMAC) {
                    cgiSelectOption( 'Editor-type-4-mac', gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mac );
                } else {
                    cgiSelectOption( 'Editor-type-4-mac', 'macInput' );
                    $('#Editor-type-4-macInput').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mac );
                }

            } else {
                $('#Editor-type').append( genSelectOption( 'addressType1' ) ).val( 1 ).trigger('change');
                cgiSelectOption( 'Editor-type-4-mac' );
            }
            break;
        case 'group_address':
            tar.h = 360;

            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                tmp += '<tr>';
                if (gNode.editor[ tar.pid ][ i ].colspan) {
                    if ( 'p' == gNode.editor[ tar.pid ][ i ].tag ) {
                        tmp += '<th colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '">';
                        tmp += '<p>' + gNode.editor[ tar.pid ][ i ].label + ' : </p>';
                        tmp += '</th>';
                    } else if ( 'span' == gNode.editor[ tar.pid ][ i ].tag ) {
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">';
                        tmp += gNode.editor[ tar.pid ][ i ].label + ' : ';
                        tmp += '</td>';
                        tmp += '<td colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '">';
                        tmp += '<span id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '"></span>';
                        tmp += '</td>';
                    } else {
                        tmp += '<th colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '">';
                        tmp += gNode.editor[ tar.pid ][ i ].label + '&nbsp;<input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '" />';
                        tmp += '</th>';
                    }
                } else if (gNode.editor[ tar.pid ][ i ].type == 'multiple') {
                    tmp += '<td colspan="2">';
                    tmp += '<table>';

                    tmp += '<tr>';
                    tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pool.wiz + '">';
                    tmp += gNode.editor[ tar.pid ][ i ].multiple.pool.label;
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.del.wiz + '">';
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.add.wiz + '">';
                    tmp += '</th>';
                    tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pick.wiz + '">';
                    tmp += gNode.editor[ tar.pid ][ i ].multiple.pick.label;
                    tmp += '</th>';
                    tmp += '</tr>';

                    tmp += '<tr>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pool.wiz + '">';
                    tmp += '<select id="pool" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.del.wiz + '">';
                    tmp += '<button class="Move2Del" id="Move2Del-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.add.wiz + '">';
                    tmp += '<button class="Move2Add" id="Move2Add-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pick.wiz + '">';
                    tmp += '<select id="pick" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';

                    tmp += '</table>';
                    tmp += '</td>';
                }
                tmp += '</tr>';
            }

            $('#Editor-table-' + tar.pid).append(tmp);
    
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerGroupAddress ) {
                    errorAlert( '<p>' + gError[ gObj.lang ].memberLimit + '</p>' );
                    return false;
                } else {
                    vSel.clone().appendTo('#pick');
                    vSel.remove();
                }
            });

            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
    
            $('#pool').change( function() {
                $('#Editor-addressName').html("");
                $('#Editor-addressType').html("");
                $('#Editor-addressValue').html("");
    
                if (gData.address) {
                    for (var i=0; i<gData.address.guiAddrTNum; i++)
                    {
                        if (parseInt(gData.address.guiAddrT[ i ].gid) === parseInt($('#pool option:selected').val())) {
                            $('#Editor-addressName').html( gData.address.guiAddrT[ i ].name);
                            $('#Editor-addressType').html( gRef.address.type[ gData.address.guiAddrT[ i ].type ] );
                            switch( parseInt( gData.address.guiAddrT[ i ].type  ) )
                            {
                            case 1:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/255.255.255.255' );
                                break;
                            case 2:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/' + gData.address.guiAddrT[ i ].netmask );
                                break;
                            case 3:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '-' + gData.address.guiAddrT[ i ].endIp );
                                break;
                            case 4:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].mac );
                                break;
                            }
                        }
                    }
                }
            });
    
            $('#pick').change( function() {
                $('#Editor-addressName').html("");
                $('#Editor-addressType').html("");
                $('#Editor-addressValue').html("");
    
                if (gData.address) {
                    for (var i=0; i<gData.address.guiAddrTNum; i++)
                    {
                        if (parseInt(gData.address.guiAddrT[ i ].gid) === parseInt($('#pick option:selected').val())) {
                            $('#Editor-addressName').html( gData.address.guiAddrT[ i ].name);
                            $('#Editor-addressType').html( gRef.address.type[ gData.address.guiAddrT[ i ].type ] );
                            switch( parseInt( gData.address.guiAddrT[ i ].type  ) )
                            {
                            case 1:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/255.255.255.255' );
                                break;
                            case 2:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/' + gData.address.guiAddrT[ i ].netmask );
                                break;
                            case 3:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '-' + gData.address.guiAddrT[ i ].endIp );
                                break;
                            case 4:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].mac );
                                break;
                            }
                        }
                    }
                }
            });

            if (type) {
                $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
       
                if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].num > 0 ) {
                    arr = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].idList.split(';');
                    for (var i=0; i<arr.length; i++)
                        arr[ i ] = parseInt( arr[ i ] );
                    for (var i=0; i<gData.address.guiAddrTNum; i++)
                    {
                        if (arr.indexOf( gData.address.guiAddrT[ i ].gid ) != -1) {
                            $('#pick').append( '<option value="' + gData.address.guiAddrT[ i ].gid + '">' + gData.address.guiAddrT[ i ].name + '</option>' );
                        } else {
                            $('#pool').append( '<option value="' + gData.address.guiAddrT[ i ].gid + '">' + gData.address.guiAddrT[ i ].name + '</option>' );
                        }
                    }
                } else {
                    for (var i=0; i<gData.address.guiAddrTNum; i++)
                    {
                        $('#pool').append( '<option value="' + gData.address.guiAddrT[ i ].gid + '">' + gData.address.guiAddrT[ i ].name + '</option>' );
                    }
                }
            } else {
                for (var i=0; i<gData.address.guiAddrTNum; i++)
                {
                    tmp = '<option value="' + gData.address.guiAddrT[ i ].gid + '">' + gData.address.guiAddrT[ i ].name + '</option>';
                    $('#pool').append( tmp );
                }
            }
            break;
        case 'service':
            tar.h = 300;

            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                if ( 'input' == gNode.editor[ tar.pid ][ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">' + gNode.editor[ tar.pid ][ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '"><input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '" /></td>';
                    tmp += '</tr>';
                } else {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">' + gNode.editor[ tar.pid ][ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '"><select id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '"></select></td>';
                    tmp += '</tr>';
                    for (var j=0, jlen=gNode.editor[ tar.pid ][ i ].option.length; j<jlen; j++)
                    {
                        tmp += '<tr class="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '">';
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ j ].wiz + '"></td>';
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].align[ 1 ] + '" >';
                        tmp += '<table id="Editor-table-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '">';
                        for (var k=0, klen=gNode.editor[ tar.pid ][ i ].option[ j ].col.length; k<klen; k++)
                        {
                            tmp += '<tr>';
                            tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].wiz + '">';
                            tmp += gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].label;
                            tmp += '</td>';
                            tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 1 ] + '">';
                            tmp += '<input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tab + '" />';
                            tmp += '&nbsp;' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                        }
                        tmp += '</table>';
                        tmp += '</td>';
                        tmp += '</tr>';
                    }
                }
            }

            $('#Editor-table-' + tar.pid).append(tmp);
            $('#Editor-type').change(function() {
                $('.Editor-type-0').hide();
                $('.Editor-type-1').hide();
                $('.Editor-type-2').hide();
                $('.Editor-type-3').hide();
                $('.Editor-type-4').hide();
                $('.Editor-type-' + $(this).val()).show();
            });
    
            if (type) {
                $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
                $('#Editor-type').append( genSelectOption( 'serviceType1' ) ).val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].type ).trigger('change');
                $('#Editor-type-' + gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].type + '-param1').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].param1 );
                $('#Editor-type-' + gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].type + '-param2').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].param2 );
            } else {
                $('#Editor-type').append( genSelectOption( 'serviceType1' ) ).val( 0 ).trigger('change');
            }
            break;
        case 'group_service':
            tar.h = 360;

            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                tmp += '<tr>';
                if (gNode.editor[ tar.pid ][ i ].colspan) {
                    if ( 'p' == gNode.editor[ tar.pid ][ i ].tag ) {
                        tmp += '<th colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '">';
                        tmp += '<p>' + gNode.editor[ tar.pid ][ i ].label + ' : </p>';
                        tmp += '</th>';
                    } else if ( 'span' == gNode.editor[ tar.pid ][ i ].tag ) {
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">';
                        tmp += gNode.editor[ tar.pid ][ i ].label + ' : ';
                        tmp += '</td>';
                        tmp += '<td colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '">';
                        tmp += '<span id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '"></span>';
                        tmp += '</td>';
                    } else {
                        tmp += '<th colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '">';
                        tmp += gNode.editor[ tar.pid ][ i ].label + '&nbsp;<input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '" />';
                        tmp += '</th>';
                    }
                } else if (gNode.editor[ tar.pid ][ i ].type == 'multiple') {
                    tmp += '<td colspan="2">';
                    tmp += '<table>';

                    tmp += '<tr>';
                    tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pool.wiz + '">';
                    tmp += gNode.editor[ tar.pid ][ i ].multiple.pool.label;
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.del.wiz + '">';
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.add.wiz + '">';
                    tmp += '</th>';
                    tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pick.wiz + '">';
                    tmp += gNode.editor[ tar.pid ][ i ].multiple.pick.label;
                    tmp += '</th>';
                    tmp += '</tr>';

                    tmp += '<tr>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pool.wiz + '">';
                    tmp += '<select id="pool" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.del.wiz + '">';
                    tmp += '<button class="Move2Del" id="Move2Del-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.add.wiz + '">';
                    tmp += '<button class="Move2Add" id="Move2Add-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pick.wiz + '">';
                    tmp += '<select id="pick" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';

                    tmp += '</table>';
                    tmp += '</td>';
                }
                tmp += '</tr>';
            }

            $('#Editor-table-' + tar.pid).append(tmp);
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerGroupService ) {
                    errorAlert( '<p>' + gError[ gObj.lang ].memberLimit + '</p>' );
                    return false;
                } else {
                    vSel.clone().appendTo('#pick');
                    vSel.remove();
                }
            });

            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
    
            $('#pool').change( function() {
                $('#Editor-serviceName').html("");
                $('#Editor-serviceType').html("");
                $('#Editor-serviceValue').html("");
    
                if (gData.service) {
                    for (var i=0; i<gData.service.guiServiceTNum; i++)
                    {
                        if (parseInt(gData.service.guiServiceT[ i ].gid) === parseInt($('#pool option:selected').val())) {
                            $('#Editor-serviceName').html( gData.service.guiServiceT[ i ].name);
                            $('#Editor-serviceType').html( gRef.service.type[ gData.service.guiServiceT[ i ].type ] );
                            switch( parseInt( gData.service.guiServiceT[ i ].type  ) )
                            {
                            case 0:
                            case 1:
                            case 2:
                                $('#Editor-serviceValue').html( gData.service.guiServiceT[ i ].param1 + '-' + gData.service.guiServiceT[ i ].param2 );
                                break;
                            case 3:
                            case 4:
                                $('#Editor-serviceValue').html( gData.service.guiServiceT[ i ].param1 );
                                break;
                            }
                        }
                    }
                }
            });
    
            $('#pick').change( function() {
                $('#Editor-serviceName').html("");
                $('#Editor-serviceType').html("");
                $('#Editor-serviceValue').html("");
    
                if (gData.service) {
                    for (var i=0; i<gData.service.guiServiceTNum; i++)
                    {
                        if (parseInt(gData.service.guiServiceT[ i ].gid) === parseInt($('#pick option:selected').val())) {
                            $('#Editor-serviceName').html( gData.service.guiServiceT[ i ].name);
                            $('#Editor-serviceType').html( gRef.service.type[ gData.service.guiServiceT[ i ].type ] );
                            switch( parseInt( gData.service.guiServiceT[ i ].type  ) )
                            {
                            case 0:
                            case 1:
                            case 2:
                                $('#Editor-serviceValue').html( gData.service.guiServiceT[ i ].param1 + '-' + gData.service.guiServiceT[ i ].param2 );
                                break;
                            case 3:
                            case 4:
                                $('#Editor-serviceValue').html( gData.service.guiServiceT[ i ].param1 );
                                break;
                            }
                        }
                    }
                }
            });

            if (type) {
                $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
                if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].num > 0 ) {
                    arr = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].idList.split(';');
                    for (var i=0; i<arr.length; i++)
                        arr[ i ] = parseInt( arr[ i ] );
    
                    for (var i=0; i<gData.service.guiServiceTNum; i++)
                    {
                        if (arr.indexOf( gData.service.guiServiceT[ i ].gid ) != -1) {
                            $('#pick').append( '<option value="' + gData.service.guiServiceT[ i ].gid + '">' + gData.service.guiServiceT[ i ].name + '</option>' );
                        } else {
                            $('#pool').append( '<option value="' + gData.service.guiServiceT[ i ].gid + '">' + gData.service.guiServiceT[ i ].name + '</option>' );
                        }
                    }
                } else {
                    for (var i=0; i<gData.service.guiServiceTNum; i++)
                    {
                        $('#pool').append( '<option value="' + gData.service.guiServiceT[ i ].gid + '">' + gData.service.guiServiceT[ i ].name + '</option>' );
                    }
                }
            } else {
                for (var i=0; i<gData.service.guiServiceTNum; i++)
                {
                    tmp = '<option value="' + gData.service.guiServiceT[ i ].gid + '">' + gData.service.guiServiceT[ i ].name + '</option>';
                    $('#pool').append( tmp );
                }
            }
            break;
        case 'schedule':
            tar.w = 520;
            tar.h = 480;

            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                if ( 'input' == gNode.editor[ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '"><input type="text" id="Editor-' + gNode.editor[ i ].tab + '" /></td>';
                    tmp += '</tr>';
                } else if ( 'p' == gNode.editor[ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '"><p id="Editor-' + gNode.editor[ i ].tab + '" >' + gNode.editor[ i ].note + '</p></td>';
                    tmp += '</tr>';
                } else {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '"><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                    tmp += '</tr>';

                    for (var j=0, jlen=gNode.editor[ i ].option.length; j<jlen; j++)
                    {
                        if (gNode.editor[ i ].option[ j ].col) {
                            for (var k=0, klen=gNode.editor[ i ].option[ j ].col.length; k<klen; k++)
                            {
                                if ( 'p' == gNode.editor[ i ].option[ j ].col[ k ].tag ) {
                                    tmp += '<tr class="Editor-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].option[ j ].tab + '">';
                                    tmp += '<td class="alignRight">' + gNode.editor[ i ].option[ j ].col[ k ].label + '</td>';
                                    tmp += '<td class="alignLeft" >';
                                    tmp += '<select id="Editor-' + gNode.editor[ i ].option[ j ].col[ k ].col[ 0 ].tab + '"></select>'; 
                                    tmp += ' : ';
                                    tmp += '<select id="Editor-' + gNode.editor[ i ].option[ j ].col[ k ].col[ 1 ].tab + '"></select>'; 
                                    tmp += '&nbsp;' + gNode.editor[ i ].option[ j ].col[ k ].note;
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                } else {
                                    tmp += '<tr class="Editor-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].option[ j ].tab + '">';
                                    tmp += '<td></td>';
                                    tmp += '<td class="alignLeft" >';
                                    tmp += '<input type="checkbox" id="Editor-' + gNode.editor[ i ].option[ j ].col[ k ].tab + '" value="' + gNode.editor[ i ].option[ j ].col[ k ].val + '" />&nbsp;<label for="Editor-' + gNode.editor[ i ].option[ j ].col[ k ].tab + '">' + gNode.editor[ i ].option[ j ].col[ k ].label + '</label>';
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }
                            }
                        }
                    }
                }
            }

            $('#Editor-table-' + tar.pid).append(tmp);
    
            $('#Editor-days').change( function() {
               if (0 === parseInt($(this).val())) {
                   $('.Editor-days-1').hide();
               } else {
                   $('.Editor-days-1').show();
               }
            });
    
            $('#Editor-times').change( function() {
               if (0 === parseInt($(this).val())) {
                   $('.Editor-times-1').hide();
               } else {
                   $('.Editor-times-1').show();
               }
            });
    
            $('#Editor-startHour').append( genSelectOption( 'Editor-startHour' ) ); 
            $('#Editor-startMin').append( genSelectOption( 'Editor-startMin' ) ); 
            $('#Editor-endHour').append( genSelectOption( 'Editor-endHour' ) ); 
            $('#Editor-endMin').append( genSelectOption( 'Editor-endMin' ) ); 

            if (type) {
                $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name );
                $('#Editor-days').append( genSelectOption( 'Editor-days' ) );
                $('#Editor-times').append( genSelectOption( 'Editor-times' ) );
    
                var arr = [];
                switch( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].type ) )
                {
                case 1:
                    $('#Editor-days').val(0).trigger('change');
                    $('#Editor-times').val(0).trigger('change');
                    break;
                case 2:
                    $('#Editor-days').val(0).trigger('change');
                    $('#Editor-times').val(1).trigger('change');
                    $('#Editor-startHour').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startHour );
                    $('#Editor-startMin').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startMin );
                    $('#Editor-endHour').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endHour );
                    $('#Editor-endMin').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endMin );
                    break;
                case 3:
                    $('#Editor-days').val(1).trigger('change');
                    $('#Editor-times').val(0).trigger('change');
    
                    if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day ) > 0) {
                        var day = gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day;
                        for (var j=0; j<7; j++)
                        {
                            if ( day & 1 ) {
                                $('#Editor-day' +  (Math.pow(2,j))).click();
                            }
                            day = day >> 1;
                        }
                    }
    
                    break;
                case 4:
                    $('#Editor-days').val(1).trigger('change');
                    $('#Editor-times').val(1).trigger('change');
                    $('#Editor-startHour').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startHour );
                    $('#Editor-startMin').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startMin );
                    $('#Editor-endHour').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endHour );
                    $('#Editor-endMin').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endMin );
    
                    if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day ) > 0) {
                        var day = gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day;
                        for (var j=0; j<7; j++)
                        {
                            if ( day & 1 ) {
                                $('#Editor-day' +  (Math.pow(2,j))).click();
                            }
                            day = day >> 1;
                        }
                    }
                    break;
                }
            } else {
                $('#Editor-days').append( genSelectOption( 'Editor-days' ) ).val( 0 ).trigger('change');
                $('#Editor-times').append( genSelectOption( 'Editor-times' ) ).val( 0 ).trigger('change');
            }
            break;
        }
    
        objectEditor(e, tar.w, tar.h);
    }
    
    function editObject(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
    
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        tar.thisNo = tar.id.split(gReg.isDash)[2];
    
        tar.w = 600;
        tar.h = 480;
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        var tmp;
        var arr = [];
    
        $('#popForm').append('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"><table id="Editor-table-' + tar.pid + '"></table></div></div>');
    
        switch( tar.pid )
        {
        case 'address':
            tar.h = 300;

            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                if ( 'input' == gNode.editor[ tar.pid ][ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">' + gNode.editor[ tar.pid ][ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '"><input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '" /></td>';
                    tmp += '</tr>';
                } else {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">' + gNode.editor[ tar.pid ][ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '"><select id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '"></select></td>';
                    tmp += '</tr>';
                    for (var j=0, jlen=gNode.editor[ tar.pid ][ i ].option.length; j<jlen; j++)
                    {
                        tmp += '<tr class="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '">';
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ j ].wiz + '"></td>';
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].align[ 1 ] + '" >';
                        tmp += '<table id="Editor-table-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '">';
                        for (var k=0, klen=gNode.editor[ tar.pid ][ i ].option[ j ].col.length; k<klen; k++)
                        {
                            tmp += '<tr class="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tab + '">';
                            if ('input' == gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tag) {
                                tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].wiz + '">';
                                tmp += gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].label;
                                tmp += '</td>';
                                tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 1 ] + '">';
                                tmp += '<input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tab + '" />';
                                tmp += '</td>';
                            } else if ('select' == gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tag) {
                                tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].wiz + '">';
                                tmp += gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].label;
                                tmp += '</td>';
                                tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 1 ] + '">';
                                tmp += '<select id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tab + '" ></select>';
                                tmp += '</td>';
                            } else {
                                tmp += '<td colspan="' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].colspan + '" class="alignLeft">' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].label + '</td>';
                            }
                            tmp += '</tr>';
                        }
                        tmp += '</table>';
                        tmp += '</td>';
                        tmp += '</tr>';
                    }
                }
            }

            $('#Editor-table-' + tar.pid).append(tmp);
    
            $('#Editor-type').change(function() {
                $('.Editor-type-1').hide();
                $('.Editor-type-2').hide();
                $('.Editor-type-3').hide();
                $('.Editor-type-4').hide();
                $('.Editor-type-' + $(this).val()).show();
            });
    
            $('#Editor-type-4-mac').change( function() {
                if ('macInput' == $(this).val())  {
                     $('.Editor-type-4-macInput').show();
                } else {
                     $('.Editor-type-4-macInput').hide();
                }
            });

            $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
    
            $('#Editor-type').append( genSelectOption( 'addressType1' ) ).val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].type ).trigger('change');
            $('#Editor-type-1-startIp').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].startIp );
            $('#Editor-type-2-startIp').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].startIp );
            $('#Editor-type-2-netmask').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].netmask );
            $('#Editor-type-3-startIp').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].startIp );
            $('#Editor-type-3-endIp').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].endIp );

            gIf.isMAC = false;
            // tell if mac in arp table
            for (var i=0, len=gCache.list.arpTable.guiArpTableTNum; i<len; i++)
            {
                if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mac == gCache.list.arpTable.guiArpTableT[ i ].mac )
                    gIf.isMAC = true;
            }

            if (gIf.isMAC) {
                cgiSelectOption( 'Editor-type-4-mac', gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mac );
            } else {
                cgiSelectOption( 'Editor-type-4-mac', 'macInput' );
                $('#Editor-type-4-macInput').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mac );
            }

            break;
        case 'group_address':
            tar.h = 360;
            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                tmp += '<tr>';
                if (gNode.editor[ tar.pid ][ i ].colspan) {
                    if ( 'p' == gNode.editor[ tar.pid ][ i ].tag ) {
                        tmp += '<th colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '">';
                        tmp += '<p>' + gNode.editor[ tar.pid ][ i ].label + ' : </p>';
                        tmp += '</th>';
                    } else if ( 'span' == gNode.editor[ tar.pid ][ i ].tag ) {
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">';
                        tmp += gNode.editor[ tar.pid ][ i ].label + ' : ';
                        tmp += '</td>';
                        tmp += '<td colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '">';
                        tmp += '<span id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '"></span>';
                        tmp += '</td>';
                    } else {
                        tmp += '<th colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '">';
                        tmp += gNode.editor[ tar.pid ][ i ].label + '&nbsp;<input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '" />';
                        tmp += '</th>';
                    }
                } else if (gNode.editor[ tar.pid ][ i ].type == 'multiple') {
                    tmp += '<td colspan="2">';
                    tmp += '<table>';

                    tmp += '<tr>';
                    tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pool.wiz + '">';
                    tmp += gNode.editor[ tar.pid ][ i ].multiple.pool.label;
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.del.wiz + '">';
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.add.wiz + '">';
                    tmp += '</th>';
                    tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pick.wiz + '">';
                    tmp += gNode.editor[ tar.pid ][ i ].multiple.pick.label;
                    tmp += '</th>';
                    tmp += '</tr>';

                    tmp += '<tr>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pool.wiz + '">';
                    tmp += '<select id="pool" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.del.wiz + '">';
                    tmp += '<button class="Move2Del" id="Move2Del-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.add.wiz + '">';
                    tmp += '<button class="Move2Add" id="Move2Add-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pick.wiz + '">';
                    tmp += '<select id="pick" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';

                    tmp += '</table>';
                    tmp += '</td>';
                }
                tmp += '</tr>';
            }

            $('#Editor-table-' + tar.pid).append(tmp);
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerGroupAddress ) {
                    errorAlert( '<p>' + gError[ gObj.lang ].memberLimit + '</p>' );
                    return false;
                } else {
                    vSel.clone().appendTo('#pick');
                    vSel.remove();
                }
            });
    
            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
    
            $('#pool').change( function() {
                $('#Editor-addressName').html("");
                $('#Editor-addressType').html("");
                $('#Editor-addressValue').html("");
    
                if (gData.address) {
                    for (var i=0; i<gData.address.guiAddrTNum; i++)
                    {
                        if (parseInt(gData.address.guiAddrT[ i ].gid) === parseInt($('#pool option:selected').val())) {
                            $('#Editor-addressName').html( gData.address.guiAddrT[ i ].name);
                            $('#Editor-addressType').html( gRef.address.type[ gData.address.guiAddrT[ i ].type ] );
                            switch( parseInt( gData.address.guiAddrT[ i ].type  ) )
                            {
                            case 1:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/255.255.255.255' );
                                break;
                            case 2:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/' + gData.address.guiAddrT[ i ].netmask );
                                break;
                            case 3:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '-' + gData.address.guiAddrT[ i ].endIp );
                                break;
                            case 4:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].mac );
                                break;
                            }
                        }
                    }
                }
            });
    
            $('#pick').change( function() {
                $('#Editor-addressName').html("");
                $('#Editor-addressType').html("");
                $('#Editor-addressValue').html("");
    
                if (gData.address) {
                    for (var i=0; i<gData.address.guiAddrTNum; i++)
                    {
                        if (parseInt(gData.address.guiAddrT[ i ].gid) === parseInt($('#pick option:selected').val())) {
                            $('#Editor-addressName').html( gData.address.guiAddrT[ i ].name);
                            $('#Editor-addressType').html( gRef.address.type[ gData.address.guiAddrT[ i ].type ] );
                            switch( parseInt( gData.address.guiAddrT[ i ].type  ) )
                            {
                            case 1:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/255.255.255.255' );
                                break;
                            case 2:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/' + gData.address.guiAddrT[ i ].netmask );
                                break;
                            case 3:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].startIp + '-' + gData.address.guiAddrT[ i ].endIp );
                                break;
                            case 4:
                                $('#Editor-addressValue').html( gData.address.guiAddrT[ i ].mac );
                                break;
                            }
                        }
                    }
                }
            });
    
            $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
    
            if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].num > 0 ) {
                arr = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].idList.split(';');
                for (var i=0; i<arr.length; i++)
                    arr[ i ] = parseInt( arr[ i ] );
                for (var i=0; i<gData.address.guiAddrTNum; i++)
                {
                    if (arr.indexOf( gData.address.guiAddrT[ i ].gid ) != -1) {
                        $('#pick').append( '<option value="' + gData.address.guiAddrT[ i ].gid + '">' + gData.address.guiAddrT[ i ].name + '</option>' );
                    } else {
                        $('#pool').append( '<option value="' + gData.address.guiAddrT[ i ].gid + '">' + gData.address.guiAddrT[ i ].name + '</option>' );
                    }
                }
            } else {
                for (var i=0; i<gData.address.guiAddrTNum; i++)
                {
                    $('#pool').append( '<option value="' + gData.address.guiAddrT[ i ].gid + '">' + gData.address.guiAddrT[ i ].name + '</option>' );
                }
            } 
            break;
        case 'service':
            tar.h = 300;
            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                if ( 'input' == gNode.editor[ tar.pid ][ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">' + gNode.editor[ tar.pid ][ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '"><input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '" /></td>';
                    tmp += '</tr>';
                } else {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">' + gNode.editor[ tar.pid ][ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '"><select id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '"></select></td>';
                    tmp += '</tr>';
                    for (var j=0, jlen=gNode.editor[ tar.pid ][ i ].option.length; j<jlen; j++)
                    {
                        tmp += '<tr class="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '">';
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ j ].wiz + '"></td>';
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].align[ 1 ] + '" >';
                        tmp += '<table id="Editor-table-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '">';
                        for (var k=0, klen=gNode.editor[ tar.pid ][ i ].option[ j ].col.length; k<klen; k++)
                        {
                            tmp += '<tr>';
                            tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].wiz + '">';
                            tmp += gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].label;
                            tmp += '</td>';
                            tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].align[ 1 ] + '">';
                            tmp += '<input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].tab + '-' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].tab + '" />';
                            tmp += '&nbsp;' + gNode.editor[ tar.pid ][ i ].option[ j ].col[ k ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                        }
                        tmp += '</table>';
                        tmp += '</td>';
                        tmp += '</tr>';
                    }
                }
            }

            $('#Editor-table-' + tar.pid).append(tmp);
            $('#Editor-type').change(function() {
                $('.Editor-type-0').hide();
                $('.Editor-type-1').hide();
                $('.Editor-type-2').hide();
                $('.Editor-type-3').hide();
                $('.Editor-type-4').hide();
                $('.Editor-type-' + $(this).val()).show();
            });
    
            $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name ).prop('disabled', true);
            $('#Editor-type').append( genSelectOption( 'serviceType1' ) ).val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].type ).trigger('change');
            $('#Editor-type-' + gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].type + '-param1').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].param1 );
            $('#Editor-type-' + gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].type + '-param2').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].param2 );
            break;
        case 'group_service':
            tar.h = 360;
            for (var i=0, len=gNode.editor[ tar.pid ].length; i<len; i++)
            {
                tmp += '<tr>';
                if (gNode.editor[ tar.pid ][ i ].colspan) {
                    if ( 'p' == gNode.editor[ tar.pid ][ i ].tag ) {
                        tmp += '<th colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '">';
                        tmp += '<p>' + gNode.editor[ tar.pid ][ i ].label + ' : </p>';
                        tmp += '</th>';
                    } else if ( 'span' == gNode.editor[ tar.pid ][ i ].tag ) {
                        tmp += '<td class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ tar.pid ][ i ].wiz + '">';
                        tmp += gNode.editor[ tar.pid ][ i ].label + ' : ';
                        tmp += '</td>';
                        tmp += '<td colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 1 ] + '">';
                        tmp += '<span id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '"></span>';
                        tmp += '</td>';
                    } else {
                        tmp += '<th colspan="' + gNode.editor[ tar.pid ][ i ].colspan + '" class="align' + gNode.editor[ tar.pid ][ i ].align[ 0 ] + '">';
                        tmp += gNode.editor[ tar.pid ][ i ].label + '&nbsp;<input type="text" id="Editor-' + gNode.editor[ tar.pid ][ i ].tab + '" />';
                        tmp += '</th>';
                    }
                } else if (gNode.editor[ tar.pid ][ i ].type == 'multiple') {
                    tmp += '<td colspan="2">';
                    tmp += '<table>';

                    tmp += '<tr>';
                    tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pool.wiz + '">';
                    tmp += gNode.editor[ tar.pid ][ i ].multiple.pool.label;
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.del.wiz + '">';
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.add.wiz + '">';
                    tmp += '</th>';
                    tmp += '<th style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pick.wiz + '">';
                    tmp += gNode.editor[ tar.pid ][ i ].multiple.pick.label;
                    tmp += '</th>';
                    tmp += '</tr>';

                    tmp += '<tr>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pool.wiz + '">';
                    tmp += '<select id="pool" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.del.wiz + '">';
                    tmp += '<button class="Move2Del" id="Move2Del-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.add.wiz + '">';
                    tmp += '<button class="Move2Add" id="Move2Add-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gNode.editor[ tar.pid ][ i ].multiple.pick.wiz + '">';
                    tmp += '<select id="pick" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';

                    tmp += '</table>';
                    tmp += '</td>';
                }
                tmp += '</tr>';
            }

            $('#Editor-table-' + tar.pid).append(tmp);
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                if ( ( $('#pool option:selected').length + $('#pick option').length) > gRows.maxMemberPerGroupService ) {
                    errorAlert( '<p>' + gError[ gObj.lang ].memberLimit + '</p>' );
                    return false;
                } else {
                    vSel.clone().appendTo('#pick');
                    vSel.remove();
                }
            });
    
            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
    
            $('#pool').change( function() {
                $('#Editor-serviceName').html("");
                $('#Editor-serviceProtocol').html("");
                $('#Editor-serviceValue').html("");
            
                if (gData.service) {
                    for (var i=0; i<gData.service.guiServiceTNum; i++)
                    {
                        if (parseInt(gData.service.guiServiceT[ i ].gid) === parseInt($('#pool option:selected').val())) {
                            $('#Editor-serviceName').html( gData.service.guiServiceT[ i ].name);
                            $('#Editor-serviceProtocol').html( gRef.service.type[ gData.service.guiServiceT[ i ].type ] );
                            switch( parseInt( gData.service.guiServiceT[ i ].type  ) )
                            {
                            case 0:
                            case 1:
                            case 2:
                                $('#Editor-serviceValue').html( gData.service.guiServiceT[ i ].param1 + '-' + gData.service.guiServiceT[ i ].param2 );
                                break;
                            case 3:
                            case 4:
                                $('#Editor-serviceValue').html( gData.service.guiServiceT[ i ].param1 );
                                break;
                            }
                        }
                    }
                }
            });
    
            $('#pick').change( function() {
                $('#Editor-serviceName').html("");
                $('#Editor-serviceProtocol').html("");
                $('#Editor-serviceValue').html("");
    
                if (gData.service) {
                    for (var i=0; i<gData.service.guiServiceTNum; i++)
                    {
                        if (parseInt(gData.service.guiServiceT[ i ].gid) === parseInt($('#pick option:selected').val())) {
                            $('#Editor-serviceName').html( gData.service.guiServiceT[ i ].name);
                            $('#Editor-serviceProtocol').html( gRef.service.type[ gData.service.guiServiceT[ i ].type ] );
                            switch( parseInt( gData.service.guiServiceT[ i ].type  ) )
                            {
                            case 0:
                            case 1:
                            case 2:
                                $('#Editor-serviceValue').html( gData.service.guiServiceT[ i ].param1 + '-' + gData.service.guiServiceT[ i ].param2 );
                                break;
                            case 3:
                            case 4:
                                $('#Editor-serviceValue').html( gData.service.guiServiceT[ i ].param1 );
                                break;
                            }
                        }
                    }
                }
            });
    
            $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name );
    
            if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].num > 0 ) {
                arr = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].idList.split(';');
                for (var i=0; i<arr.length; i++)
                    arr[ i ] = parseInt( arr[ i ] );
    
                for (var i=0; i<gData.service.guiServiceTNum; i++)
                {
                    if (arr.indexOf( gData.service.guiServiceT[ i ].gid ) != -1) {
                        $('#pick').append( '<option value="' + gData.service.guiServiceT[ i ].gid + '">' + gData.service.guiServiceT[ i ].name + '</option>' );
                    } else {
                        $('#pool').append( '<option value="' + gData.service.guiServiceT[ i ].gid + '">' + gData.service.guiServiceT[ i ].name + '</option>' );
                    }
                }
            } else {
                for (var i=0; i<gData.service.guiServiceTNum; i++)
                {
                    $('#pool').append( '<option value="' + gData.service.guiServiceT[ i ].gid + '">' + gData.service.guiServiceT[ i ].name + '</option>' );
                }
            } 
    
            break;
        case 'schedule':
            tar.w = 520;
            tar.h = 480;
            for (var i=0, len=gNode.editor.length; i<len; i++)
            {
                if ( 'input' == gNode.editor[ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '"><input type="text" id="Editor-' + gNode.editor[ i ].tab + '" /></td>';
                    tmp += '</tr>';
                } else if ( 'p' == gNode.editor[ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '"><p id="Editor-' + gNode.editor[ i ].tab + '" >' + gNode.editor[ i ].note + '</p></td>';
                    tmp += '</tr>';
                } else {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gNode.editor[ i ].align[ 0 ] + '" style="width: ' + gNode.editor[ i ].wiz + '">' + gNode.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + gNode.editor[ i ].align[ 1 ] + '"><select id="Editor-' + gNode.editor[ i ].tab + '"></select></td>';
                    tmp += '</tr>';

                    for (var j=0, jlen=gNode.editor[ i ].option.length; j<jlen; j++)
                    {
                        if (gNode.editor[ i ].option[ j ].col) {
                            for (var k=0, klen=gNode.editor[ i ].option[ j ].col.length; k<klen; k++)
                            {
                                if ( 'p' == gNode.editor[ i ].option[ j ].col[ k ].tag ) {
                                    tmp += '<tr class="Editor-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].option[ j ].tab + '">';
                                    tmp += '<td class="alignRight">' + gNode.editor[ i ].option[ j ].col[ k ].label + '</td>';
                                    tmp += '<td class="alignLeft" >';
                                    tmp += '<select id="Editor-' + gNode.editor[ i ].option[ j ].col[ k ].col[ 0 ].tab + '"></select>';
                                    tmp += ' : ';
                                    tmp += '<select id="Editor-' + gNode.editor[ i ].option[ j ].col[ k ].col[ 1 ].tab + '"></select>';
                                    tmp += '&nbsp;' + gNode.editor[ i ].option[ j ].col[ k ].note;
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                } else {
                                    tmp += '<tr class="Editor-' + gNode.editor[ i ].tab + '-' + gNode.editor[ i ].option[ j ].tab + '">';
                                    tmp += '<td></td>';
                                    tmp += '<td class="alignLeft" >';
                                    tmp += '<input type="checkbox" id="Editor-' + gNode.editor[ i ].option[ j ].col[ k ].tab + '" value="' + gNode.editor[ i ].option[ j ].col[ k ].val + '" />&nbsp;<label for="Editor-' + gNode.editor[ i ].option[ j ].col[ k ].tab + '">' + gNode.editor[ i ].option[ j ].col[ k ].label + '</label>';
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }
                            }
                        }
                    }
                }
            }

            $('#Editor-table-' + tar.pid).append(tmp);
    
            $('#Editor-days').change( function() {
               if (0 === parseInt($(this).val())) {
                   $('.Editor-days-1').hide();
               } else {
                   $('.Editor-days-1').show();
               }
            });
    
            $('#Editor-times').change( function() {
               if (0 === parseInt($(this).val())) {
                   $('.Editor-times-1').hide();
               } else {
                   $('.Editor-times-1').show();
               }
            });
    
            $('#Editor-name').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name );
            $('#Editor-days').append( genSelectOption( 'Editor-days' ) );
            $('#Editor-times').append( genSelectOption( 'Editor-times' ) );
            $('#Editor-startHour').append( genSelectOption( 'Editor-startHour' ) ); 
            $('#Editor-startMin').append( genSelectOption( 'Editor-startMin' ) ); 
            $('#Editor-endHour').append( genSelectOption( 'Editor-endHour' ) ); 
            $('#Editor-endMin').append( genSelectOption( 'Editor-endMin' ) ); 
    
            var arr = [];
            switch( parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].type ) )
            {
            case 1:
                $('#Editor-days').val(0).trigger('change');
                $('#Editor-times').val(0).trigger('change');
                break;
            case 2:
                $('#Editor-days').val(0).trigger('change');
                $('#Editor-times').val(1).trigger('change');
                $('#Editor-startHour').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startHour );
                $('#Editor-startMin').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startMin );
                $('#Editor-endHour').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endHour );
                $('#Editor-endMin').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endMin );
                break;
            case 3:
                $('#Editor-days').val(1).trigger('change');
                $('#Editor-times').val(0).trigger('change');
    
                if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day ) > 0) {
                    var day = gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day;
                    for (var j=0; j<7; j++)
                    {
                        if ( day & 1 ) {
                            $('#Editor-day' +  (Math.pow(2,j))).click(); 
                        }
                        day = day >> 1;
                    }
                }
    
                break;
            case 4:
                $('#Editor-days').val(1).trigger('change');
                $('#Editor-times').val(1).trigger('change');
                $('#Editor-startHour').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startHour );
                $('#Editor-startMin').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startMin );
                $('#Editor-endHour').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endHour );
                $('#Editor-endMin').val( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endMin );
    
                if (parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day ) > 0) {
                    var day = gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day;
                    for (var j=0; j<7; j++)
                    {
                        if ( day & 1 ) {
                            $('#Editor-day' +  (Math.pow(2,j))).click(); 
                        }
                        day = day >> 1;
                    }
                }
                break;
            }
    
            break;
        }
        objectEditor(e, tar.w, tar.h);
    }
    
    function deleteObject(e) {
        var tar = {};
    
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[1];
    
        tar.thisTr = $(e.currentTarget).parents('tr:eq(0)');
        tar.thisNo = tar.thisTr.find('td:eq(0) input:checkbox').val();
    
        gIf.alter = true;

        switch( tar.pid )
        {
        case 'address':
        case 'service':
            tar.tabDisabled = 0;
            if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid > 0 ) {
                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 1;
                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name = "";
            } else {
                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].splice( tar.thisNo, 1 );
                gData[ tar.pid ][ gNode.guiTNum[ tar.pid] ] = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length;
            }

            gObj.tabber.tabs({"disabled": [tar.tabDisabled]});
            break;
        case 'group_address':
        case 'group_service':
            tar.tabDisabled = 1;
            if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid > 0 ) {
                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 1;
                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name = "";
            } else {
                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].splice( tar.thisNo, 1 );
                gData[ tar.pid ][ gNode.guiTNum[ tar.pid] ] = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length;
            }

            gObj.tabber.tabs({"disabled": [tar.tabDisabled]});
            break;
        case 'schedule':
            if ( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid > 0 ) {
                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].action = 1;
                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = "";
            } else {
                gData[ tar.pid ][ gNode.guiT ].splice( tar.thisNo, 1 );
                gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
            }

            break;
        }
        refreshObject(tar.pid);
    }
    
    function removeObject(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        var arr = [];
        var urlPost;
        var urlGet;
        // scan for check
        $('#table-' + tar.pid + ' tr').each(function() {
            tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
            switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
            {
            case true:
                gIf.alter = true;
                switch( tar.pid )
                {
                case 'address':
                case 'service':
                    tar.tabDisabled = 0;
                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 1;
                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name = "";
                    gObj.tabber.tabs({"disabled": [tar.tabDisabled]});
                    break;
                case 'group_address':
                case 'group_service':
                    tar.tabDisabled = 1;
                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 1;
                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name = "";
                    gObj.tabber.tabs({"disabled": [tar.tabDisabled]});
                    break;
                case 'schedule':
                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].action = 1;
                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = "";
                    break;
                }
                break;
            }
        });

        switch( tar.pid )
        {
        case 'address':
        case 'group_address':
        case 'service':
        case 'group_service':
            for (var i=0, len=gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length; i<len; i++) 
            {
                if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ].gid < 0 && gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ].name == "" ) 
                    continue;
                arr.push( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ i ] );
            }

            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ] = arr;
            gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ] = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length;
            break;
        case 'schedule':
            for (var i=0, len=gData[ tar.pid ][ gNode.guiT ].length; i<len; i++) 
            {
                if ( gData[ tar.pid ][ gNode.guiT ][ i ].gid < 0 && gData[ tar.pid ][ gNode.guiT ][ i ].name == "" ) 
                    continue;
                arr.push( gData[ tar.pid ][ gNode.guiT ][ i ] );
            }

            gData[ tar.pid ][ gNode.guiT ] = arr;
            gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
            break;
        }
        refreshObject(tar.pid);
    }
    
    function objectEditor( e, w, h ) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[1];
    
        if (gObj.active.h5Index == 'NA') {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ((gNode.tabs)? ' > ' + gNode.tabs[ tar.pid ] : '');
        }else {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].label + ((gNode.tabs)? ' > ' + gNode.tabs[ tar.pid ] : '');
        }
    
        gPop.popForm = $('#popForm').dialog({
            width: w || 800,
            height: h || 600,
            position: "center",
            resizable: false,
            modal: true,
            title: tar.title + ' > ' + gTerm[ gObj.lang ][ tar.type ],
            buttons: {
                OK: function() {
                    if (objectChecker(e)) {
                        gIf.alter = true;
                        var arr = [];
                        switch( tar.pid )
                        {
                        case 'address':
                            if (tar.type == 'Create' || tar.type == 'Duplicate') {
                                gCache.address_gid--;
                                tar.thisNo = gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ];
                                gData[ tar.pid ][ gNode.guiMACTNum[ tar.pid ] ]++;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ] = $.extend({}, gTmpl[ tar.pid ]);
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid = gCache.address_gid;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].userDefined = 1;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 0;
                                gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ] = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length;
                            } else {
                                tar.thisNo  = tar.id.split(gReg.isDash)[2];
                                if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid > 0 )
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 1;
                            }
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name = $('#Editor-name').val();
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].type = $('#Editor-type').val();
    
                            switch(parseInt( $('#Editor-type').val() ))
                            {
                            case 1:
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].startIp = $('#Editor-type-1-startIp').val();
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].endIp = $('#Editor-type-1-startIp').val();
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].netmask = '255.255.255.255';
                                break;
                            case 2:
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].startIp = gObj.calc.startIp;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].endIp = gObj.calc.endIp;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].netmask = $('#Editor-type-2-netmask').val();
                                break;
                            case 3:
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].startIp = $('#Editor-type-3-startIp').val();
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].endIp = $('#Editor-type-3-endIp').val();
                                break;
                            case 4:
                                if (gReg.isCMAC.test( $('#Editor-type-4-mac').val() )) {
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mac = $('#Editor-type-4-macInput').val();
                                } else {
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].mac = $('#Editor-type-4-mac').val();
                                }
                                break;
                            }
                            tar.tabDisabled = 0;
                            gObj.tabber.tabs({"disabled": [tar.tabDisabled]});
                            break;
                        case 'group_address':
                            if (tar.type == 'Create' || tar.type == 'Duplicate') {
                                gCache.group_address_gid--;
                                tar.thisNo = gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ];
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ] = $.extend({}, gTmpl[ tar.pid ]);
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid = gCache.group_address_gid;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].userDefined = 1;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 0;
                                gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ] = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length;
                            } else {
                                tar.thisNo  = tar.id.split(gReg.isDash)[2];
                                if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid > 0 )
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 1;
                            }
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name = $('#Editor-name').val();
                            $('#pick option').each(function() {
                                arr.push($(this).val());
                            });
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].num = arr.length;
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].idList = arr.join(';');
                            tar.tabDisabled = 1;
                            gObj.tabber.tabs({"disabled": [tar.tabDisabled]});
                            break;
                        case 'group_service':
                            if (tar.type == 'Create' || tar.type == 'Duplicate') {
                                gCache.group_service_gid--;
                                tar.thisNo = gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ];
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ] = $.extend({}, gTmpl[ tar.pid ]);
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid = gCache.group_service_gid;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].userDefined = 1;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 0;
                                gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ] = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length;
                            } else {
                                tar.thisNo  = tar.id.split(gReg.isDash)[2];
                                if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid > 0 )
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 1;
                            }
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name = $('#Editor-name').val();
                            $('#pick option').each(function() {
                                arr.push($(this).val());
                            });
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].num = arr.length;
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].idList = arr.join(';');
                            tar.tabDisabled = 1;
                            gObj.tabber.tabs({"disabled": [tar.tabDisabled]});
                            break;
                        case 'service':
                            if (tar.type == 'Create' || tar.type == 'Duplicate') {
                                gCache.service_gid--;
                                tar.thisNo = gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ];
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ] = $.extend({}, gTmpl[ tar.pid ]);
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid = gCache.service_gid;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].userDefined = 1;
                                gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 0;
                                gData[ tar.pid ][ gNode.guiTNum[ tar.pid ] ] = gData[ tar.pid ][ gNode.guiT[ tar.pid ] ].length;
                            } else {
                                tar.thisNo  = tar.id.split(gReg.isDash)[2];
                                if ( gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].gid > 0 )
                                    gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].action = 1;
                            }
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].name = $('#Editor-name').val();
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].type = $('#Editor-type').val();
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].param1 = $('#Editor-type-' + $('#Editor-type').val() + '-param1').val();
                            gData[ tar.pid ][ gNode.guiT[ tar.pid ] ][ tar.thisNo ].param2 = $('#Editor-type-' + $('#Editor-type').val() + '-param2').val();
                            tar.tabDisabled = 0;
                            gObj.tabber.tabs({"disabled": [tar.tabDisabled]});
                            break;
                        case 'schedule':
                            if (tar.type == 'Create' || tar.type == 'Duplicate') {
                                gCache.schedule_gid--;
                                tar.thisNo = gData[ tar.pid ][ gNode.guiTNum ];
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ] = $.extend({}, gTmpl[ tar.pid ]);
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid = gCache.schedule_gid;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].userDefined = 1;
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].action = 0;
                                gData[ tar.pid ][ gNode.guiTNum ] = gData[ tar.pid ][ gNode.guiT ].length;
                            } else {
                                tar.thisNo  = tar.id.split(gReg.isDash)[2];
                                if ( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].gid > 0) 
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].action = 1;
                            }

                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].name = $('#Editor-name').val();
    
                            if (1 === parseInt( $('#Editor-days').val() )) {
                                if (1 === parseInt( $('#Editor-times').val() )) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].type = 4;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startHour = $('#Editor-startHour').val();
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startMin = $('#Editor-startMin').val();
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endHour = $('#Editor-endHour').val();
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endMin = $('#Editor-endMin').val();
                                } else {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].type = 3;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startHour = 0;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startMin = 0;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endHour = 23;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endMin = 59;
                                } 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day = 0;
                                for (var x in gRef.schedule.day)
                                { 
                                    if ($('#Editor-day' + x ).is(':checked'))  {
                                        gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day += parseInt(x);
                                    }
                                } 
                            } else {
                                if (1 === parseInt( $('#Editor-times').val() )) {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].type = 2;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startHour = $('#Editor-startHour').val();
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startMin = $('#Editor-startMin').val();
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endHour = $('#Editor-endHour').val();
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endMin = $('#Editor-endMin').val();
                                } else {
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].type = 1;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startHour = 0;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].startMin = 0;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endHour = 23;
                                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].endMin = 59;
                                } 
                                gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].day = 0;
                            }
                            break;
                        }
                        gPop.popForm.dialog("close");
                        refreshObject(tar.pid);
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });
        gObj.tab = $('.tabs').tabs();
    }
    
    function objectChecker( e, pid ) {
        var tar = {};
        if (pid) {
            tar.pid = pid;
            tar.type = 'Save';
        }else {
            tar.id = $(e.currentTarget).attr('id');
            if (!tar.id)
                return false;
            tar.type  = tar.id.split(gReg.isDash)[0];
    
            tar.pid  = tar.id.split(gReg.isDash)[1];
    
            if (tar.type == 'Create' || 'Duplicate')
                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
            else
                tar.thisNo = tar.id.split(gReg.isDash)[2];
        }
        var arr = [];
        var msg = '';
        var pass = true;
        gObj.calc = {};

        if (!gReg.ascii.default.test( $('#Editor-name').val() )) {
            pass = false;
            msg += '<p>' + gError[ gObj.lang ].name63 + '</p>';
        }

        switch( tar.pid )
        {
        case 'address':
            switch( parseInt( $('#Editor-type').val() ) )
            {
            case 1:
                if (!gReg.isIPv4.test( $('#Editor-type-' + $('#Editor-type').val() + '-startIp').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ip + '</p>';
                }
                break;
            case 2:
                if (!gReg.isIPv4.test( $('#Editor-type-' + $('#Editor-type').val() + '-startIp').val() ) ) { 
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipStart + '</p>';
                }
                if (!gReg.isIPv4.test( $('#Editor-type-' + $('#Editor-type').val() + '-netmask').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].netmask + '</p>';
                }
    
                if (pass) {
                    arr = $('#Editor-type-' + $('#Editor-type').val() + '-startIp').val().split('\.');
                    for (var i=0; i<arr.length; i++)
                    {
                        gObj.calc[ "ip_" + (i+1) ] = parseInt( arr[ i ] );
                    }
                    arr = $('#Editor-type-' + $('#Editor-type').val() + '-netmask').val().split('\.');
                    for (var i=0; i<arr.length; i++)
                    {
                        gObj.calc[ "snm_" + (i+1) ] = parseInt( arr[ i ] );
                    }
                    calcNWbits(gObj.calc);
    
                    if (gObj.calc.result == 'invalid') {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                    } else {
                        gObj.calc.bits = gObj.calc.result;
                        calcNBFL(gObj.calc);
    
                        switch( gObj.calc.numofaddr )
                        {
                        case 'ERR':
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                            break;
                        case 'one':
                        case 'two':
                            gObj.calc.startIp = gObj.calc.firstadr_1 + '.' + gObj.calc.firstadr_2 + '.' + gObj.calc.firstadr_3 + '.' + gObj.calc.firstadr_4;
                            gObj.calc.endIp = gObj.calc.lastadr1 + '.' + gObj.calc.lastadr_2 + '.' + gObj.calc.lastadr_3 + '.' + gObj.calc.lastadr_4;
                            break;
                        default: 
                            gObj.calc.startIp = gObj.calc.nwadr_1 + '.' + gObj.calc.nwadr_2 + '.' + gObj.calc.nwadr_3 + '.' + gObj.calc.nwadr_4;
                            gObj.calc.endIp = gObj.calc.bcast_1 + '.' + gObj.calc.bcast_2 + '.' + gObj.calc.bcast_3 + '.' + gObj.calc.bcast_4;
                        }
                    }
                }
                break;
            case 3:
                if (!gReg.isIPv4.test( $('#Editor-type-' + $('#Editor-type').val() + '-startIp').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipStart + '</p>';
                }
                if (!gReg.isIPv4.test( $('#Editor-type-' + $('#Editor-type').val() + '-endIp').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipEnd + '</p>';
                }
    
                if (pass) {
                    if (! ipv4Compare( $('#Editor-type-' + $('#Editor-type').val() + '-startIp').val(), $('#Editor-type-' + $('#Editor-type').val() + '-endIp').val() ) ) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].ipRange + '</p>';
                    }
                }
                break;
            case 4:
                if (!gReg.isMAC.test( $('#Editor-type-' + $('#Editor-type').val() + '-mac').val() ) ) {
                    if (gReg.isCMAC.test( $('#Editor-type-' + $('#Editor-type').val() + '-mac').val() )) {
                        if (!gReg.isMAC.test( $('#Editor-type-' + $('#Editor-type').val() + '-macInput').val() ) ) {
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].macAddr + '</p>';
                        }
                    } else {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].macAddr + '</p>';
                    }
                }
                break;
            }
            break;
        case 'group_address':
            break;
        case 'service':
            break;
        case 'group_service':
            break;
        case 'schedule':
            break;
        }
    
        if (!pass) {
            errorAlert( msg );
        }
        return pass;
    }
    
    function saveObject(pid) {
        var sum = 0;
        var cnt = 0;
        switch( pid ) 
        {
        case 'address':
        case 'service':
            for (var i=0, len=parseInt( gData[ pid ][ gNode.guiTNum[ pid ] ] ); i<len; i++)
            {
                if ( !isNaN( parseInt( gData[ pid ][ gNode.guiT[ pid ] ][ i ].action ) ) ) {
                    cnt++;
                    if ( 0 === gData[ pid ][ gNode.guiT[ pid ] ][ i ].action )
                        gData[ pid ][ gNode.guiT[ pid ] ][ i ].gid = 0;
                    $.post('cgi-bin/' + gNode.url.post[ pid ] + '.cgi', gY.JSON.stringify( gData[ pid ][ gNode.guiT[ pid ] ][ i ] ), function( poster ) {
                        sum++;
                        if (sum == cnt) {
                            $.ajax({
                                url: 'cgi-bin/' + gNode.url.get[ pid ] + '.' + gNode.ext,
                                dataType: 'json',
                                success: function(data) {
                                    gData[ pid ] = data;
                                    refreshObject( pid );
                                }
                            });
                            $.ajax({
                                url: 'cgi-bin/' + gNode.url.get[ 'group_' + pid ] + '.' + gNode.ext,
                                dataType: 'json',
                                success: function(data) {
                                    gData[ 'group_' + pid ] = data;
                                    refreshObject( 'group_' + pid );
                                }
                            });
                            gObj.tabber.tabs("enable", 0);
                            gIf.alter = false;
                        }
                    });
                }
            }
            break;
        case 'group_address':
        case 'group_service':
            for (var i=0, len=parseInt( gData[ pid ][ gNode.guiTNum[ pid ] ] ); i<len; i++)
            {
                if ( !isNaN( parseInt( gData[ pid ][ gNode.guiT[ pid ] ][ i ].action ) ) ) {
                    cnt++;
                    if ( 0 === gData[ pid ][ gNode.guiT[ pid ] ][ i ].action )
                        gData[ pid ][ gNode.guiT[ pid ] ][ i ].gid = 0;
                    $.post('cgi-bin/' + gNode.url.post[ pid ] + '.cgi', gY.JSON.stringify( gData[ pid ][ gNode.guiT[ pid ] ][ i ] ), function( poster ) {
                        sum++;
                        if (sum == cnt) {
                            $.ajax({
                                url: 'cgi-bin/' + gNode.url.get[ pid ] + '.' + gNode.ext,
                                dataType: 'json',
                                success: function(data) {
                                    gData[ pid ] = data;
                                    refreshObject( pid );
                                }
                            });
                            $.ajax({
                                url: 'cgi-bin/' + gNode.url.get[ pid.replace('group_','') ] + '.' + gNode.ext,
                                dataType: 'json',
                                success: function(data) {
                                    gData[ pid.replace('group_','') ] = data;
                                    refreshObject( pid.replace('group_','') );
                                }
                            });
                            gObj.tabber.tabs("enable", 1);
                            gIf.alter = false;
                        }
                    });
                }
            }
            break;
        case 'schedule':
            for (var i=0, len=parseInt( gData[ pid ][ gNode.guiTNum ] ); i<len; i++)
            {
                if ( !isNaN( parseInt( gData[ pid ][ gNode.guiT ][ i ].action ) ) ) {
                    cnt++;
                    if ( 0 === gData[ pid ][ gNode.guiT ][ i ].action )
                        gData[ pid ][ gNode.guiT ][ i ].gid = 0;
                    $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify( gData[ pid ][ gNode.guiT ][ i ] ), function( poster ) {
                        sum++;

                        if (sum == cnt) {
                            $.ajax({
                                url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                                dataType: 'json',
                                success: function(data) {
                                    gData[ pid ] = data;
                                    gIf.alter = false;
                                    refreshObject( pid );
                                }
                            });
                        }
                    });
                }
            }
            break;
        }
    }
    
    function genDevice(pid) {
        var tmp = '';
    
        switch(gNode.ext)
        {
        case 'cgi':
            switch(gNode.tag)
            {
            case 'table':
                switch( pid )
                {
                case 'backup_restore':
                    gCheckbox.backup_restore = {};
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div id="div-' + pid + '"></div></div>');
                    tmp = '<table id="table-' + pid + '">';
                    tmp += '<thead>';
                    tmp += '<tr>';
                    for (var i=0, len=gNode.col.length; i<len; i++)
                    {
                        tmp += '<th class="ui-state-default" style="width: ' + gNode.col[ i ].wiz + '">';
                        if ('checkbox' == gNode.col[ i ].tab) 
                            tmp += '<input type="checkbox" id="' + pid + '_all" value="1" />';
                        else
                            tmp += gNode.col[ i ].label;
                        tmp += '</th>';
                    }
                    tmp += '</tr>';
                    tmp += '</thead>';
                    tmp += '<tbody>';
                    tmp += '</tbody>';
                    tmp += '</table>';
                    $('#div-' + pid).append( tmp );

                    $.ajax({
                        url: 'cgi-bin/' + gNode.url.get + '.cgi',
                        dataType: 'json',
                        success: function(data) {
                            gData[ pid ] = data;
                            gCache[ pid ] = {};
                            gCache[ pid ].gid = 0;
                            var acts = gNode.rowAction.split(' ');

                            // lazy sorting ...
                            data.guiProfileT.sort( function( obj1, obj2 ) {
                                return obj2.inUsed - obj1.inUsed;
                            });

                            data.guiProfileT.sort( function( obj1, obj2 ) {
                                return obj1.userDefined - obj2.userDefined;
                            });

                            for (var i=0, len=parseInt( data[ gNode.guiTNum ] ); i<len; i++)
                            {
                                tmp = '<tr id="tr-' + pid + '-' + i + '" class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                if ( 0 === parseInt(data[ gNode.guiT ][ i ].userDefined ) ) {
                                    for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                                    {
                                        tmp += '<td>';
                                        if ('action' == gNode.col[ j ].tab) {
                                                tmp += '<button type="button" id="Export-' + pid + '-' + i + '" class="Export" title="Export"><span class="ui-icon"></span></button>';
                                        } else if ('checkbox' == gNode.col[ j ].tab) {
                                            tmp += '';
                                        } else if ('index' == gNode.col[ j ].tab) {
                                            tmp += (i+1);
                                        } else {
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                        }
                                        tmp += '</td>';
                                    }
                                    tmp += '</tr>';
                                    $('#table-' + pid + ' tbody').append( tmp );
                                } else if ( 1 === parseInt(data[ gNode.guiT ][ i ].inUsed ) ) {
                                    for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                                    {
                                        tmp += '<td>';
                                        if ('action' == gNode.col[ j ].tab) {
                                            tmp += '<button type="button" id="Apply-' + pid + '-' + i + '" class="Apply" title="Apply"><span class="ui-icon"></span></button>';
                                            tmp += '<button type="button" id="Import-' + pid + '-' + i + '" class="Import" title="Import"><span class="ui-icon"></span></button>';
                                            tmp += '<button type="button" id="Export-' + pid + '-' + i + '" class="Export" title="Export"><span class="ui-icon"></span></button>';
                                            tmp += '<button type="button" id="Delete-' + pid + '-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                                        } else if ('checkbox' == gNode.col[ j ].tab) {
                                            tmp += '';
                                        } else if ('index' == gNode.col[ j ].tab) {
                                            tmp += (i+1);
                                        } else {
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                        }
                                        tmp += '</td>';
                                    }
                                    tmp += '</tr>';
                                    $('#table-' + pid + ' tbody').append( tmp );
                                    $('#Apply-' + pid + '-' + i).prop('disabled', true);
                                    $('#Import-' + pid + '-' + i).prop('disabled', true);
                                    $('#Delete-' + pid + '-' + i).prop('disabled', true);
                                } else {
                                    for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                                    {
                                        tmp += '<td>';
                                        if ('action' == gNode.col[ j ].tab) {
                                            tmp += '<button type="button" id="Apply-' + pid + '-' + i + '" class="Apply" title="Apply"><span class="ui-icon"></span></button>';
                                            tmp += '<button type="button" id="Import-' + pid + '-' + i + '" class="Import" title="Import"><span class="ui-icon"></span></button>';
                                            tmp += '<button type="button" id="Export-' + pid + '-' + i + '" class="Export" title="Export"><span class="ui-icon"></span></button>';
                                            tmp += '<button type="button" id="Delete-' + pid + '-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                                        } else if ('checkbox' == gNode.col[ j ].tab) {
                                            tmp += '<input type="checkbox" class="' + pid + 'Checkbox" id="' + pid + '-' + i + '" value="' + i + '" />';
                                        } else if ('index' == gNode.col[ j ].tab) {
                                            tmp += (i+1);
                                        } else {
                                            tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                        }
                                        tmp += '</td>';
                                    }
                                    tmp += '</tr>';
                                    $('#table-' + pid + ' tbody').append( tmp );
                                }
                            }
                            
                            if (gIf.power) {
                                genTblAction( pid );
                                if (data[ gNode.guiTNum ] >= gRows.maxProfile) {
                                    $('#Create-' + pid).prop('disabled', true);
                                    $('#Import-' + pid).prop('disabled', true);
                                }
                            } else {
                                $('#div-' + pid + ' button').prop('disabled', true);
                            }
                        }
                    });
                    break;
                case 'packet_capture':
                    gCheckbox.packet_capture = {};
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div id="div-' + pid + '"></div></div>');
                    tmp = '<table id="table-' + gNode.tab + '">';
                    tmp += '<thead>';
                    tmp += '<tr>';
                    for (var i=0, len=gNode.col.length; i<len; i++)
                    {
                        tmp += '<th class="ui-state-default" style="width: ' + gNode.col[ i ].wiz + '">';
                        if ('checkbox' == gNode.col[ i ].tab)
                            tmp += '<input type="checkbox" id="' + pid + '_all" value="1" />';
                        else
                            tmp += gNode.col[ i ].label;
                        tmp += '</th>';
                    }
                    tmp += '</tr>';
                    tmp += '</thead>';
                    tmp += '<tbody>';
                    tmp += '</tbody>';
                    tmp += '</table>';

                    $('#div-' + gNode.tab).append( tmp );

                    $.ajax({
                        url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                        dataType: 'json',
                        success: function(data) {
                            gData[ pid ] = data;
                            for (var i=0, len=data[ gNode.guiTNum ]; i<len; i++)
                            {
                                tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                for (var j=0, jlen=gNode.col.length; j<jlen; j++)
                                {
                                    tmp += '<td>';
                                    if ('action' == gNode.col[ j ].tab) {
                                        tmp += '<button type="button" id="Download-' + gNode.tab + '-' + i + '" class="Download" title="Download"><span class="ui-icon"></span></button>';
                                        tmp += '<button type="button" id="Delete-' + gNode.tab + '-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                                    } else if ('checkbox' == gNode.col[ j ].tab) {
                                        tmp += '<input type="checkbox" id="' + pid + '-' + i + '" class="' + pid + 'Checkbox" value="' + i + '" />';
                                    } else if ('index' == gNode.col[ j ].tab) {
                                        tmp += (i+1);
                                    } else {
                                        tmp += data[ gNode.guiT ][ i ][ gNode.col[ j ].tab ];
                                    }
                                    tmp += '</td>';
                                }
                                tmp += '</tr>';
                                $('#table-' + gNode.tab + ' tbody').append( tmp );
                            }

                            if (gIf.power) {
                                genTblAction( gNode.tab );
                                if ( data[ gNode.guiTNum ] >= gLimit[ gNode.url.get ].rows ) {
                                    $('#New-' + gNode.tab).prop('disabled', true);
                                }

                                $.ajax({
                                    url: 'cgi-bin/' + gNode.url.check + '.' + gNode.ext,
                                    dataType: 'json',
                                    success: function(data) {
                                        if ( parseInt( data.diskUsage ) >= 90 ) {
                                            $('#New-' + gNode.tab).prop('disabled', true);
                                        }
                                    }
                                }).done( function() {
                                    // check if still capturing
                                    $.ajax({
                                        url: 'cgi-bin/' + gNode.url.capture + '.' + gNode.ext,
                                        dataType: 'json',
                                        success: function(data) {
                                            if ('start' == data.action)
                                                btnNew( data );
                                            else {
                                                // check if advanced debugging
                                                $.ajax({
                                                    url: 'cgi-bin/' + gNode.url.checkPcap + '.' + gNode.ext,
                                                    dataType: 'json',
                                                    success: function(data) {
                                                        if (1 === parseInt( data.pcapEnable )) {
                                                            errorAlert('<p>' + gError[ gObj.lang ].advancedDebugging + '</p>');
                                                            $('#New-' + gNode.tab).prop('disabled', true);
                                                        }
                                                    }
                                                });
                                            }
                                        }
                                    });
                                })
                            } else {
                                $('#div-' + gNode.tab + ' button').prop('disabled', true);
                                $('#div-' + gNode.tab + ' input').prop('disabled', true);
                            }
                        }
                    });
                    break;
                }
                break;
            case 'div':
                switch(gNode.type)
                {
                case 'buttons':
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div id="div-' + pid + '"></div></div>');
                    for (var i=0, len=gNode.col.length; i<len; i++)
                    {
                        tmp = '<div id="div-' + gNode.col[ i ].tab + '">';
                        if ( 'radio' == gNode.col[ i ].type ) {
                            gIf.radio = true;
                            gObj.radio = gNode.col[ i ].tab;
                            tmp += '<ul>';
                            for (var x in gNode.col[ i ].option)
                            {
                                tmp += '<li><input type="radio" name="resetMode" id="resetMode-' + x + '" value="' + x + '" /><label for="resetMode-' + x + '"> ' + gNode.col[ i ].option[ x ].label + ' </label></li>'; 
                            }
                            tmp += '</ul>';
                            tmp += '<button class="yui3-button" id="' + gNode.col[ i ].tab + '" title="' + gNode.col[ i ].label + '" >' + gNode.col[ i ].label + '</button>';
                        } else {
                            tmp += '<button class="yui3-button" id="' + gNode.col[ i ].tab + '" title="' + gNode.col[ i ].label + '" >' + gNode.col[ i ].label + '</button>';
                        }
                        tmp += '</div>';
                        $('#div-' + pid).append(tmp);

                        $('#' + gNode.col[ i ].tab).bind('click', function(e) {
                            cmdAlert( $(this).attr('id') ); 
                        });

                        if (!gIf.power) {
                            $('#' + gNode.col[ i ].tab).prop('disabled', true);
                        }
                    }

                    if ( gIf.radio ) {
                        $('input[name="' + gObj.radio + 'Mode"]').eq(0).trigger('click'); 
                    }

                    if (!gIf.power) {
                        $('#div-' + gNode.tab + ' button').prop('disabled', true);
                        $('#div-' + gNode.tab + ' input').prop('disabled', true);
                    }
                    break;
                case 'tables':
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div id="div-' + pid + '"></div></div>');
                    if (gIf.power) {
                        $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                        gY.one('#pgSave').on('click', function(e) {
                            saveDevice(pid);
                        });
                    }
    
                    $.ajax({
                        url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                        dataType: 'json',
                        success: function(data) {
                            gData[ pid ] = data;
                            switch( pid )
                            {
                            case 'management_settings': 
                                var hasDiv = false;
                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    if ('input' == gNode.col[ i ].tag) {
                                        if ( hasDiv ) {
                                            hasDiv = false;
                                            tmp += '<tr>';
                                            tmp += '<th class="align' + gNode.col[ i ].align[ 0 ] + '" style="width: ' + gNode.col[ i ].wiz + '">';
                                            tmp += '<label for="' + gNode.col[ i ].tab + '">' + gNode.col[ i ].label + '</label>';
                                            tmp += '</th>';
                                            tmp += '<td>';
                                            tmp += '<input type="text" id="' + gNode.col[ i ].tab + '" size="' + gNode.col[ i ].size + '" />&nbsp' + gNode.col[ i ].note;
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                            tmp += '</table>'; 
                                            tmp += '</div>'; 
                                        } else { 
                                            hasDiv = true;
                                            tmp += '<div id="div-listen_port">';
                                            tmp += '<table id="table-listen_port">';
                                            tmp += '<tr>';
                                            tmp += '<th class="align' + gNode.col[ i ].align[ 0 ] + '" style="width: ' + gNode.col[ i ].wiz + '">';
                                            tmp += '<label for="' + gNode.col[ i ].tab + '">' + gNode.col[ i ].label + '</label>';
                                            tmp += '</th>';
                                            tmp += '<td>';
                                            tmp += '<input type="text" id="' + gNode.col[ i ].tab + '" size="' + gNode.col[ i ].size + '" />&nbsp' + gNode.col[ i ].note;
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                        } 
                                    } else {
                                        tmp += '<div id="div-management_setting">';
                                        tmp += '<table id="table-management_setting">';
                                        tmp += '<thead>';
                                        tmp += '<tr>';
                                        for (var j=0, jlen=gNode.col[ i ].col.length; j<jlen; j++)
                                        {
                                            tmp += '<th id="' + gNode.col[ i ].col[ j ].tab + '" class="ui-state-default align' + gNode.col[ i ].col[ j ].align[ 0 ] + '" style="width: ' + gNode.col[ i ].col[ j ].wiz + '">';
                                            if (gNode.col[ i ].col[ j ].sortable) {
                                                tmp += '<div id="div-' + gNode.tab + '-' + gNode.col[ i ].col[ j ].tab + '" class="sortable">' + gNode.col[ i ].col[ j ].label + '<span id="span-' + gNode.tab + '-' + gNode.col[ i ].col[ j ].tab + '" class="sortable" ></span></div>';
                                            } else {
                                                tmp += gNode.col[ i ].col[ j ].label;
                                            }
                                            tmp += '</th>';
                                        }
                                        tmp += '</tr>';
                                        tmp += '</thead>';
                                        tmp += '</table>'; 
                                        tmp += '</div>'; 
                                    } 
                                }
    
                                $('#div-management_settings').html( tmp );
    
                                $('#httpsPort').val( data.httpsPort );
                                $('#sshPort').val( data.sshPort );
                                if (!gIf.power) {
                                    $('#httpsPort').val( data.httpsPort );
                                    $('#sshPort').val( data.sshPort );
                                }
                                var tableID = '#table-management_setting';
                                var cgiT    = 'guiManagementInterfaceT';
                                var cgiTNum = 'guiManagementInterfaceTNum';
                                var tableBD = tableID + ' > tbody';
                                $(tableID).append('<tbody>');
    
                                for (var i=0, len=parseInt(data[ cgiTNum ]); i<len; i++)
                                {
                                    tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                    $(tableID + ' tr th').each(function(index) {
                                        // each col
                                        var thID = $(this).attr('id');
                                        tmp += '<td id="' + thID + '-' + i + '">';
                                        switch(thID)
                                        {
                                        case 'action':
                                            if (gIf.power) {
                                                tmp += '<button id="Edit-' + pid + '-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                                            } else {
                                                tmp += '';
                                            }
                                            break;
                                        case 'interfaceId':
                                            tmp += gCache.name[ parseInt(data[ gNode.guiT ][ i ][ thID ]) ];
                                            break;
                                        case 'accessAddressId':
                                            tmp += (parseInt( data[ gNode.guiT ][i][thID] ) == 0)? gTerm[ gObj.lang ].Any : gCache.address[ parseInt(data[ gNode.guiT ][ i ][ thID ]) ];
                                            break;
                                        default:
                                            tmp += gRef[ gNode.url.get ].enabled[ data[ gNode.guiT ][ i ][ thID ] ];
                                        }
                                        tmp += '</td>';
                                    });
                                    tmp += '</tr>';
                                    $(tableBD).append(tmp);
                                }
                                break;
                            }
                        }
                    });
                    break;
                case 'submit':
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div id="div-' + pid + '"></div></div>');
    
                    switch( pid )
                    {
                    case 'firmware':
                        for (var i=0, len=gNode.col.length; i<len; i++)
                        {
                            tmp += '<div id="div-' + gNode.col[ i ].tab + '" class="tableDiv">';
                            tmp += '<table id="table-' + gNode.col[ i ].tab + '">';
                            tmp += '<caption>' + gNode.col[ i ].label + '</caption>';
                            for (var j=0, jlen=gNode.col[ i ].col.length; j<jlen; j++)
                            {
                                switch( gNode.col[ i ].col[ j ].tag ) 
                                {
                                case 'button':
			            tmp += '<tr>';
			            tmp += '<td class="alignLeft" style="width: ' + gNode.col[ i ].col[ j ].wiz + '">';
			            tmp += gNode.col[ i ].col[ j ].label;
			            tmp += '</td>';
			            tmp += '<td class="alignLeft">';
			            tmp += '<button type="button" id="' + gNode.col[ i ].col[ j ].tab + '" class="yui3-button">' + gNode.col[ i ].col[ j ].label + '</button>';
			            tmp += '</td>';
			            tmp += '</tr>';
			            break;
                                case 'buttons':
			            tmp += '<tr>';
			            for (var x in gNode.col[ i ].col[ j ].buttons)
			            {
			                if (gNode.col[ i ].col[ j ].buttons[ x ].colspan) {
			                    tmp += '<td colspan="' + gNode.col[ i ].col[ j ].buttons[ x ].colspan + '" class="alignLeft">';
			                } else {
			                    tmp += '<td class="alignLeft" style="width: ' + gNode.col[ i ].col[ j ].wiz + '">';
			                }
			                tmp += '<button type="button" id="' + gNode.col[ i ].col[ j ].buttons[ x ].tab + '" class="yui3-button">' + gNode.col[ i ].col[ j ].buttons[ x ].label + '</button>';
			                tmp += '</td>';
			            }
			            tmp += '</tr>';
			            break;
                                case 'p':
			            tmp += '<tr>';
			            tmp += '<td class="alignLeft" style="width: ' + gNode.col[ i ].col[ j ].wiz + '">';
			            tmp += gNode.col[ i ].col[ j ].label;
			            tmp += '</td>';
			            tmp += '</td>';
			            tmp += '<td class="alignLeft">';
			            tmp += '<p id="' + gNode.col[ i ].col[ j ].tab + '"></p>';
			            tmp += '</td>';
			            tmp += '</tr>';
			            break;
                                case 'input':
                                    for (var x in gNode.col[ i ].col[ j ].option)
                                    {
			                tmp += '<tr>';
			                tmp += '<td class="alignLeft" style="width: ' + gNode.col[ i ].col[ j ].wiz + '">';
			                tmp += '<input type="radio" name="' + gNode.col[ i ].col[ j ].tab + '" id="' + gNode.col[ i ].col[ j ].option[ x ].tab + '" value="' + x + '" />&nbsp;<label for="' + gNode.col[ i ].col[ j ].option[ x ].tab + '">' + gNode.col[ i ].col[ j ].option[ x ].label + '</label>';
			                tmp += '</td>';
                                        switch( parseInt( x ) )
                                        {
                                        case 0:
                                            tmp += '<td class="alignLeft BT160"><div id="selectFileButtonContainer"></div></td>';
                                            tmp += '<td class="alignLeft"><div id="selectFileStatus"></div></td>';
                                            break;
                                        case 1:
                                            tmp += '<td colspan="2" class="alignLeft"></td>';
                                            break;
                                        case 2:
                                            tmp += '<td colspan="2" class="alignLeft"><select id="fpath"></select></td>';
                                            break;
                                        }
			                tmp += '</tr>';
                                    }
			            break;
			        }
			    }
                            tmp += '</table>';
                            tmp += '</div>';
                        }
                        
                        $('#div-firmware').append( tmp );
    
                        $('input[name=type]').change( function() {
                            $('#fpath').prop('disabled', true);
                            $('#upgradeFirmware').prop('disabled', true);
                            $('#resetDefault').prop('disabled', true);
                            switch( parseInt( $(this).val() ) ) 
                            {
                            case 0:
                                if (gIf.uploaded) {
                                    $('#upgradeFirmware').prop('disabled', false);
                                    $('#resetDefault').prop('disabled', false);
                                }
                                break;
                            case 1:
                                $('#upgradeFirmware').prop('disabled', false);
                                $('#resetDefault').prop('disabled', false);
                                break;
                            case 2:
                                $.ajax({
                                    url: 'cgi-bin/common_usbFile_list.cgi',
                                    dataType: 'json',
                                    success: function(data) {
                                        $('#fpath').empty();
                                        $('#fpath').change( function() {
                                            if ( 'NA' == $(this).val() ) {
                                                $('#upgradeFirmware').prop('disabled', true);
                                                $('#resetDefault').prop('disabled', true);
                                            } else {
                                                $('#upgradeFirmware').prop('disabled', false);
                                                $('#resetDefault').prop('disabled', false);
                                            }
                                        });
                                        $('#fpath').append('<option value="NA">Select file from usb</option>');
                                        if (1 === parseInt(data.status)) {
                                            $('#fpath').prop('disabled', false);
                                            for (var i=0, len=data.guiUsbFileT.length; i<len; i++)
                                                $('#fpath').append('<option value="' + data.guiUsbFileT[ i ].path + '">' + data.guiUsbFileT[ i ].name + '</option>');
                                        }
                                    }
                                });
                                break;
                            }
                        });
    
                        $.ajax({
                            url: 'cgi-bin/common_usbFile_list.cgi',
                            dataType: 'json',
                            success: function(data) {
                                $('#fpath').empty();
                                $('#fpath').append('<option value="NA">Select file from usb</option>');
                                $('#fpath').prop('disabled', true);
                                if (1 === parseInt(data.status)) {
                                    $('#type-2').prop('disabled', false);
                                    for (var i=0, len=data.guiUsbFileT.length; i<len; i++)
                                        $('#fpath').append('<option value="' + data.guiUsbFileT[ i ].path + '">' + data.guiUsbFileT[ i ].name + '</option>');
                                }else {
                                    $('#fpath').prop('disabled', true);
                                }
                            }
                        });
    
                        $.ajax({
                            url: 'cgi-bin/' + gNode.url.get + '.cgi',
                            dataType: 'json',
                            success: function(data) {
                                gData[ pid ] = data;
                                $('#primaryVer').html( data.primaryVer );
                                $('#secondaryVer').html( data.secondaryVer );
                                $('#serverVer').html( data.serverVer );
                                $('#lastCheck').html( data.lastCheck );
                
                                $('#upgradeFirmware').prop('disabled', true);
                                $('#resetDefault').prop('disabled', true);
                            }
                        });
                
                        // prepare for firmware uploader 
                        gIf.uploaded = false;
                        gObj.uploader = new gY.Uploader({
                                           width: "100px",
                                           height: "25px",
                                           multipleFiles: false,
                                           fileFieldName: 'binary',
                                           swfURL: "assets/flashuploader.swf?t=" + Math.random(),
                                           uploadURL: "cgi-bin/" + gNode.url.post + ".cgi",
                                           simLimit: 1,
                                           withCredentials: false
                                       }).render("#selectFileButtonContainer");
                        gIf.uploaded = false;
                
                        gObj.uploader.after("fileselect", function (e) {
                            gIf.invalid = false;
                            gObj.uploaderFile = e.fileList[0];
                            gObj.uploaderFile.set('name', 'firmware.img');
                            gY.one("#selectFileStatus").set("text", gObj.uploaderFile.get('name') );
                            $('#upgradeFirmware').prop('disabled', false);
                            $('#resetDefault').prop('disabled', false);
                        });
                
                        gObj.uploader.on("uploadprogress", function (e) {
                            $('.processDiv').progressbar({ value: parseInt( e.percentLoaded ) });
                        });
                
                        gObj.uploader.on("uploadcomplete", function (e) {
                            var json = gY.JSON.parse(e.data);
                            if (parseInt(json.status) == 0) {
                                gIf.uploaded = true;
                                gPop.popError.dialog( "close" );
                                gObj.loading = 99;
                                gIf.loading = true;
                                gIf.reboot = true;
                            } else {
                                loadingToggle( false );
                                gIf.invalid = true;
                                gIf.uploaded = false;
                                $('#upgradeFirmware').prop('disabled', false);
                                $('#resetDefault').prop('disabled', false);
                                $('.errorMsg').html( '<p>' + json.msg + '</p>' );
                            }
                        });
                
                        gY.one('#switchFirmware').on('click', function (e) {
                            rebootAlert(e);
                        });
                
                        gY.one('#checkFirmware').on('click', function (e) {
                            rebootAlert(e);
                        });
                
                        gY.one('#upgradeFirmware').on('click', function (e) {
                            rebootAlert(e);
                        });
    
                        gY.one('#resetDefault').on('click', function (e) {
                            rebootAlert(e);
                        });
                
                        $('#type-0').attr('checked', true);
                        break;
                    case 'dns_lookup':
                    case 'ping':
                    case 'traceroute':
                        tmp = '<table id="table-' + gNode.tab + '">';
                        for (var i=0, len=gNode.col.length; i<len; i++)
                        {
                            tmp += '<tr>';
                            switch (gNode.col[ i ].tag)
                            {
                            case 'input':
                                tmp += '<th class="alignLeft" style="width: 150px">'; 
                                tmp += gNode.col[ i ].label;
                                tmp += '</th>';
                                tmp += '<td class="alignLeft" >'; 
                                tmp += '<input type="text" id="' + gNode.col[ i ].tab + '" />';
                                tmp += '</td>';
                                break;
                            case 'ul':
                                tmp += '<th class="alignLeft" style="width: 150px">'; 
                                tmp += gNode.col[ i ].label;
                                tmp += '</th>';
                                tmp += '<td class="alignLeft" >'; 
                                tmp += '<div class="resultDiv"><ul></ul></div>';
                                tmp += '</td>';
                                break;
                            case 'select':
                                tmp += '<th class="alignLeft" style="width: 150px">'; 
                                tmp += gNode.col[ i ].label;
                                tmp += '</th>';
                                tmp += '<td class="alignLeft" >'; 
                                tmp += '<select id="' + gNode.col[ i ].tab + '" >';
                                for (var x in gNode.col[ i ].option)
                                {
                                    tmp += '<option value="' + gNode.col[ i ].option[ x ] + '">' + gNode.col[ i ].option[ x ] + '</option>';
                                }
                                tmp += '</select>';
                                tmp += '</td>';
                                break;
                            }
                            tmp += '</tr>';
                        }
                        tmp += '</table>';
                        $('#div-' + gNode.tab).append( tmp );

                        if ($('#packetsize').exists()) {
                            $('#packetsize').val(32);
                        }
                        break;
                    }

                    if (gIf.power) {
                        if (gNode.pgAction) {
                            var pgacts = gNode.pgAction.split(' ');
                            for (var i=0, len=pgacts.length; i<len; i++)
                            {
                                $('#main_ft').append( gHtml[ 'pg' + pgacts[ i ] ] );
                            }
                        }
                    } else {
                        $('.templateDiv input').prop('disabled', true);
                        $('.templateDiv button').prop('disabled', true);
                        $('.templateDiv select').prop('disabled', true);
                    }

                    break;
                case 'form':
                    if (gIf.power) {
                        $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                        gY.one('#pgSave').on('click', function(e) {
                            saveDevice(pid);
                        });
                    }
    
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div id="div-' + pid + '"></div></div>');
                    $.ajax({
                        url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                        dataType: 'json',
                        success: function(data) {
                            gData[ pid ] = data;
                            switch( pid )
                            {
                            case 'administrator_settings':
                                tmp = '<div id="div-admin_manage">';
                                tmp += '<table id="table-admin_manage">';
                                tmp += '<caption>' + gNode.col[ 0 ].caption + '</caption>';
                                tmp += '<tr>';
                                tmp += '<td rowspan="2" class="BT100"><img src="css/images/i_64_user_name_00.png" /></td>';
                                tmp += '<td class="alignLeft"><label for="adminName">' + gNode.col[ 0 ].col[ 0 ].label + '</label></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft"><input type="text" id="adminName" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td rowspan="2" class="BT100"><img src="css/images/i_64_current_password_00.png" /></td>';
                                tmp += '<td class="alignLeft"><label for="adminOldPwd">' + gNode.col[ 0 ].col[ 1 ].label + '</label></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft"><input type="password" id="adminOldPwd" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td rowspan="2" class="BT100"></td>';
                                tmp += '<td class="alignLeft"><label for="adminNewPwd">' + gNode.col[ 0 ].col[ 2 ].label + '</label></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft"><input type="password" id="adminNewPwd" /></td>';
                                tmp += '</tr>';
                                tmp += '<td rowspan="2" class="BT100"></td>';
                                tmp += '<td class="alignLeft"><label for="adminNewPwdConfirm">' + gNode.col[ 0 ].col[ 3 ].label + '</label></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft"><input type="password" id="adminNewPwdConfirm" /></td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';
                
                                tmp += '<div id="div-control_manage">';
                                tmp += '<div id="div-session_manage">';
                                tmp += '<table id="table-session_manage">';
                                tmp += '<caption>' + gNode.col[ 1 ].caption + '</caption>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180"><label for="loginInactiveTimeout">' + gNode.col[ 1 ].col[ 0 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input type="text" id="loginInactiveTimeout" size="8" />&nbsp;( 60-1000 )</td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180"><label for="loginSessionLimitEnable">' + gNode.col[ 1 ].col[ 1 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input type="checkbox" id="loginSessionLimitEnable" value="1" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180"><label for="loginSessionLimit">' + gNode.col[ 1 ].col[ 2 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input type="text" id="loginSessionLimit" size="8" />&nbsp;( 60-1000 )</td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';
                                tmp += '<div id="div-block_manage">';
                                tmp += '<table id="table-block_manage">';
                                tmp += '<caption>' + gNode.col[ 1 ].col[ 3 ].label + '</caption>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180"><label for="loginFailBlockMaxAttempts">' + gNode.col[ 1 ].col[ 4 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input type="text" id="loginFailBlockMaxAttempts" size="8"/>&nbsp;( 0-1000 )</td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180"><label for="loginFailBlockTime">' + gNode.col[ 1 ].col[ 5 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input type="text" id="loginFailBlockTime" size="8"/>&nbsp;( 30-3600 )</td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';
                                tmp += '</div>';
                                $('#div-' + pid).html( tmp );
                                for (var node in data)
                                {
                                    switch(node)
                                    {
                                    case 'setPassword':
                                    case 'adminOldPwd':
                                    case 'adminNewPwd':
                                        break;
                                    case 'loginSessionLimitEnable':
                                        gIf.limited = false;
                                        if (1 === parseInt(data[ node ]) ) {
                                            $('#' + node).attr('checked', true);
                                            gIf.limited = true;
                                        }
                                        break;
                                    case 'loginInactiveTimeout':
                                        $('#'+node).val(data[node]);
                                        break;
                                    default:
                                        $('#'+node).val(data[node]);
                                    }
                                }
                                break;
                            case 'properties':
                                tmp = '<div id="div-' + gNode.col[ 0 ].tab + '">';
                                tmp += '<span id="label-' + gNode.col[ 0 ].tab + '"><label for="' + gNode.col[ 0 ].tab + '">' + gNode.col[ 0 ].label + '</label></span>';
                                tmp += '<span id="input-' + gNode.col[ 0 ].tab + '"><input type="text" id="' + gNode.col[ 0 ].tab + '" /></span>';
                                tmp += '</div>';
                                tmp += '<div id="div-' + gNode.col[ 1 ].tab + '">';
                                tmp += '<span id="label-' + gNode.col[ 1 ].tab + '"><label for="' + gNode.col[ 1 ].tab + '">' + gNode.col[ 1 ].label + '</label></span>';
                                tmp += '<span id="input-' + gNode.col[ 1 ].tab + '"><input type="text" id="' + gNode.col[ 1 ].tab + '" /></span>';
                                tmp += '</div>';
                                gY.one('#div-' + pid).set('innerHTML', tmp);
                                $('#' + gNode.col[ 0 ].tab ).val( data[ gNode.col[ 0 ].tab ] );
                                $('#' + gNode.col[ 1 ].tab ).val( data[ gNode.col[ 1 ].tab ] );
                                break;
                            case 'date_and_time':
                                tmp = '<div id="div-' + gNode.col[ 0 ].tab + '">';
                                tmp += '<table id="table-' + gNode.col[ 0 ].tab + '">';
                                tmp += '<tr>';
                                tmp += '<th class="alignLeft BT80"><label for="' + gNode.col[ 0 ].col[ 0 ].tab + '">' + gNode.col[ 0 ].col[ 0 ].label + '</label></th>';
                                tmp += '<td class="alignLeft"><p id="' + gNode.col[ 0 ].col[ 0 ].tab + '"></p></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<th class="alignLeft BT80"><label for="' + gNode.col[ 0 ].col[ 1 ].tab + '">' + gNode.col[ 0 ].col[ 1 ].label + '</label></th>';
                                tmp += '<td class="alignLeft"><select id="' + gNode.col[ 0 ].col[ 1 ].tab + '" ></select></td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';
    
                                tmp += '<div id="div-system_time">';
                                tmp += '<div id="div-' + gNode.col[ 1 ].option[ 0 ].tab + '">';
                                tmp += '<table id="table-' + gNode.col[ 1 ].option[ 0 ].tab + '" >';
                                tmp += '<tr>';
                                tmp += '<td class="alignCenter BT10"><input type="radio" name="' + gNode.col[ 1 ].tab + '" id="' + gNode.col[ 1 ].option[ 0 ].tab + '" value="0" /></td>';
                                tmp += '<th colspan="2" class="alignLeft "><label for="' + gNode.col[ 1 ].option[ 0 ].tab + '">' + gNode.col[ 1 ].option[ 0 ].label + '</label></th>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td></td>';
                                tmp += '<th class="alignLeft BT60"><label for="' + gNode.col[ 1 ].option[ 0 ].col[ 0 ].tab + '">' + gNode.col[ 1 ].option[ 0 ].col[ 0 ].label + '</label></th>';
                                tmp += '<td class="alignLeft"><input type="text" id="' + gNode.col[ 1 ].option[ 0 ].col[ 0 ].tab + '" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td></td>';
                                tmp += '<th class="alignLeft BT60">' + gNode.col[ 1 ].option[ 0 ].col[ 1 ].label + '</th>';
                                tmp += '<td class="alignLeft"><label for="' + gNode.col[ 1 ].option[ 0 ].col[ 1 ].selects[ 0 ].tab + '">' + gNode.col[ 1 ].option[ 0 ].col[ 1 ].selects[ 0 ].label + '</label>&nbsp;<select id="' + gNode.col[ 1 ].option[ 0 ].col[ 1 ].selects[ 0 ].tab + '"></select>&nbsp;<label for="' + gNode.col[ 1 ].option[ 0 ].col[ 1 ].selects[ 1 ].tab + '">' + gNode.col[ 1 ].option[ 0 ].col[ 1 ].selects[ 1 ].label + '</label>&nbsp;<select id="' + gNode.col[ 1 ].option[ 0 ].col[ 1 ].selects[ 1 ].tab + '"></select>&nbsp;<label for="' + gNode.col[ 1 ].option[ 0 ].col[ 1 ].selects[ 2 ].tab + '">' + gNode.col[ 1 ].option[ 0 ].col[ 1 ].selects[ 2 ].label + '</label>&nbsp;<select id="' + gNode.col[ 1 ].option[ 0 ].col[ 1 ].selects[ 2 ].tab + '"></select>&nbsp;</td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';
    
                                tmp += '<div id="div-' + gNode.col[ 1 ].option[ 1 ].tab + '">';
                                tmp += '<table id="table-' + gNode.col[ 1 ].option[ 1 ].tab + '" >';
                                tmp += '<tr>';
                                tmp += '<td class="alignCenter BT10"><input type="radio" name="' + gNode.col[ 1 ].tab + '" id="' + gNode.col[ 1 ].option[ 1 ].tab + '" value="1" /></td>';
                                tmp += '<th colspan="3" class="alignLeft"><label for="' + gNode.col[ 1 ].option[ 1 ].tab + '">' + gNode.col[ 1 ].option[ 1 ].label + '</label></th>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT10"></td>';
                                tmp += '<td class="alignCenter BT10"><input type="checkbox" id="' + gNode.col[ 1 ].option[ 1 ].col[ 0 ].tab + '" value="1" /></td>';
                                tmp += '<th colspan="2" class="alignLeft"><label for="' + gNode.col[ 1 ].option[ 1 ].col[ 0 ].tab + '">' + gNode.col[ 1 ].option[ 1 ].col[ 0 ].label + '</label></th>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT10"></td>';
                                tmp += '<td class="alignCenter BT10"><input type="radio" name="' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].tab + '" id="' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 0 ].tab + '" value="0" /></td>';
                                tmp += '<th colspan="2" class="alignLeft"><label for="' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 0 ].tab + '">' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 0 ].label + '</label></th>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT10"></td>';
                                tmp += '<td class="alignCenter BT10"><input type="radio" name="' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].tab + '" id="' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 1 ].tab + '" value="1" /></td>';
                                tmp += '<th colspan="2" class="alignLeft"><label for="' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 1 ].tab + '">' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 1 ].label + '</label></th>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td colspan="2"></td>';
                                tmp += '<td class="alignLeft BT140"><label for="' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 1 ].col[ 0 ].tab + '">' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 1 ].col[ 0 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input type="text" id="' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 1 ].col[ 0 ].tab + '" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td colspan="2"></td>';
                                tmp += '<td class="alignLeft BT140"><label for="' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 1 ].col[ 1 ].tab + '">' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 1 ].col[ 1 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input type="text" id="' + gNode.col[ 1 ].option[ 1 ].col[ 1 ].option[ 1 ].col[ 1 ].tab + '" /></td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';
                                tmp += '</div>';
    
                                gY.one('#div-' + pid).set('innerHTML', tmp);
    
                                $('#tzName').change( function() {
                                    if (gRef.systime.dstEnable.indexOf( $('#tzName').val() ) == -1)
                                        $('#dstEnable').prop('disabled', true);
                                    else if ($('#mode-1').is(':checked')) {
                                        $('#dstEnable').prop('disabled', false);
                                    }
                                });

                                $('input[name=mode]').change( function() {
                                    switch(parseInt($(this).val()))
                                    {
                                    case 0:
                                        $('#sysDate').prop('disabled', false);
                                        $('#hour').prop('disabled', false);
                                        $('#minute').prop('disabled', false);
                                        $('#second').prop('disabled', false);
                                        $('#dstEnable').prop('disabled', true);
                                        $('#ntpServerType-0').prop('disabled', true);
                                        $('#ntpServerType-1').prop('disabled', true);
                                        $('#ntpCustomServer1').prop('disabled', true);
                                        $('#ntpCustomServer2').prop('disabled', true);
                                        break;
                                    case 1:
                                        $('#sysDate').prop('disabled', true);
                                        $('#hour').prop('disabled', true);
                                        $('#minute').prop('disabled', true);
                                        $('#second').prop('disabled', true);
    
                                        if (gRef.systime.dstEnable.indexOf( $('#tzName').val() ) == -1)
                                            $('#dstEnable').prop('disabled', true);
                                        else
                                            $('#dstEnable').prop('disabled', false);
    
                                        $('#ntpServerType-0').prop('disabled', false);
                                        $('#ntpServerType-1').prop('disabled', false);
                                        if ($('#ntpServerType-1').is(':checked')) {
                                            $('#ntpCustomServer1').prop('disabled', false);
                                            $('#ntpCustomServer2').prop('disabled', false);
                                        }else {
                                            $('#ntpCustomServer1').prop('disabled', true);
                                            $('#ntpCustomServer2').prop('disabled', true);
                                        }
                                        break;
                                    }
                                })
    
                                $('input[name=ntpServerType]').change( function() {
                                    switch(parseInt($(this).val()))
                                    {
                                    case 0:
                                        $('#ntpCustomServer1').prop('disabled', true);
                                        $('#ntpCustomServer2').prop('disabled', true);
                                        break;
                                    case 1:
                                        $('#ntpCustomServer1').prop('disabled', false);
                                        $('#ntpCustomServer2').prop('disabled', false);
                                        break;
                                    }
                                })
    
                                for (var node in data)
                                {
                                    switch(node)
                                    {
                                    case 'mode':
                                    case 'ntpServerType':
                                        $('input[name=' + node + ']').each(function(){
                                            switch(parseInt( $(this).val() ) == parseInt( data[ node ] ) )
                                            {
                                            case true:
                                                $(this).click();
                                                $(this).attr('checked', true);
                                                break;
                                            }
                                        });
                                        break;
                                    case 'year':
                                    case 'month':
                                    case 'day':
                                    case 'ntpDefaultServer':
                                        break;
                                    case 'tzName':
                                    case 'hour':
                                    case 'minute':
                                    case 'second':
                                        $('#' + node).append( genSelectOption( node ) ).val( data[ node ] );//.trigger('change');
                                        break;
                                    case 'dstEnable':
                                        if ( parseInt(data[ node ]) == 1)
                                            $('#' + node).click();
                                        break;
                                    default:
                                        $('#' + node).val( data[ node ] );
                                    }
                                }
                
                                var sysDate = data.year + '/' + data.month + '/' + data.day;
                                $('#sysDate').val( sysDate );
                                $('#sysDate').datepicker({
                                    showOn: "button",
                                    buttonImage: "css/images/calendar.gif",
                                    buttonImageOnly: true,
                                    changeMonth: true,
                                    changeYear: true,
                                    yearRange: "2013:2025",
                                    dateFormat: "yy/mm/dd"
                                });
    
                                gIf.systime = true;

                                break;
                             case 'proxy':
                                tmp = '<table id="table-proxy">';
                                tmp += '<caption>' + gNode.col[ 0 ].label + '</caption>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT150"><label for="enable">' + gNode.col[ 0 ].col[ 0 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input type="checkbox" id="enable" value="1" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT150"><label for="serverAddr">' + gNode.col[ 0 ].col[ 1 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input class="enable" type="text" id="serverAddr" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT150"><label for="serverPort">' + gNode.col[ 0 ].col[ 2 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input class="enable" type="text" id="serverPort" /> ( 1-65535 )</td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT150"><label for="proxyAuthenicationMode">' + gNode.col[ 0 ].col[ 3 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input class="enable" type="checkbox" id="proxyAuthenicationMode" value="1" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT150"><label for="proxyUser">' + gNode.col[ 0 ].col[ 4 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input type="text" class="enable proxyAuthenicationMode" id="proxyUser" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT150"><label for="proxyUserPwd">' + gNode.col[ 0 ].col[ 5 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"><input type="password" class="enable proxyAuthenicationMode" id="proxyUserPwd" /></td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                gY.one('#div-' + pid).set('innerHTML', tmp);
                                
                                $('#proxyAuthenicationMode').change( function() {
                                    if ($('#proxyAuthenicationMode').is(':checked')) {
                                        $('.proxyAuthenicationMode').prop('disabled', false);
                                    } else {
                                        $('.proxyAuthenicationMode').prop('disabled', true);
                                    }
                                });

                                $('#enable').change( function(){
                                    if ($(this).is(':checked')) {
                                        $('.enable').prop('disabled', false);
                                        if ($('#proxyAuthenicationMode').is(':checked')) {
                                            $('.proxyAuthenicationMode').prop('disabled', false);
                                        } else {
                                            $('.proxyAuthenicationMode').prop('disabled', true);
                                        }
                                    } else {
                                        $('.enable').prop('disabled', true);
                                    }
                                });

                                $('.proxyAuthenicationMode').prop('disabled', true);

                                $.ajax({
                                    url: 'cgi-bin/av_proxy' + '.' + gNode.ext,
                                    dataType: 'json',
                                    success: function(datas) {
                                        gData.proxy = datas;
                                        if (1 === parseInt( datas.proxyAuthenicationMode ))
                                            $('#proxyAuthenicationMode').click();

                                        $('.enable').prop('disabled', true);
                                        if (1 === parseInt( datas.enable ))
                                            $('#enable').click();
                                        $('#serverAddr').val(datas.serverAddr);
                                        $('#serverPort').val(datas.serverPort);
                                        $('#proxyUser').val(datas.proxyUser);
                                        $('#proxyUserPwd').val(datas.proxyUserPwd);
                                    }
                                });

                                break;
                             default:
                                tmp = '<table id="table-' + pid + '">';
                                for (var i=0, len=gNode.col.length; i<len; i++)
                                {
                                    tmp += '<tr>';
                                    tmp += '<th>' + gNode.col[ i ].label + '</th>';
                                    tmp += '<td>';
        
                                    if (gNode.col[ i ].type == 'table') {
                                        tmp += '<table id="table-' + gNode.col[ i ].tab + '">';
                                        if (gNode.col[ i ].caption)
                                            tmp += '<caption>' + gNode.col[ i ].caption + '</caption>';
                                        for (var j=0, jlen=gNode.col[ i ].col.length; j<jlen; j++)
                                        {
                                            tmp += '<tr>';
                                            tmp += '<th>' + gNode.col[ i ].col[ j ].label + '</th>';
                                            tmp += '<td>';
                                            if (gNode.col[ i ].col[ j ].tag == 'p') 
                                                tmp += '';
                                            else if (gNode.col[ i ].col[ j ].tag == 'input') {
                                                if (gNode.col[ i ].col[ j ].type == 'text') {
                                                    tmp += '<input type="' + gNode.col[ i ].col[ j ].type + '" id="' + gNode.col[ i ].col[ j ].tab + '" value="' + data[ gNode.col[ i ].col[ j ].tab ] + '"/>';
                                                }else if (gNode.col[ i ].col[ j ].type == 'password') {
                                                    tmp += '<input type="' + gNode.col[ i ].col[ j ].type + '" id="' + gNode.col[ i ].col[ j ].tab + '" />';
                                                }else if (gNode.col[ i ].col[ j ].type == 'checkbox') {
                                                    tmp += '<input type="' + gNode.col[ i ].col[ j ].type + '" id="' + gNode.col[ i ].col[ j ].tab + '" ' + ( ( 1===parseInt( data[ gNode.col[ i ].col[ j ].tab ] ) )? 'checked=checked' : '') + 'value="1" />';
                                                }
                                            }
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                        }
                                        tmp += '</table>';
                                    }else 
                                        tmp += '<input type="text" id="' + gNode.col[ i ].tab + '" value="' + data[ gNode.col[ i ].tab ] + '" size="8"/>';
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }
                                tmp += '</table>';
                                gY.one('#div-' + pid).set('innerHTML', tmp);
                                if (gNode.pgAction)
                                    genPageAction(pid, gNode.pgAction);
                            }
                            if (!gIf.power) {
                                $('.templateDiv input').prop('disabled', true);
                                $('.templateDiv select').prop('disabled', true);
                                $('.templateDiv button').prop('disabled', true);
                                $('.templateDiv img').prop('disabled', true);
                            }
                        }
                    });
                    break;
                case 'tabsForm':
                    gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div class="tabber"><ul></ul></div></div>');
                    switch(pid)
                    {
                    case 'email_alert':
                        if (gIf.power) {
                            $('#main_ft').html( gHtml.pgCheck + gHtml.pgSave + gHtml.pgCancel );
                            gY.one('#pgSave').on('click', function(e) {
                                saveDevice(pid);
                            });

                            gY.one('#pgCheck').on('click', function(e) {
                                btnCheckSMTP( pid );
                            });
                        }
    
                        $('.tabber ul').append('<li id="tab-email_settings"><a href="#panel-email_settings">' + gNode.col[ 0 ].label + '</a></li><li id="tab-email_alerts"><a href="#panel-email_alerts">' + gNode.col[ 1 ].label + '</a></li>');
                        $('.tabber').append('<div id="panel-email_settings"></div><div id="panel-email_alerts"></div></li>');
                        gObj.tabber = $('.tabber').tabs();
    
                        $.ajax({
                            url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                            dataType: 'json',
                            success: function(data) {
                                gData[ pid ] = data;
    
                                tmp = '<div id="div-email_settings">';
                                tmp += '<table id="table-settings" class="BT500">';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180">' + gNode.col[ 0 ].col[ 0 ].label + '</td>';
                                tmp += '<td class="alignLeft"><input type="text" id="server" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180">' + gNode.col[ 0 ].col[ 1 ].label + '</td>';
                                tmp += '<td class="alignLeft"><input type="text" id="port" size="8" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180">' + gNode.col[ 0 ].col[ 2 ].label + '</td>';
                                tmp += '<td class="alignLeft"><select id="secureMethod"></select></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180">' + gNode.col[ 0 ].col[ 3 ].label + '</td>';
                                tmp += '<td class="alignLeft"><input type="checkbox" id="enableAuth" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180">' + gNode.col[ 0 ].col[ 4 ].label + '</td>';
                                tmp += '<td class="alignLeft"><input type="text" id="account" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180">' + gNode.col[ 0 ].col[ 5 ].label + '</td>';
                                tmp += '<td class="alignLeft"><input type="password" id="password" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180">' + gNode.col[ 0 ].col[ 6 ].label + '</td>';
                                tmp += '<td class="alignLeft"><input type="text" id="fromEmail" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180">' + gNode.col[ 0 ].col[ 7 ].label + '</td>';
                                tmp += '<td class="alignLeft"><input type="text" id="toEmail0" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180">' + gNode.col[ 0 ].col[ 8 ].label + '</td>';
                                tmp += '<td class="alignLeft"><input type="text" id="toEmail1" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180">' + gNode.col[ 0 ].col[ 9 ].label + '</td>';
                                tmp += '<td class="alignLeft"><input type="text" id="toEmail2" /></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT180"></td>';
                                tmp += '<td class="alignLeft"></td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';
                                $('#panel-email_settings').html( tmp );
    
                                tmp = '<div id="div-email_alerts">';
                                tmp += '<div id="div-email_systems">';
                                tmp += '<table id="table-email_systems">';
                                tmp += '<caption>' + gNode.col[ 1 ].col[ 0 ].label + '</caption>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT200"><input type="checkbox" id="cpuAlertEnable" />&nbsp;<label for="cpuAlertEnable">' + gNode.col[ 1 ].col[ 0 ].col[ 0 ].label + '<label></td>';
                                tmp += '<td class="alignLeft">' + gNode.col[ 1 ].col[ 0 ].col[ 0 ].col[ 0 ].label + '&nbsp;<input type="text" id="cpuAlertThreshold" size="8"/>&nbsp;( 10-100 % )</td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT200"><input type="checkbox" id="newFwAlertEnable" />&nbsp;<label for="newFwAlertEnable">' + gNode.col[ 1 ].col[ 0 ].col[ 1 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT200"><input type="checkbox" id="restartAlertEnable" />&nbsp;<label for="restartAlertEnable">' + gNode.col[ 1 ].col[ 0 ].col[ 2 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT200"><input type="checkbox" id="failLoginAlertEnable" />&nbsp;<label for="failLoginAlertEnable">' + gNode.col[ 1 ].col[ 0 ].col[ 3 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT200"><input type="checkbox" id="diskAlertEnable" />&nbsp;<label for="diskAlertEnable">' + gNode.col[ 1 ].col[ 0 ].col[ 4 ].label + '</label></td>';
                                tmp += '<td class="alignLeft ">' + gNode.col[ 1 ].col[ 0 ].col[ 4 ].col[ 0 ].label + '&nbsp;<input type="text" id="diskAlertThreshold" size="8"/>&nbsp;( 50-100 % )</td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';
                                tmp += '<div id="div-email_networks">';
                                tmp += '<table id="table-email_networks">';
                                tmp += '<caption>' + gNode.col[ 1 ].col[ 1 ].label + '</caption>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT200"><input type="checkbox" id="vpnAlertEnable" />&nbsp;<label for="vpnAlertEnable">' + gNode.col[ 1 ].col[ 1 ].col[ 0 ].label + '</label></td>';
                                tmp += '<td class="alignLeft"></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT200"><input type="checkbox" id="wanAlertEnable" />&nbsp;<label for="wanAlertEnable">' + gNode.col[ 1 ].col[ 1 ].col[ 1 ].label + '</label></td>';
                                tmp += '<td class="alignLeft ">' + gNode.col[ 1 ].col[ 1 ].col[ 1 ].col[ 0 ].label + '&nbsp;<input type="text" id="wanAlertInterval" size="8"/>&nbsp;' + gNode.col[ 1 ].col[ 1 ].col[ 1 ].col[ 0 ].note + '</td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';
                                tmp += '<div id="div-email_security">';
                                tmp += '<table id="table-security">';
                                tmp += '<caption>' + gNode.col[ 1 ].col[ 2 ].label + '</caption>';
                                tmp += '<tr>';
                                tmp += '<td class="alignLeft BT200"><input type="checkbox" id="virusAlertEnable" />&nbsp;<label for="virusAlertEnable">' + gNode.col[ 1 ].col[ 2 ].col[ 0 ].label + '</td>';
                                tmp += '<td class="alignLeft ">' + gNode.col[ 1 ].col[ 2 ].col[ 0 ].col[ 0 ].label + '&nbsp;<input type="text" id="virusAlertInterval" size="8"/>&nbsp;' + gNode.col[ 1 ].col[ 2 ].col[ 0 ].col[ 0 ].note + '</td>';
                                tmp += '</tr>';
                                //tmp += '<tr>';
                                //tmp += '<td class="alignLeft BT200"><input type="checkbox" id="ipsAlertEnable" /> <label for="ipsAlertEnable">IPS Alert</label></td>';
                                //tmp += '<td class="alignLeft ">Alert Interval <input type="text" id="ipsAlertInterval" size="8"/> ( 3~1440 minutes )</td>';
                                //tmp += '</tr>';
                                //tmp += '<tr>';
                                //tmp += '<td class="alignLeft BT200"><input type="checkbox" id="urlAlertEnable" /> <label for="urlAlertEnable">Web URL Filtering Alert</td>';
                                //tmp += '<td class="alignLeft"></td>';
                                //tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';
                                tmp += '</div>';
    
                                $('#panel-email_alerts').html( tmp );
    
                                $('#server').val( data.server );
                                $('#port').val( data.port );
                                $('#secureMethod').append( genSelectOption('secureMethod') ).val( data.secureMethod );
                                $('#enableAuth').change( function() {
                                    if ($(this).is(':checked')) {
                                        $('#account').prop('disabled', false);
                                        $('#password').prop('disabled', false);
                                    } else {
                                        $('#account').prop('disabled', true);
                                        $('#password').prop('disabled', true);
                                    }
                                });
    
                                if (parseInt( data.enableAuth ) == 1) {
                                    $('#enableAuth').click();
                                }else {
                                    $('#account').prop('disabled', true);
                                    $('#password').prop('disabled', true);
                                }
                                $('#account').val( data.account );
                                $('#password').val( data.password );
                                $('#fromEmail').val( data.fromEmail );

                                gObj.toEmails = data.toEmail.split(';');

                                for (var i=0, len=gObj.toEmails.length; i<len; i++)
                                {
                                    $('#toEmail' + i ).val( gObj.toEmails[ i ] );
                                }
                
                                // alerts
                                if (parseInt( data.cpuAlertEnable ) == 1)
                                    $('#cpuAlertEnable').attr('checked', true);
                                $('#cpuAlertThreshold').val( data.cpuAlertThreshold );
                                if (parseInt( data.newFwAlertEnable ) == 1)
                                    $('#newFwAlertEnable').attr('checked', true);
                                if (parseInt( data.restartAlertEnable ) == 1)
                                    $('#restartAlertEnable').attr('checked', true);
                                if (parseInt( data.failLoginAlertEnable ) == 1)
                                    $('#failLoginAlertEnable').attr('checked', true);
                                if (parseInt( data.diskAlertEnable ) == 1)
                                    $('#diskAlertEnable').attr('checked', true);
                                $('#diskAlertThreshold').val( data.diskAlertThreshold );
                                if (parseInt( data.vpnAlertEnable ) == 1)
                                    $('#vpnAlertEnable').attr('checked', true);
                                if (parseInt( data.wanAlertEnable ) == 1)
                                    $('#wanAlertEnable').attr('checked', true);
                                $('#wanAlertInterval').val( data.wanAlertInterval );
                                if (parseInt( data.virusAlertEnable ) == 1)
                                    $('#virusAlertEnable').attr('checked', true);
                                $('#virusAlertInterval').val( data.virusAlertInterval );
                                //if (parseInt( data.ipsAlertEnable ) == 1)
                                //    $('#ipsAlertEnable').attr('checked', true);
                                //$('#ipsAlertInterval').val( data.ipsAlertInterval );
                                //if (parseInt( data.urlAlertEnable ) == 1)
                                //    $('#urlAlertEnable').attr('checked', true);

                                if (!gIf.power) {
                                    $('.templateDiv input').prop('disabled', true);
                                    $('.templateDiv select').prop('disabled', true);
                                    $('.templateDiv button').prop('disabled', true);
                                }
                            }
                        });
    
                        break;
                    case 'advanced_debug':
                        gY.one('.tabber ul').append('<li id="tab-log"><a href="#panel-log">' + gNode.tabs.log + '</a></li><li id="tab-debug"><a href="#panel-debug">' + gNode.tabs.debug  + '</a></li>');
                        gY.one('.tabber').append('<div id="panel-log"></div><div id="panel-debug"></div>');

                        gCheckbox.log = {};
                        gCheckbox.debug = {};

                        gObj.tabber = $('.tabber').tabs({
                            active: gObj.tabIndex
                        });

                        $.ajax({
                            url: 'cgi-bin/' + gNode.url.get + '.' + gNode.ext,
                            dataType: 'json',
                            success: function(data) {
                                gData[ pid ] = data;

                                if (1 === parseInt( data.logEnable )) {
                                    gIf.log = true;
                                    gIf.debug = true;
                                } else 
                                    gIf.log = false;
                                
                                if (1 === parseInt( data.pcapEnable )) {
                                    gIf.pcap = true;
                                    gIf.debug = true;
                                } else 
                                    gIf.pcap = false;

                                tmp = '<div id="div-log">';
                                tmp += '<div id="div-log_global">';
                                tmp += '<table id="table-log_global">';
                                tmp += '<tr><td class="alignRight BT80"><input type="checkbox" id="logEnable" value="1" /></td><th class="alignLeft BT160"><label for="logEnable">' + gNode.col[ "log" ][ 0 ].col[ 0 ].label + '</label></th><td class="BT40"></td></tr>';
                                tmp += '<tr>';
                                tmp += '<th class="alignRight BT80">' + gNode.col[ "log" ][ 0 ].col[ 1 ].label + '</th>';
                                tmp += '<td class="alignLeft BT160"><input type="text" id="logDesc" ></td>';
                                tmp += '<td class="BT40">';
                                if (gIf.power)
                                    tmp += '<button id="pgSave" class="Save" title="Save"><span class="ui-icon"></span></button>';
                                tmp += '</td>';
                                tmp += '</tr>';
                                tmp += '</table>';
                                tmp += '</div>';

                                tmp += '<div id="div-log_list">';
                                tmp += '<table id="table-log_list">';
                                tmp += '<thead>';
                                tmp += '<tr>';
                                tmp += '<th class="ui-state-default BT40"><input type="checkbox" id="log_all" value="1" /></th>';
                                tmp += '<th class="ui-state-default BT50">' + gNode.col[ "log" ][ 1 ].col[ 1 ].label + '</th>';
                                tmp += '<th class="ui-state-default BT350">' + gNode.col[ "log" ][ 1 ].col[ 2 ].label + '</th>';
                                tmp += '<th class="ui-state-default">' + gNode.col[ "log" ][ 1 ].col[ 3 ].label + '</th>';
                                tmp += '<th class="ui-state-default BT100">' + gNode.col[ "log" ][ 1 ].col[ 4 ].label + '</th>';
                                tmp += '</tr>';
                                tmp += '</thead>';
                                tmp += '<tbody>';
                                tmp += '</tbody>';
                                tmp += '</table>';
                                tmp += '<div class="tblAction">';
                                if (gIf.power)
                                    tmp += '<button id="Remove-log" class="Remove" title="Remove"><span class="ui-icon"></span></button>';
                                tmp += '</div>';
                                tmp += '</div>';
                                tmp += '</div>';
                                $('#panel-log').html( tmp );

                                tmp = '<div id="div-debug">';
				tmp += '<div id="div-debug_global">';
                                tmp += '<table id="table-debug_global">';
                                tmp += '<tbody>';
                                tmp += '<tr>';
                                tmp += '<td class="BT40"></td>';
                                tmp += '<th class="alignLeft BT110">Description</th>';
                                tmp += '<td class="alignLeft BT200" colspan="2"> <input class="debugging" type="text" id="pcapDesc" /> </td>';
                                tmp += '<td class="BT40"></td>';
                                tmp += '<th class="alignLeft BT120"></th>';
                                tmp += '<td class="alignLeft BT200" colspan="2"></td>';
                                tmp += '<td class="BT100"></td>';
                                tmp += '</tr>';

                                tmp += '<tr>';
                                tmp += '<td class="BT40"></td>';
                                tmp += '<th class="alignLeft BT110">Network Interface </th>';
                                tmp += '<td class="alignLeft BT200" colspan="2">';
                                tmp += '<select id="pcapIfName" class="debugging"></select>';
                                tmp += '</td>';

                                tmp += '<td class="BT40"></td>';
                                tmp += '<th class="alignLeft BT120"></th>';
                                tmp += '<td class="alignLeft BT200" colspan="2"></td>';
                                tmp += '<td class="BT100"></td>';
                                tmp += '</tr>';

                                tmp += '<tr>';
                                tmp += '<td class="BT40"></td>';
                                tmp += '<th class="alignLeft BT110">Port Range </th>';
                                tmp += '<td class="alignLeft BT100">Start</td>';
                                tmp += '<td class="alignLeft BT100"> <input class="debugging" type="text" id="pcapPortStart" size="8"> </td>';
                
                                tmp += '<td class="BT40"></td>';
                                tmp += '<td class="alignLeft BT120">End</td>';
                                tmp += '<td class="alignLeft BT200" colspan="2"> <input class="debugging" type="text" id="pcapPortEnd" size="8"> </td>';
                                tmp += '<td class="BT100"></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="BT40"></td>';
                                tmp += '<th class="alignLeft BT110">Host</th>';
                                tmp += '<td class="alignLeft BT100">Address</td>';
                                tmp += '<td class="alignLeft BT100"> <input class="debugging" type="text" id="pcapHost"> </td>';
                
                                tmp += '<td class="BT40"></td>';
                                tmp += '<td class="BT310" colspan="3"></td>';
                
                                tmp += '<td class="BT100"></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="BT40"></td>';
                                tmp += '<th class="alignLeft BT110">Net </th>';
                                tmp += '<td class="alignLeft BT100">Address</td>';
                                tmp += '<td class="alignLeft BT100"> <input class="debugging" type="text" id="pcapNetAddress"> </td>';
                                tmp += '<td class="BT40"></td>';
                                tmp += '<td class="alignLeft BT120" >Netmask</td>';
                                tmp += '<td class="alignLeft" colspan="2"> <input class="debugging" type="text" id="pcapNetmask"> </td>';
                
                                tmp += '<td class="BT100"></td>';
                                tmp += '</tr>';
                                tmp += '<tr>';
                                tmp += '<td class="BT40"></td>';
                                tmp += '<th class="alignLeft BT110">MAC </th>';
                                tmp += '<td class="alignLeft BT100">Address</td>';
                                tmp += '<td class="alignLeft BT100"> <input class="debugging" type="text" id="pcapMac"> </td>';
                
                                tmp += '<td class="BT40"></td>';
                                tmp += '<td class="BT320" colspan="3"></td>';
                                tmp += '<td class="BT100">';
                                if (gIf.power) {
                                    tmp += '<button id="pgStart" class="Start" title="Start"><span class="ui-icon"></span></button>';
                                    tmp += '<button id="pgStop" class="Stop" title="Stop"><span class="ui-icon"></span></button>';
                                }
                                tmp += '</td>';
                                tmp += '</tr>';
                                tmp += '</tbody>';
                                tmp += '</table>';
                                tmp += '</div>';

                                tmp += '<div id="div-debug_list">';
                                tmp += '<table id="table-debug_list">';
                                tmp += '<thead>';
                                tmp += '<tr>';
                                
                                tmp += '<th class="ui-state-default BT40"><input type="checkbox" id="debug_all" value="1" /></th>';
                                tmp += '<th class="ui-state-default BT50">' + gNode.col[ "debug" ][ 1 ].col[ 1 ].label + '</th>';
                                tmp += '<th class="ui-state-default BT350">' + gNode.col[ "debug" ][ 1 ].col[ 2 ].label + '</th>';
                                tmp += '<th class="ui-state-default">' + gNode.col[ "debug" ][ 1 ].col[ 3 ].label + '</th>';
                                tmp += '<th class="ui-state-default BT100">' + gNode.col[ "debug" ][ 1 ].col[ 4 ].label + '</th>';
                                
                                tmp += '</tr>';
                                tmp += '</thead>';
                                tmp += '<tbody>';
                                tmp += '</tbody>';
                                tmp += '</table>';
                                tmp += '<div class="tblAction">';
                                if (gIf.power)
                                    tmp += '<button id="Remove-debug" class="Remove" title="Remove"><span class="ui-icon"></span></button>';
                                tmp += '</div>';
                                tmp += '</div>';
                                tmp += '</div>';
                                $('#panel-debug').html( tmp );
                                
                                if (1 === parseInt( data.logEnable ))
                                    $('#logEnable').click();
                                
                                $('#logDesc').val( data.logDesc );

                                if (1 === parseInt( data.logEnable ))
                                    $('#pcapEnable').click();
                                
                                $('#pcapDesc').val( data.pcapDesc );
                                cgiSelectOption( 'pcapIfName', data.pcapIfName );
                                $('#pcapPortStart').val( data.pcapPortStart );
                                $('#pcapPortEnd').val( data.pcapPortEnd );
                                $('#pcapHost').val( data.pcapHost );
                                $('#pcapNetAddress').val( data.pcapNetAddress );
                                $('#pcapNetmask').val( data.pcapNetmask );
                                $('#pcapMac').val( data.pcapMac );

                                $.ajax({
                                    url: 'cgi-bin/' + gNode.url.log + '.' + gNode.ext,
                                    dataType: 'json',
                                    success: function(data) {
                                        gData.log = data;
                                        for (var i=0, len=data[ gNode.guiTNum ]; i<len; i++)
                                        {
                                            tmp = '<tr class="' + ((i%2 == 0)? 'odd' : 'even') + '">';
                                            tmp += '<td>';
                                            tmp += '<input class="logCheckbox" type="checkbox" id="log-' + i + '" value="' + i + '" />';
                                            tmp += '</td>';
                                            tmp += '<td>';
                                            tmp += (i+1);
                                            tmp += '</td>';
                                            tmp += '<td>';
                                            tmp += data[ gNode.guiT ][ i ].filepath;
                                            tmp += '</td>';
                                            tmp += '<td>';
                                            tmp += data[ gNode.guiT ][ i ].desc;
                                            tmp += '</td>';
                                            tmp += '<td>';
                                            tmp += '<button id="Donwload-log-' + i + '" class="Download" title="Download"><span class="ui-icon"></span></button>';
                                            tmp += '<button id="Delete-log-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                                            tmp += '</td>';
                                            tmp += '</tr>';
                                            $('#table-log_list tbody').append( tmp );
                                        }
                                    }   
                                }).done( function() {
                                
                                    $.ajax({
                                        url: 'cgi-bin/' + gNode.url.debug + '.' + gNode.ext,
                                        dataType: 'json',
                                        success: function(data) {
                                            gData.debug = data;
                                            for (var i=0, len=data[ gNode.guiTNum ]; i<len; i++)
                                            {
                                                tmp = '<tr class="' + ((i%2 == 0)? 'odd' : 'even') + '">';
                                                tmp += '<td>';
                                                tmp += '<input class="debugCheckbox" type="checkbox" id="debug-' + i + '" value="' + i + '" />';
                                                tmp += '</td>';
                                                tmp += '<td>';
                                                tmp += (i+1);
                                                tmp += '</td>';
                                                tmp += '<td>';
                                                tmp += data[ gNode.guiT ][ i ].filepath;
                                                tmp += '</td>';
                                                tmp += '<td>';
                                                tmp += data[ gNode.guiT ][ i ].desc;
                                                tmp += '</td>';
                                                tmp += '<td>';
                                                tmp += '<button id="Donwload-debug-' + i + '" class="Download" title="Download"><span class="ui-icon"></span></button>';
                                                tmp += '<button id="delete-debug-' + i + '" class="Delete" title="Delete"><span class="ui-icon"></span></button>';
                                                tmp += '</td>';
                                                tmp += '</tr>';
                                                $('#table-debug_list tbody').append( tmp );
                                            }
                                        }   
                                    }).done( function() {
                                        if (gIf.power) {
                                            gY.one('#pgSave').on('click', function(e) {
                                                saveDevice( pid );
                                            });

                                            if ( 1 === parseInt( data.pcapEnable )) {
                                                $('#pgStart').prop('disabled', true);
                                                $('.debugging').prop('disabled', true);
                                            } else {
                                                $('#pgStop').prop('disabled', true);
                                                $('.debugging').prop('disabled', false);
                                            }
                                            
                                            if (gRows.maxDebug <= gData.debug.guiFileTNum) {
                                                $('#pgStart').prop('disabled', true);
                                            }
                                            
                                            $.ajax({
                                                url: 'cgi-bin/' + gNode.url.checkPcap + '.' + gNode.ext,
                                                dataType: 'json',
                                                success: function(data) {
                                                    if ('start' == data.action) {
                                                        errorAlert('<p>' + gError[ gObj.lang ].packetCapturing + '</p>');
                                                        $('#pgStart').prop('disabled', true);
                                                    }
                                                }
                                            });
                                        } else {
                                            $('.templateDiv input').prop('disabled', true);
                                            $('.templateDiv select').prop('disabled', true);
                                            $('.templateDiv button').prop('disabled', true);
                                        }
                                    });
                                });
                            }   
                        });
                        break;
                    case 'license':
                        gY.one('.tabber ul').append('<li id="tab-registration"><a href="#panel-registration">' + gNode.tabs.registration + '</a></li><li id="tab-services"><a href="#panel-services">' + gNode.tabs.services  + '</a></li>');
                        gY.one('.tabber').append('<div id="panel-registration"></div><div id="panel-services"></div>');
                        if (gIf.power) {
                            $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel );
                            gY.one('#pgSave').on('click', function(e) {
                                saveDevice( 'registration' );
                            });
                        }

                        gObj.tabber = $('.tabber').tabs({
                            active: gObj.tabIndex,
                            select: function (event, ui) {
                                if (0 === parseInt( ui.index ) ) {
                                    $('#pgSave').show();
                                    $('#pgCancel').show();
                                } else {
                                    $('#pgSave').hide();
                                    $('#pgCancel').hide();
                                }
                                gObj.tabIndex = ui.index;
                            }
                        });

                        for (var y in gNode.tabs)
                        {
                            $.ajax({
                                url: 'cgi-bin/' + gNode.url.get[ y ] + '.' + gNode.ext,
                                dataType: 'json',
                                success: function(data) {
                                    var guiT = true;
                                    var x = "";
                                    for (var z in gNode.guiT)
                                    {
                                        if (data[ gNode.guiT[ z ] ]) 
                                            x = z;
                                        else if ( gNode.guiT[ z ] == z )
                                            x = z;
                                    }
                                    gData[ x ] = data;
    
                                    switch( x ) 
                                    {
                                    case 'registration':
                                        gCache[ x ] = data;
    
                                        tmp = '<div id="div-registration" >';
                                        tmp += '<div id="div-registration-general" >';
                                        switch( parseInt(data.haveAccount) )
                                        {
                                        case 0:
                                            tmp += '<table id="table-registration-general">';
                                            tmp +=   '<caption>' + gNode.col[ x ][ 0 ].label + '</caption>';
                                            tmp +=   '<tr>';
                                            tmp +=     '<th class="BT250">';
                                            tmp +=       '<input type="radio" name="registrationMode" id="registrationMode-0" value="0" />&nbsp;<label for="registrationMode-0">' + gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].label + '</label>';
                                            tmp +=     '</th>';
                                            tmp +=     '<td>';
                                            tmp +=       '<table id="table-new_registration" class="registrationMode-0">';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=            gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 0 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="text" id="newUsername" />';
                                            tmp +=             '&nbsp;<button id="Check-newUsername" class="Check"><span class="ui-icon" title="check username"></span></button>';
                                            tmp +=             '&nbsp;<span class="newUsername"></span>';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=            gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 1 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="password" id="newPassword"  />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 2 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="password" id="confirmPassword"  />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 3 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="text" id="firstName"  />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 4 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="text" id="lastName"  />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 5 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="text" id="email"  />';
                                            tmp +=           '</td >';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 6 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="text" id="company"  />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 7 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="text" id="raddress"  />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 8 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="text" id="city"  />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 9 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="text" id="zipCode"  />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 10 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="text" id="state"  />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "0" ].col[ 11 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<select id="country" ></select>';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=       '</table>';
                                            tmp +=     '</td>';
                                            tmp +=   '</tr>';
                                            tmp +=   '<tr>';
                                            tmp +=     '<td colspan="2">';
                                            tmp +=     '<hr/>';
                                            tmp +=     '</td>';
                                            tmp +=   '</tr>';
                                            tmp +=   '<tr>';
                                            tmp +=     '<th class="BT250">';
                                            tmp +=       '<input type="radio" name="registrationMode" id="registrationMode-1" value="1" />&nbsp;<label for="registrationMode-1">' + gNode.col[ x ][ 0 ].col[ 0 ].option[ "1" ].label + '</label>';
                                            tmp +=     '</th>';
                                            tmp +=     '<td>';
                                            tmp +=       '<table id="table-old_registration" class="registrationMode-1">';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "1" ].col[ 0 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="text" id="oldUsername" />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 0 ].option[ "1" ].col[ 1 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '<input type="password" id="oldPassword" />';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=       '</table>';
                                            tmp +=     '</td>';
                                            tmp +=   '</tr>';
                                            tmp += '</table>';
                                            break;
                                        case 1:
                                            tmp += '<table id="table-registration-general">';
                                            tmp +=   '<caption>' + gNode.col[ x ][ 0 ].col[ 1 ].label + '</caption>';
                                            tmp +=   '<tr>';
                                            tmp +=     '<th class="BT200">';
                                            tmp +=     '</th>';
                                            tmp +=     '<td>';
                                            tmp +=       '<table id="table-old_registration">';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 0 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             data.oldUsername;
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 1 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             '********';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 2 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             data.firstName;
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 3 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             data.lastName;
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 4 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             data.email;
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 5 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             data.company;
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 6 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             data.address;
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 7 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             data.city;
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 8 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             data.zipCode;
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 9 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             data.state;
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=         '<tr>';
                                            tmp +=           '<td class="alignLeft BT100">';
                                            tmp +=             gNode.col[ x ][ 0 ].col[ 1 ].col[ 10 ].label;
                                            tmp +=           '</td>';
                                            tmp +=           '<td class="alignLeft">';
                                            tmp +=             (parseInt(data.country) > 0)? gRef.country[ data.country ] : 'no comment';
                                            tmp +=           '</td>';
                                            tmp +=         '</tr>';
                                            tmp +=       '</table>';
                                            tmp +=     '</td>';
                                            tmp +=   '</tr>';
                                            tmp += '</table>';
                                            break;
                                        }
    
                                        tmp +=   '</div>';
                                        tmp +=   '<hr/>';
                                        tmp +=   '<div id="div-registration-trial">';
                                        tmp +=     '<table id="table-registration-trial">';
                                        tmp +=       '<caption>' + gNode.col[ x ][ 1 ].label + '</caption>';
                                        tmp +=       '<tr>';
                                        tmp +=         '<th class="alignRight BT200">';
                                        tmp +=           gNode.col[ x ][ 1 ].col[ 0 ].label;
                                        tmp +=         '</th>';
                                        tmp +=         '<td class="alignLeft">';
                                        tmp +=           '<input type="checkbox" id="trialCodeActivation" value="1" />';
                                        tmp +=         '</td>';
                                        tmp +=       '</tr>';
                                        tmp +=     '</table>';
                                        tmp +=   '</div>';
                                        tmp += '</div>';
                                        break;
                                    case 'services':
                                        tmp = '<div id="div-services" >';
                                        tmp += '<div id="div-services_manage" >';
                                        tmp +=   '<table id="table-services_manage" >';
                                        tmp +=     '<caption>' + gNode.col[ x ][ 0 ].label + '</caption>';
                                        tmp +=     '<thead>';
                                        tmp +=       '<tr>';
                                        tmp +=         '<th class="ui-state-default">';
                                        tmp +=           gNode.col[ x ][ 0 ].col[ 0 ].label;
                                        tmp +=         '</th>';
                                        tmp +=         '<th class="ui-state-default">';
                                        tmp +=           gNode.col[ x ][ 0 ].col[ 1 ].label;
                                        tmp +=         '</th>';
                                        tmp +=         '<th class="ui-state-default">';
                                        tmp +=           gNode.col[ x ][ 0 ].col[ 2 ].label;
                                        tmp +=         '</th>';
                                        tmp +=         '<th class="ui-state-default">';
                                        tmp +=           gNode.col[ x ][ 0 ].col[ 3 ].label;
                                        tmp +=         '</th>';
                                        tmp +=       '</tr>';
                                        tmp +=     '</thead>';
                                        tmp +=     '<tbody>';
                                        tmp +=     '</tbody>';
                                        tmp +=   '</table>';
                                        tmp +=   '<div class="tblAction"><button id="licenseRefresh" class="LicenseRefresh"><span class="ui-icon"></span></button></div>';
                                        tmp += '</div>';
    
                                        tmp += '<div id="div-services_active" >';
                                        tmp +=   '<table id="table-services_active">';
                                        tmp +=     '<caption>' + gNode.col[ x ][ 1 ].label + '</caption>';
                                        tmp +=     '<thead>';
                                        tmp +=       '<tr>';
                                        tmp +=         '<td class="alignRight BT120">';
                                        tmp +=           gNode.col[ x ][ 1 ].col[ 0 ].label;
                                        tmp +=         '</td>';
                                        tmp +=         '<td class="alignLeft BT150">';
                                        tmp +=           '<input type="text" id="activeCode" />';
                                        tmp +=         '</td>';
                                        tmp +=         '<td class="alignLeft"><div class="tblAction"><button id="licenseUpgrade" class="LicenseUpgrade"><span class="ui-icon"></span></button></div></td>';
                                        tmp +=       '</tr>';
                                        tmp +=     '</thead>';
                                        tmp +=   '</table>';
                                        tmp += '</div>';
                                        tmp += '</div>';
                                        break;
                                    }
                                    gY.one('#panel-' + x).set('innerHTML', tmp);
    
                                    $('#newUsername').blur( function() {
                                        if (gReg.ascii.username.test( $('#newUsername').val() )) {
                                            gCache.registration.registrationMode = 2;
                                            gCache.registration.newUsername = $('#newUsername').val();
                                            
                                            $.post('cgi-bin/accountRegistration.cgi', gY.JSON.stringify( gCache.registration ), function(poster) {
                                                if (parseInt(poster.status) == 0) {
                                                    gIf.newUsername = true;
                                                    $('.newUsername').removeClass('isKO');
                                                    $('.newUsername').addClass('isOK');
                                                }else {
                                                    $('.newUsername').removeClass('isOK');
                                                    $('.newUsername').addClass('isKO');
                                                    errorAlert( '<p>' + poster.msg + '</p>' );
                                                }
                                            }).fail( function(){
                                                errorAlert( 'register server connecting failed' );
                                            });
                                        }else {
                                            $('.newUsername').removeClass('isOK');
                                            $('.newUsername').addClass('isKO');
                                            errorAlert( 'username can only be [a-zA-Z0-9.@_-] and length should between 6 ~ 20' );
                                        }
                                    });
    
                                    switch(x) 
                                    {
                                    case 'registration':
                                        if (!$('#popPlus').exists())
                                            $('#popBase').append('<div id="popPlus"></div>');
                                        if (parseInt(data.code) != 0) {
                                            $('#popPlus').html('<div class="plusForm"><p class="plusMsg"></p></div>');
                                            $('#popPlus').dialog({
                                                width: 300,
                                                height:200,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    Ok: function() {
                                                        $( this ).dialog( "close" );
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            switch(parseInt(data.code))
                                            {
                                            default:
                                                $('.plusMsg').html(data.message );
                                                break;
                                            }
                                        }
    
                                        if (0 === parseInt( data.haveAccount )) {
                                            $('input[name=registrationMode]').each(function() {
                                                if ($(this).val() == data.registrationMode)
                                                    $(this).attr('checked', true).trigger('click');
                                            });
                                            $('#country').append(genSelectOption('country'));
                                            gObj.tabber.tabs({"disabled": [1]});
                                        }
                                        
                                        break;
                                    case 'services':
                                        var len = parseInt( data[ gNode.guiTNum[ x ] ] );
                                        if (len > 0 ) {
                                            for (var i=0; i<len; i++)
                                            {
                                                var tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                                                tmp += '<td>';
                                                tmp += data[ gNode.guiT[ x ] ][ i ].service;
                                                tmp += '</td>';
                                                tmp += '<td>';
                                                tmp += data[ gNode.guiT[ x ] ][ i ].type;
                                                tmp += '</td>';
                                                tmp += '<td>';
                                                tmp += data[ gNode.guiT[ x ] ][ i ].status;
                                                tmp += '</td>';
                                                tmp += '<td>';
                                                tmp += data[ gNode.guiT[ x ] ][ i ].expireDate;
                                                tmp += '</td>';
                                                tmp += '</tr>';
                                                $('#table-services_manage tbody').append( tmp );
                                            }
                                        }
                                        break;
                                    }

                                    if (!gIf.power) {
                                        $('.templateDiv input').prop('disabled', true);
                                        $('.templateDiv select').prop('disabled', true);
                                        $('.templateDiv button').prop('disabled', true);
                                    }

                                }
                            });
                        }
                        break;
                    }
                }
                break;
            }
            break;
        case 'mix':
            gY.one('#main_bd').set('innerHTML', '<div class="templateDiv"><div class="tabber"><ul></ul></div></div>');
    
            if ('log_settings' == pid)
                gObj.tabIndex = 1;
            else if ('logs_facility' == pid)
                gObj.tabIndex = 2;
            else
                gObj.tabIndex = 0;
    
            pid = gNode.tab;
    
            if (gIf.power) {
                $('#main_ft').html( gHtml.pgSave + gHtml.pgCancel + gHtml.pgExtend + gHtml.pgExport );
                gY.one('#pgSave').on('click', function(e) {
                    gObj.tabIndex = gObj.tabber.tabs('option', 'selected');
                    if (1 == gObj.tabber.tabs('option', 'selected'))
                        saveDevice('log_settings');
                    else
                        saveDevice('logs_facility');
                });
    
                gY.one('#pgExtend').on('click', function(e) {
                    if ($('#theadDiv-view_logs').hasClass('Expand')) {
                        $('#pgExtend').removeClass('Expand');
                        $('#theadDiv-view_logs').removeClass('Expand');
                        $('#tbodyDiv-view_logs').removeClass('Expand');
                    } else {
                        $('#pgExtend').addClass('Expand');
                        $('#theadDiv-view_logs').addClass('Expand');
                        $('#tbodyDiv-view_logs').addClass('Expand');
                    }
                });
    
                //gY.one('#pgExport').on('click', function(e) {
                //    btnExport(e);
                //});
            }
    
            for (var x in gNode.tabs)
            {
                gY.one('.tabber ul').append('<li id="tab-' + x + '"><a href="#panel-' + x + '">' + gNode.tabs[ x ] + '</a></li>');
                gY.one('.tabber').append('<div id="panel-' + x + '"><div id="div-' + x + '"></div></div>');
            }
                    
            gObj.tabber = $('.tabber').tabs({
                active: gObj.tabIndex,
                select: function (event, ui) {
                    if ( 0 === parseInt( ui.index ) ) {
                        $('#pgSave').hide();
                        $('#pgCancel').hide();
                        $('#pgExtend').show();
                        $('#pgExport').show();
                        $('#pgClear').show();
                        $('#pagerDiv').show();
                    } else {
                        $('#pgSave').show();
                        $('#pgCancel').show();
                        $('#pgExtend').hide();
                        $('#pgExport').hide();
                        $('#pgClear').hide();
                        $('#pagerDiv').hide();
                    }
                    gObj.tabIndex = ui.index;
                }
            });

            /* view logs */
    
            gObj.phpQuery.pi = 1;
            gObj.phpQuery.ps = 1;
            gObj.phpQuery.pp = 20;
            gObj.phpQuery.id = 'view_logs';
    
            loadingToggle( true );
            $.ajax({
                url: gObj.phpQuery.php + '.php?param=' + gObj.phpQuery.id + '&pi=1&pp=' + gObj.phpQuery.pp,
                dataType: 'json',
                success: function(data) {
                    loadingToggle( false );
                    tmp = '<div class="queryDiv"></div>';
                    tmp += '<div id="theadDiv-view_logs">';
                    tmp += '<table id="theadTable-view_logs">';
                    tmp += '<thead>';
                    tmp += '<tr>';
                    for (var i=0, len=gNode.col.view_logs.length; i<len; i++)
                    {
                        tmp += '<th class="ui-state-default" style="width: ' + gNode.col.view_logs[ i ].wiz+ ';">';
                        tmp += gNode.col.view_logs[ i ].label;
                        tmp += '</th>';
                    }
                    tmp += '</tr>';
                    tmp += '</thead>';
                    tmp += '</table>';
                    tmp += '</div>';
    
                    tmp += '<div id="tbodyDiv-view_logs">';
                    tmp += '<table id="tbodyTable-view_logs">';
                    tmp += '<tbody>';
                    if (parseInt(data.queryRows) > 0) {
                        for (var i=0; i<data.queryResults.length; i++)
                        {
                            tmp += '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                            for (var j=0; j<gNode.col.view_logs.length; j++)
                            {
                                tmp += '<td ';
                                if (gNode.col.view_logs[ j ].wiz)
                                    tmp += ' style="width:' + gNode.col.view_logs[ j ].wiz + ';"';
                                if (gNode.col.view_logs[ j ].align)
                                    tmp += ' class="align' + gNode.col.view_logs[ j ].align + '"';
                                tmp += '>';
                                if ( gNode.col.view_logs[ j ].tab == 'date' )
                                    tmp += data.queryResults[ i ].date + ' ' + data.queryResults[ i ].time;
                                else if ( gNode.col.view_logs[ j ].tab == 'severity' )
                                    tmp += gRef.loggings.severity[ data.queryResults[ i ][ gNode.col.view_logs[ j ].tab ] ];
                                else if (data.queryResults[ i ][ gNode.col.view_logs[ j ].tab ])
                                    tmp += data.queryResults[ i ][ gNode.col.view_logs[ j ].tab ];
                                else
                                    tmp += '';
                                tmp += '</td>';
                            }
                            tmp += '</tr>';
                        }
                    }
    
                    tmp += '</tbody>';
                    tmp += '</table>';
                    tmp += '</div>';

                    gY.one('#panel-view_logs').set('innerHTML', tmp);
                    phpQuery('view_logs');
                    gObj.phpQuery.ps = Math.ceil(data.queryRows/gObj.phpQuery.pp);
                    phpPager( 'view_logs' , gObj.phpQuery.pi, gObj.phpQuery.ps );
                    $('#pgSave').hide();
                    $('#pgCancel').hide();
                }
            });
    
            // log settings 
            $.ajax({
                url: 'cgi-bin/' + gNode.url.get[ 'log_settings' ] + '.cgi',
                dataType: 'json',
                success: function(data) {
                    $('#div-log_settings').empty();
                    $('#div-log_settings').append('<div id="div-log_enable"><table id="table-log_enable"></table></div>');
                    $('#div-log_settings').append('<div id="div-log_local"><table id="table-log_local"></table></div>');
                    $('#div-log_settings').append('<div id="div-log_remote"><table id="table-log_remote"></table></div>');
                    $('#div-log_settings').append('<div id="div-log_email"><table id="table-log_email"></table></div>');
    
                    tmp = '<tr>';
                    tmp += '<td class="alignCenter BT10">';
                    tmp += '<input type="checkbox" id="enable" value="1" />';
                    tmp += '</td>';
                    tmp += '<th class="alignLeft">';
                    tmp += '<label for="enable">' + gNode.col.log_settings[ 0 ].label + '</label>';
                    tmp += '</th>';
                    tmp += '</tr>';
                    $('#table-log_enable').append(tmp);
    
                    tmp = '<caption>' + gNode.col.log_settings[ 1 ].label + '</caption>';
                    tmp += '<tr>';
                    tmp += '<td class="alignCenter BT10">';
                    tmp += '<input type="checkbox" id="localLogEnable" value="1" />';
                    tmp += '</td>';
                    tmp += '<td colspan="2" class="alignLeft">';
                    tmp += '<label for="localLogEnable">' + gNode.col.log_settings[ 1 ].col[ 0 ].label + '</label>';
                    tmp += '</td>';
                    tmp += '</tr>';
    
                    tmp += '<tr>';
                    tmp += '<td class="alignCenter BT10">';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft BT80">';
                    tmp += '<label for="localLogSeverity">' + gNode.col.log_settings[ 1 ].col[ 1 ].label + '</label>';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft">';
                    tmp += '<select id="localLogSeverity"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';
    
                    $('#table-log_local').append(tmp);
    
                    tmp = '<caption>' + gNode.col.log_settings[ 2 ].label + '</caption>';
                    tmp += '<tr>';
                    tmp += '<td class="alignCenter BT10">';
                    tmp += '<input type="checkbox" id="remoteLogEnable" value="1" />';
                    tmp += '</td>';
                    tmp += '<td colspan="2" class="alignLeft">';
                    tmp += '<label for="remoteLogEnable">' + gNode.col.log_settings[ 2 ].col[ 0 ].label + '</label>';
                    tmp += '</td>';
                    tmp += '</tr>';
                        
                    tmp += '<tr>';
                    tmp += '<td class="alignCenter BT10">';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft BT80">';
                    tmp += '<label for="remoteLogServer">' + gNode.col.log_settings[ 2 ].col[ 1 ].label + '</label>';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft">';
                    tmp += '<input type="text" id="remoteLogServer">';
                    tmp += '</td>';
    
                    tmp += '<tr>';
                    tmp += '<td class="alignCenter BT10">';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft BT80">';
                    tmp += '<label for="remoteLogSeverity">' + gNode.col.log_settings[ 2 ].col[ 2 ].label + '</label>';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft">';
                    tmp += '<select id="remoteLogSeverity"></select>';
                    tmp += '</td>';
    
                    tmp += '</tr>';
    
                    $('#table-log_remote').append(tmp);
    
                    tmp = '<caption>' + gNode.col.log_settings[ 3 ].label + '</caption>';
                    tmp += '<tr>';
                    tmp += '<td class="alignCenter BT10">';
                    tmp += '<input type="checkbox" id="emailLogEnable" value="1" />';
                    tmp += '</td>';
                    tmp += '<td colspan="2" class="alignLeft">';
                    tmp += '<label for="emailLogEnable">' + gNode.col.log_settings[ 3 ].col[ 0 ].label + '</label>';
                    tmp += '</td>';
    
                    tmp += '<tr>';
                    tmp += '<td class="alignLeft BT10">';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft BT80">';
                    tmp += '<label for="emailSchUnit">' + gNode.col.log_settings[ 3 ].col[ 1 ].label + '</label>';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft">';
                    tmp += '<select id="emailSchUnit"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';
    
                    tmp += '<tr>';
                    tmp += '<td class="alignLeft BT10">';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft BT80">';
                    tmp += '<label for="emailSchDay">' + gNode.col.log_settings[ 3 ].col[ 2 ].label + '</label>';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft">';
                    tmp += '<select id="emailSchDay"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';
    
                    tmp += '<tr>';
                    tmp += '<td class="alignLeft BT10">';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft BT80">';
                    tmp += '<label for="emailSchTimeHour">' + gNode.col.log_settings[ 3 ].col[ 3 ].label + '</label>';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft">';
                    tmp += '<select id="emailSchTimeHour"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';
    
                    tmp += '<tr>';
                    tmp += '<td class="alignLeft BT10">';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft BT80">';
                    tmp += '<label for="emailLogSeverity">' + gNode.col.log_settings[ 3 ].col[ 4 ].label + '</label>';
                    tmp += '</td>';
                    tmp += '<td class="alignLeft">';
                    tmp += '<select id="emailLogSeverity"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';
    
                    $('#table-log_email').append(tmp);
                    gData.log_settings = data;
                    if (parseInt( data.enable ) == 1)
                        $('#enable').attr('checked', true);
                    if (parseInt( data.localLogEnable ) == 1)
                        $('#localLogEnable').attr('checked', true);
                    $('#localLogSeverity').append( genSelectOption( 'localLogSeverity' ) ).val( data.localLogSeverity );
                    if (parseInt( data.remoteLogEnable ) == 1)
                        $('#remoteLogEnable').attr('checked', true);
                    $('#remoteLogServer').val( data.remoteLogServer );
                    $('#remoteLogSeverity').append( genSelectOption( 'remoteLogSeverity' ) ).val( data.remoteLogSeverity );
                    if (parseInt( data.emailLogEnable ) == 1)
                        $('#emailLogEnable').attr('checked', true);
                    $('#emailSchUnit').append( genSelectOption( 'emailSchUnit' ) ).val( data.emailSchUnit );
                    $('#emailSchDay').append( genSelectOption( 'emailSchDay' ) ).val( data.emailSchDay );
                    $('#emailSchTimeHour').append( genSelectOption( 'emailSchTimeHour' ) ).val( data.emailSchTimeHour );
                    $('#emailLogSeverity').append( genSelectOption( 'emailLogSeverity' ) ).val( data.emailLogSeverity );

                    if (!gIf.power) {
                        $('#div-log_settings input').prop('disabled', true);
                        $('#div-log_settings select').prop('disabled', true);
                    }
                }
            })
    
            // logs facility 
            $.ajax({
                url: 'cgi-bin/' + gNode.url.get[ 'logs_facility' ] + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gData.logs_facility = data;
                    gCache.facility = {};
                    gCache.facility.localLogFacilities = data.localLogFacilities.split('|');
                    gCache.facility.remoteLogFacilities = data.remoteLogFacilities.split('|');
                    gCache.facility.emailLogFacilities = data.emailLogFacilities.split('|');
    
                    tmp = '<table id="table-logs_facility">';
                    tmp += '<thead>';
                    tmp += '<tr>';
                    tmp += '<th class="ui-state-default" id="logFacilities">' + gNode.col.logs_facility[ 0 ].label + '</th>';
                    tmp += '<th class="ui-state-default checkboxCol" id="localLogFacilities">' + gNode.col.logs_facility[ 1 ].label + '</th>';
                    tmp += '<th class="ui-state-default checkboxCol" id="remoteLogFacilities">' + gNode.col.logs_facility[ 2 ].label + '</th>';
                    tmp += '<th class="ui-state-default checkboxCol" id="emailLogFacilities">' + gNode.col.logs_facility[ 3 ].label + '</th>';
                    tmp += '</tr>';
                    tmp += '</thead>';
                    tmp += '<tbody>';
                    tmp += '</tbody>';
                    tmp += '</table>';
    
                    $('#div-logs_facility').append( tmp );
    
                    var cnt = 0;
                    for (var x in gRef.loggings.facility)
                    {
                        tmp = '<tr class="' + ((cnt%2 == 0)? 'even' : 'odd') + '">';
                        tmp += '<td id="' + x + '">' + gRef.loggings.facility[ x ] + '</td>';
                        for (var y in gCache.facility)
                        {
                            tmp += '<td class="checkTD">';
                            tmp += '<input type="checkbox" id="' + y + '-' + cnt + '" value="' + x + '" />';
                            tmp += '</td>';
                        }
                        tmp += '</tr>';
                        $('#table-logs_facility').append(tmp);
                        for (var y in gCache.facility)
                        {
                            if (gCache.facility[y].indexOf( x ) != -1)
                                $('#' + y + '-' + cnt).attr('checked', true);
                        }
                        cnt++;
                    }

                    if (!gIf.power) {
                        $('#div-logs_facility input').prop('disabled', true);
                    }
                }
            });
            break;
        }
    }
    
    function refreshDevice( pid ) {
        var tmp = '';
        var query = '';
    
        switch ( pid )
        {
        case 'management_settings':
            var tableID = '#table-management_setting';
            var cgiT     = 'guiManagementInterfaceT';
            var cgiTNum    = 'guiManagementInterfaceTNum';
            var tableBD = tableID + ' > tbody';
            $(tableBD).empty();
        
            for (var i=0, len=parseInt(gData[ pid ][ gNode.guiTNum ]); i<len; i++)
            {
                tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
                $(tableID + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    tmp += '<td id="' + thID + '-' + i + '">';
                    switch(thID)
                    {
                    case 'action':
                        tmp += '<button id="Edit-' + pid + '-' + i + '" class="Edit" title="Edit"><span class="ui-icon"></span></button>';
                        break;
                    case 'interfaceId':
                        tmp += gCache.name[ parseInt(gData[ pid ][ gNode.guiT ][ i ][ thID ]) ];
                        break;
                    case 'accessAddressId':
                        tmp += (parseInt( gData[ pid ][ gNode.guiT ][i][thID] ) == 0)? gTerm[ gObj.lang ].Any : gCache.address[ parseInt(gData[ pid ][ gNode.guiT ][ i ][ thID ]) ];
                        break;
                    default:
                        tmp += gRef[ gNode.url.get ].enabled[ gData[ pid ][ gNode.guiT ][ i ][ thID ] ];
                    }
                    tmp += '</td>';
                });
                tmp += '</tr>';
                $(tableBD).append(tmp);
            }
            
            break;
        case 'view_logs':
            var tableID = '#tbodyTable-view_logs';
            var tableBD = tableID + ' > tbody';
            
            if (gNode.pager) {
                gObj.phpQuery.pp = $('#phpPerPage').val();
                if (gIf.query)
                    query += gQuery.q;

                query += '&pi=' + gObj.phpQuery.pi + '&pp=' + gObj.phpQuery.pp;
            }
            
            loadingToggle( true );
            $.ajax({
                url: gObj.phpQuery.php + '.php?param=' + pid + query,
                dataType: 'json',
                success: function(data) {
                    loadingToggle( false );
                    $(tableBD).remove();
                    if (parseInt( data.queryRows ) > 0) {
                        tmp = '<tbody>';
                        for (var i=0, len=data.queryResults.length; i<len; i++)
                        {
                            tmp += '<tr class="' + ( (i%2==0)? 'even': 'odd' )+ '">';
                            for (var j=0; j<gNode.col.view_logs.length; j++)
                            {
                                tmp += '<td ';
                                if (gNode.col.view_logs[ j ].wiz)
                                    tmp += ' style="width:' + gNode.col.view_logs[ j ].wiz + '";';
                                if (gNode.col.view_logs[ j ].align)
                                    tmp += ' class="align' + gNode.col.view_logs[ j ].align + '"';
                                tmp += '>';
                                if ( gNode.col.view_logs[ j ].tab == 'date' )
                                    tmp += data.queryResults[ i ].date + ' ' + data.queryResults[ i ].time;
                                else if ( gNode.col.view_logs[ j ].tab == 'severity' )
                                    tmp += gRef.loggings.severity[ data.queryResults[ i ][ gNode.col.view_logs[ j ].tab ] ];
                                else if (data.queryResults[ i ][ gNode.col.view_logs[ j ].tab ])
                                    tmp += data.queryResults[ i ][ gNode.col.view_logs[ j ].tab ];
                                else
                                    tmp += '';
                                tmp += '</td>';
                            }
                            tmp += '</tr>';
                        }
                
                        tmp += '</tbody>';
                        $(tableID).append(tmp);
                    }
                    if (gNode.pager) {
                        gObj.phpQuery.ps = Math.ceil(data.queryRows/gObj.phpQuery.pp);
                        phpPager( pid , gObj.phpQuery.pi, gObj.phpQuery.ps );
                    }
                }
            });
            break;
        }
    }
    
    function createDevice(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');

        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];

        tar.w = 500;
        tar.h = 250;

        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');

        $('#popForm').html('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"><table id="Editor-table-' + tar.pid + '"></table></div></div>');
        var tmp = '';
        switch( tar.pid )
        {
        case 'backup_restore':
            for (var i=0, len=gNode.editor.create.length; i<len; i++)
            {
                tmp = '<tr>';
                tmp += '<th class="alignLeft BT100">' + gNode.editor.create[ i ].label + '</th>';
                tmp += '<td class="alignLeft">';
                if ('radio' == gNode.editor.create[ i ].type) { 
                    tmp += '<table>';
                    for (var x in gNode.editor.create[ i ].option)
                    {
                        tmp += '<tr>';
                        tmp += '<td class="alignLeft BT80">';
                        tmp += '<input type="radio" id="Editor-' + gNode.editor.create[ i ].tab + '-' + x + '" name="Editor-' + gNode.editor.create[ i ].tab + '" value="' + x + '" />&nbsp;<label for="Editor-' + gNode.editor.create[ i ].tab + '-' + x + '">' + gNode.editor.create[ i ].option[ x ].label + '</lable>';
                        tmp += '</td>';
                        if ( 'file' == gNode.editor.create[ i ].option[ x ].tag ) {
                            tmp += '<td class="alignLeft BT100">';
                            tmp += '<div id="Editor-' + gNode.editor.create[ i ].option[ x ].tab + '"></div>';
                            tmp += '</td>';
                            tmp += '<td class="alignLeft">';
                            tmp += '<div id="Editor-' + gNode.editor.create[ i ].option[ x ].tab + '-status"></div>';
                            tmp += '</td>';
                        } else {
                            tmp += '<td colspan="2" class="alignLeft">';
                            tmp += '<select id="Editor-' + gNode.editor.create[ i ].option[ x ].tab + '"></select>';
                            tmp += '</td>';
                        }
                        tmp += '</tr>';
                    }
                    tmp += '</table>';
                } else {
                    tmp += '<input type="text" id="Editor-' + gNode.editor.create[ i ].tab + '" />';
                }
                tmp += '</td>';
                tmp += '</tr>';
                $('#Editor-table-' + tar.pid).append( tmp );
            }

            break;
        }
        deviceEditor( e, tar.w, tar.h );
    }

    function editDevice(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
    
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        tar.thisNo = tar.id.split(gReg.isDash)[2];
    
        tar.w = 400;
        tar.h = 300;
    
        if (!($('#popForm').exists()))
            $('#popBase').append('<div id="popForm"></div>');
    
        $('#popForm').html('<div class="formDiv"><div id="Editor-div-' + tar.pid + '"><table id="Editor-table-' + tar.pid + '"></table></div></div>');
        var tmp;
        switch( tar.pid )
        {
        case 'management_settings':
            tmp = '<tr>';
            tmp += '<th class="alignLeft BT80">' + gNode.editor[ 0 ].label + '</th><td class="alignLeft" id="Editor-interfaceId"></td>';
            tmp += '</tr>';
    
            tmp += '<tr>';
            tmp += '<th class="alignLeft " colspan="2"><input type="checkbox" id="Editor-pingEnabled" value="1" /><label for="Editor-pingEnabled">&nbsp;' + gNode.editor[ 1 ].label + '</label></th>';
            tmp += '</tr>';
    
            tmp += '<tr>';
            tmp += '<th class="alignLeft " colspan="2"><input type="checkbox" id="Editor-httpsEnabled" value="1" /><label for="Editor-httpsEnabled">&nbsp;' + gNode.editor[ 2 ].label + '</label></th>';
            tmp += '</tr>';
    
            tmp += '<tr>';
            tmp += '<th class="alignLeft " colspan="2"><input type="checkbox" id="Editor-sshEnabled" value="1" /><label for="Editor-sshEnabled">&nbsp;' + gNode.editor[ 3 ].label + '</label></th>';
            tmp += '</tr>';
    
            tmp += '<tr>';
            tmp += '<th class="alignLeft BT80">' + gNode.editor[ 4 ].label + '</th><td class="alignLeft"><select id="Editor-accessAddressId"></select></td>';
            tmp += '</tr>';
    
            $('#Editor-table-' + tar.pid).html( tmp );
    
            $('#Editor-interfaceId').html( gCache.name[ gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].interfaceId ] );
            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].pingEnabled )) {
                $('#Editor-pingEnabled').attr('checked', true);
            }
            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].httpsEnabled )) {
                $('#Editor-httpsEnabled').attr('checked', true);
            }
            if (1 === parseInt( gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].sshEnabled )) {
                $('#Editor-sshEnabled').attr('checked', true);
            }
            cgiSelectOption( 'Editor-accessAddressId', gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].accessAddressId );
            break;
        }
    
        deviceEditor( e, tar.w, tar.h );
    }
    
    function deleteDevice(e) {
        var tar = {};
    
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid = tar.id.split('-')[ 1 ];
        tar.thisNo = tar.id.split('-')[ 2 ];

        gIf.alter = false;
        switch( tar.pid )
        {
        case 'backup_restore':
            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
            $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(gData[ tar.pid ]), function( poster ) {
                genDevice( tar.pid );
            });
            break;
        case 'packet_capture':
            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].delete = 1;
            $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(gData[ tar.pid ]), function( poster ) {
                genDevice( tar.pid );
            });
            break;
        case 'log':
            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].delete = 1;
            $.post('cgi-bin/' + gNode.url.log + '.cgi', gY.JSON.stringify(gData[ tar.pid ]), function( poster ) {
                genDevice( 'advanced_debug' );
            });
            break;
        case 'debug':
            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].delete = 1;
            $.post('cgi-bin/' + gNode.url.debug + '.cgi', gY.JSON.stringify(gData[ tar.pid ]), function( poster ) {
                genDevice( 'advanced_debug' );
            });
            break;
        }
    }

    function removeDevice(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
    
        gIf.alter = false;

        switch( tar.pid ) 
        {
        case 'packet_capture':
            $('#table-' + tar.pid + ' tr').each(function() {
                tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
                switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
                {
                case true:
                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].delete = 1;
                    break;
                }
            });

            $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(gData[ tar.pid ]), function( poster ) {
                genDevice( tar.pid );
            });
            break;
        case 'backup_restore':
            $('#table-' + tar.pid + ' tr').each(function() {
                tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
                switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
                {
                case true:
                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
                    break;
                }
            });

            $.post('cgi-bin/' + gNode.url.post + '.cgi', gY.JSON.stringify(gData[ tar.pid ]), function( poster ) {
                genDevice( tar.pid );
            });
            break;
        case 'debug':
        case 'log':
            $('#table-' + tar.pid + '_list tr').each(function() {
                tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
                switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
                {
                case true:
                    gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].delete = 1;
                    break;
                }
            });

            $.post('cgi-bin/' + gNode.url[ tar.pid ] + '.cgi', gY.JSON.stringify(gData[ tar.pid ]), function( poster ) {
                genDevice( 'advanced_debug' );
            });
            break;
        }
    }

    function deviceEditor(e, w, h) {
        var tar = {};
    
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[1];
    
        if (gObj.active.h5Index == 'NA') {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ((gNode.tabs)? ' > ' + gNode.tabs[ tar.pid ] : '');
        }else {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].label + ((gNode.tabs)? ' > ' + gNode.tabs[ tar.pid ] : '');
        }
    
        gPop.popForm = $('#popForm').dialog({
            width: w || 800,
            height: h || 600,
            position: "center",
            resizable: false,
            modal: true,
            title: tar.title + ' > ' + gTerm[ gObj.lang ][ tar.type ],
            buttons: {
                OK: function() {
                    if (deviceChecker(e)) {
                        gObj.form = {};
                        switch( tar.pid ) 
                        {               
                        case 'backup_restore':               
                            gObj.form.profileName = $('#Editor-name').val();
                            gObj.form.profileDesc = $('#Editor-desc').val();

                            switch( parseInt( $('input[name=Editor-baseOn]:checked').val() ) )
                            {
                            case 0:
                                gObj.form.baseOn = $('#Editor-baseOn-device').val();

                                $.ajax({
                                    type: "POST",
                                    url: 'cgi-bin/' + gNode.url.baseOnDevice + '.cgi',
                                    data: gObj.form,
                                    success: function(data) {
                                        if (0 === parseInt( data.status ) )
                                            genDevice( 'backup_restore' );
                                        else
                                            errorAlert('<p>' + gError[ gObj.lang ][ data.msg ] + '</p>');
                                    }
                                });
                                break;
                            case 1:
                                if (!gIf.uploaded && gObj.uploader.get("fileList").length > 0) {
                                    if (gIf.invalid) {
                                        $('.errorMsg').html( gError[ gObj.lang ].please_check_file );
                                    } else {
                                        loadingToggle( true );
                                        gObj.uploader.upload(gObj.uploaderFile, gObj.uploader.uploadURL, gObj.form);
                                    }
                                } else {
                                    errorAlert('<p>' + gError[ gObj.lang ].profileName + '</p>');
                                }
                                break;
                            case 2:
                                gObj.form.fpath = $('#Editor-baseOn-usb').val();

                                $.ajax({
                                    type: "POST",
                                    url: 'cgi-bin/' + gNode.url.baseOnUSB + '.cgi',
                                    data: gObj.form,
                                    success: function(data) {
                                        if (0 === parseInt( data.status ) )
                                            genDevice( 'backup_restore' );
                                        else
                                            errorAlert('<p>' + gError[ gObj.lang ][ data.msg ] + '</p>');
                                    }
                                });
                                break;
                            }

                            break;
                        case 'management_settings':               
                            tar.thisNo  = tar.id.split(gReg.isDash)[2];
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].pingEnabled = ($('#Editor-pingEnabled').is(':checked'))? 1 : 0;
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].httpsEnabled = ($('#Editor-httpsEnabled').is(':checked'))? 1 : 0;
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].sshEnabled = ($('#Editor-sshEnabled').is(':checked'))? 1 : 0;
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].accessAddressId = $('#Editor-accessAddressId').val();
                            gData[ tar.pid ][ gNode.guiT ][ tar.thisNo ].cgiAction = 2;
    
                            refreshDevice( tar.pid );
    
                            break;               
                        }               
                        $( this ).dialog( "close" );
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            open: function(event, ui) {
                switch( tar.pid )
                {
                case 'backup_restore':
                    cgiSelectOption('Editor-baseOn-device'); 

                    gObj.uploader = new gY.Uploader({
                                       width: "100px",
                                       multipleFiles: false,
                                       fileFieldName: 'binary',
                                       swfURL: "assets/flashuploader.swf?t=" + Math.random(),
                                       uploadURL: "cgi-bin/" + gNode.url.baseOnPC + ".cgi",
                                       simLimit: 1,
                                       withCredentials: false
                                   });
                    gIf.uploaded = false;

                    gObj.uploader.render("#Editor-baseOn-pc");

                    gObj.uploader.after("fileselect", function (e) {
                        gIf.invalid = false;
                        gObj.uploaderFile = e.fileList[0];
                        gY.one("#Editor-baseOn-pc-status").set("text", gObj.uploaderFile.get('name') );
                    });

                    gObj.uploader.on("uploadprogress", function (e) {
                        $('.processDiv').progressbar({ value: parseInt( e.percentLoaded ) });
                    });

                    gObj.uploader.on("uploadstart", function (e) {
                        gObj.uploader.set("enabled", false);
                    });

                    gObj.uploader.on("uploadcomplete", function (e) {
                        var json = gY.JSON.parse(e.data);
                        loadingToggle( false );
                        if (parseInt(json.status) == 0) {
                            gIf.uploaded = true;
                            genDevice( 'backup_restore' );
                        } else {
                            gIf.uploaded = false;
                            gIf.invalid = true;
                            errorAlert( '<p>' + json.msg + '</p>' );
                        }
                    });
                 
                    $('#Editor-baseOn-usb').html('<option value="NA">' + gTerm[ gObj.lang ].selectFromUSB + '</option>');
                    $('input[name=Editor-baseOn]').change( function() {
                        $('#Editor-baseOn-device').prop('disabled', true);
                        $('#Editor-baseOn-pc button').prop('disabled', true);
                        $('#Editor-baseOn-usb').prop('disabled', true);
                        switch( parseInt( $(this).val() ) )
                        {
                        case 0:
                            $('#Editor-baseOn-device').prop('disabled', false);
                            break;
                        case 1:
                            $('#Editor-baseOn-pc button').prop('disabled', false);
                            break;
                        case 2:
                            $.ajax({
                                url: 'cgi-bin/common_usbFile_list.cgi',
                                dataType: 'json',
                                success: function(data) {
                                    gData[ 'common_usbFile_list' ] = data;
                                    $('#Editor-baseOn-usb').html('<option value="NA">' + gTerm[ gObj.lang ].selectFromUSB + '</option>');
                                    if (1 === parseInt(data.status)) {
                                        $('#Editor-baseOn-usb').prop('disabled', false);
                                        for (var i=0, len=data.guiUsbFileT.length; i<len; i++) {
                                            $('#Editor-baseOn-usb').append('<option value="' + data.guiUsbFileT[ i ].path + '">' + data.guiUsbFileT[ i ].name + '</option>');
                                        }
                                    } else {
                                        $('#Editor-baseOn-2').prop('disabled', true);
                                    }
                                }
                            }); 
                            break;
                        }   
                    }).eq( 0 ).trigger('click');
                    
                    break;
                }
            },
            close: function(event, ui) {
                $(this).dialog('destroy').remove();
            }
        });
    }
    
    function deviceChecker(e, pid) {
    
        var tar = {};
    
        if (pid) {
            tar.pid = pid;
            tar.type = 'Save';
        }else {
            tar.id = $(e.currentTarget).attr('id');
            if (!tar.id)
                return false;
            tar.type  = tar.id.split(gReg.isDash)[0];
    
            tar.pid  = tar.id.split(gReg.isDash)[1];
    
            if (tar.type == 'Create')
                tar.thisNo = parseInt( gData[ tar.pid ][ gNode.guiTNum ] );
            else 
                tar.thisNo = tar.id.split(gReg.isDash)[2];
        }
    
        var pass = true;
        var msg = '';
        switch(tar.pid)
        {
        case 'administrator_settings' :
            if ($('#adminNewPwd').val().length > 0 || $('#adminNewPwdConfirm').val().length > 0) {
                // pwd change, check
                if ( $('#adminNewPwd').val() == $('#adminNewPwdConfirm').val() ) {
                    if ($('#adminOldPwd').val().length > 0 && $('#adminName').val().length > 0) {
                        gData[ pid ].setPassword = 1;
                    }else {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].adminPwd + '</p>';
                    }
                }else {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].adminPwdMatch + '</p>';
                }
            }
    
            if (!gReg.loginInactiveTimeout.test($('#loginInactiveTimeout').val())) { 
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].inactiveTimeout + '</p>';
            }
    
            if (!gReg.loginSessionLimit.test($('#loginSessionLimit').val())){
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].sessionLimit + '</p>';
            }
    
            if (!gReg.loginFailBlockMaxAttempts.test($('#loginFailBlockMaxAttempts').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].blockPwd + '</p>';
            }
    
            if (!gReg.loginFailBlockTime.test($('#loginFailBlockTime').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].blockAccess + '</p>';
            }
            break;
        case 'management_settings' :
            if (!gReg.portList.test($('#httpsPort').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].httpsPortRange + '</p>';
            }
    
            if (!gReg.portList.test($('#sshPort').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].sshPortRange + '</p>';
            }
    
            break;
        case 'email_alert' :
            if (!(gReg.ipv4.test( $('#server').val() ) || gReg.isURL.test( $('#server').val() ) ) ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].smtpServer + '</p>';
            }
    
            if (!gReg.portList.test( $('#port').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].portList + '</p>';
            }

            if ($('#enableAuth').is(':checked')) {
                if (!gReg.userOut63.test( $('#account').val() )) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].userOut63 + '</p>';
                }
    
                if (!gReg.passOut63.test( $('#password').val() )) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].passOut63 + '</p>';
                }
            }
    
            if (!gReg.isEmail.test( $('#fromEmail').val() ) || !gReg.email.test( $('#fromEmail').val() ) ) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].fromEmail + '</p>';
            }
   
            gIf.toEmail = false;
            gObj.toEmails = [];

            if ( gReg.email.test( $('#toEmail0').val() ) ) {
                if (gReg.isEmail.test( $('#toEmail0').val() )) {
                    gObj.toEmails.push( $('#toEmail0').val() );
                    gIf.toEmail = true;
                } else {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].toEmail + '</p>';
                }
            }

            if ( gReg.email.test( $('#toEmail1').val() ) ) {
                if (gReg.isEmail.test( $('#toEmail1').val() )) {
                    gObj.toEmails.push( $('#toEmail1').val() );
                    gIf.toEmail = true;
                } else {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].toEmail + '</p>';
                }
            }

            if ( gReg.email.test( $('#toEmail2').val() ) ) {
                if (gReg.isEmail.test( $('#toEmail2').val() )) {
                    gObj.toEmails.push( $('#toEmail2').val() );
                    gIf.toEmail = true;
                } else {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].toEmail + '</p>';
                }
            }

            if (!gIf.toEmail) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].toEmail + '</p>';
            }

            if ($('#cpuAlertEnable').is(':checked') && !gReg.cpuAlertThreshold.test( $('#cpuAlertThreshold').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].cpuThreshold + '</p>';
            }
    
            if ($('#diskAlertEnable').is(':checked') && !gReg.diskAlertThreshold.test( $('#diskAlertThreshold').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].diskThreshold + '</p>';
            }
    
            if ($('#wanAlertEnable').is(':checked') && !gReg.alertInterval.test( $('#wanAlertInterval').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].wanAlertInterval + '</p>';
            }
    
            if ($('#virusAlertEnable').is(':checked') && !gReg.alertInterval.test( $('#virusAlertInterval').val() )) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].virusAlertInterval + '</p>';
            }
    
            //if ($('#ipsAlertEnable').is(':checked') && !gReg.alertInterval.test( $('#ipsAlertInterval').val() )) {
            //    pass = false;
            //    msg += '<p>' + gError[ gObj.lang ].ipsAlertInterval + '</p>';
            //}
            break;
        case 'backup_restore':
            if (!gReg.ascii.default.test($('#Editor-name').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].name63 + '</p>';
            }

            if (!gReg.length255.test($('#Editor-desc').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].desc255 + '</p>';
            }


            if ($('#Editor-baseOn-0').is(':checked') && gReg.isNA.test($('#Editor-baseOn-device').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].profileNA + '</p>';
            }

            break;
        case 'proxy':
            if ($('#enable').is(':checked')) {
                 if (!(gReg.ipv4.test( $('#serverAddr').val() ) || gReg.isURL.test( $('#serverAddr').val() ) ) ) {
                     pass = false;
                     msg += '<p>' + gError[ gObj.lang ].proxyAddr + '</p>';
                 }
 
                 if (!gReg.portList.test( $('#serverPort').val()) ) {
                     pass = false;
                     msg += '<p>' + gError[ gObj.lang ].proxyPort + '</p>';
                 }
 
                 if ($('#authenicationMode').is(':checked')) {
                     if (!gReg.userOut63.test($('#proxyUser').val())) {
                         pass = false;
                         msg += '<p>' + gError[ gObj.lang ].proxyUser + '</p>';
                     }
 
                     if (!gReg.passOut.test($('#proxyUserPwd').val())) {
                         pass = false;
                         msg += '<p>' + gError[ gObj.lang ].proxyUserPwd + '</p>';
                     }
                 }
            }
            break;
        case 'advanced_debug' :
            if (!gReg.length0127.test($('#log-logDesc').val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].length0127 + '</p>';
            }
            break;
        case 'registration' :
            if (gData[ pid ].haveAccount == 0) {
                $('.newUsername').removeClass('isOK');
                $('.newUsername').removeClass('isKO');
                if ($('#registrationMode-0').is(':checked')) {
                    // new
                    if (!gReg.ascii.username.test($('#newUsername').val())) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].account20 + '</p>';
                    }

                    if (gReg.ascii.userpass.test($('#newPassword').val())) {
                        if ($('#newPassword').val() != $('#confirmPassword').val()) {
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].passwordMatch + '</p>';
                        }
                    }else {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].password20 + '</p>';
                    }
    
                    if (!gReg.ascii.license32.test($('#firstName').val())) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].firstName32 + '</p>';
                    }
    
                    if (!gReg.ascii.license32.test($('#lastName').val())) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].lastName32 + '</p>';
                    }
    
                    if (!gReg.isEmail.test( $('#email').val() ) || !gReg.email.test( $('#email').val() )) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].email + '</p>';
                    }
    
                    if (!gReg.ascii.license064.test($('#comapny').val())) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].company64 + '</p>';
                    }

                    if (!gReg.ascii.license64.test($('#raddress').val())) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].address64 + '</p>';
                    }
    
                    if (!gReg.ascii.license32.test($('#city').val())) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].city32 + '</p>';
                    }
    
                    if (!gReg.isZipCode.test($('#zipCode').val())) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].zipCode + '</p>';
                    }
    
                    if (!gReg.ascii.license32.test($('#state').val())) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].state32 + '</p>';
                    }
    
                    if ($('#country').val() == 'NA') {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].countryNeed + '</p>';
                    }
    
                }else {
                    // existing
                    if (!gReg.ascii.username.test($('#oldUsername').val())) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].account20 + '</p>';
                    }
    
                    if (!gReg.ascii.userpass.test($('#oldPassword').val())) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].password20 +  '</p>';
                    }
                }
            }
            break;
        case 'properties':
            if (!gReg.hostname.test($('#' + gNode.col[ 0 ].tab).val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].hostName +  '</p>';
            }
    
            if (!gReg.domainName.test($('#' + gNode.col[ 1 ].tab).val())) {
                pass = false;
                msg += '<p>' + gError[ gObj.lang ].domainName +  '</p>';
            }
            break;
        }
    
        if (!pass) {
            errorAlert( msg );
        }
        return pass;
    }
    
    function saveDevice(pid) {
        var checker = {};
        var msg = '';
        switch(pid)
        {
        case 'administrator_settings':
            //checker = callCheckers( pid );
            checker = formChecker( pid );
            if (checker.pass) {
                if (1 === tar.setPassword) {
                    gData[ pid ].setPassword = tar.setPassword;
                    gData[ pid ].adminName = $('#adminName').val();
                    gData[ pid ].adminOldPwd = $('#adminOldPwd').val();
                    gData[ pid ].adminNewPwd = $('#adminNewPwd').val();
                }
                gData[ pid ].loginInactiveTimeout = $('#loginInactiveTimeout').val();
                gData[ pid ].loginSessionLimitEnable = ($('#loginSessionLimitEnable').is(':checked'))? 1 : 0;
                gData[ pid ].loginSessionLimit = $('#loginSessionLimit').val();
                gData[ pid ].loginFailBlockMaxAttempts = $('#loginFailBlockMaxAttempts').val();
                gData[ pid ].loginFailBlockTime = $('#loginFailBlockTime').val();
                gIf.limited = (1 === parseInt(gData.loginSessionLimitEnable) )? true : false;
            } else {
                for (var i=0, len=checker.cols.length; i<len; i++)
                {
                    if (!checker.cols[ i ].pass) {
                        msg += '<p>' + gError[ gObj.lang ][ checker.cols[ i ].id ] + '</p>';
                    } else if (checker.cols[ i ].check && !checker.cols[ i ].check.pass) {
                        msg += '<p>' + gError[ gObj.lang ][ checker.cols[ i ].check.id ] + '</p>';
                    }
                }
                errorAlert( msg );
                return false;
            }
            break;
        case 'management_settings':
            if (deviceChecker(null, pid)) {
                gData[ pid ].httpsPort = $('#httpsPort').val();
                gData[ pid ].sshPort = $('#sshPort').val();
            } else {
                return false;
            }
            break;
        case 'log_settings':
            if (deviceChecker(null, pid)) {
                if ($('#enable').is(':checked'))
                    gData[ pid ].enable = 1;
                else 
                    gData[ pid ].enable = 0;
                
                if ($('#localLogEnable').is(':checked'))
                    gData[ pid ].localLogEnable = 1;
                else 
                    gData[ pid ].localLogEnable = 0;
                gData[ pid ].localLogSeverity = $('#localLogSeverity').val();
    
                if ($('#remoteLogEnable').is(':checked'))
                    gData[ pid ].remoteLogEnable = 1;
                else 
                    gData[ pid ].remoteLogEnable = 0;
                gData[ pid ].remoteLogServer = $('#remoteLogServer').val();
                gData[ pid ].remoteLogSeverity = $('#remoteLogSeverity').val();
    
                if ($('#emailLogEnable').is(':checked'))
                    gData[ pid ].emailLogEnable = 1;
                else 
                    gData[ pid ].emailLogEnable = 0;
                gData[ pid ].emailSchUnit = $('#emailSchUnit').val();
                gData[ pid ].emailSchDay = $('#emailSchDay').val();
                gData[ pid ].emailSchTimeHour = $('#emailSchTimeHour').val();
                gData[ pid ].emailLogSeverity = $('#emailLogSeverity').val();
            }
            break;
        case 'logs_facility':
            if (deviceChecker(null, pid)) {
                gData[ pid ] = { "localLogFacilities": "", "remoteLogFacilities": "", "emailLogFacilities": "" };
                gObj.cache = { "localLogFacilities": [], "remoteLogFacilities": [], "emailLogFacilities": [] };
                $('#table-logs_facility tbody tr').each(function() {
                    $(this).find('td input:checkbox').each(function() {
                        var thID = $(this).attr('id').replace(/-\d+/,'');
                        if ($(this).is(':checked'))
                            gObj.cache[ thID ].push( $(this).val() );
                    });
                });
    
                for (var x in gObj.cache)
                {
                    if (gObj.cache[ x ].length > 0)
                        gData[ pid ][ x ] = gObj.cache[ x ].join('|');
                }
            }
            break;
        case 'email_alert':
            if (deviceChecker(null, pid)) {
                gData.email_alert.server = $('#server').val();
                gData.email_alert.port = $('#port').val();
                gData.email_alert.secureMethod = $('#secureMethod').val();
    
                if ($('#enableAuth').is(':checked')) {
                    gData.email_alert.enableAuth = 1;
                    gData.email_alert.account = $('#account').val();
                    gData.email_alert.password = $('#password').val();
                } else {
                    gData.email_alert.enableAuth = 0;
                }    

                gData.email_alert.fromEmail = $('#fromEmail').val();
                gData.email_alert.toEmail = gObj.toEmails.join(';');
    
                gData.email_alert.cpuAlertEnable = ($('#cpuAlertEnable').is(':checked'))? 1 : 0;
                gData.email_alert.cpuAlertThreshold = $('#cpuAlertThreshold').val();
                gData.email_alert.newFwAlertEnable = ($('#newFwAlertEnable').is(':checked'))? 1 : 0;
                gData.email_alert.restartAlertEnable = ($('#restartAlertEnable').is(':checked'))? 1 : 0;
                gData.email_alert.failLoginAlertEnable = ($('#failLoginAlertEnable').is(':checked'))? 1 : 0;
                gData.email_alert.diskAlertEnable = ($('#diskAlertEnable').is(':checked'))? 1 : 0;
                gData.email_alert.diskAlertThreshold = $('#diskAlertThreshold').val();
                gData.email_alert.vpnAlertEnable = ($('#vpnAlertEnable').is(':checked'))? 1 : 0;
                gData.email_alert.wanAlertEnable = ($('#wanAlertEnable').is(':checked'))? 1 : 0;
                gData.email_alert.wanAlertInterval = $('#wanAlertInterval').val();
                gData.email_alert.virusAlertEnable = ($('#virusAlertEnable').is(':checked'))? 1 : 0;
                gData.email_alert.virusAlertInterval = $('#virusAlertInterval').val();
                //gData.email_alert.ipsAlertEnable = ($('#ipsAlertEnable').is(':checked'))? 1 : 0;
                //gData.email_alert.ipsAlertInterval = $('#ipsAlertInterval').val();
                //gData.email_alert.urlAlertEnable = ($('#urlAlertEnable').is(':checked'))? 1 : 0;
            } else {
                return false;
            }
            break;
        case 'proxy':
            if (deviceChecker(null, pid)) {
                gData.proxy.enable = ($('#enable').is(':checked'))? 1 : 0;
                if (1 === gData.proxy.enable) {
                    gData.proxy.serverAddr = $('#serverAddr').val();
                    gData.proxy.serverPort = $('#serverPort').val();
                    gData.proxy.proxyAuthenicationMode = ($('#proxyAuthenicationMode').is(':checked'))? 1 : 0;
                    if (1 === parseInt( gData.proxy.proxyAuthenicationMode )) {
                        gData.proxy.proxyUser = $('#proxyUser').val();
                        gData.proxy.proxyUserPwd = $('#proxyUserPwd').val();
                    }
                }
                cgiID = 'av_proxy';
                $.post('cgi-bin/' + cgiID + '.cgi', gY.JSON.stringify(gData.proxy), function( poster ) {
                    if (0 === parseInt( poster.status ) )
                        getCgiList(gObj.active.pid);
                    else 
                        errorAlert( poster.msg );
                });
            }
            return false;
            break;
        case 'advanced_debug':
            //checker = callCheckers( 'log' );
            checker = formChecker( 'log' );
            if (checker.pass) {
                if ($('#logEnable').is(':checked')) 
                    gData.advanced_debug.logEnable = 1;
                else
                    gData.advanced_debug.logEnable = 0;
                gData.advanced_debug.logDesc = $('#logDesc').val();
                gObj.tabIndex = 0;
            } else {
                for (var i=0, len=checker.cols.length; i<len; i++)
                {
                    if (!checker.cols[ i ].pass) {
                        msg += '<p>' + gError[ gObj.lang ][ checker.cols[ i ].id ] + '</p>';
                    }
                }
                errorAlert( msg );
                return false;
            }
            break;
        case 'registration':
            if (deviceChecker(null, pid)) {
                if ( 0 === parseInt( gData[ pid ].haveAccount ) ) {
                    if ($('#registrationMode-0').is(':checked')) {
                        gData[ pid ].registrationMode = 0;
                        gData[ pid ].newUsername = $('#newUsername').val();
                        gData[ pid ].newPassword = $('#newPassword').val();
                        gData[ pid ].firstName = $('#firstName').val();
                        gData[ pid ].lastName = $('#lastName').val();
                        gData[ pid ].email = $('#email').val();
                        gData[ pid ].company = $('#company').val();
                        gData[ pid ].address = $('#raddress').val();
                        gData[ pid ].city = $('#city').val();
                        gData[ pid ].zipCode = $('#zipCode').val();
                        gData[ pid ].state = $('#state').val();
                        gData[ pid ].country = $('#country').val();
                    }else {
                        gData[ pid ].registrationMode = 1;
                        gData[ pid ].oldUsername = $('#oldUsername').val();
                        gData[ pid ].oldPassword = $('#oldPassword').val();
                    }
                }else {
                    gData[ pid ].registrationMode = 3;
                }
    
                if ($('#trialCodeActivation').is(':checked')) 
                    gData[ pid ].enableTrial = 1;
                else 
                    gData[ pid ].enableTrial = 0;
            } else {
                return false;
            }
            break;
        case 'properties':
            if (deviceChecker(null, pid)) {
                gIf.alter = false;
                gData[ pid ].hostname = $('#' + gNode.col[ 0 ].tab).val();
                gData[ pid ].domainname = $('#' + gNode.col[ 1 ].tab).val();
            } else {
                return false;
            }
            break;
        case 'date_and_time':
            for (var node in gData[pid])
            {
                switch( node )
                {
                case 'mode':
                case 'ntpServerType':
                    $('input[name=' + node + ']').each(function() {
                        switch($(this).is(':checked'))
                        {
                        case true:
                            gData[ pid ][node] = $(this).val();
                            break;
                        }
                    });
                    break;
                case 'dstEnable':
                    switch($('#' + node).is(':checked'))
                    {
                    case true:
                        switch($('#' + node).is(':disabled'))
                        {
                        case true:
                            gData[ pid ][node] = 0;
                            break;
                        case false:
                            gData[ pid ][node] = 1;
                            break;
                        }
                        break;
                    case false:
                        gData[ pid ][node] = "0";
                        break;
                    }
                    break;
                case 'ntpDefaultServer':
                    gData[ pid ][node] = gData[pid][node];
                    break;
                case 'year':
                case 'month':
                case 'day':
                    break;
                default:
                    gData[ pid ][node] = $('#' + node).val();
                }
            }
            var arr = $('#sysDate').val().split('/');
            gData[ pid ].year = arr[0];
            gData[ pid ].month = arr[1];
            gData[ pid ].day = arr[2];
            break;
        }
    
        if ('administrator_settings' == pid) {
            if (1 === gData[ pid ].setPassword) {
                gObj.form = {};
                gObj.form.name = $('#adminName').val();
                gObj.form.password = $('#adminOldPwd').val();
                $.post('cgi-bin/checkCurrentPwd.cgi', gY.JSON.stringify(gObj.form), function(poster) {
                    // suppose i'll get valid
                    loadingToggle( true );
                    if (0 === parseInt( poster.status ) && 'success' == poster.result) {
                        $.post('cgi-bin/' + (('object' === typeof gNode.url.post)? gNode.url.post[ pid ] : gNode.url.post) + '.cgi', gY.JSON.stringify(gData[ pid ]), function( poster ) {
                            gIf.alter = false;
                            if (parseInt(poster.status) == 0) {
                                if (poster.duration) {
                                    gObj.loading = poster.duration;
                                    gIf.loading = true;
                                } else {
                                    loadingToggle( false );
                                    getCgiList(gObj.active.pid);
                                }
                            } else {
                                loadingToggle( false );
                            } 
                        });
                    } else {
                        loadingToggle( false );
                        msg = '<p>' + gError[ gObj.lang ].adminPwdChange + '</p>';
                        errorAlert( msg );
                    }
                });
            } else {
                $.post('cgi-bin/' + (('object' === typeof gNode.url.post)? gNode.url.post[ pid ] : gNode.url.post) + '.cgi', gY.JSON.stringify(gData[ pid ]), function( poster ) {
                    gIf.alter = false;
                    if (parseInt(poster.status) == 0) {
                        if (poster.duration) {
                            gObj.loading = poster.duration;
                            gIf.loading = true;
                        } else {
                            loadingToggle( false );
                            getCgiList(gObj.active.pid);
                        } 
                    } 
                }); 
            }
        } else {
            loadingToggle( true );
            $.post('cgi-bin/' + (('object' === typeof gNode.url.post)? gNode.url.post[ pid ] : gNode.url.post) + '.cgi', gY.JSON.stringify(gData[ pid ]), function( poster ) {
                gIf.alter = false;
                if (parseInt(poster.status) == 0) {
                    if (poster.duration) {
                        gObj.loading = poster.duration;
                        gIf.loading = true;
                    } else {
                        loadingToggle( false );
                        getCgiList(gObj.active.pid);
                    }
                }else {
                    loadingToggle( false );
                    if (!$('#popPlus').exists())
                        $('#popBase').append('<div id="popPlus"></div>');
                        $('#popPlus').html('<div class="plusForm"><p class="plusMsg"></p></div>');
                    $('#popPlus').dialog({
                        width: 300,
                        height:200,
                        position: "center",
                        resizable: false,
                        modal: true,
                        buttons: {
                            Ok: function() {
                                $( this ).dialog( "close" );
                            },
                            Cancel: function() {
                                $( this ).dialog( "close" );
                            }
                        },
                        close: function(event, ui) {
                            $(this).dialog('destroy').remove();
                        }
                    });
                    switch(parseInt(poster.status))
                    {
                    default:
                        $('.plusMsg').html( poster.msg );
                    }
                }
            });
        }
    }
    
    function cgiRefresh(id) {
        var tID;
        var tableID;
        var tableBD;
        var tableHD;
        var trNo;
        var cgiID;
        var cgiT;
        var cgiTNum;
        gIf.ajaxed = false;
    
        switch(id)
        {
        case 'show_routing_table':
            tableID = '#table-' + id;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            trNo = 0;
            cgiID = 'routingTable';
            cgiT = 'guiRoutingTableT';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gIf.ajaxed = true;
                    gData[id] = data;
                    cgiTNum = gData[ id ][ cgiT ].length;
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                        trNo++;
                        $(tableHD + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += gData[ id ][ cgiT ][ i ][ thID ];
                            tmp += '</td>';
                        });
                        tmp += '</tr>';
                            
                        $(tableBD).append(tmp);
            
                    }
                }
            });
            break;
        case 'show_arp_table':
            tableID = '#table-' + id;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            trNo = 0;
            cgiID = 'arpTable';
            cgiT = 'guiArpTableT';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gIf.ajaxed = true;
                    gData[id] = data;
                    cgiTNum = gData[ id ][ cgiT ].length;
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                        trNo++;
                        $(tableHD + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += gData[ id ][ cgiT ][ i ][ thID ];
                            tmp += '</td>';
                        });
                        tmp += '</tr>';
                            
                        $(tableBD).append(tmp);
            
                    }
                }
            });
            break;
        case 'dhcp_bindings':
            tableID = '#table-' + id;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            trNo = 0;
            cgiID = 'dhcpLeases';
            cgiT = 'dhcpLeasesT';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gIf.ajaxed = true;
                    gData[id] = data;
                    cgiTNum = gData[ id ][ cgiT ].length;
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                        trNo++;
                        var arr = data[ cgiT ][ i ].LeaseInfo.split(gReg.isPipe);
                        $(tableHD + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            
                            tmp += '<td id="' + thID + '-' + i + '">' +  arr[ gRef[ cgiID ][ cgiT ].indexOf( thID ) ] + '</td>';
                        });
                        tmp += '</tr>';
                            
                        $(tableBD).append(tmp);
            
                    }
                }
            });
            break;
        case 'active_sessions':
            tableID = '#table-' + id;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            trNo = 0;
            cgiID = 'ipsecSession';
            cgiT = 'guiIpsecSessionT';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gIf.ajaxed = true;
                    gData[id] = data;
                    cgiTNum = parseInt( data.guiIpsecSessionTNum );
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((i%2==0)? 'even' : 'odd') + '">';
    
                        $(tableID + ' tr th').each(function(index) {
                        // each col
                            var thID = $(this).attr('id');
                            var thClass = $(this).attr('class');
                            gObj.reg = thClass.match(gReg.isRow);
                            if (gObj.reg != null) {
                                $(this).addClass('rowAction BT'+gObj.reg.length);
                                tmp += '<td class="buttonTD">';
                                for (var x in gObj.reg)
                                {
                                    switch(gReg.isDigit.test(x))
                                    {
                                    case true:
                                        tmp += '<button id="' + gObj.reg[x] + '-' + id + '-' + i + '" class="' + gObj.reg[x] +    '"><span class="ui-icon" title="' + gObj.reg[x] + '"></span></button>';
                                        break;
                                    }
                                }
                                tmp += '</td>';
                            }else if (gReg.isCheckbox.test(thClass)) {
                                tmp += '<td class="checkTD">';
                                tmp += '<input type="checkbox" value="' + i + '" />';
                                tmp += '</td>';
                            }else {
                                tmp += '<td id="' + thID + '-' + i + '">';
                                tmp += gData[ id ][ cgiT ][ i ][ thID ];
                                tmp += '</td>';
                            }
                        });
                        tmp += '</tr>';
                        $(tableBD).append(tmp);
    
                        switch( parseInt(data[ cgiT ][ i ].infoStatus) )
                        {
                        case 0:
                            $('#Disconnect-' + id + '-' + i).prop('disabled', true);
                            break;
                        case 1:
                            $('#Connect-' + id + '-' + i).prop('disabled', true);
                            break;
                        case 2:
                            $('#Connect-' + id + '-' + i).prop('disabled', true);
                            $('#Disconnect-' + id + '-' + i).prop('disabled', true);
                            break;
                        }
    
                    }
                }
            });
            break;
        case 'nat_status':
            tableID = '#table-' + id;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            trNo = 0;
            cgiID = 'natStatus';
            cgiT = 'guiNatStatusT';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gIf.ajaxed = true;
                    gData[id] = data;
                    cgiTNum = gData[ id ][ cgiT ].length;
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                        trNo++;
                        $(tableHD + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += gData[ id ][ cgiT ][ i ][ thID ];
                            tmp += '</td>';
                        });
                        tmp += '</tr>';
                            
                        $(tableBD).append(tmp);
            
                    }
                }
            });
            break;
        case 'status_summary':
            tID     = 'port';
            tableID = '#table-' + tID;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            trNo    = 0;
            cgiID   = 'statusSummary_port';
            cgiT    = 'guiPortIfT';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gIf.ajaxed = true;
                    gData.port = data;
                    cgiTNum = parseInt(gData[ tID ][ cgiT + 'Num' ]);
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                        trNo++;
                        $(tableHD + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += gData[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                            tmp += '</td>';
                        });
                        tmp += '</tr>';
                            
                        $(tableBD).append(tmp);
            
                    }
                }
            }).done(function() {
                trNo    = 0;
                cgiID = 'statusSummary_wan';
                cgiT = 'guiWanIfT';
                tID = 'wan';
                tableID = '#table-' + tID;
                tableBD = tableID + ' > tbody';
                tableHD = tableID + ' > thead';
                $(tableBD).remove();
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                $.ajax({
                    url: 'cgi-bin/' + cgiID + '.cgi',
                    dataType: 'json',
                    success: function(data) {
                        gData.wan = data;
                        
                        cgiTNum = parseInt(gData[ tID ][ cgiT + 'Num' ]);
                        for (var i=0; i<cgiTNum; i++)
                        {
                            var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                            trNo++;
                            $(tableHD + ' tr th').each(function(index) {
                                // each col
                                var thID = $(this).attr('id');
                                tmp += '<td id="' + thID + '-' + i + '">'; 
                                tmp += gData[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                                tmp += '</td>';
                            });
                            tmp += '</tr>';
                                
                            $(tableBD).append(tmp);
                
                        }
                    }
                }).done( function() {
                    trNo    = 0;
                    cgiID = 'statusSummary_lan';
                    cgiT = 'guiLanIfT';
                    tID = 'lan';
                    tableID = '#table-' + tID;
                    tableBD = tableID + ' > tbody';
                    tableHD = tableID + ' > thead';
                    $(tableBD).remove();
                    if ($(tableBD).length == 0)
                        $(tableID).append('<tbody>');
                    $.ajax({
                        url: 'cgi-bin/' + cgiID + '.cgi',
                        dataType: 'json',
                        success: function(data) {
                            gData.lan = data;
                            
                            cgiTNum = parseInt(gData[ tID ][ cgiT + 'Num' ]);
                            for (var i=0; i<cgiTNum; i++)
                            {
                                var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                                trNo++;
                                $(tableHD + ' tr th').each(function(index) {
                                    // each col
                                    var thID = $(this).attr('id');
                                    tmp += '<td id="' + thID + '-' + i + '">'; 
                                    tmp += gData[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                                    tmp += '</td>';
                                });
                                tmp += '</tr>';
                                    
                                $(tableBD).append(tmp);
                    
                            }
                        }
                    }).done( function() {
                        trNo    = 0;
                        cgiID = 'statusSummary_vlan';
                        cgiT = 'guiVlanIfT';
                        tID = 'vlan';
                        tableID = '#table-' + tID;
                        tableBD = tableID + ' > tbody';
                        tableHD = tableID + ' > thead';
                        $(tableBD).remove();
                        if ($(tableBD).length == 0)
                            $(tableID).append('<tbody>');
                        $.ajax({
                            url: 'cgi-bin/' + cgiID + '.cgi',
                            dataType: 'json',
                            success: function(data) {
                                gData.vlan = data;
                                cgiTNum = parseInt(gData[ tID ][ cgiT + 'Num' ]);
                                for (var i=0; i<cgiTNum; i++)
                                {
                                    var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                                    trNo++;
                                    $(tableHD + ' tr th').each(function(index) {
                                        // each col
                                        var thID = $(this).attr('id');
                                        tmp += '<td id="' + thID + '-' + i + '">'; 
                                        tmp += gData[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                                        tmp += '</td>';
                                    });
                                    tmp += '</tr>';
                                        
                                    $(tableBD).append(tmp);
                        
                                }
                            }
                        });
                    });
                });
            });
            break;
    
        case 'port':
            trNo    = 0;
            switch(gObj.active.pid)
            {
            case 'traffic_statistics':
                cgiID = 'trafficStatisticsPort';
                cgiT = 'guiTrafficStatisticsPortT';
                break;
            case 'status_summary':
                cgiID = 'statusSummary_port';
                cgiT = 'guiPortIfT';
                break;
            }
            tID = 'port';
            tableID = '#table-' + tID;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gIf.ajaxed = true;
                    gData.port = data;
                    switch(gObj.active.pid)
                    {
                    case 'traffic_statistics':
                        cgiTNum = gData[ tID ][ cgiT ].length;
                        break;
                    case 'status_summary':
                        cgiTNum = parseInt(gData[ tID ][ cgiT + 'Num' ]);
                        break;
                    }
    
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                        trNo++;
                        $(tableHD + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += gData[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                            tmp += '</td>';
                        });
                        tmp += '</tr>';
                            
                        $(tableBD).append(tmp);
            
                    }
                }
            });
            break;
        case 'lan':
            trNo    = 0;
            switch(gObj.active.pid)
            {
            case 'traffic_statistics':
                cgiID = 'trafficStatisticsLan';
                cgiT = 'guiTrafficStatisticsLanT';
                break;
            case 'status_summary':
                cgiID = 'statusSummary_lan';
                cgiT = 'guiLanIfT';
                break;
            }
            tID = 'lan';
            tableID = '#table-' + tID;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gIf.ajaxed = true;
                    gData.lan = data;
                    switch(gObj.active.pid)
                    {
                    case 'traffic_statistics':
                        cgiTNum = gData[ tID ][ cgiT ].length;
                        break;
                    case 'status_summary':
                        cgiTNum = parseInt(gData[ tID ][ cgiT + 'Num' ]);
                        break;
                    }
    
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                        trNo++;
                        $(tableHD + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += gData[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                            tmp += '</td>';
                        });
                        tmp += '</tr>';
                            
                        $(tableBD).append(tmp);
            
                    }
                }
            });
            break;
        case 'vlan':
            trNo    = 0;
            switch(gObj.active.pid)
            {
            case 'traffic_statistics':
                cgiID = 'trafficStatisticsVlan';
                cgiT = 'guiTrafficStatisticsVlanT';
                break;
            case 'status_summary':
                cgiID = 'statusSummary_vlan';
                cgiT = 'guiVlanIfT';
                break;
            }
            tID = 'vlan';
            tableID = '#table-' + tID;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gIf.ajaxed = true;
                    gData.vlan = data;
                    switch(gObj.active.pid)
                    {
                    case 'traffic_statistics':
                        cgiTNum = gData[ tID ][ cgiT ].length;
                        break;
                    case 'status_summary':
                        cgiTNum = parseInt(gData[ tID ][ cgiT + 'Num' ]);
                        break;
                    }
    
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                        trNo++;
                        $(tableHD + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += gData[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                            tmp += '</td>';
                        });
                        tmp += '</tr>';
                            
                        $(tableBD).append(tmp);
            
                    }
                }
            });
            break;
        case 'wan':
            trNo    = 0;
            switch(gObj.active.pid)
            {
            case 'traffic_statistics':
                cgiID = 'trafficStatisticsWan';
                cgiT = 'guiTrafficStatisticsWanT';
                break;
            case 'status_summary':
                cgiID = 'statusSummary_wan';
                cgiT = 'guiWanIfT';
                break;
            }
            tID = 'wan';
            tableID = '#table-' + tID;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    gIf.ajaxed = true;
                    gData.wan = data;
                    switch(gObj.active.pid)
                    {
                    case 'traffic_statistics':
                        cgiTNum = gData[ tID ][ cgiT ].length;
                        break;
                    case 'status_summary':
                        cgiTNum = parseInt(gData[ tID ][ cgiT + 'Num' ]);
                        break;
                    }
    
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((trNo %2==0)? 'even' : 'odd') + '">';
                        trNo++;
                        $(tableHD + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += gData[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                            tmp += '</td>';
                        });
                        tmp += '</tr>';
                            
                        $(tableBD).append(tmp);
            
                    }
                }
            });
            break;
        }
    }
    
    function tooltipTable( id, tableID, members ) {
        var tmp;
        if (members) {
            var arr = [];
            switch(id)
            {
            case 'group_service':
                arr = members.split(gReg.isSemicolon);
                tmp = '<table id="table-' + tableID + '" class="group_service">';
                
                for (var i=0, len=arr.length; i<len; i++)
                {
                    for (var j=0; j < parseInt(gData.service.guiServiceTNum); j++)
                    {
                        switch( parseInt(arr[i]) == parseInt(gData.service.guiServiceT[ j ].gid) )
                        {
                        case true:
                            tmp += '<tr class="' + ((0 === i%2)? 'even' : 'odd') + '">';
                            tmp += '<td class="alignLeft BT320">' + gData.service.guiServiceT[ j ].name + '</td>';
                            tmp += '<td class="alignLeft BT100">' + gRef.service.type[ gData.service.guiServiceT[ j ].type ] + '</td>';
                            tmp += '<td class=" BT150">' + gData.service.guiServiceT[ j ].param1 + '</td>';
                            if (parseInt( gData.service.guiServiceT[ j ].type ) < 3)
                                tmp += '<td class=" BT80">' + gData.service.guiServiceT[ j ].param2 + '</td>';
                            else
                                tmp += '<td class=" BT80">N/A</td>';
                            tmp += '</tr>';
                            break;
                        }
                    }                
                }
                
                tmp += '</table>';
                break;
            case 'group_address':
                arr = members.split(gReg.isSemicolon);
                tmp = '<table id="table-' + tableID + '" class="group_address">';
                
                for (var i=0, len=arr.length; i<len; i++)
                {
                    for (var j=0; j < parseInt(gData.address.guiAddrTNum); j++)
                    {
                        switch( parseInt(arr[i]) == parseInt(gData.address.guiAddrT[ j ].gid) )
                        {
                        case true:
                            tmp += '<tr class="' + ((0 === i%2)? 'even' : 'odd') + '">';
                            tmp += '<td class="alignLeft BT300">' + gData.address.guiAddrT[ j ].name + '</td>';
                            
                            tmp += '<td class="alignLeft BT250">';
                            switch(parseInt( gData.address.guiAddrT[ j ].type ))
                            {
                            case 1:
                                tmp += gData.address.guiAddrT[ j ].startIp + '/255.255.255.255';
                                break;
                            case 2:
                                tmp += gData.address.guiAddrT[ j ].startIp + '/' + gData.address.guiAddrT[ j ].netmask;
                                break;
                            case 3:
                                tmp += gData.address.guiAddrT[ j ].startIp + '-' + gData.address.guiAddrT[ j ].endIp;
                                break;
                            case 4:
                                tmp += gData.address.guiAddrT[ j ].mac;
                                break;
                            }
                            tmp += '</td>';
                            tmp += '<td class="alignLeft BT100">' + gRef.address.type[ gData.address.guiAddrT[ j ].type ] + '</td>';
                            tmp += '</tr>';
                            break;
                        }
                    }                
                }
                tmp += '</table>';
                break;
            }
        }else
            tmp = "Sorry, no member yet!";
        return tmp;
    }
    
    function createSelector( e ) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid   = tar.id.split(gReg.isDash)[1];
        tar.val = $(e.currentTarget).val();
    
        if (!($('#popMore').exists()))
            $('#popBase').append('<div id="popMore"></div>');
    
        tar.w = 480;
        tar.h = 320;
    
        var tmp = '';
    
        $('#popMore').append('<div class="formDiv"><div id="More-div-' + tar.pid + '"><table id="More-table-' + tar.pid + '"></table></div></div>');
    
        switch( tar.val )
        {
        case 'cMAC':
        case 'cAddr':
            tar.h = 300;
            gSelector = gObj.menu[ 7 ].panel[ 0 ];
            for (var i=0, len=gSelector.editor[ 'address' ].length; i<len; i++)
            {
                if ( 'input' == gSelector.editor[ 'address' ][ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gSelector.editor[ 'address' ][ i ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'address' ][ i ].wiz + '">' + gSelector.editor[ 'address' ][ i ].label + '</th>';
                    tmp += '<td class="align' + gSelector.editor[ 'address' ][ i ].align[ 1 ] + '"><input type="text" id="More-' + gSelector.editor[ 'address' ][ i ].tab + '" /></td>';
                    tmp += '</tr>';
                } else {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gSelector.editor[ 'address' ][ i ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'address' ][ i ].wiz + '">' + gSelector.editor[ 'address' ][ i ].label + '</th>';
                    tmp += '<td class="align' + gSelector.editor[ 'address' ][ i ].align[ 1 ] + '"><select id="More-' + gSelector.editor[ 'address' ][ i ].tab + '"></select></td>';
                    tmp += '</tr>';
                    for (var j=0, jlen=gSelector.editor[ 'address' ][ i ].option.length; j<jlen; j++)
                    {
                        tmp += '<tr class="More-' + gSelector.editor[ 'address' ][ i ].tab + '-' + gSelector.editor[ 'address' ][ i ].option[ j ].tab + '">';
                        tmp += '<td class="align' + gSelector.editor[ 'address' ][ i ].option[ j ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'address' ][ i ].option[ j ].wiz + '"></td>';
                        tmp += '<td class="align' + gSelector.editor[ 'address' ][ i ].option[ j ].align[ 1 ] + '" >';
                        tmp += '<table id="More-table-' + gSelector.editor[ 'address' ][ i ].tab + '-' + gSelector.editor[ 'address' ][ i ].option[ j ].tab + '">';
                        for (var k=0, klen=gSelector.editor[ 'address' ][ i ].option[ j ].col.length; k<klen; k++)
                        {
                            tmp += '<tr class="More-' + gSelector.editor[ 'address' ][ i ].tab + '-' + gSelector.editor[ 'address' ][ i ].option[ j ].tab + '-' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].tab + '">';
                            if ('input' == gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].tag) {
                                tmp += '<td class="align' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].wiz + '">';
                                tmp += gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].label;
                                tmp += '</td>';
                                tmp += '<td class="align' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].align[ 1 ] + '">';
                                tmp += '<input type="text" id="More-' + gSelector.editor[ 'address' ][ i ].tab + '-' + gSelector.editor[ 'address' ][ i ].option[ j ].tab + '-' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].tab + '" />';
                                tmp += '</td>';
                            } else if ('select' == gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].tag) {
                                tmp += '<td class="align' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].wiz + '">';
                                tmp += gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].label;
                                tmp += '</td>';
                                tmp += '<td class="align' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].align[ 1 ] + '">';
                                tmp += '<select id="More-' + gSelector.editor[ 'address' ][ i ].tab + '-' + gSelector.editor[ 'address' ][ i ].option[ j ].tab + '-' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].tab + '" ></select>';
                                tmp += '</td>';

                            } else {
                                tmp += '<td colspan="' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].colspan + '" class="alignLeft">' + gSelector.editor[ 'address' ][ i ].option[ j ].col[ k ].label + '</td>';
                            }
                            tmp += '</tr>';
                        }
                        tmp += '</table>';
                        tmp += '</td>';
                        tmp += '</tr>';
                    }
                }
            }

            $('#More-table-' + tar.pid).append(tmp);
    
            $('#More-type').change(function() {
                $('.More-type-1').hide();
                $('.More-type-2').hide();
                $('.More-type-3').hide();
                $('.More-type-4').hide();
                $('.More-type-' + $(this).val()).show();
            });
    
            $('#More-type-4-mac').change( function() {
                if ('macInput' == $(this).val())  {
                     $('.More-type-4-macInput').show();
                } else {
                     $('.More-type-4-macInput').hide();
                }
            });

            $('#Editor-type').append( genSelectOption( 'addressType1' ) ).val( 1 ).trigger('change');
            cgiSelectOption( 'More-type-4-mac' );

            switch( tar.pid )
            {
            case 'localNetworkId':
            case 'remoteNetworkId':
            case 'dstIpId':
                $('#More-type').append( genSelectOption( 'addressType3' ) ).val( 1 ).trigger('change');
                break; 
            case 'privateIp':
            case 'nhIpId':
            case 'netDetectPingIpId':
            case 'netDetectDnsIpId':
                $('#More-type').append( genSelectOption( 'addressType4' ) ).val( 1 ).trigger('change');
                break;
            default:
                switch( tar.id ) 
                {
                case 'aliasIP':
                case 'dhcpBindingIP':
                    $('#More-type').append( genSelectOption( 'addressType4' ) ).val( 1 ).trigger('change');
                    break;
                case 'dhcpBindingMAC':
                    $('#More-type').append( genSelectOption( 'addressType5' ) ).val( 1 ).trigger('change');
                    break;
                default:
                    $('#More-type').append( genSelectOption( 'addressType2' ) ).val( 1 ).trigger('change');
                }
            }
    
            break;
        case 'cGAddr':
            tar.h = 360;
            gSelector = gObj.menu[ 7 ].panel[ 0 ];
            for (var i=0, len=gSelector.editor[ 'group_address' ].length; i<len; i++)
            {
                tmp += '<tr>';
                if (gSelector.editor[ 'group_address' ][ i ].colspan) {
                    if ( 'p' == gSelector.editor[ 'group_address' ][ i ].tag ) {
                        tmp += '<th colspan="' + gSelector.editor[ 'group_address' ][ i ].colspan + '" class="align' + gSelector.editor[ 'group_address' ][ i ].align[ 0 ] + '">';
                        tmp += '<p>' + gSelector.editor[ 'group_address' ][ i ].label + ' : </p>';
                        tmp += '</th>';
                    } else if ( 'span' == gSelector.editor[ 'group_address' ][ i ].tag ) {
                        tmp += '<td class="align' + gSelector.editor[ 'group_address' ][ i ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'group_address' ][ i ].wiz + '">';
                        tmp += gSelector.editor[ 'group_address' ][ i ].label + ' : ';
                        tmp += '</td>';
                        tmp += '<td colspan="' + gSelector.editor[ 'group_address' ][ i ].colspan + '" class="align' + gSelector.editor[ 'group_address' ][ i ].align[ 1 ] + '">';
                        tmp += '<span id="More-' + gSelector.editor[ 'group_address' ][ i ].tab + '"></span>';
                        tmp += '</td>';
                    } else {
                        tmp += '<th colspan="' + gSelector.editor[ 'group_address' ][ i ].colspan + '" class="align' + gSelector.editor[ 'group_address' ][ i ].align[ 0 ] + '">';
                        tmp += gSelector.editor[ 'group_address' ][ i ].label + '&nbsp;<input type="text" id="More-' + gSelector.editor[ 'group_address' ][ i ].tab + '" />';
                        tmp += '</th>';
                    }
                } else if (gSelector.editor[ 'group_address' ][ i ].type == 'multiple') {
                    tmp += '<td colspan="2">';
                    tmp += '<table>';

                    tmp += '<tr>';
                    tmp += '<th style="width: ' + gSelector.editor[ 'group_address' ][ i ].multiple.pool.wiz + '">';
                    tmp += gSelector.editor[ 'group_address' ][ i ].multiple.pool.label;
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_address' ][ i ].multiple.del.wiz + '">';
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_address' ][ i ].multiple.add.wiz + '">';
                    tmp += '</th>';
                    tmp += '<th style="width: ' + gSelector.editor[ 'group_address' ][ i ].multiple.pick.wiz + '">';
                    tmp += gSelector.editor[ 'group_address' ][ i ].multiple.pick.label;
                    tmp += '</th>';
                    tmp += '</tr>';

                    tmp += '<tr>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_address' ][ i ].multiple.pool.wiz + '">';
                    tmp += '<select id="pool" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_address' ][ i ].multiple.del.wiz + '">';
                    tmp += '<button class="Move2Del" id="Move2Del-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_address' ][ i ].multiple.add.wiz + '">';
                    tmp += '<button class="Move2Add" id="Move2Add-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_address' ][ i ].multiple.pick.wiz + '">';
                    tmp += '<select id="pick" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';

                    tmp += '</table>';
                    tmp += '</td>';
                }
                tmp += '</tr>';
            }

            $('#More-table-' + tar.pid).append(tmp);
    
            for (var i=0; i<gData.address.guiAddrTNum; i++)
            {
                tmp = '<option value="' + gData.address.guiAddrT[ i ].gid + '">' + gData.address.guiAddrT[ i ].name + '</option>';
                $('#pool').append( tmp );
            }
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                vSel.clone().appendTo('#pick');
                vSel.remove();
            });
    
            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
    
            $('#pool').change( function() {
                $('#More-addressName').html("");
                $('#More-addressType').html("");
                $('#More-addressValue').html("");
    
                if (gData.address) {
                    for (var i=0; i<gData.address.guiAddrTNum; i++)
                    {
                        if (parseInt(gData.address.guiAddrT[ i ].gid) === parseInt($('#pool option:selected').val())) {
                            $('#More-addressName').html( gData.address.guiAddrT[ i ].name);
                            $('#More-addressType').html( gRef.address.type[ gData.address.guiAddrT[ i ].type ] );
                            switch( parseInt( gData.address.guiAddrT[ i ].type  ) )
                            {
                            case 1:
                                $('#More-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/255.255.255.255' );
                                break;
                            case 2:
                                $('#More-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/' + gData.address.guiAddrT[ i ].netmask );
                                break;
                            case 3:
                                $('#More-addressValue').html( gData.address.guiAddrT[ i ].startIp + '-' + gData.address.guiAddrT[ i ].endIp );
                                break;
                            case 4:
                                $('#More-addressValue').html( gData.address.guiAddrT[ i ].mac );
                                break;
                            }
                        }
                    }
                }
            });
    
            $('#pick').change( function() {
                $('#More-addressName').html("");
                $('#More-addressType').html("");
                $('#More-addressValue').html("");
    
                if (gData.address) {
                    for (var i=0; i<gData.address.guiAddrTNum; i++)
                    {
                        if (parseInt(gData.address.guiAddrT[ i ].gid) === parseInt($('#pick option:selected').val())) {
                            $('#More-addressName').html( gData.address.guiAddrT[ i ].name);
                            $('#More-addressType').html( gRef.address.type[ gData.address.guiAddrT[ i ].type ] );
                            switch( parseInt( gData.address.guiAddrT[ i ].type  ) )
                            {
                            case 1:
                                $('#More-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/255.255.255.255' );
                                break;
                            case 2:
                                $('#More-addressValue').html( gData.address.guiAddrT[ i ].startIp + '/' + gData.address.guiAddrT[ i ].netmask );
                                break;
                            case 3:
                                $('#More-addressValue').html( gData.address.guiAddrT[ i ].startIp + '-' + gData.address.guiAddrT[ i ].endIp );
                                break;
                            case 4:
                                $('#More-addressValue').html( gData.address.guiAddrT[ i ].mac );
                                break;
                            }
                        }
                    }
                }
            });
            break;
        case 'cService':
            tar.h = 300;
            gSelector = gObj.menu[ 7 ].panel[ 1 ];
            for (var i=0, len=gSelector.editor[ 'service' ].length; i<len; i++)
            {
                if ( 'input' == gSelector.editor[ 'service' ][ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gSelector.editor[ 'service' ][ i ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'service' ][ i ].wiz + '">' + gSelector.editor[ 'service' ][ i ].label + '</th>';
                    tmp += '<td class="align' + gSelector.editor[ 'service' ][ i ].align[ 1 ] + '"><input type="text" id="More-' + gSelector.editor[ 'service' ][ i ].tab + '" /></td>';
                    tmp += '</tr>';
                } else {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gSelector.editor[ 'service' ][ i ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'service' ][ i ].wiz + '">' + gSelector.editor[ 'service' ][ i ].label + '</th>';
                    tmp += '<td class="align' + gSelector.editor[ 'service' ][ i ].align[ 1 ] + '"><select id="More-' + gSelector.editor[ 'service' ][ i ].tab + '"></select></td>';
                    tmp += '</tr>';
                    for (var j=0, jlen=gSelector.editor[ 'service' ][ i ].option.length; j<jlen; j++)
                    {
                        tmp += '<tr class="More-' + gSelector.editor[ 'service' ][ i ].tab + '-' + gSelector.editor[ 'service' ][ i ].option[ j ].tab + '">';
                        tmp += '<td class="align' + gSelector.editor[ 'service' ][ i ].option[ j ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'service' ][ i ].option[ j ].wiz + '"></td>';
                        tmp += '<td class="align' + gSelector.editor[ 'service' ][ i ].option[ j ].align[ 1 ] + '" >';
                        tmp += '<table id="More-table-' + gSelector.editor[ 'service' ][ i ].tab + '-' + gSelector.editor[ 'service' ][ i ].option[ j ].tab + '">';
                        for (var k=0, klen=gSelector.editor[ 'service' ][ i ].option[ j ].col.length; k<klen; k++)
                        {
                            tmp += '<tr>';
                            tmp += '<td class="align' + gSelector.editor[ 'service' ][ i ].option[ j ].col[ k ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'service' ][ i ].option[ j ].col[ k ].wiz + '">';
                            tmp += gSelector.editor[ 'service' ][ i ].option[ j ].col[ k ].label;
                            tmp += '</td>';
                            tmp += '<td class="align' + gSelector.editor[ 'service' ][ i ].option[ j ].col[ k ].align[ 1 ] + '">';
                            tmp += '<input type="text" id="More-' + gSelector.editor[ 'service' ][ i ].tab + '-' + gSelector.editor[ 'service' ][ i ].option[ j ].tab + '-' + gSelector.editor[ 'service' ][ i ].option[ j ].col[ k ].tab + '" />';
                            tmp += '&nbsp;' + gSelector.editor[ 'service' ][ i ].option[ j ].col[ k ].note;
                            tmp += '</td>';
                            tmp += '</tr>';
                        }
                        tmp += '</table>';
                        tmp += '</td>';
                        tmp += '</tr>';
                    }
                }
            }

            $('#More-table-' + tar.pid).append(tmp);
            $('#More-type').change(function() {
                $('.More-type-0').hide();
                $('.More-type-1').hide();
                $('.More-type-2').hide();
                $('.More-type-3').hide();
                $('.More-type-4').hide();
                $('.More-type-' + $(this).val()).show();
            });
    
            switch( tar.pid )
            {
            case 'service':
            case 'originalService':
            case 'translatedService':
            case 'triggerService':
            case 'openedService':
                $('#More-type').append( genSelectOption( 'serviceType2' ) ).val( 0 ).trigger('change');
                break; 
            default:
                $('#More-type').append( genSelectOption( 'serviceType' ) ).val( 0 ).trigger('change');
            }
            break;
        case 'cGService':
            tar.h = 360;
            gSelector = gObj.menu[ 7 ].panel[ 1 ];
            for (var i=0, len=gSelector.editor[ 'group_service' ].length; i<len; i++)
            {
                tmp += '<tr>';
                if (gSelector.editor[ 'group_service' ][ i ].colspan) {
                    if ( 'p' == gSelector.editor[ 'group_service' ][ i ].tag ) {
                        tmp += '<th colspan="' + gSelector.editor[ 'group_service' ][ i ].colspan + '" class="align' + gSelector.editor[ 'group_service' ][ i ].align[ 0 ] + '">';
                        tmp += '<p>' + gSelector.editor[ 'group_service' ][ i ].label + ' : </p>';
                        tmp += '</th>';
                    } else if ( 'span' == gSelector.editor[ 'group_service' ][ i ].tag ) {
                        tmp += '<td class="align' + gSelector.editor[ 'group_service' ][ i ].align[ 0 ] + '" style="width: ' + gSelector.editor[ 'group_service' ][ i ].wiz + '">';
                        tmp += gSelector.editor[ 'group_service' ][ i ].label + ' : ';
                        tmp += '</td>';
                        tmp += '<td colspan="' + gSelector.editor[ 'group_service' ][ i ].colspan + '" class="align' + gSelector.editor[ 'group_service' ][ i ].align[ 1 ] + '">';
                        tmp += '<span id="More-' + gSelector.editor[ 'group_service' ][ i ].tab + '"></span>';
                        tmp += '</td>';
                    } else {
                        tmp += '<th colspan="' + gSelector.editor[ 'group_service' ][ i ].colspan + '" class="align' + gSelector.editor[ 'group_service' ][ i ].align[ 0 ] + '">';
                        tmp += gSelector.editor[ 'group_service' ][ i ].label + '&nbsp;<input type="text" id="More-' + gSelector.editor[ 'group_service' ][ i ].tab + '" />';
                        tmp += '</th>';
                    }
                } else if (gSelector.editor[ 'group_service' ][ i ].type == 'multiple') {
                    tmp += '<td colspan="2">';
                    tmp += '<table>';

                    tmp += '<tr>';
                    tmp += '<th style="width: ' + gSelector.editor[ 'group_service' ][ i ].multiple.pool.wiz + '">';
                    tmp += gSelector.editor[ 'group_service' ][ i ].multiple.pool.label;
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_service' ][ i ].multiple.del.wiz + '">';
                    tmp += '</th>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_service' ][ i ].multiple.add.wiz + '">';
                    tmp += '</th>';
                    tmp += '<th style="width: ' + gSelector.editor[ 'group_service' ][ i ].multiple.pick.wiz + '">';
                    tmp += gSelector.editor[ 'group_service' ][ i ].multiple.pick.label;
                    tmp += '</th>';
                    tmp += '</tr>';

                    tmp += '<tr>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_service' ][ i ].multiple.pool.wiz + '">';
                    tmp += '<select id="pool" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_service' ][ i ].multiple.del.wiz + '">';
                    tmp += '<button class="Move2Del" id="Move2Del-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_service' ][ i ].multiple.add.wiz + '">';
                    tmp += '<button class="Move2Add" id="Move2Add-idList"><span class="ui-icon"></span></button>';
                    tmp += '</td>';
                    tmp += '<td style="width: ' + gSelector.editor[ 'group_service' ][ i ].multiple.pick.wiz + '">';
                    tmp += '<select id="pick" multiple size="10"></select>';
                    tmp += '</td>';
                    tmp += '</tr>';

                    tmp += '</table>';
                    tmp += '</td>';
                }
                tmp += '</tr>';
            }

            $('#More-table-' + tar.pid).append(tmp);
    
            for (var i=0; i<gData.service.guiServiceTNum; i++)
            {
                tmp = '<option value="' + gData.service.guiServiceT[ i ].gid + '">' + gData.service.guiServiceT[ i ].name + '</option>';
                $('#pool').append( tmp );
            }
            // bind double click event
            $('#pool').dblclick(function(e) {
                var vSel = $('#pool option:selected');
                vSel.clone().appendTo('#pick');
                vSel.remove();
            });
    
            $('#pick').dblclick(function(e) {
                var vSel = $('#pick option:selected');
                vSel.clone().appendTo('#pool');
                vSel.remove();
            });
    
            $('#pool').change( function() {
                $('#More-serviceName').html("");
                $('#More-serviceProtocol').html("");
                $('#More-serviceValue').html("");
    
                if (gData.service) {
                    for (var i=0; i<gData.service.guiServiceTNum; i++)
                    {
                        if (parseInt(gData.service.guiServiceT[ i ].gid) === parseInt($('#pool option:selected').val())) {
                            $('#More-serviceName').html( gData.service.guiServiceT[ i ].name);
                            $('#More-serviceProtocol').html( gRef.service.type[ gData.service.guiServiceT[ i ].type ] );
                            switch( parseInt( gData.service.guiServiceT[ i ].type  ) )
                            {
                            case 0:
                            case 1:
                            case 2:
                                $('#More-serviceValue').html( gData.service.guiServiceT[ i ].param1 + '-' + gData.service.guiServiceT[ i ].param2 );
                                break;
                            case 3:
                            case 4:
                                $('#More-serviceValue').html( gData.service.guiServiceT[ i ].param1 );
                                break;
                            }
                        }
                    }
                }
            });
    
            $('#pick').change( function() {
                $('#More-serviceName').html("");
                $('#More-serviceProtocol').html("");
                $('#More-serviceValue').html("");
    
                if (gData.service) {
                    for (var i=0; i<gData.service.guiServiceTNum; i++)
                    {
                        if (parseInt(gData.service.guiServiceT[ i ].gid) === parseInt($('#pick option:selected').val())) {
                            $('#More-serviceName').html( gData.service.guiServiceT[ i ].name);
                            $('#More-serviceProtocol').html( gRef.service.type[ gData.service.guiServiceT[ i ].type ] );
                            switch( parseInt( gData.service.guiServiceT[ i ].type  ) )
                            {
                            case 0:
                            case 1:
                            case 2:
                                $('#More-serviceValue').html( gData.service.guiServiceT[ i ].param1 + '-' + gData.service.guiServiceT[ i ].param2 );
                                break;
                            case 3:
                            case 4:
                                $('#More-serviceValue').html( gData.service.guiServiceT[ i ].param1 );
                                break;
                            }
                        }
                    }
                }
            });
            break;
        case 'cSchedule':
            tar.w = 520;
            tar.h = 480;

            gSelector = gObj.menu[ 7 ].panel[ 2 ];

            for (var i=0, len=gSelector.editor.length; i<len; i++)
            {
                if ( 'input' == gSelector.editor[ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gSelector.editor[ i ].align[ 0 ] + '" style="width: ' + gSelector.editor[ i ].wiz + '">' + gSelector.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + gSelector.editor[ i ].align[ 1 ] + '"><input type="text" id="More-' + gSelector.editor[ i ].tab + '" /></td>';
                    tmp += '</tr>';
                } else if ( 'p' == gSelector.editor[ i ].tag ) {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gSelector.editor[ i ].align[ 0 ] + '" style="width: ' + gSelector.editor[ i ].wiz + '">' + gSelector.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + gSelector.editor[ i ].align[ 1 ] + '"><p id="More-' + gSelector.editor[ i ].tab + '" >' + gSelector.editor[ i ].note + '</p></td>';
                    tmp += '</tr>';
                } else {
                    tmp += '<tr>';
                    tmp += '<th class="align' + gSelector.editor[ i ].align[ 0 ] + '" style="width: ' + gSelector.editor[ i ].wiz + '">' + gSelector.editor[ i ].label + '</th>';
                    tmp += '<td class="align' + gSelector.editor[ i ].align[ 1 ] + '"><select id="More-' + gSelector.editor[ i ].tab + '"></select></td>';
                    tmp += '</tr>';

                    for (var j=0, jlen=gSelector.editor[ i ].option.length; j<jlen; j++)
                    {
                        if (gSelector.editor[ i ].option[ j ].col) {
                            for (var k=0, klen=gSelector.editor[ i ].option[ j ].col.length; k<klen; k++)
                            {
                                if ( 'p' == gSelector.editor[ i ].option[ j ].col[ k ].tag ) {
                                    tmp += '<tr class="More-' + gSelector.editor[ i ].tab + '-' + gSelector.editor[ i ].option[ j ].tab + '">';
                                    tmp += '<td class="alignRight">' + gSelector.editor[ i ].option[ j ].col[ k ].label + '</td>';
                                    tmp += '<td class="alignLeft" >';
                                    tmp += '<select id="More-' + gSelector.editor[ i ].option[ j ].col[ k ].col[ 0 ].tab + '"></select>';
                                    tmp += ' : ';
                                    tmp += '<select id="More-' + gSelector.editor[ i ].option[ j ].col[ k ].col[ 1 ].tab + '"></select>';
                                    tmp += '&nbsp;' + gSelector.editor[ i ].option[ j ].col[ k ].note;
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                } else {
                                    tmp += '<tr class="More-' + gSelector.editor[ i ].tab + '-' + gSelector.editor[ i ].option[ j ].tab + '">';
                                    tmp += '<td></td>';
                                    tmp += '<td class="alignLeft" >';
                                    tmp += '<input type="checkbox" id="More-' + gSelector.editor[ i ].option[ j ].col[ k ].tab + '" value="' + gSelector.editor[ i ].option[ j ].col[ k ].val + '" />&nbsp;<label for="More-' + gSelector.editor[ i ].option[ j ].col[ k ].tab + '">' + gSelector.editor[ i ].option[ j ].col[ k ].label + '</label>';
                                    tmp += '</td>';
                                    tmp += '</tr>';
                                }
                            }
                        }
                    }
                }
            }

            $('#More-table-' + tar.pid).append(tmp);
    
            $('#More-days').change( function() {
               if (0 === parseInt($(this).val())) {
                   $('.More-days-1').hide();
               } else {
                   $('.More-days-1').show();
               }
            });
    
            $('#More-times').change( function() {
               if (0 === parseInt($(this).val())) {
                   $('.More-times-1').hide();
               } else {
                   $('.More-times-1').show();
               }
            });
    
            $('#More-days').append( genSelectOption( 'More-days' ) ).val( 0 ).trigger('change');
            $('#More-times').append( genSelectOption( 'More-times' ) ).val( 0 ).trigger('change');
            $('#More-startHour').append( genSelectOption( 'More-startHour' ) ); 
            $('#More-startMin').append( genSelectOption( 'More-startMin' ) ); 
            $('#More-endHour').append( genSelectOption( 'More-endHour' ) ); 
            $('#More-endMin').append( genSelectOption( 'More-endMin' ) ); 
    
            break;
        }
    
        selectorEditor( e, tar.w, tar.h ) 
    }
    
    function selectorEditor( e, w, h ) {
        var tar = {};
    
        if (gObj.active.h5Index == 'NA') {
            //gNode = gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index];
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label;
        }else {
            //gNode = gObj.menu[gObj.active.h3Index].panel[gObj.active.h4Index].panel[gObj.active.h5Index];
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].label;
        }
    
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid  = tar.id.split(gReg.isDash)[1];
        tar.val = $(e.currentTarget).val();
        tar.data = {};
        gPop.popMore = $('#popMore').dialog({
            width: w || 480,
            height: h || 320,
            position: "center",
            resizable: false,
            modal: true,
            title: tar.title + ' > ' + ((tar.pid)? tar.pid : tar.id ) + ' > ' + gTerm[ gObj.lang ].create,
            buttons: {
                ok: function() {
                    if (selectorChecker(e)) {
                        var arr = [];
                        switch( tar.val )
                        {
                        case 'cAddr':
                        case 'cMAC':
                            tar.data.gid = 0;
                            tar.data.action = 0;
                            tar.data.userDefined = 1;
                            tar.data.name = $('#More-name').val();
                            tar.data.type = $('#More-type').val();
                            tar.data.startIp = "";
                            tar.data.endIp = "";
                            tar.data.netmask = "";
                            tar.data.mac = "";
    
                            switch(parseInt( $('#More-type').val() ))
                            {
                            case 1:
                                tar.data.startIp = $('#More-type-' + tar.data.type + '-startIp').val();
                                tar.data.endIp = tar.data.startIp;
                                tar.data.netmask = '255.255.255.255';
                                break;
                            case 2:
                                tar.data.startIp = gObj.calc.startIp;
                                tar.data.endIp = gObj.calc.endIp;
                                tar.data.netmask = $('#More-type-' + tar.data.type + '-netmask').val();
                                break;
                            case 3:
                                tar.data.startIp = $('#More-type-' + tar.data.type + '-startIp').val();
                                tar.data.endIp = $('#More-type-' + tar.data.type + '-endIp').val();
                                break;
                            case 4:
                                tar.data.mac = (gReg.isCMAC.test( $('#More-type-' + tar.data.type + '-mac').val() ))? $('#More-type-' + tar.data.type + '-macInput').val() : $('#More-type-' + tar.data.type + '-mac').val();
                                break;
                            }
                            cgiPost( 'common_updateAddr', gY.JSON.stringify( tar.data ), 'cgiSelectOption', tar.id, 'common_addr_list' );
                            break;
                        case 'cGAddr':
                            tar.data.gid = 0;
                            tar.data.action = 0;
                            tar.data.userDefined = 1;
                            tar.data.name = $('#More-name').val();
    
                            $('#pick option').each(function() {
                                arr.push($(this).val());
                            });
    
                            tar.data.num = arr.length;
                            tar.data.idList = arr.join(';');
                            
                            cgiPost( 'common_updateGAddr', gY.JSON.stringify( tar.data ), 'cgiSelectOption', tar.id, 'common_gAddr_list' );
                            break;
                        case 'cService':
                            tar.data.gid = 0;
                            tar.data.action = 0;
                            tar.data.userDefined = 1;
                            tar.data.name = $('#More-name').val();
                            tar.data.type = $('#More-type').val();
                            tar.data.param1 = $('#More-type-' + tar.data.type + '-param1').val();
                            tar.data.param2 = "";
    
                            switch(parseInt( $('#More-type').val() ))
                            {
                            case 0:
                            case 1:
                            case 2:
                                tar.data.param2 = $('#More-type-' + tar.data.type + '-param2').val();
                                break;
                            }
    
                            cgiPost('common_updateService', gY.JSON.stringify( tar.data ), 'cgiSelectOption', tar.id, 'common_service_list');
                            break;
                        case 'cGService':
                            tar.data.gid = 0;
                            tar.data.action = 0;
                            tar.data.userDefined = 1;
                            tar.data.name = $('#More-name').val();
    
                            $('#pick option').each(function() {
                                arr.push($(this).val());
                            });
    
                            tar.data.num = arr.length;
                            tar.data.idList = arr.join(';');
    
                            cgiPost('common_updateGService', gY.JSON.stringify( tar.data ), 'cgiSelectOption', tar.id, 'common_gService_list');
                            break;
                        case 'cSchedule':
                            tar.data.gid = 0;
                            tar.data.action = 0;
                            tar.data.userDefined = 1;
                            tar.data.name = $('#More-name').val();
                            tar.data.day = 0;
    
                            if (1 === parseInt($('#More-days').val())) {
                                if (1 === parseInt($('#More-times').val())) {
                                    tar.data.type = 4;
                                    tar.data.startHour = $('#More-startHour').val();
                                    tar.data.startMin = $('#More-startMin').val();
                                    tar.data.endHour = $('#More-endHour').val();
                                    tar.data.endMin = $('#More-endMin').val();
                                } else {
                                    tar.data.type = 3;
                                    tar.data.startHour = 0;
                                    tar.data.startMin = 0;
                                    tar.data.endHour = 23;
                                    tar.data.endMin = 59;
                                }
                                for (var x in gRef.schedule.day)
                                { 
                                    if ($('#More-day' + x ).is(':checked'))  {
                                        tar.data.day += parseInt(x);
                                    }
                                } 
                            } else {
                                if (1 === parseInt($('#More-times').val())) {
                                    tar.data.type = 2;
                                    tar.data.startHour = $('#More-startHour').val();
                                    tar.data.startMin = $('#More-startMin').val();
                                    tar.data.endHour = $('#More-endHour').val();
                                    tar.data.endMin = $('#More-endMin').val();
                                } else {
                                    tar.data.type = 1;
                                    tar.data.startHour = 0;
                                    tar.data.startMin = 0;
                                    tar.data.endHour = 23;
                                    tar.data.endMin = 59;
                                }
                            }
                            cgiPost('common_updateTime', gY.JSON.stringify( tar.data ), 'cgiSelectOption', tar.id, 'common_time_list');
                            break;
                        }
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(e, ui) {
                $(this).dialog('destroy').remove();
            }
        });
    }
    
    function selectorChecker(e) {
        var pass = true;
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.pid  = tar.id.split(gReg.isDash)[1];
        tar.val = $(e.currentTarget).val();
    
        var arr = [];
        var msg = '';
        var pass = true;
        gObj.calc = {};
    
        switch( tar.val )
        {
        case 'cAddr':
            switch( parseInt( $('#More-type').val() ) )
            {
            case 1:
                if (!gReg.isIPv4.test( $('#More-type-' + $('#More-type').val() + '-startIp').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ip + '</p>';
                }
                break;
            case 2:
                if (!gReg.isIPv4.test( $('#More-type-' + $('#More-type').val() + '-startIp').val() ) ) { 
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipStart + '</p>';
                }
                if (!gReg.isIPv4.test( $('#More-type-' + $('#More-type').val() + '-netmask').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].netmask + '</p>';
                }
    
                if (pass) {
                    arr = $('#More-type-' + $('#More-type').val() + '-startIp').val().split('\.');
                    for (var i=0; i<arr.length; i++)
                    {
                        gObj.calc[ "ip_" + (i+1) ] = parseInt( arr[ i ] );
                    }
                    arr = $('#More-type-' + $('#More-type').val() + '-netmask').val().split('\.');
                    for (var i=0; i<arr.length; i++)
                    {
                        gObj.calc[ "snm_" + (i+1) ] = parseInt( arr[ i ] );
                    }
                    calcNWbits(gObj.calc);
    
                    if (gObj.calc.result == 'invalid') {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                    } else {
                        gObj.calc.bits = gObj.calc.result;
                        calcNBFL(gObj.calc);
    
                        switch( gObj.calc.numofaddr )
                        {
                        case 'ERR':
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                            break;
                        case 'one':
                        case 'two':
                            gObj.calc.startIp = gObj.calc.firstadr_1 + '.' + gObj.calc.firstadr_2 + '.' + gObj.calc.firstadr_3 + '.' + gObj.calc.firstadr_4;
                            gObj.calc.endIp = gObj.calc.lastadr1 + '.' + gObj.calc.lastadr_2 + '.' + gObj.calc.lastadr_3 + '.' + gObj.calc.lastadr_4;
                            break;
                        default: 
                            gObj.calc.startIp = gObj.calc.nwadr_1 + '.' + gObj.calc.nwadr_2 + '.' + gObj.calc.nwadr_3 + '.' + gObj.calc.nwadr_4;
                            gObj.calc.endIp = gObj.calc.bcast_1 + '.' + gObj.calc.bcast_2 + '.' + gObj.calc.bcast_3 + '.' + gObj.calc.bcast_4;
                        }
                    }
                }
                break;
            case 3:
                if (!gReg.isIPv4.test( $('#More-type-' + $('#More-type').val() + '-startIp').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipStart + '</p>';
                }

                if (!gReg.isIPv4.test( $('#More-type-' + $('#More-type').val() + '-endIp').val() ) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipEnd + '</p>';
                }
    
                if (pass) {
                    if (! ipv4Compare( $('#More-type-' + $('#More-type').val() + '-startIp').val(), $('#More-type-' + $('#More-type').val() + '-endIp').val() ) ) {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].ipRange + '</p>';
                    }
                }
                break;
            case 4:
                if (!gReg.isMAC.test( $('#More-type-' + $('#More-type').val() + '-mac').val() ) ) {
                    if (gReg.isCMAC.test( $('#More-type-' + $('#More-type').val() + '-mac') ) ) {
                        if (!gReg.isMAC.test( $('#More-type-' + $('#More-type').val() + '-macInput').val() ) ) {
                            pass = false;
                            msg += '<p>' + gError[ gObj.lang ].macAddr + '</p>';
                        }
                    } else {
                        pass = false;
                        msg += '<p>' + gError[ gObj.lang ].macAddr + '</p>';
                    }
                }
                break;
            }
            break;
        case 'cGAddr':
            break;
        case 'cService':
            break;
        case 'cGService':
            break;
        case 'cSchedule':
            break;
        }
    
        if (!pass) {
            errorAlert( msg );
        }
        return pass;
        if (!pass) {
            errorAlert(msg);
        }
    
        return pass;
    }
    
    function selectorSave() {
    
    }

    function genDhcpBinding( pno ) {
        gObj.dhcpBinding = [];
        gCache.dhcpBinding = [];
        gObj.pno = false;
        
        $('#table-dhcp_binding').append('<tbody></tbody>');
        if (pno) {
            gObj.refIfName = gData[ gNode.tab ][ gNode.guiT ][ pno ].name;
            gObj.ifId = gData[ gNode.tab ][ gNode.guiT ][ pno ].gid ;
            gObj.pno = pno;

            var cnt = 0;
            for (var i=0; i<gData[ gNode.tab ][ gNode.reservTNum ]; i++)
            {
                if ( (3 != parseInt( gData[ gNode.tab ][ gNode.reservT ][ i ].cgiAction ) ) && ( (gData[ gNode.tab ][ gNode.guiT ][ pno ].gid == gData[ gNode.tab ][ gNode.reservT ][ i ].ifId ) || (gData[ gNode.tab ][ gNode.guiT ][ pno ].name == gData[ gNode.tab ][ gNode.reservT ][ i ].refIfName ) ) ) {
                    var tmp = '<tr class="' + ((0 === cnt%2)? 'even' : 'odd') + '">';
                    tmp += '<td>';
                    tmp += '<input type="checkbox" id="Editor-dhcp_binding-' + cnt + '" value="' + cnt + '">';
                    tmp += '</td>';
                    tmp += '<td>';
                    tmp += gData[ gNode.tab ][ gNode.reservT ][ i ].name;
                    tmp += '</td>';
                    tmp += '<td>';
                    tmp += gCache.address[ gData[ gNode.tab ][ gNode.reservT ][ i ].assignIpId ];
                    tmp += '</td>';
                    tmp += '<td>';
                    tmp += gCache.address[ gData[ gNode.tab ][ gNode.reservT ][ i ].macAddrId ];
                    tmp += '</td>';
                    tmp += '<td>';
                    if (gIf.power) {
                        tmp += '<button id="Edit-dhcp_binding-' + gNode.tab + '-' + cnt + '" class="Edit"><span class="ui-icon"></span></button>';
                        tmp += '<button id="Delete-dhcp_binding-' + gNode.tab + '-' + cnt + '" class="Delete"><span class="ui-icon"></span></button>';
                    } else {
                        tmp += '';
                    }
                    tmp += '</td>';
                    tmp += '</tr>';
                    $('#table-dhcp_binding tbody').append(tmp);
                    gCache.dhcpBinding.push( true );
                    gObj.dhcpBinding.push( gData[ gNode.tab ][ gNode.reservT ][ i ] );
                    cnt++;
                }
            }
        }


        if (gIf.power) {
            $('#panel-dhcp_binding').append('<div class="tblAction table-dhcp_binding"><button id="Create-dhcp_binding-' + gNode.tab + '" class="Create" title="Create"><span class="ui-icon"></span></button><button id="Remove-dhcp_binding-' + gNode.tab + '" class="Remove" title="Remove"><span class="ui-icon"></span></button></div>');
            if (gObj.dhcpBinding.length >= gLimit.dnssetting.rows)
                $('#Edit-dhcp_binding-' + gNode.tab).prop('disabled', true);
        }
    }

    function refreshDhcpBinding( ) {
        $('#table-dhcp_binding tbody').empty();

        var cnt = 0;
        for (var i=0; i<gObj.dhcpBinding.length; i++)
        {
            if ( (3 === parseInt( gObj.dhcpBinding[ i ].cgiAction )) || !gCache.dhcpBinding[ i ] )
                continue;
            var tmp = '<tr class="' + ((0 === cnt%2)? 'even' : 'odd') + '">';
            tmp += '<td>';
            tmp += '<input type="checkbox" id="Editor-dhcp_binding-' + i + '" value="' + i + '">';
            tmp += '</td>';
            tmp += '<td>';
            tmp += gObj.dhcpBinding[ i ].name;
            tmp += '</td>';
            tmp += '<td>';
            tmp += gCache.address[ gObj.dhcpBinding[ i ].assignIpId ];
            tmp += '</td>';
            tmp += '<td>';
            tmp += gCache.address[ gObj.dhcpBinding[ i ].macAddrId ];
            tmp += '</td>';
            tmp += '<td>';
            if (gIf.power) {
                tmp += '<button id="Edit-dhcp_binding-' + gNode.tab + '-' + i + '" class="Edit"><span class="ui-icon"></span></button>';
                tmp += '<button id="Delete-dhcp_binding-' + gNode.tab + '-' + i + '" class="Delete"><span class="ui-icon"></span></button>';
            } else {
                tmp += '';
            }
            tmp += '</td>';
            tmp += '</tr>';
            $('#table-dhcp_binding tbody').append(tmp);
            cnt++;
        }
        if (cnt >= gLimit.dnssetting.rows)
            $('#Edit-dhcp_binding-' + gNode.tab).prop('disabled', true);
        else
            $('#Edit-dhcp_binding-' + gNode.tab).prop('disabled', false);
    }

    function createDhcpBinding(e) {
        if (!($('#popPlus').exists()))
            $('#popBase').append('<div id="popPlus"></div>');

        var tmp = '<table id="Create-table-dhcp_binding">';
        tmp += '<tr>';
        tmp += '<th class="alignLeft BT80"><label for="dhcpBindingName">' + gTerm[ gObj.lang ].name + '</label></th>';
        tmp += '<td class="alignLeft"><input type="text" id="dhcpBindingName" /></td>';
        tmp += '</tr>';
        tmp += '<tr>';
        tmp += '<th class="alignLeft BT80"><label for="dhcpBindingIP">' + gTerm[ gObj.lang ].IP + '</label></th>';
        tmp += '<td class="alignLeft"><select id="dhcpBindingIP"></select></td>';
        tmp += '</tr>';
        tmp += '<tr>';
        tmp += '<th class="alignLeft"><label for="dhcpBindingMAC">' + gTerm[ gObj.lang ].MAC + '</label></th>';
        tmp += '<td class="alignLeft"><select id="dhcpBindingMAC"></select></td>';
        tmp += '</tr>';
        tmp += '</table>';

        $('#popPlus').append(tmp);

        cgiSelectOption('dhcpBindingIP');
        cgiSelectOption('dhcpBindingMAC');

        dhcpBindingEditor( e );
    }

    function editDhcpBinding(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');

        if (!tar.id)
            return false;

        tar.pid   = tar.id.split(gReg.isDash)[2];

        tar.thisNo = tar.id.split(gReg.isDash)[3];

        if (!($('#popPlus').exists()))
            $('#popBase').append('<div id="popPlus"></div>');

        var tmp = '<table id="Edit-table-dhcp_binding">';
        tmp += '<tr>';
        tmp += '<th class="alignLeft BT80"><label for="dhcpBindingName">' + gTerm[ gObj.lang ].name + '</label></th>';
        tmp += '<td class="alignLeft"><input type="text" id="dhcpBindingName" /></td>';
        tmp += '</tr>';
        tmp += '<tr>';
        tmp += '<th class="alignLeft BT80"><label for="dhcpBindingIP">' + gTerm[ gObj.lang ].IP + '</label></th>';
        tmp += '<td class="alignLeft"><select id="dhcpBindingIP"></select></td>';
        tmp += '</tr>';
        tmp += '<tr>';
        tmp += '<th class="alignLeft "><label for="dhcpBindingMAC">' + gTerm[ gObj.lang ].MAC + '</label></th>';
        tmp += '<td class="alignLeft"><select id="dhcpBindingMAC"></select></td>';
        tmp += '</tr>';
        tmp += '</table>';

        $('#popPlus').append(tmp);
        cgiSelectOption('dhcpBindingIP', gObj.dhcpBinding[ tar.thisNo ].assignIpId );
        cgiSelectOption('dhcpBindingMAC', gObj.dhcpBinding[ tar.thisNo ].macAddrId );
        $('#dhcpBindingName').val( gObj.dhcpBinding[ tar.thisNo ].name );
        dhcpBindingEditor( e );
    }

    function dhcpBindingEditor( e ) {
        var tar = {};
        if (gObj.active.h5Index == 'NA') {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label;
        }else {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].label;
        }
    
        tar.id = $(e.currentTarget).attr('id');

        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];

        tar.pid  = tar.id.split(gReg.isDash)[ 2 ];

        gPop.popPlus = $('#popPlus').dialog({
            width: 300,
            height: 200,
            position: "center",
            resizable: false,
            modal: true,
            title: tar.title + ' > ' + gTerm[ gObj.lang ].dhcpBinding + ' > ' + gTerm[ gObj.lang ][ tar.type ],
            buttons: {
                Ok: function() {
                    if (dhcpBindingChecker(tar)) {
                        switch( tar.type )
                        {
                        case 'Create':
                            gCache[ tar.pid ].reservTGid--;
                            tar.thisNo = gObj.dhcpBinding.length;
                            gObj.dhcpBinding[ tar.thisNo ] = $.extend({}, gJson[ gNode.url.get ][ gNode.reservT ][ 0 ]);
                           
                            gObj.dhcpBinding[ tar.thisNo ].gid = gCache[ tar.pid ].reservTGid;
                            gObj.dhcpBinding[ tar.thisNo ].cgiAction = 1;  
                            gObj.dhcpBinding[ tar.thisNo ].ifId = (gObj.pno)? gObj.ifId : '';
                            gObj.dhcpBinding[ tar.thisNo ].refIfName = (gObj.pno)? gObj.refIfName : $('#basic_settings-name').val();
                            gCache.dhcpBinding.push( true );
                            break;
                        case 'Edit':
                            tar.thisNo  = tar.id.split(gReg.isDash)[ 3 ];
                            if ( gObj.dhcpBinding[ tar.thisNo ].gid > 0 ) 
                                gObj.dhcpBinding[ tar.thisNo ].cgiAction = 2;  
                            
                            break;
                        }

                        gObj.dhcpBinding[ tar.thisNo ].name = $('#dhcpBindingName').val();
                        gObj.dhcpBinding[ tar.thisNo ].assignIpId = $('#dhcpBindingIP').val();
                        gObj.dhcpBinding[ tar.thisNo ].macAddrId = $('#dhcpBindingMAC').val();

                        refreshDhcpBinding();
                        $( this ).dialog( "close" );
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(e, ui) {
                $(this).dialog('destroy').remove();
            }
        });
    }
    
    function dhcpBindingChecker(tar) {
        var msg = '';
        var pass = true;
        var uniqName = true;
        var uniqIP = true;

        switch( tar.type )
        {
        case 'Create':
            // uniq name & ip
            for (var i=0, len=gData[ gNode.tab ][ gNode.reservT ].length; i<len; i++)
            {
                if ($('#dhcpBindingName').val() == gData[ gNode.tab ][ gNode.reservT ][ i ].name) {
                    pass = false;
                    uniqName = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName63 + '</p>';
                }

                if ($('#dhcpBindingIP').val() == gData[ gNode.tab ][ gNode.reservT ][ i ].assignIpId) {
                    pass = false;
                    uniqIP = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqIP + '</p>';
                }
            }
        
            for (var i=0, len=gObj.dhcpBinding.length; i<len; i++)
            {
                if (uniqName && $('#dhcpBindingName').val() == gObj.dhcpBinding[ i ].name) {
                    pass = false;
                    uniqName = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName63 + '</p>';
                }

                if (uniqIP && $('#dhcpBindingIP').val() == gObj.dhcpBinding[ i ].assignIpId) {
                    pass = false;
                    uniqIP = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqIP + '</p>';
                }

                if ($('#dhcpBindingMAC').val() == gObj.dhcpBinding[ i ].macAddrId) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqMAC + '</p>';
                }
            }

            // ip & if @ same subnet 
            if (gObj.pno) {
                if ( ( gCache.ipAlias[ parseInt( $('#dhcpBindingIP').val() )  ] == gData[ gNode.tab ][ gNode.guiT ][ gObj.pno ].address ) || (!compareIf( gCache.ipAlias[ parseInt( $('#dhcpBindingIP').val() ) ], gData[ gNode.tab ][ gNode.guiT ][ gObj.pno ].address, gData[ gNode.tab ][ gNode.guiT ][ gObj.pno ].netmask )) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipMatch + '</p>';
                } 
            } else if ( gReg.ipv4.test( $('#basic_settings-address').val() ) && gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                if ( ( gCache.ipAlias[ parseInt( $('#dhcpBindingIP').val() ) ] == $('#basic_settings-address').val() ) || (!compareIf( gCache.ipAlias[ parseInt( $('#dhcpBindingIP').val() ) ], $('#basic_settings-address').val(), $('#basic_settings-netmask').val() )) ) { 
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipMatch + '</p>';
                } 
            }
            break;
        case 'Edit':
            // uniq name & ip
            tar.thisNo  = parseInt( tar.id.split(gReg.isDash)[ 3 ] );
            for (var i=0, len=gData[ gNode.tab ][ gNode.reservT ].length; i<len; i++)
            {
                if ($('#dhcpBindingName').val() == gData[ gNode.tab ][ gNode.reservT ][ i ].name && gObj.dhcpBinding[ tar.thisNo ].gid != gData[ gNode.tab ][ gNode.reservT ][ i ].gid) {
                    pass = false;
                    uniqName = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName63 + '</p>';
                }

                if ($('#dhcpBindingIP').val() == gData[ gNode.tab ][ gNode.reservT ][ i ].assignIpId && gObj.dhcpBinding[ tar.thisNo ].gid != gData[ gNode.tab ][ gNode.reservT ][ i ].gid) {
                    pass = false;
                    uniqIP = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqIP + '</p>';
                }
            }

            for (var i=0, len=gObj.dhcpBinding.length; i<len; i++)
            {
                if (uniqName && $('#dhcpBindingName').val() == gObj.dhcpBinding[ i ].name && tar.thisNo != i) {
                    uniqName = false;
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqName63 + '</p>';
                }

                if (uniqIP && $('#dhcpBindingIP').val() == gObj.dhcpBinding[ i ].assignIpId && tar.thisNo != i) {
                    pass = false;
                    uniqIP = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqIP + '</p>';
                }

                if ($('#dhcpBindingMAC').val() == gObj.dhcpBinding[ i ].macAddrId && tar.thisNo != i) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].uniqMAC + '</p>';
                }
            }

            // ip & if @ same subnet
            if (gObj.pno) {
                if ( (gCache.ipAlias[ parseInt( $('#dhcpBindingIP').val() ) ] == gData[ gNode.tab ][ gNode.guiT ][ gObj.pno ].address ) || (!compareIf( gCache.ipAlias[ parseInt( $('#dhcpBindingIP').val() ) ], gData[ gNode.tab ][ gNode.guiT ][ gObj.pno ].address, gData[ gNode.tab ][ gNode.guiT ][ gObj.pno ].netmask ))) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipMatch + '</p>';
                } 
            } else if ( gReg.ipv4.test( $('#basic_settings-address').val() ) && gReg.ipv4.test( $('#basic_settings-netmask').val() ) ) {
                if ( ( gCache.ipAlias[ parseInt( $('#dhcpBindingIP').val() ) ] == $('#basic_settings-address').val() ) || (!compareIf( gCache.ipAlias[ parseInt( $('#dhcpBindingIP').val() ) ], $('#basic_settings-address').val(), $('#basic_settings-netmask').val() )) ) {
                    pass = false;
                    msg += '<p>' + gError[ gObj.lang ].ipMatch + '</p>';
                } 
            }
            break;
        }

        if (!pass) 
            errorAlert(msg);

        return pass;
    }

    function deleteDhcpBinding(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[2];
        tar.thisNo  = tar.id.split(gReg.isDash)[3];
        // gObj.dhcpBinding[ tar.thisNo ].cgiAction = 3;
        gCache.dhcpBinding[ tar.thisNo ] = false;
        refreshDhcpBinding( tar.pid );
    }

    function removeDhcpBinding( e ) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[2];
        $('#table-dhcp_binding tr').each(function() {
            switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
            {
            case true:
                tar.thisNo = $(this).find('td:eq(0) input:checkbox').val();
                //gObj.dhcpBinding[ tar.thisNo ].cgiAction = 3;
                gCache.dhcpBinding[ tar.thisNo ] = false;
                break;
            }
        });
        refreshDhcpBinding( tar.pid );
    }

    function genAlias( pid, data) {
    
        gObj.ipAlias = [];
    
        $('#table-ip_alias').append('<tbody></tbody>');
        if (data) {
            var addrs = data.address.split(';');
            var masks = data.netmask.split(';');
            for (var i=0; i<data.ipAliasCnt; i++)
            {
                var tmp = '<tr class="' + ((0 === i%2)? 'even' : 'odd') + '">';
                tmp += '<td>' + gCache.ipAlias[ addrs[ i ] ] + '</td>';
                tmp += '<td>' + masks[ i ] + '</td>';
                tmp += '<td>';
                tmp += '<button id="Edit-ip_alias-' + pid + '-' + i + '" class="Edit"><span class="ui-icon"></span></button>';
                tmp += '<button id="Delete-ip_alias-' + pid + '-' + i + '" class="Delete"><span class="ui-icon"></span></button>';
                tmp += '</td>';
                tmp += '</tr>';
                $('#table-ip_alias tbody').append(tmp);
                gObj.ipAlias.push( {'address': addrs[ i ], 'netmask': masks[ i ]} );
            }
        }
    
        $('#panel-ip_alias').append('<div class="tblAction table-ip_alias"><button id="Create-ip_alias-' + pid + '" class="Create" title="Create"><span class="ui-icon"></span></button></div>');
    
        if (gObj.ipAlias.length < gRows.maxIPAlias ) {
            $('#Create-ip_alias-' + pid).prop('disabled', false);
        }else {
            $('#Create-ip_alias-' + pid).prop('disabled', true);
        }
    }
    
    function refreshAlias( pid ) {
        $('#table-ip_alias tbody').empty();
        for (var i=0; i<gObj.ipAlias.length; i++)
        {
            var tmp = '<tr class="' + ((0 === i%2)? 'even' : 'odd') + '">';
            tmp += '<td>' + gCache.ipAlias[gObj.ipAlias[ i ].address] + '</td>';
            tmp += '<td>' + gObj.ipAlias[ i ].netmask + '</td>';
            tmp += '<td>';
            tmp += '<button id="Edit-ip_alias-' + pid + '-' + i + '" class="Edit"><span class="ui-icon"></span></button>';
            tmp += '<button id="Delete-ip_alias-' + pid + '-' + i + '" class="Delete"><span class="ui-icon"></span></button>';
            tmp += '</td>';
            tmp += '</tr>';
            $('#table-ip_alias tbody').append(tmp);
        }
    
        if (gObj.ipAlias.length < gRows.maxIPAlias ) {
            $('#Create-ip_alias-' + pid).prop('disabled', false);
        }else {
            $('#Create-ip_alias-' + pid).prop('disabled', true);
        }
    }
    
    function createAlias(e) {
        if (!($('#popPlus').exists()))
            $('#popBase').append('<div id="popPlus"></div>');
        
        var tmp = '<table id="Create-table-alias">';
        tmp += '<tr>';
        tmp += '<th class="alignLeft BT60"><label for="aliasIP">' + gTerm[ gObj.lang ].address + '</label></th>';
        tmp += '<td class="alignLeft"><select id="aliasIP"></select></td>';
        tmp += '</tr>';
        tmp += '<tr>';
        tmp += '<th class="alignLeft BT60"><label for="aliasMask">' + gTerm[ gObj.lang ].netmask + '</label></th>';
        tmp += '<td class="alignLeft"><input type="text" id="aliasMask" /></td>';
        tmp += '</tr>';
        tmp += '</table>';
        
        $('#popPlus').append(tmp);
        cgiSelectOption('aliasIP');
    
        aliasEditor( e );
    }
    
    function editAlias(e) {
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
    
        if (!tar.id)
            return false;
    
        tar.pid   = tar.id.split(gReg.isDash)[2];
    
        tar.thisNo = tar.id.split(gReg.isDash)[3];
    
        if (!($('#popPlus').exists()))
            $('#popBase').append('<div id="popPlus"></div>');
        
        var tmp = '<table id="Edit-table-alias">';
        tmp += '<tr>';
        tmp += '<th class="alignLeft BT60"><label for="aliasIP">' + gTerm[ gObj.lang ].address + '</label></th>';
        tmp += '<td class="alignLeft"><select id="aliasIP"></select></td>';
        tmp += '</tr>';
        tmp += '<tr>';
        tmp += '<th class="alignLeft BT60"><label for="aliasMask">' + gTerm[ gObj.lang ].netmask + '</label></th>';
        tmp += '<td class="alignLeft"><input type="text" id="aliasMask" /></td>';
        tmp += '</tr>';
        tmp += '</table>';
        
        $('#popPlus').append(tmp);
        cgiSelectOption('aliasIP', gObj.ipAlias[ tar.thisNo ].address);
        $('#aliasMask').val( gObj.ipAlias[ tar.thisNo ].netmask );
        aliasEditor( e );
    }
    
    function aliasEditor(e) {
        var tar = {};
        var msg = '';
        if (gObj.active.h5Index == 'NA') {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label;
        }else {
            tar.title = gObj.menu[ gObj.active.h3Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].label + ' > ' + gObj.menu[ gObj.active.h3Index ].panel[ gObj.active.h4Index ].panel[ gObj.active.h5Index ].label;
        }
    
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];

        switch( tar.type )
        {
        case 'Create':
            tar.thisNo = -1;
            tar.pid  = tar.id.split(gReg.isDash).pop();
            break;
        case 'Edit':
            tar.thisNo  = tar.id.split(gReg.isDash).pop();
            tar.pid  = tar.id.split(gReg.isDash)[2];
            break;
        }

        gObj.alias = {};
        gObj.alias.checkIp = {
            "checkType" : false,
            "startIp" : "",
            "endIp" : "",
            "isConflict" : 0,
            "conflictType" : ""
        };
    
        gPop.popPlus = $('#popPlus').dialog({
            width: 300,
            height: 200,
            position: "center",
            resizable: false,
            modal: true,
            title: tar.title + ' > ' + gTerm[ gObj.lang ].ipAlias + ' > ' + gTerm[ gObj.lang ][ tar.type ],
            buttons: {
                Ok: function() {
                    if (aliasChecker(e)) {
                        // check ip conflict 
                        var pass = true;
                        var startIp = gCache.ipAlias[ parseInt( $('#aliasIP').val() ) ];
                        switch( tar.pid )
                        {
                        case 'wan_settings':
                            gObj.alias.checkIp.checkType = 'wanIpAlias';
                            for (var i=0; i<gData[ tar.pid ][ gNode.guiT ].length; i++)
                            {
                                if (0 === parseInt( gData[ tar.pid ][ gNode.guiT ][ i ].wanProto )) {
                                    if (startIp == gData[ tar.pid ][ gNode.staticipT ][ i ].ip) {
                                        pass = false;
                                        gObj.alias.checkIp.conflictType = 'wanIfIp';
                                    }
                                }else if (startIp == gData[ tar.pid ][ gNode.guiT ][ i ].address) {
                                    pass = false;
                                    gObj.alias.checkIp.conflictType = 'wanIfIp';
                                }
                            }
            
                            for (var i=0; i<gData[ tar.pid ][ gNode.aliasT ].length; i++)
                            {
                                var arr = gData[ tar.pid ][ gNode.aliasT ][ i ].address.split(';');
                                for (var j=0; j<arr.length; j++) 
                                {
                                    if (!isNaN( arr[ j ] )) {
                                        if ($('#aliasIP').val() == arr[ j ]) {
                                            if (tar.thisNo != j ) {
                                                pass = false;
                                                gObj.alias.checkIp.conflictType = 'wanIfIpAlias';
                                            }
                                        }
                                    }
                                }
                            }
                            break;
                        default: 
                            gObj.alias.checkIp.checkType = ( tar.pid == 'lan' )? 'lanIpAlias' : ( (tar.pid == 'ports')? 'portIpAlias' : 'vlanIpAlias' );
                            for (var i=0; i<gData[ tar.pid ][ gNode.guiTNum ]; i++)
                            {
                                if (startIp == gData[ tar.pid ][ gNode.guiT ][ i ].address) {
                                    pass = false;
                                    gObj.alias.checkIp.conflictType = ( tar.pid == 'lan' )? 'lanIfIp' : ( (tar.pid == 'vlan_interfaces')? 'vlanIfIp' : 'portIfIp' );
                                } 
                            }
            
                            for (var i=0; i<gData[ tar.pid ][ gNode.aliasTNum ]; i++)
                            {
                                var arr = gData[ tar.pid ][ gNode.aliasT ][ i ].address.split(';');
                                for (var j=0; j<arr.length; j++) 
                                {
                                    if (!isNaN( arr[ j ] )) {
                                        if ($('#aliasIP').val() == arr[ j ]) {
                                            if (tar.thisNo != j ) {
                                                pass = false;
                                                gObj.alias.checkIp.conflictType = ( tar.pid == 'lan' )? 'lanIfIpAlias' : ( (tar.pid == 'vlan_interfaces')? 'vlanIfIpAlias' : 'portIfIpAlias' );
                                            }
                                        }
                                    }
                                }
                            }
                        }

                        if ( pass ) {
                            var arr = startIp.split('.');
                            for (var i=0; i<arr.length; i++)
                                gObj.alias["ip_" + (i+1)] = parseInt(arr[i]);
                            arr = $('#aliasMask').val().split('.');
                            for (var i=0; i<arr.length; i++)
                                gObj.alias["snm_" + (i+1)] = parseInt(arr[i]);
                            calcNWbits(gObj.alias);
        
                            if (gObj.alias.result == 'invalid' || gObj.alias.numofaddr == 'ERR') {
                                pass = false;
                                msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                            } else {
                                gObj.alias.bits = gObj.alias.result;
                                calcNBFL(gObj.alias);
        
                                switch( gObj.alias.numofaddr )
                                {
                                case 'ERR':
                                    pass = false;
                                    msg += '<p>' + gError[ gObj.lang ].ipNetmask + '</p>';
                                    break;
                                case 'one':
                                case 'two':
                                    gObj.alias.startIp = gObj.alias.firstadr_1 + '.' + gObj.alias.firstadr_2 + '.' + gObj.alias.firstadr_3 + '.' + gObj.alias.firstadr_4;
                                    gObj.alias.endIp = gObj.alias.lastadr1 + '.' + gObj.alias.lastadr_2 + '.' + gObj.alias.lastadr_3 + '.' + gObj.alias.lastadr_4;
                                    gObj.alias.checkIp.startIp = gObj.alias.startIp;
                                    gObj.alias.checkIp.endIp = gObj.alias.endIp;
                                    break;
                                default:
                                    gObj.alias.startIp = gObj.alias.nwadr_1 + '.' + gObj.alias.nwadr_2 + '.' + gObj.alias.nwadr_3 + '.' + gObj.alias.nwadr_4;
                                    gObj.alias.endIp = gObj.alias.bcast_1 + '.' + gObj.alias.bcast_2 + '.' + gObj.alias.bcast_3 + '.' + gObj.alias.bcast_4;
                                    gObj.alias.checkIp.startIp = gObj.alias.startIp;
                                    gObj.alias.checkIp.endIp = gObj.alias.endIp;
                                }

                                if (pass) {
                                    $.ajax({
                                        type : "post",
                                        url : "cgi-bin/checkIp.cgi",
                                        dataType: 'json',
                                        data: gY.JSON.stringify( gObj.alias.checkIp ),
                                        success: function(data) {
                                            if ( 0 === parseInt( data.status ) && 0 === parseInt( data.isConflict ) ) {
                                                switch( tar.type )
                                                {
                                                case 'Create':
                                                    gObj.ipAlias.push( {'address': $('#aliasIP').val(), 'netmask': $('#aliasMask').val()} );
                                                    break;
                                                case 'Edit':
                                                    tar.thisNo  = tar.id.split(gReg.isDash).pop();
                                                    gObj.ipAlias[ tar.thisNo ] = {'address': $('#aliasIP').val(), 'netmask': $('#aliasMask').val()};
                                                    break;
                                                }
                                                refreshAlias( tar.pid );
                                                gPop.popPlus.dialog( "close" );
                                            } else {
                                                //data.conflictType = data.conflictType.replace(',', '');
                                                var conflicts = data.conflictType.split(',');
                                                for (var i=0; i<conflicts.length; i++) 
                                                {
                                                    if (gError[ gObj.lang ][ conflicts[ i ] ] )
                                                        msg += '<p>' + gError[ gObj.lang ][ conflicts[ i ] ] + '</p>';
                                                }
                                                errorAlert( msg );
                                            }
                                        },
                                        fail: function() {
                                            msg = '<p>' + gError[ gObj.lang ].overlapCheck + '</p>';
                                            errorAlert( msg );
                                        }
                                    });
                                } 
                            } 
                        } else {
                            msg = '<p>' + gError[ gObj.lang ][ gObj.alias.checkIp.conflictType ] + '</p>';
                            errorAlert( msg );
                        }
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function(e, ui) {
                $(this).dialog('destroy').remove();
            }
        });
    }
    
    function aliasChecker(e) {
        var pass = true;

        if (!gReg.ipv4.test( $('#aliasMask').val() )) {
            pass = false;
            msg = '<p>' + gError[ gObj.lang ].netmask + '</p>';
        }
    
        if (!pass) {
            errorAlert(msg);
        }

        return pass;
    }
    
    function deleteAlias(e) {
    
        var tar = {};
        tar.id = $(e.currentTarget).attr('id');
        if (!tar.id)
            return false;
        tar.type  = tar.id.split(gReg.isDash)[0];
        tar.pid  = tar.id.split(gReg.isDash)[2];
    
        tar.thisNo  = tar.id.split(gReg.isDash)[3];
    
        gObj.ipAlias.splice(tar.thisNo, 1);
    
        refreshAlias( tar.pid );
    }
    
    function genSelector(id, val, reg) {
        var tmp = '';
        
        $('#' + id).empty();
    
        switch(id)
        {
        case 'vpn_failover-backupPolicyName':
            var cnt=0;
            //tmp = '<option value="NA" >Select From Existing IPSec Policy</option>';
            tmp = '<option value="NA" >Select From Existing IPSec Policy</option>';
            tmp = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].IPSec + ' ' + gTerm[ gObj.lang ].policy + '</option>';
             
            var backups = {};
            for (var i=0; i<gData.ipsec_policies.guiS2svpnTNum; i++)
            {
                if ( gCache.uniq.ipsec_policies[ gData.ipsec_policies.guiS2svpnT[ i ].backupPolicyName ]) {
                    backups[ gData.ipsec_policies.guiS2svpnT[ i ].name ] = true;
                    backups[ gData.ipsec_policies.guiS2svpnT[ i ].backupPolicyName ] = true;
                }
            }
    
            for (var i=0; i<gData.ipsec_policies.guiS2svpnTNum; i++)
            {
                if (1 === parseInt( gData.ipsec_policies.guiS2svpnT[ i ].infoStatus )) {
                    continue;
                } else if ( val && val === gData.ipsec_policies.guiS2svpnT[ i ].name ) {
                    tmp += '<option value="' + gData.ipsec_policies.guiS2svpnT[ i ].name + '">' + gData.ipsec_policies.guiS2svpnT[ i ].name + '</option>';
                } else if ( backups[ gData.ipsec_policies.guiS2svpnT[ i ].name ] ) {
                    continue;
                } else if ( reg && reg === gData.ipsec_policies.guiS2svpnT[ i ].name ) {
                    continue;
                } else {
                    tmp += '<option value="' + gData.ipsec_policies.guiS2svpnT[ i ].name + '">' + gData.ipsec_policies.guiS2svpnT[ i ].name + '</option>';
                }
                cnt++;
            }
    
            if (0 === cnt) {
                $('#vpn_failover-backupPolicyEnable').prop('disabled', true);
                $('#vpn_failover-backupPolicyName').prop('disabled', true);
                $('#vpn_failover-fallbackTime').prop('disabled', true);
            }
    
            break;
        case 'multiple_wan_settings-backupWanName':
            var cnt = 0;
    
            tmp = '<option value="NA" >Select From Existing WAN</option>';
            for (var x in gCache.wan.wan)
            {
                if (!gCache.wan.wan[ x ]) {
                    if ( reg && reg == x )
                        continue;
                    
                    if (val && val == x ) {
                        tmp += '<option value="' + x + '">' + x + '</option>';
                        cnt ++;
                    } else if (!(gCache.wan.backupWanName[ x ] || gCache.wan.wanName[ x ])) {
                        tmp += '<option value="' + x + '">' + x + '</option>';
                        cnt ++;
                    } 
                }
            }
            
            if (0 === cnt ) {
                $('#multiple_wan_settings-failoverEnable').prop('disabled', true);
                $('#multiple_wan_settings-backupWanName').prop('disabled', true);
            }
            break;
        case 'Editor-type':
            $('#Editor-type').change(function(){
                genSelector( 'Editor-sub', 0, $(this).val() );
            });
    
            for (var i=0, len=gRef.mime.length; i<len; i++)
                tmp += '<option value="' + gRef.mime[ i ].tab + '">' + gRef.mime[ i ].label + '</option>';
            break;
        case 'Editor-sub':
            if (reg) {
                for (var i=0, len=gRef.mime.length; i<len; i++)
                {
                    if (gRef.mime[ i ].tab == reg) {
                        for (var j=0, jlen=gRef.mime[ i ].types.length; j<jlen; j++)
                            tmp += '<option value="' + j + '">' + gRef.mime[ i ].types[ j ] + '</option>';
                    }
                }
            }else {
                for (var i=0, len=gRef.mime[ 0 ].types.length; i<len; i++)
                    tmp += '<option value="' + i + '">' + gRef.mime[ 0 ].types[ i ] + '</option>';
            }
            break;
        }
        if (val)
            $('#' + id).append( tmp ).val( val );
        else
            $('#' + id).append( tmp );
    }
    
    function refreshSelector(id, val, reg) {
    
    }
    
    function genMultiSelector( id, val, reg ) {
        var pool = '';
        var pick = '';
    
        switch( id )
        {
        case 'lan':
            for (var i=0, len=parseInt( gCache.list.common_portIf_list.guiPortIfTNum ); i<len; i++)
            {
                if (val && val.indexOf( parseInt( gCache.list.common_portIf_list.guiPortIfT[ i ].gid ) ) != -1 ) {
                    pick += '<option value="' + gCache.list.common_portIf_list.guiPortIfT[ i ].gid + '">' + gCache.list.common_portIf_list.guiPortIfT[ i ].name + '</option>';
                } else {
                    pool += '<option value="' + gCache.list.common_portIf_list.guiPortIfT[ i ].gid + '">' + gCache.list.common_portIf_list.guiPortIfT[ i ].name + '</option>';
                }
            }
    
            for (var i=0, len=parseInt( gCache.list.common_vlanIf_list.guiVlanIfTNum ); i<len; i++)
            {
                if (val && val.indexOf( parseInt( gCache.list.common_vlanIf_list.guiVlanIfT[ i ].gid ) ) != -1 ) { 
                    pick += '<option value="' + gCache.list.common_vlanIf_list.guiVlanIfT[ i ].gid + '">' + gCache.list.common_vlanIf_list.guiVlanIfT[ i ].name + '</option>';
                } else {
                    pool += '<option value="' + gCache.list.common_vlanIf_list.guiVlanIfT[ i ].gid + '">' + gCache.list.common_vlanIf_list.guiVlanIfT[ i ].name + '</option>';
                }
            }
            break;
        case 'zone':
            for (var i=0, len=parseInt(gCache.list.common_if_list.guiIfTNum); i<len; i++)
            {
                if (parseInt(gCache.list.common_if_list.guiIfT[ i ].ipNum) > 0) {
                    if (val && val.indexOf( parseInt( gCache.list.common_if_list.guiIfT[ i ].gid ) ) != -1 ) {
                        pick += '<option value="' + gCache.list.common_if_list.guiIfT[ i ].gid + '">' + gCache.list.common_if_list.guiIfT[ i ].name + '</option>';
                    } else {
                        pool += '<option value="' + gCache.list.common_if_list.guiIfT[ i ].gid + '">' + gCache.list.common_if_list.guiIfT[ i ].name + '</option>';
                    }
                }
            }
            break;
        }
    
        $('#pick').append( pick );
        $('#pool').append( pool );
    }
    
    function cgiSelectOption(id, val, tag, plus) {
        var cgiID;
        var cgiT;
        var cgiTNum;
        var tmp = "";
        var reg = "";
        if (isNaN(parseInt(tag))) { 
            $('#' + id + ' option').remove();
            switch(id)
            {
            case 'basic_settings-portId':
            case 'sourceAddress':
            case 'destinationAddress':
            case 'Editor-sAddrId':
            case 'Editor-dAddrId':
            case 'Editor-sourceAddress':
            case 'Editor-destinationAddress':
            case 'basic_settings-localNetworkId':
            case 'basic_settings-remoteNetworkId':
            case 'Editor-service':
            case 'Editor-accessAddressId':
                tag = 2;
                break;
            case 'Editor-fromIf':
            case 'Editor-toIf':
            case 'Editor-interfaceId':
                tag = 4;
                break;
            case 'vpn_failover-backupPolicyName':
                reg = tag;
                tag = 0;
                break;
            case 'Editor-nhIfId':
                if ($('#Editor-isDefaultRt').is(':checked'))
                    tag = 1;
                else 
                    tag = 4;
                break;
            default:
                tag = 0;
            }
        }
    
        switch( id )
        {
        case 'membership-groupId':
            cgiID   = 'group';
            cgiT    = 'groupListT';
            break;
        case 'basic_settings-wanId':
            cgiID   = 'common_wanIf_list';
            cgiT    = 'guiWanIfT';
            cgiTNum = 'guiWanIfTNum';
            break;
        case 'advance_settings-ikePolicyId':
            cgiID   = 'ipsecike';
            cgiT    = 'guiIpsecikeT';
            cgiTNum = 'guiIpsecikeTNum';
            break;
        case 'advance_settings-transformPolicyId':
            cgiID   = 'ipsectransform';
            cgiT    = 'guiIpsectransformT';
            cgiTNum = 'guiIpsectransformTNum';
            break;
        case 'basic_settings-interface':
            cgiID   = 'common_portIf_list';
            cgiT    = 'guiPortIfT';
            cgiTNum = 'guiPortIfTNum';
            break;
        case 'query-fromZone':
        case 'query-toZone':
        case 'Editor-fromZone':
        case 'Editor-toZone':
            cgiID   = 'common_zoneIf_list';
            cgiT    = 'guiZoneIfT';
            cgiTNum = 'guiZoneIfTNum';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].zone + '</option>';
            break;
        case 'ports-zoneId':
        case 'lan-zoneId':
        case 'basic_settings-zoneId':
            cgiID   = 'common_zoneIf_list';
            cgiT    = 'guiZoneIfT';
            cgiTNum = 'guiZoneIfTNum';
            break;
        case 'basic_settings-portId':
            switch(tag)
            {
            case 1:
                cgiID   = 'common_vlanIf_list';
                cgiT    = 'guiVlanIfT';
                cgiTNum = 'guiVlanIfTNum';
                break;
            case 2:
                cgiID   = 'common_portIf_list';
                cgiT    = 'guiPortIfT';
                cgiTNum = 'guiPortIfTNum';
                break;
            }
            break;
        case 'Editor-sAddrId':
        case 'Editor-dAddrId':
            switch(tag)
            {
            case 1:
                cgiID   = 'common_gAddr_list';
                cgiT    = 'guiGAddrT';
                cgiTNum = 'guiGAddrTNum';
                break;
            case 2:
                cgiID   = 'common_addr_list';
                cgiT    = 'guiAddrT';
                cgiTNum = 'guiAddrTNum';
                tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].address + '</option>';
                tmp    += '<option value="cAddr"'; 
                if (gObj.thisNo>= gLimit.common_addr_list.rows)
                    tmp += '"disabled=disabled"';
                tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].address + '</option>';
                tmp    += '<option value="cGAddr"';
                if (gObj.thisNo>= gLimit.common_gAddr_list.rows)
                    tmp += '"disabled=disabled"';
                tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].group + ' ' + gTerm[ gObj.lang ].address + '</option>';
                tmp    += '<option value="0" >' + gTerm[ gObj.lang ].Any + '</option>';
                break;
            }
            break;
        case 'sourceAddress':
        case 'destinationAddress':
        case 'Editor-sourceAddress':
        case 'Editor-destinationAddress':
            switch(tag)
            {
            case 1:
                cgiID   = 'common_gAddr_list';
                cgiT    = 'guiGAddrT';
                cgiTNum = 'guiGAddrTNum';
                break;
            case 2:
                cgiID   = 'common_addr_list';
                cgiT    = 'guiAddrT';
                cgiTNum = 'guiAddrTNum';
                tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].address + '</option>';
                tmp    += '<option value="cAddr"'; 
                if (gObj.thisNo>= gLimit.common_addr_list.rows)
                    tmp += '"disabled=disabled"';
                tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].address + '</option>';
                tmp    += '<option value="cGAddr"';
                if (gObj.thisNo>= gLimit.common_gAddr_list.rows)
                    tmp += '"disabled=disabled"';
                tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].group + ' ' + gTerm[ gObj.lang ].address + '</option>';
                break;
            }
            break;
        case 'Editor-accessAddressId':
            switch(tag)
            {
            case 1:
                cgiID   = 'common_gAddr_list';
                cgiT    = 'guiGAddrT';
                cgiTNum = 'guiGAddrTNum';
                break;
            case 2:
                cgiID   = 'common_addr_list';
                cgiT    = 'guiAddrT';
                cgiTNum = 'guiAddrTNum';
                tmp     = '<option value="0" >' + gTerm[ gObj.lang ].Any + '</option>';
                tmp    += '<option value="cAddr"';
                if (gObj.thisNo>= gLimit.common_addr_list.rows)
                    tmp += '"disabled=disabled"';
                tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].address + '</option>';
                tmp    += '<option value="cGAddr"';
                if (gObj.thisNo>= gLimit.common_gAddr_list.rows)
                    tmp += '"disabled=disabled"';
                tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].group + ' ' + gTerm[ gObj.lang ].address + '</option>';
                break;
            }
            break;
        case 'basic_settings-localNetworkId':
        case 'basic_settings-remoteNetworkId':
            switch(tag)
            {
            case 1:
                cgiID   = 'common_gAddr_list';
                cgiT    = 'guiGAddrT';
                cgiTNum = 'guiGAddrTNum';
                break;
            case 2:
                cgiID   = 'common_addr_list';
                cgiT    = 'guiAddrT';
                cgiTNum = 'guiAddrTNum';
                tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].address + '</option>';
                tmp    += '<option value="cAddr"'; 
                if (gObj.thisNo>= gLimit.common_addr_list.rows)
                    tmp += '"disabled=disabled"';
                tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].address + '</option>';
                tmp    += '<option value="cGAddr"';
                if (gObj.thisNo>= gLimit.common_gAddr_list.rows)
                    tmp += '"disabled=disabled"';
                tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].group + ' ' + gTerm[ gObj.lang ].address + '</option>';
                tmp    += '<option value="0" >' + gTerm[ gObj.lang ].Any + '</option>';
                break;
            }
            break;
        case 'vpn_failover-backupPolicyName':
            cgiID = 's2svpn';
            cgiT  = 'guiS2svpnT';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].IPSec + ' ' + gTerm[ gObj.lang ].policy + '</option>';
            break;
        case 'Editor-originalSrc':
        case 'Editor-originalDst':
        case 'Editor-translatedSrc':
        case 'Editor-translatedDst':
        case 'Editor-privateIp':
            cgiID   = 'common_addr_list';
            cgiT    = 'guiAddrT';
            cgiTNum = 'guiAddrTNum';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].address + '</option>';
            tmp    += '<option value="cAddr"'; 
            if (gObj.thisNo>= gLimit.common_addr_list.rows)
                tmp += '"disabled=disabled"';
            tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].address + '</option>';
            break;
        case 'Editor-wanIpId':
            cgiID   = 'common_addr_list';
            cgiT    = 'guiAddrT';
            cgiTNum = 'guiAddrTNum';
            break;
        case 'Editor-publicIp':
            cgiID   = 'common_addr_list';
            cgiT    = 'guiAddrT';
            cgiTNum = 'guiAddrTNum';
            reg    = new RegExp( $('#Editor-wanInterface').val() );
            break;
        case 'Editor-addressId':
            cgiID   = 'common_addr_list';
            cgiT    = 'guiAddrT';
            cgiTNum = 'guiAddrTNum';
            reg    = new RegExp( $('#Editor-wanName').html() );
            break;
        case 'Editor-fromIf':
        case 'Editor-toIf':
        case 'Editor-interfaceId':
        case 'Editor-nhIfId':
            switch(tag)
            {
            case 2:
                cgiID   = 'common_lanIf_list';
                cgiT    = 'guiLanIfT';
                cgiTNum = 'guiLanIfTNum';
                break;
            case 3:
                cgiID   = 'common_vlanIf_list';
                cgiT    = 'guiVlanIfT';
                cgiTNum = 'guiVlanIfTNum';
                break;
            case 1:
                cgiID   = 'common_wanIf_list';
                cgiT    = 'guiWanIfT';
                cgiTNum = 'guiWanIfTNum';
                if ($('#Editor-isDefaultRt').is(':checked'))
                    tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].interface + '</option>';
                break;
            case 4:
                cgiID   = 'common_portIf_list';
                cgiT    = 'guiPortIfT';
                cgiTNum = 'guiPortIfTNum';
                tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].interface + '</option>';
                break;
            }
            break;
        case 'Editor-originalService':
        case 'Editor-translatedService':
        case 'Editor-triggerService':
        case 'Editor-openedService':
            cgiID   = 'common_service_list';
            cgiT    = 'guiServiceT';
            cgiTNum = 'guiServiceTNum';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].service + '</option>';
            tmp    += '<option value="cService"'; 
            if (gObj.thisNo>= gLimit.common_service_list.rows)
                tmp += '"disabled=disabled"';
            tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].service + '</option>';
            break;
        case 'Editor-service':
            switch( tag )
            {
            case 1:
                cgiID   = 'common_gService_list';
                cgiT    = 'guiGServiceT';
                cgiTNum = 'guiGServiceTNum';
                break;
            case 2:
                cgiID   = 'common_service_list';
                cgiT    = 'guiServiceT';
                cgiTNum = 'guiServiceTNum';
                tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].service + '</option>';
                tmp    += '<option value="cService"'; 
                if (gObj.thisNo>= gLimit.common_service_list.rows)
                    tmp += '"disabled=disabled"';
                tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].service + '</option>';
                tmp    += '<option value="cGService"'; 
                if (gObj.thisNo>= gLimit.common_gService_list.rows)
                    tmp += '"disabled=disabled"';
                tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].group + ' ' + gTerm[ gObj.lang ].service + '</option>';
                break;
            }
            break;
        case 'Editor-schedule':
            cgiID   = 'common_time_list';
            cgiT    = 'guiTimeT';
            cgiTNum = 'guiTimeTNum';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].schedule + '</option>';
            tmp    += '<option value="cSchedule"'; 
            if (gObj.thisNo>= gLimit.common_time_list.rows)
                tmp += '"disabled=disabled"';
            tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].schedule + '</option>';
            break;
        case 'multiple_wan_settings-netDetectPingIpId':
            cgiID   = 'common_addr_list';
            cgiT    = 'guiAddrT';
            cgiTNum = 'guiAddrTNum';
            tmp     = '<option value="0"> -- ' + gTerm[ gObj.lang ].default + ' ' + gTerm[ gObj.lang ].gateway + ' -- </option>';
            tmp    += '<option value="cAddr"'; 
            if (gObj.thisNo>= gLimit.common_addr_list.rows)
                tmp += '"disabled=disabled"';
            tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].address + '</option>';
            break;
        case 'multiple_wan_settings-netDetectDnsIpId':
            cgiID   = 'common_addr_list';
            cgiT    = 'guiAddrT';
            cgiTNum = 'guiAddrTNum';
            tmp     = '<option value="0"> -- ' + gTerm[ gObj.lang ].default + ' ' + gTerm[ gObj.lang ].DNS + ' ' + gTerm[ gObj.lang ].server + ' -- </option>';
            tmp    += '<option value="cAddr"'; 
            if (gObj.thisNo>= gLimit.common_addr_list.rows)
                tmp += '"disabled=disabled"';
            tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].address + '</option>';
            break;
        case 'Editor-dstIpId':
        case 'Editor-nhIpId':
        case 'aliasIP':
            cgiID   = 'common_addr_list';
            cgiT    = 'guiAddrT';
            cgiTNum = 'guiAddrTNum';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].address + '</option>';
            tmp    += '<option value="cAddr"'; 
            if (gObj.thisNo>= gLimit.common_addr_list.rows)
                tmp += '"disabled=disabled"';
            tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].address + '</option>';
            break;
        case 'dhcpBindingIP':
            cgiID   = 'common_addr_list';
            cgiT    = 'guiAddrT';
            cgiTNum = 'guiAddrTNum';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].address + '</option>';
            tmp    += '<option value="cAddr"'; 
            if (gObj.thisNo>= gLimit.common_addr_list.rows)
                tmp += '"disabled=disabled"';
            tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].host + ' ' + gTerm[ gObj.lang ].address + '</option>';
            break;
        case 'More-type-4-mac':
        case 'Editor-type-4-mac':
            cgiID   = 'arpTable';
            cgiT    = 'guiArpTableT';
            cgiTNum = 'guiArpTableTNum';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].MAC + ' ' + gTerm[ gObj.lang ].address + '</option>';
            tmp    += '<option value="macInput"'; 
            if (gObj.thisNo>= gLimit.common_addr_list.rows)
                tmp += '"disabled=disabled"';
            tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].MAC + ' ' + gTerm[ gObj.lang ].address + '</option>';
            break;
        case 'dhcpBindingMAC':
            cgiID   = 'common_addr_list';
            cgiT    = 'guiAddrT';
            cgiTNum = 'guiAddrTNum';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].MAC + ' ' + gTerm[ gObj.lang ].address + '</option>';
            tmp    += '<option value="cMAC"'; 
            if (gObj.thisNo>= gLimit.dhcpBindingMAC.rows)
                tmp += '"disabled=disabled"';
            tmp    += '>' + gTerm[ gObj.lang ].create + ' ' + gTerm[ gObj.lang ].new + ' ' + gTerm[ gObj.lang ].MAC + ' ' + gTerm[ gObj.lang ].address + '</option>';
            break;
        case 'Editor-ifname' :
        case 'pcapIfName' :
            cgiID   = 'common_if_list';
            cgiT    = 'guiIfT';
            cgiTNum = 'guiIfTNum';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].existing + ' ' + gTerm[ gObj.lang ].interface + ' ' + gTerm[ gObj.lang ].list + '</option>';
            break;
        case 'Editor-baseOn-device' :
        case 'Editor-importFrom-device' :
            cgiID   = 'backup_restore';
            cgiT    = 'guiProfileT';
            cgiTNum = 'guiProfileTNum';
            tmp     = '<option value="NA" >' + gTerm[ gObj.lang ].selectFromDevice + '</option>'; 
            break;
        }
    
        switch( id )
        {
        case 'basic_settings-portId':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                if ( !gCache.wan.portId[ parseInt( gCache.list[ cgiID ][ cgiT ][ i ].gid ) ] ||  parseInt( gCache.list[ cgiID ][ cgiT ][ i ].gid ) == val )
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'basic_settings-interface':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                if ( parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) != 2 )
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].name + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'sourceAddress':
        case 'destinationAddress':
        case 'Editor-sAddrId':
        case 'Editor-dAddrId':
        case 'Editor-sourceAddress':
        case 'Editor-destinationAddress':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                switch( tag )
                {
                case 2:
                    if ( parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) < 4 )
                        tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
                    break;
                case 1:
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
                    break;
                }
            }
            break;
        case 'basic_settings-localNetworkId':
        case 'basic_settings-remoteNetworkId':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                switch( tag )
                {
                case 2:
                    if ( parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) < 3 )
                        tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
                    break;
                case 1:
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
                    break;
                }
            }
            break;
        case 'Editor-originalSrc':
        case 'Editor-originalDst':
        case 'Editor-translatedSrc':
        case 'Editor-translatedDst':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                if ( parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) < 4 )
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'Editor-wanIpId':
            if ( parseInt( $('#Editor-wan').val() ) > 0 ) {
                var arr = gCache.if[ gCache.wanAlias[ 'WAN' + $('#Editor-wan').val() ] ].split(';');
    
                for (var i=0; i<arr.length; i++)
                {
                    if (!isNaN( parseInt( arr[ i ] ) ) ) {
                        tmp += '<option value="' + arr[ i ] + '">' + gCache.address[ arr[ i ] ] + '</option>';
                    }
                }
            }
            break;
        case 'Editor-publicIp':
        case 'Editor-addressId':
            for (var x in gCache.wanAlias)
            {
                if (reg.test( x )) {
                    var arr = gCache.if[ gCache.wanAlias[ x ] ].split(';');
                    for (var i=0; i<arr.length; i++)
                    { 
                        if (gCache.ipName[ arr[ i ] ]) {
                            tmp += '<option value="' + arr[ i ] + '">' + gCache.ipName[ arr[ i ] ] + '</option>';
                        }
                    }
                }
            }
            break;
        case 'Editor-privateIp':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++) {
                if ( parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) == 1 )
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'Editor-originalService':
        case 'Editor-translatedService':
        case 'Editor-triggerService':
        case 'Editor-openedService':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                if ( parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) < 3 )
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'multiple_wan_settings-netDetectPingIpId':
        case 'multiple_wan_settings-netDetectDnsIpId':
            for (var i=0, len=parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                if ( parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) < 2  || parseInt( gCache.list[ cgiID ][ cgiT ][ i ].gid ) == val  )
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'Editor-dstIpId':
            for (var i=0, len=parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                if ( (parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) < 3  && gCache.static_routing.dstIpId.indexOf( parseInt( gCache.list[ cgiID ][ cgiT ][ i ].gid ) )== -1) || parseInt( gCache.list[ cgiID ][ cgiT ][ i ].gid ) == val )
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'Editor-service':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
                tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            break;
        case 'Editor-schedule':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
                tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            break;
        case 'vpn_failover-backupPolicyName':
            for (var x in gCache.uniq.ipsec_policies.infoStatus)
            {
                if (gCache.uniq.ipsec_policies.backupPolicyName[ x ] || gCache.uniq.ipsec_policies.name[ x ] || x == reg)
                    continue;
                tmp += '<option value="' + x + '">' + x + '</option>';
            }
            break;
        case 'aliasIP':
        case 'Editor-nhIpId':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                if ( parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) == 1 ) 
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'dhcpBindingIP':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                if ( 1 === parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) && 1 === parseInt( gCache.list[ cgiID ][ cgiT ][ i ].userDefined ) ) 
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'More-type-4-mac':
        case 'Editor-type-4-mac':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                if (gReg.isMAC.test( gCache.list[ cgiID ][ cgiT ][ i ].mac ))
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].mac + '">' + gCache.list[ cgiID ][ cgiT ][ i ].mac + '</option>';
            }
            break;
        case 'dhcpBindingMAC':
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
            {
                if ( 4 === parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) && 1 === parseInt( gCache.list[ cgiID ][ cgiT ][ i ].userDefined ) ) 
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].mac + '</option>';
            }
            break;
        case 'membership-groupId':
            for ( var i=0, len=gData[ cgiID ][ cgiT ].length; i<len; i++ ) 
            {
                tmp += '<option value="' + gData[ cgiID ][ cgiT ][ i ].gid + '">' + gData[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'Editor-baseOn-device':
            for ( var i=0, len=gData[ cgiID ][ cgiT ].length; i<len; i++ ) 
            {
                tmp += '<option value="' + gData[ cgiID ][ cgiT ][ i ].name + '">' + gData[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'Editor-importFrom-device':
            for ( var i=0, len=gData[ cgiID ][ cgiT ].length; i<len; i++ ) 
            {
                if (val != i)
                    tmp += '<option value="' + gData[ cgiID ][ cgiT ][ i ].name + '">' + gData[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'Editor-ifname':
        case 'pcapIfName' :
            for ( var i=0, len=gCache.list[ cgiID ][ cgiTNum ]; i<len; i++ ) 
            {
                tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].name + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
            }
            break;
        case 'Editor-nhIfId':
            switch( tag )
            {
            case 1:
            case 2:
                for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
                break;
            case 3:
            case 4:
                for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++) {
                    if ( 0 === parseInt( gCache.list[ cgiID ][ cgiT ][ i ].type ) && gReg.ipv4.test( gCache.list[ cgiID ][ cgiT ][ i ].ip ))
                    tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
                }
                break;
            }
            break;
        default:
            for (var i=0, len= parseInt(gCache.list[ cgiID ][ cgiTNum ]); i < len; i++)
                tmp += '<option value="' + gCache.list[ cgiID ][ cgiT ][ i ].gid + '">' + gCache.list[ cgiID ][ cgiT ][ i ].name + '</option>';
    
        }
    
        $('#' + id).append(tmp);
       
        tag--;
    
        if (tag > 0)
            cgiSelectOption( id, val, tag);
        else {
            if (val || val == 0)
                $('#' + id).val( val ).trigger('change');
            else 
                $('#' + id).val( $('#' + id + ' option:first').val() ).trigger('change');
        }
    }
    
    function genSelectOption(id) {
        var tmp = "";
        switch(id)
        {
        case 'country':
            tmp += '<option value="NA">' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].country + '</option>';
            for (var x in gRef.country)
                tmp += '<option value="' + x + '">' + gRef.country[ x ] + '</option>';
            break;
        case 'tzName':
            for (var x in gRef.systime.tzName)
                tmp += '<option value="' + x + '">' + gRef.systime.tzName[x] + '</option>';
            break;
        case 'Editor-days':
        case 'More-days':
            tmp += '<option value="0">' + gTerm[ gObj.lang ].All + ' ' + gTerm[ gObj.lang ].days + '</option>';
            tmp += '<option value="1">' + gTerm[ gObj.lang ].specific + ' ' + gTerm[ gObj.lang ].days + '</option>';
            break;
        case 'Editor-times':
        case 'More-times':
            tmp += '<option value="0">' + gTerm[ gObj.lang ].All + ' ' + gTerm[ gObj.lang ].times + '</option>';
            tmp += '<option value="1">' + gTerm[ gObj.lang ].specific + ' ' + gTerm[ gObj.lang ].times + '</option>';
            break;
        case 'Editor-startHour':
        case 'Editor-endHour':
        case 'More-startHour':
        case 'More-endHour':
        case 'hour':
        case 'query-startHour':
        case 'query-endHour':
            for (var i=0; i<24; i++)
                tmp += '<option value="' + i + '">' + i + '</option>';
            break;
        case 'More-startMin':
        case 'More-endMin':
        case 'Editor-startMin':
        case 'Editor-endMin':
        case 'minute':
        case 'second':
        case 'query-startMin':
        case 'query-endMin':
            for (var i=0; i<60; i++)
                tmp += '<option value="' + i + '">' + i + '</option>';
            break;
        case 'signature-type':
            for (var x in gRef.antivirus.type)
                tmp += '<option value="' + x + '">' + gRef.antivirus.type[ x ] + '</option>';
            break;
        case 'signature-number-0':
            for (var i=gRef.antivirus.number.min[0]; i<=gRef.antivirus.number.max[0]; i++)
                tmp += '<option value="' + i + '">' + i + '</option>';
            break;
        case 'signature-number-1':
            for (var i=gRef.antivirus.number.min[1]; i<=gRef.antivirus.number.max[1]; i++)
                tmp += '<option value="' + i + '">' + i + '</option>';
            break;
        case 'signature-number-2':
            for (var i=gRef.antivirus.number.min[2]; i<=gRef.antivirus.number.max[2]; i++)
                tmp += '<option value="' + i + '">' + i + '</option>';
            break;
        case 'httpAct':
        case 'ftpAct':
        case 'smtpAct':
        case 'pop3Act':
        case 'imapAct':
        case 'cifsAct':
            for (var x in gRef.antivirus[ id ])
                tmp += '<option value="' + x + '">' + gRef.antivirus[ id ][ x ] + '</option>';
            break;
        case 'ports-speed':
            for (var x in gRef.port.speed)
                tmp += '<option value="' + x + '">' + gRef.port.speed[x] + '</option>';
            break;
        case 'ports-duplex':
            for (var x in gRef.port.duplex)
                tmp += '<option value="' + x + '">' + gRef.port.duplex[x] + '</option>';
            break;
        case 'guiDhcpsT-type':
            for (var x in gRef.dhcpServer.type)
                tmp += '<option value="' + x + '">' + gRef.dhcpServer.type[x] + '</option>';
            break;
        case 'basic_settings-interface':
            for (var i=0, len=gRef.vlan.interface.length; i<len; i++)
                tmp += '<option value="' + gRef.vlan.interface[i] + '">' + gRef.vlan.interface[i] + '</option>';
            break;
        case 'wanIpIfT-netDetectPingIpId':
        case 'wanIpIfT-netDetectDnsIpId':
            for (var i=0; i < parseInt(gCache.list.common_addr_list.guiAddrTNum); i++)
                tmp += '<option value="' + gCache.list.common_addr_list.guiAddrT[ i ].gid + '">' + gCache.list.common_addr_list.guiAddrT[ i ].name + '</option>';
            break;
        case 'wanIpIfT-wanProto':
            for (var i=0, len=gRef.wan.wanProto.length; i<len; i++) {
                tmp += '<option value="' + i + '">' + gRef.wan.wanProto[i] + '</option>';
            }
            break;
        case 'ipsec_policies-remoteGwType':
            for (var x in gRef.s2svpn.remoteGwType)
                tmp += '<option value="' + x + '">' + gRef.s2svpn.remoteGwType[x] + '</option>';
            break;
        case 'ipsec_policies-dpdaction':
            for (var x in gRef.s2svpn.dpdaction)
                tmp += '<option value="' + x + '">' + gRef.s2svpn.dpdaction[x] + '</option>';
            break;
        case 'ipsecike-cipher':
            for (var x in gRef.ipsecike.cipher)
                tmp += '<option value="' + x + '">' + gRef.ipsecike.cipher[x] + '</option>';
            break;
        case 'ipsecike-hash':
            for (var x in gRef.ipsecike.hash)
                tmp += '<option value="' + x + '">' + gRef.ipsecike.hash[x] + '</option>';
            break;
        case 'ipsecike-dhgroup':
            for (var x in gRef.ipsecike.dhgroup)
                tmp += '<option value="' + x + '">' + gRef.ipsecike.dhgroup[x] + '</option>';
            break;
        case 'ipsectransform-cipher':
            for (var x in gRef.ipsectransform.cipher)
                tmp += '<option value="' + x + '">' + gRef.ipsectransform.cipher[x] + '</option>';
            break;
        case 'ipsectransform-hash':
            for (var x in gRef.ipsectransform.hash)
                tmp += '<option value="' + x + '">' + gRef.ipsectransform.hash[x] + '</option>';
            break;
        case 'ipsectransform-pfsgroup':
            for (var x in gRef.ipsectransform.pfsgroup)
                tmp += '<option value="' + x + '">' + gRef.ipsectransform.pfsgroup[x] + '</option>';
            break;
        case 'Editor-wan':
            for (var x in gRef.portForwarding.wan)
            {
                if ( x == 0 || gCache.wanAlias[ gRef.portForwarding.wan[ x ] ])
                    tmp += '<option value="' + x + '">' + gRef.portForwarding.wan[x] + '</option>';
            }
            break;
        case 'Editor-wanInterface':
            for (var x in gCache.wanAlias)
                tmp += '<option value="' + x + '">' + x + '</option>';
            break;
        case 'Editor-matchAction':
            for (var x in gRef.rules.matchAction)
                tmp += '<option value="' + x + '">' + gRef.rules.matchAction[x] + '</option>';
            break;
        case 'access_control-actionType':
            tmp = '<option value="0">' + gTerm[ gObj.lang ].deny + '</option>';
            tmp += '<option value="1">' + gTerm[ gObj.lang ].permit + '</option>';
            break;
        case 'membership-groupId':
            for ( var i=0, len=gData.group.groupListT.length; i<len; i++ )
                tmp += '<option value="' + gData.group.groupListT[ i ].gid + '">' + gData.group.groupListT[ i ].name + '</option>';
            break;
        case 'groupList-webLoginPriv':
            for (var x in gRef.group.webLoginPriv)
                tmp += '<option value="' + x + '">' + gRef.group.webLoginPriv[x] + '</option>';
            break;
        case 'serviceType1':
            for (var x in gRef.service.type)
                tmp += '<option value="' + x + '">' + gRef.service.type[x] + '</option>';
            break;
        case 'serviceType2':
            for (var x in gRef.service.type2)
                tmp += '<option value="' + x + '">' + gRef.service.type2[x] + '</option>';
            break;
        case 'addressType1':
            for (var x in gRef.address.type)
                tmp += '<option value="' + x + '">' + gRef.address.type[x] + '</option>';
            break;
        case 'addressType2':
            for (var x in gRef.address.type2)
                tmp += '<option value="' + x + '">' + gRef.address.type2[x] + '</option>';
            break;
        case 'addressType3':
            for (var x in gRef.address.type3)
                tmp += '<option value="' + x + '">' + gRef.address.type3[x] + '</option>';
            break;
        case 'addressType4':
            for (var x in gRef.address.type4)
                tmp += '<option value="' + x + '">' + gRef.address.type4[x] + '</option>';
            break;
        case 'addressType5':
            for (var x in gRef.address.type5)
                tmp += '<option value="' + x + '">' + gRef.address.type5[x] + '</option>';
            break;
        case 'policy':
            tmp = '<option value="0">Deny</option>';
            tmp += '<option value="1">Permit</option>';
            break;
        case 'port':
            for (var x in gRef.emailAlert.port)
                tmp += '<option value="' + x + '">' + gRef.emailAlert.port[x] + '</option>';
            break;
        case 'secureMethod':
            for (var x in gRef.emailAlert.secureMethod)
                tmp += '<option value="' + x + '">' + gRef.emailAlert.secureMethod[x] + '</option>';
            break;
        case 'query-facility':
            tmp += '<option value="NA">All</option>';
            for (var x in gRef.loggings.facility)
                tmp += '<option value="' + x + '">' + gRef.loggings.facility[x] + '</option>';
            break;
        case 'query-severity':
        case 'localLogSeverity':
        case 'remoteLogSeverity':
        case 'emailLogSeverity':
            for (var x in gRef.loggings.severity)
                tmp += '<option value="' + x + '">' + gRef.loggings.severity[x] + '</option>';
            break;
        case 'emailSchUnit':
            for (var x in gRef.loggings.frequency)
                tmp += '<option value="' + x + '">' + gRef.loggings.frequency[x] + '</option>';
            break;
        case 'emailSchDay':
            for (var x in gRef.loggings.day)
                tmp += '<option value="' + x + '">' + gRef.loggings.day[x] + '</option>';
            break;
        case 'emailSchTimeHour':
            for (var i=gRef.loggings.time.min; i<gRef.loggings.time.max; i++)
                tmp += '<option value="' + i + '">' + ((i<10)? '0' + i : i) + '</option>';
            break;
        case 'phpPerPage':
            for (var i=0; i<gRef.phpPerPage.length; i++)
                tmp += '<option value="' + gRef.phpPerPage[ i ] + '">' + gRef.phpPerPage[ i ] + '</option>';
            break;
        case 'refreshPage':
            for (var x in gRef.refreshPage)
                tmp += '<option value="' + x + '">' + gRef.refreshPage[ x ] + '</option>';
            break;
        }
        return tmp;
    }

    function dataSort( data, pid, isTab ) {
        var arr = [];

        if ( isTab ) {
            pid = gNode.tab + '-' + pid;
        }

        if (!$('#table-' + pid + ' thead').exists())
            return false;

        var ascend = gY.one('#table-' + pid + ' thead').all('span.sortable.ascending');
        var descend = gY.one('#table-' + pid + ' thead').all('span.sortable.descending');
        var sortBy;

        if ( 'dhcp_bindings' == pid ) {
            if (ascend._nodes.length > 0) {
                sortBy = ascend._nodes[ 0 ].id.split('-').pop();
                data.sort( function( obj1, obj2 ) {
                    var arr1 = obj1.LeaseInfo.split('|');   
                    var arr2 = obj2.LeaseInfo.split('|');   
                    if (arr1[ sortBy ].toString().toLowerCase() > arr2[ sortBy ].toString().toLowerCase())
                        return 1;
                    if (arr1[ sortBy ].toString().toLowerCase() < arr2[ sortBy ].toString().toLowerCase())
                        return -1;
                    return 0;
                });
            } else if ( descend._nodes.length > 0) {
                sortBy = descend._nodes[ 0 ].id.split('-').pop();
                data.sort( function( obj1, obj2 ) {
                    var arr1 = obj1.LeaseInfo.split('|');   
                    var arr2 = obj2.LeaseInfo.split('|');   
                    if (arr1[ sortBy ].toString().toLowerCase() < arr2[ sortBy ].toString().toLowerCase())
                        return 1;
                    if (arr1[ sortBy ].toString().toLowerCase() > arr2[ sortBy ].toString().toLowerCase())
                        return -1;
                    return 0;
                });
            }
        } else {
            if (ascend._nodes.length > 0) {
                sortBy = ascend._nodes[ 0 ].id.split('-').pop();
                if (gReg.isNumeric.test( sortBy )) {
                    data.sort( function( obj1, obj2 ) {
                        return obj1[ sortBy ] - obj2[ sortBy ];
                    });
                } else {
                    data.sort( function( obj1, obj2 ) {
                        if (obj1[ sortBy ].toString().toLowerCase() > obj2[ sortBy ].toString().toLowerCase())
                            return 1;
                        if (obj1[ sortBy ].toString().toLowerCase() < obj2[ sortBy ].toString().toLowerCase())
                            return -1;
                        return 0;
                    });
                }
            } else if ( descend._nodes.length > 0) {
                sortBy = descend._nodes[ 0 ].id.split('-').pop();
                if (gReg.isNumeric.test( sortBy )) {
                    data.sort( function( obj1, obj2 ) {
                        return obj1[ sortBy ] - obj2[ sortBy ];
                    });
                } else {
                    data.sort( function( obj1, obj2 ) {
                        if (obj1[ sortBy ].toString().toLowerCase() < obj2[ sortBy ].toString().toLowerCase())
                            return 1;
                        if (obj1[ sortBy ].toString().toLowerCase() > obj2[ sortBy ].toString().toLowerCase())
                            return -1;
                        return 0;
                    });
                }
            }
        }

        arr = data;
        return arr;
    }
    
    function dataSortPhp( data, pid ) {
        var ascend = ( gReg.isTop.test( pid ) )? gY.one('#table-' + pid + ' thead').all('span.sortable.ascending') : gY.one('#theadTable-' + pid + ' thead').all('span.sortable.ascending');
        var descend = (gReg.isTop.test( pid ) )? gY.one('#table-' + pid + ' thead').all('span.sortable.descending') : gY.one('#theadTable-' + pid + ' thead').all('span.sortable.descending');
        var sortBy;

        if (ascend._nodes.length > 0) {
            sortBy = ascend._nodes[ 0 ].id.split('-').pop();

            if (gReg.isNumeric.test( sortBy )) {
                data.sort( function( obj1, obj2 ) {
                    return obj1[ sortBy ] - obj2[ sortBy ];
                });
            } else if (gReg.isIPAddress.test( sortBy )) {
                data.sort( function( obj1, obj2 ) {
                    return compare_ip( obj1[ sortBy ], obj2[ sortBy ] ); 
                });
            } else {
                data.sort( function( obj1, obj2 ) {
                    if (obj1[ sortBy ].toString().toLowerCase() > obj2[ sortBy ].toString().toLowerCase())
                        return 1;
                    if (obj1[ sortBy ].toString().toLowerCase() < obj2[ sortBy ].toString().toLowerCase())
                        return -1;
                    return 0;
                });
            }
        } else if ( descend._nodes.length > 0) {
            sortBy = descend._nodes[ 0 ].id.split('-').pop();

            if (gReg.isNumeric.test( sortBy )) {
                data.sort( function( obj1, obj2 ) {
                    return obj2[ sortBy ] - obj1[ sortBy ];
                });
            } else if (gReg.isIPAddress.test( sortBy )) {
                data.sort( function( obj1, obj2 ) {
                    return compare_ip( obj2[ sortBy ], obj1[ sortBy ] ); 
                });
            } else {
                data.sort( function( obj1, obj2 ) {
                    if (obj1[ sortBy ].toString().toLowerCase() < obj2[ sortBy ].toString().toLowerCase())
                        return 1;
                    if (obj1[ sortBy ].toString().toLowerCase() > obj2[ sortBy ].toString().toLowerCase())
                        return -1;
                    return 0;
                });
            }
        }

        return data;
    }

    function autoMaskBits( netmask ) {
        var nets = netmask.split(gReg.isDot);
        var bits = 0;
        var result = [];
        for (var i=0, len=nets.length; i<len; i++)
        {
            result.push( h_countbitsfromleft( parseInt( nets[ i ] ) ) );
            if (isNaN(result[ i ]) || ( i > 0 && result[ i ] > result[ i-1 ])) {
                return false;
            }
            bits += result[ i ];
        }
        return bits;
    }

    function dhcp_range( address, netmask, startIp, endIp ) {
        var pass = true;
        var addrArr = address.split('.');
        var maskArr = netmask.split('.');
        var startIpArr = startIp.split('.');
        var endIpArr = endIp.split('.');

        var addr = (parseInt(addrArr[ 0 ]) << 24) + (parseInt(addrArr[ 1 ]) << 16) + (parseInt(addrArr[ 2 ]) << 8) + parseInt(addrArr[ 3 ]);
        var mask = (parseInt(maskArr[ 0 ]) << 24) + (parseInt(maskArr[ 1 ]) << 16) + (parseInt(maskArr[ 2 ]) << 8) + parseInt(maskArr[ 3 ]);

        var start = (parseInt(startIpArr[ 0 ]) << 24) + (parseInt(startIpArr[ 1 ]) << 16) + (parseInt(startIpArr[ 2 ]) << 8) + parseInt(startIpArr[ 3 ]);
        var end = (parseInt(endIpArr[ 0 ]) << 24) + (parseInt(endIpArr[ 1 ]) << 16) + (parseInt(endIpArr[ 2 ]) << 8) + parseInt(endIpArr[ 3 ]);
        if ( start > end ) 
            pass = false;
        return pass;
    }

    function compare_ip( ip1, ip2 ) {
        var ip1Arr = ip1.split('.');
        var ip2Arr = ip2.split('.');
        var ip1Int = (parseInt(ip1Arr[ 0 ]) * 256 * 256 * 256) + (parseInt(ip1Arr[ 1 ]) * 256 * 256) + (parseInt(ip1Arr[ 2 ]) * 256) + (parseInt(ip1Arr[ 3 ]));
        var ip2Int = (parseInt(ip2Arr[ 0 ]) * 256 * 256 * 256) + (parseInt(ip2Arr[ 1 ]) * 256 * 256) + (parseInt(ip2Arr[ 2 ]) * 256) + (parseInt(ip2Arr[ 3 ]));
        return (ip1Int - ip2Int);
    }

    function dhcp_overlap( address, netmask, startIp, endIp ) {
        var pass = true;
        var addrArr = address.split('.');
        var maskArr = netmask.split('.');
        var startIpArr = startIp.split('.');
        var endIpArr = endIp.split('.');

        var addr = (parseInt(addrArr[ 0 ]) << 24) + (parseInt(addrArr[ 1 ]) << 16) + (parseInt(addrArr[ 2 ]) << 8) + parseInt(addrArr[ 3 ]);
        var mask = (parseInt(maskArr[ 0 ]) << 24) + (parseInt(maskArr[ 1 ]) << 16) + (parseInt(maskArr[ 2 ]) << 8) + parseInt(maskArr[ 3 ]);

        var start = (parseInt(startIpArr[ 0 ]) << 24) + (parseInt(startIpArr[ 1 ]) << 16) + (parseInt(startIpArr[ 2 ]) << 8) + parseInt(startIpArr[ 3 ]);
        var end = (parseInt(endIpArr[ 0 ]) << 24) + (parseInt(endIpArr[ 1 ]) << 16) + (parseInt(endIpArr[ 2 ]) << 8) + parseInt(endIpArr[ 3 ]);
        if ( (addr >= start) && (addr <= end)) 
            pass = false;
        return pass;
    }

    function pick_bigger( address, netmask ) {
        var addrArr = address.split('.');
        var maskArr = netmask.split('.');

        var addr = (parseInt(addrArr[ 0 ]) << 24) + (parseInt(addrArr[ 1 ]) << 16) + (parseInt(addrArr[ 2 ]) << 8) + parseInt(addrArr[ 3 ]);
        var mask = (parseInt(maskArr[ 0 ]) << 24) + (parseInt(maskArr[ 1 ]) << 16) + (parseInt(maskArr[ 2 ]) << 8) + parseInt(maskArr[ 3 ]);
        var start = (addr & mask);

        var end = ((addr & mask) | ~mask);

        var range = {};
        if (addr - start > end - addr) {
            range.start = [ ((start & 0xFF000000) >>> 24), ((start & 0x00FF0000) >>> 16), ((start & 0x0000FF00) >>> 8), ((start & 0x000000FF) + 1) ];
            range.end = [ ((addr & 0xFF000000) >>> 24), ((addr & 0x00FF0000) >>> 16), ((addr & 0x0000FF00) >>> 8), ((addr & 0x000000FF) - 1) ];
        } else {
            range.start = [ ((addr & 0xFF000000) >>> 24), ((addr & 0x00FF0000) >>> 16), ((addr & 0x0000FF00) >>> 8), ((addr & 0x000000FF) + 1) ];
            range.end = [ ((end & 0xFF000000) >>> 24), ((end & 0x00FF0000) >>> 16), ((end & 0x0000FF00) >>> 8), ((end & 0x000000FF) -1) ];
        }

        return range;
    }
    
    function autoDhcpServer(id, address, netmask, startIp, endIp) {
        
        gObj.calc = {};
        var addr = address.split(gReg.isDot);
        for (var i=0, len=addr.length; i<len; i++)
            gObj.calc["ip_" + (i+1)] = parseInt(addr[i]);
    
        var nets = netmask.split(gReg.isDot);
        for (var i=0, len=nets.length; i<len; i++)
            gObj.calc["snm_" + (i+1)] = parseInt(nets[i]);
    
        calcNWbits(gObj.calc);
    
        if (gObj.calc.result != 'invalid') {
            $('#dhcp_pool_settings-type option').each(function() {
                if (parseInt($(this).val()) == 1)
                    $(this).prop('disabled', false);
            });
            gObj.calc.bits = gObj.calc.result;
            calcNBFL(gObj.calc);
    
            switch(gObj.calc.numofaddr)
            {
            case 'ERR':
            case 'one':
                $('#dhcp_pool_settings-type option').each(function() {
                    if (parseInt($(this).val()) == 1)
                        $(this).prop('disabled', true);
                });
                break;
            case 'two':
                if (gObj.calc.ip_4 == gObj.calc.firstadr_4) {
                    gObj.calc.startIp   = gObj.calc.lastadr_1 + '.' + gObj.calc.lastadr_2 + '.' + gObj.calc.lastadr_3 + '.' + gObj.calc.lastadr_4;
                }else {
                    gObj.calc.startIp = gObj.calc.firstadr_1 + '.' + gObj.calc.firstadr_2 + '.' + gObj.calc.firstadr_3 + '.' + gObj.calc.firstadr_4;
                }
    
                gObj.calc.endIp = gObj.calc.startIp;
                $('#dhcp_pool_settings-1-startIp').val( gObj.calc.startIp );
                $('#dhcp_pool_settings-1-endIp').val( gObj.calc.endIp );
                $('#dhcp_pool_settings-1-gateway').val( address );

                if ( !gReg.ipv4.test( $('#dhcp_pool_settings-1-dns1').val() ) ) 
                    $('#dhcp_pool_settings-1-dns1').val( address );
                break;
            default:
                // check if existing dhcp settings, based on /24  
                var range = pick_bigger( address, netmask );
                
                if ((gReg.ipv4.test( startIp ) && gReg.ipv4.test( endIp )) &&  (compareIf( address, startIp, netmask ) && compareIf( address, endIp, netmask ))) {
                    range.oldStart = parseInt( startIp.split('.')[3] );
                    range.oldEnd = parseInt( endIp.split('.')[3] );
                    if ( parseInt( addr[ 3 ] ) >= range.oldStart && parseInt( addr[ 3 ] ) <= range.oldEnd ) {
                        $('#dhcp_pool_settings-1-startIp').val( range.start.join('.') );
                        $('#dhcp_pool_settings-1-endIp').val( range.end.join('.') );
                    } else {
                        $('#dhcp_pool_settings-1-startIp').val( startIp );
                        $('#dhcp_pool_settings-1-endIp').val( endIp );
                    }
                } else {
                    $('#dhcp_pool_settings-1-startIp').val( range.start.join('.') );
                    $('#dhcp_pool_settings-1-endIp').val( range.end.join('.') );
                }
                $('#dhcp_pool_settings-1-gateway').val( address );
                $('#dhcp_pool_settings-1-dns1').val( address );
            }
        }
    }

    function phpPager(id, page, pages) {
        if ($('#phpPerPage').exists()) {
            $('#rowsPage').html(page);
            $('#rowsPages').html(pages);
        }else {
            var tmp = '<div id="pagerDiv">';
            tmp += '<table id="pagerTable-' + id + '" class="BorderNone">';
            tmp += '<tr>';
            tmp += '<td><button Class="Move2First" id="Move2First-' + id + '"><span class="ui-icon"></span></button></td>';
            tmp += '<td><button Class="Move2Prev" id="Move2Prev-' + id + '"><span class="ui-icon"></span></button></td>';
            tmp += '<td><span id="rowsPage">' + page + '</span> / <span id="rowsPages">' + pages + '</span></td>';
            tmp += '<td><button Class="Move2Next" id="Move2Next-' + id + '"><span class="ui-icon"></span></button></td>';
            tmp += '<td><button Class="Move2Last" id="Move2Last-' + id + '"><span class="ui-icon"></span></button></td>';
            tmp += '<td><select id="phpPerPage"></select>';
    
            tmp += '</tr>';
            tmp += '</table>';
            tmp += '</div>';
    
            $('#main_ft').append(tmp);
            $('#phpPerPage').append( genSelectOption('phpPerPage') );
    
            $('#phpPerPage').change( function() {
                gObj.phpQuery.pi = 1;
                gObj.phpQuery.ps = 1;
                gObj.phpQuery.pp = $(this).val();
                if ( id == 'view_logs' )
                    refreshDevice( id );
                else
                    refreshReports( id );
            });
        }
    }
    
    function cgiSearch(id) {
        var tmp = '<table id="table-search">';
        switch(id)
        {
        case 'ip_mac_binding':
            tmp += '<tr>';
            tmp += '<td class="alignLeft BT100">';
            tmp += '<input type="text" id="searchCols" />';
            tmp += '</td>';
            tmp += '<td class="alignLeft">';
            tmp += '<button class="Search" id="Search-' + id + '"><span class="ui-icon" title="Search"></span></button>';
            tmp += '</td>';
            tmp += '</tr>';
            break;
        }
        tmp += '</table>';
        $('.searchDiv').append(tmp);
    }

    function cgiQuery(id) {
        var tmp = '<table id="table-query">';
        switch(id) 
        {
        case 'rule':
            tmp += '<caption>' + gTerm[ gObj.lang ].select + ' ' + gTerm[ gObj.lang ].criterion + ' ' + gTerm[ gObj.lang ].for + ' ' + gTerm[ gObj.lang ].rule + ' ' + gTerm[ gObj.lang ].table + '</caption>';
            tmp +=   '<tr>';
            tmp +=      '<td class="BT225">' + gTerm[ gObj.lang ].from + ' ' + gTerm[ gObj.lang ].zone + ' <select id="query-fromZone"></select></td>';
            tmp +=      '<td class="BT225">' + gTerm[ gObj.lang ].to + ' ' + gTerm[ gObj.lang ].zone + ' <select id="query-toZone"></select></td>';
            tmp +=      '<td class="BT100"><input type="checkbox" id="query-default" value="1" checked /> <label for="query-default">' + gTerm[ gObj.lang ].default + ' ' + gTerm[ gObj.lang ].rule + '</label></td>';
            tmp +=      '<td class="BT80"><input type="checkbox" id="query-vpn" value="1" checked /> <label for="query-vpn">' + gTerm[ gObj.lang ].VPN + ' ' + gTerm[ gObj.lang ].rule + '</label></td>';
            tmp +=      '<td class="BT80"><input type="checkbox" id="query-nat" value="1" checked /> <label for="query-nat">' + gTerm[ gObj.lang ].NAT + ' ' + gTerm[ gObj.lang ].rule + '</label></td>';
            tmp +=      '<td class="BT40"><button class="Query" id="query-rule"><span class="ui-icon" title="Query"></span></button></td>';
            tmp +=   '</tr>';
            break;
        }
        tmp += '</table>';
        $('.queryDiv').append(tmp);
    
        switch(id)
        {
        case 'rule':
            cgiSelectOption('query-fromZone');
            cgiSelectOption('query-toZone');
            break;
        }
    }
    
    function phpQuery(id) {
        var tmp = '<table id="table-query">';
        switch(id)
        {
        case 'wan_bandwidth_report':
        case 'resource_utilization':
            tmp += '<tr>';
            tmp += '<td>';
            tmp += gTerm[ gObj.lang ].start + ' ' + gTerm[ gObj.lang ].date + ': <input type="text" id="query-startDate" /> ' + gTerm[ gObj.lang ].hour + ': <select id="query-startHour"></select> ' + gTerm[ gObj.lang ].minute + ': <select id="query-startMin"></select>';
            tmp += '</td>';
            tmp += '<td>';
            tmp += gTerm[ gObj.lang ].end + ' ' + gTerm[ gObj.lang ].date + ': <input type="text" id="query-endDate" /> ' + gTerm[ gObj.lang ].hour + ': <select id="query-endHour"></select> ' + gTerm[ gObj.lang ].minute + ': <select id="query-endMin"></select>';
            tmp += '</td>';
            tmp += '<td class="alignCenter">';
            tmp += '<button class="Query" id="Query-' + id + '"><span class="ui-icon" title="query"></span></button>';
            tmp += '</td>';
            tmp += '</tr>';
    
            break;
        case 'view_logs':
            tmp += '<tr>';
            tmp += '<td class="BT40" >';
            tmp += '<img src="css/images/i_16_severity_00.png" />';
            tmp += '</td>';
            tmp += '<th class="alignLeft BT150">';
            tmp += gTerm[ gObj.lang ].severity;
            tmp += '</th>';
            tmp += '<td class="alignLeft BT200">';
            tmp += '<select id="query-severity"></select>';
            tmp += '</td>';
    
            tmp += '<td class="BT40" >';
            tmp += '<img src="css/images/i_16_facility_00.png" />';
            tmp += '</td>';
            tmp += '<th class="alignLeft BT150">';
            tmp += gTerm[ gObj.lang ].facility;
            tmp += '</th>';
            tmp += '<td class="alignLeft BT180">';
            tmp += '<select id="query-facility"></select>';
            tmp += '</td>';
            tmp += '<td class="BT40" >';
            tmp += '</td>';
            tmp += '</tr>';
    
            tmp += '<tr>';
            tmp += '<td class="BT40" >';
            tmp += '<img src="css/images/i_16_source_address_00.png" />';
            tmp += '</td>';
            tmp += '<th class="alignLeft BT150">';
            tmp += gTerm[ gObj.lang ].source + ' ' + gTerm[ gObj.lang ].address;
            tmp += '</th>';
            tmp += '<td class="alignLeft BT200">';
            tmp += '<input type="text" id="query-srcIp"/>';
            tmp += '</td>';
            tmp += '<td class="BT40" >';
            tmp += '<img src="css/images/i_16_destination_address_00.png" />';
            tmp += '</td>';
            tmp += '<th class="alignLeft BT150">';
            tmp += gTerm[ gObj.lang ].destination + ' ' + gTerm[ gObj.lang ].address;
            tmp += '</th>';
            tmp += '<td class="alignLeft BT200">';
            tmp += '<input type="text" id="query-dstIp"/>';
            tmp += '</td>';
            tmp += '</tr>';
    
            tmp += '<tr>';
            tmp += '<td class="BT40" >';
            tmp += '<img src="css/images/i_16_date_00.png" />';
            tmp += '</td>';
            tmp += '<th class="alignLeft BT150">';
            tmp += gTerm[ gObj.lang ].start + ' ' + gTerm[ gObj.lang ].date;
            tmp += '</th>';
            tmp += '<td class="alignLeft BT200">';
            tmp += '<input type="text" id="query-startDate"/>';
            tmp += '</td>';
    
            tmp += '<td class="BT40" >';
            tmp += '<img src="css/images/i_16_date_00.png" />';
            tmp += '</td>';
            tmp += '<th class="alignLeft BT150">';
            tmp += gTerm[ gObj.lang ].end + ' ' + gTerm[ gObj.lang ].date;
            tmp += '</th>';
            tmp += '<td class="alignLeft BT180">';
            tmp += '<input type="text" id="query-endDate"/>';
            tmp += '</td>';
            tmp += '<td class="BT40" >';
            tmp += '<button class="Query" id="Query-' + id + '"><span class="ui-icon" title="query"></span></button>';
            tmp += '</td>';
            tmp += '</tr>';
    
            break;
        default:
            tmp += '<tr>';
            tmp += '<td class="BT250">';
            tmp += gTerm[ gObj.lang ].startDatetime + ': <input type="text" id="query-startDate" size="12" />&nbsp;<select id="query-startHour"></select>';
            tmp += '</td>';
            tmp += '<td class="BT250">';
            tmp += gTerm[ gObj.lang ].endDatetime + ': <input type="text" id="query-endDate" size="12" />&nbsp;<select id="query-endHour"></select>';
            tmp += '</td>';

            tmp += '<td class="BT230">';
            tmp += gTerm[ gObj.lang ].aggregateBy + ' <select id="query-aggregateBy">';
            tmp += '<option value="0">None</option>';
            switch(id)
            {
            case 'traffic_direction':
                tmp += '<option value="1">' + gTerm[ gObj.lang ].address + '</option>';
                tmp += '<option value="2">' + gTerm[ gObj.lang ].srcIp + '</option>';
                tmp += '<option value="3">' + gTerm[ gObj.lang ].dstIp + '</option>';
                tmp += '<option value="4">' + gTerm[ gObj.lang ].protocol + '</option>';
                tmp += '<option value="5">' + gTerm[ gObj.lang ].dstPort + '</option>';
                tmp += '<option value="6">' + gTerm[ gObj.lang ].zone + '</option>';
                break;
            case 'file_extension':
                tmp += '<option value="1">' + gTerm[ gObj.lang ].extension + '</option>';
                break;
            case 'blocked_host':
            case 'affected_host':
                tmp += '<option value="1">' + gTerm[ gObj.lang ].host + ' ' + gTerm[ gObj.lang ].IP + '/' + gTerm[ gObj.lang ].user + '</option>';
                break;
            case 'antivirus_report':
                tmp += '<option value="1">' + gTerm[ gObj.lang ].source + ' ' + gTerm[ gObj.lang ].IP + '/' + gTerm[ gObj.lang ].user + '</option>';
                tmp += '<option value="2">' + gTerm[ gObj.lang ].destination + ' ' + gTerm[ gObj.lang ].IP + '/' + gTerm[ gObj.lang ].user + '</option>';
                tmp += '<option value="3">' + gTerm[ gObj.lang ].virusName + '</option>';
                break;
            }
            tmp += '</select>';
            tmp += '</td>';
            tmp += '<td class="alignCenter">';
            tmp += '<button class="Query" id="Query-' + id + '"><span class="ui-icon" title="query"></span></button>';
            tmp += '<button class="Weekly" id="Weekly-' + id + '"><span class="ui-icon" title="weekly"></span></button>';
            tmp += '</td>';
            tmp += '</tr>';
        }
        tmp += '</table>';
    
        $('.queryDiv').append(tmp);
    
        switch (id)
        {
        case 'wan_bandwidth_report':
        case 'resource_utilization':
            // query listener
            $('#query-startDate').datepicker({
                minDate: -365,
                maxDate: 0,
                dateFormat: "yy/mm/dd",
                changeMonth: true,
                changeYear: true,
                onSelect: function( selectedDate ) {
                    $('#query-endDate').datepicker( "option", "minDate", selectedDate );
                    $('#query-startHour').prop('disabled', false);
                    $('#query-startMin').prop('disabled', false);
                }
            });
       
            $('#query-endDate').datepicker({
                minDate: -365,
                maxDate: 0,
                dateFormat: "yy/mm/dd",
                changeMonth: true,
                changeYear: true,
                onSelect: function( selectedDate ) {
                    $('#query-startDate').datepicker( "option", "maxDate", selectedDate );
                    $('#query-endHour').prop('disabled', false);
                    $('#query-endMin').prop('disabled', false);
                }
            });

            $('#query-startHour').append( genSelectOption('query-startHour') ).prop('disabled', true); 
            $('#query-endHour').append( genSelectOption('query-endHour') ).val(23).prop('disabled', true);
            $('#query-startMin').append( genSelectOption('query-startMin') ).prop('disabled', true);
            $('#query-endMin').append( genSelectOption('query-endMin') ).val(59).prop('disabled', true);
            break;
        case 'view_logs':
            $('#query-severity').append( genSelectOption('query-severity') ).val(7);;
            $('#query-facility').append( genSelectOption('query-facility') );
        default:
            // query listener
            $('#query-startDate').datepicker({
                minDate: -365,
                maxDate: 0,
                dateFormat: "yy/mm/dd",
                changeMonth: true,
                changeYear: true,
                onSelect: function( selectedDate ) {
                    $('#query-endDate').datepicker( "option", "minDate", selectedDate );
                    $('#query-startHour').prop('disabled', false);
                    $('#query-startMin').prop('disabled', false);
                    // once pick start, make sure end within 30d, vise versa
                    theEnd = $('#query-endDate').datepicker('getDate');
                    theStart = $('#query-startDate').datepicker('getDate');
                    interval = parseInt( (theEnd - theStart)/86400000 );
 
                    if (interval > 30) {
                        theMax = new Date( theStart.setDate( theStart.getDate() + 30 ) );
                        $('#query-endDate').datepicker("setDate", theMax);
                    } 
                }
            }).datepicker("setDate", "+0d");
       
            $('#query-endDate').datepicker({
                minDate: -365,
                maxDate: 0,
                dateFormat: "yy/mm/dd",
                changeMonth: true,
                changeYear: true,
                onSelect: function( selectedDate ) {
                    $('#query-startDate').datepicker( "option", "maxDate", selectedDate );
                    $('#query-endHour').prop('disabled', false);
                    $('#query-endMin').prop('disabled', false);
                    // once pick end, make sure start within 30d, vise versa
                    theEnd = $('#query-endDate').datepicker('getDate');
                    theStart = $('#query-startDate').datepicker('getDate');
                    interval = parseInt( (theEnd - theStart)/86400000 );

                    if (interval > 30) {
                        theMin = new Date( theEnd.setDate( theEnd.getDate() - 30 ) );
                        $('#query-startDate').datepicker("setDate", theMin);
                    } 
                }
            }).datepicker("setDate", "+0d");

            $('#query-startHour').html( genSelectOption('query-startHour') ).val( gObj.sysHour );
            $('#query-endHour').html( genSelectOption('query-endHour') ).val( gObj.sysHour );
        }
    }
    
    function genPageAction(id, pageClass) {
        var divID = '#div-' + id;
        var tmp = '';
        if (pageClass) {
            gObj.reg = pageClass.match(gReg.isPage);
            if (gObj.reg != null) {
                tmp = '<div class="pageAction">';
                for (var x in gObj.reg)
                {
                    if (gReg.isDigit.test(x)) {
                        tmp += '<button id="' + gObj.reg[ x ] + '-' + id + '" class="' + gObj.reg[ x ] + '" title="' + gObj.reg[ x ] + '">';
                        tmp += '<span class="ui-icon" ></span>';
                        tmp += '</button>';
                    }
                }
                tmp += '</div>';
                $(divID).append(tmp);
            }
        }
    }
    
    function genTblAction( pid, tid, tbid ) {
        var tmp = '';
    
        if ( gNode.tblAction ) {
            if ( tid ) {
                if ( tbid ) {
                    for (var j=0; j<tid.length; j++)
                    {
                        tmp = '<div class="tblAction">';
                        tmp += '<button id="Create-' + tid[ j ] + '" class="Create" title="Create"><span class="ui-icon"></span></button>';
                        tmp += '</div>';
                        $('#table-' + tid[ j ]).parent().append( tmp );
                    }
                } else {
                    tmp = '<div class="tblAction">';
                    var arr = gNode.tblAction[ tid ].split(' ');
                    for (var i=0; i<arr.length; i++) 
                        tmp += '<button id="' + arr[ i ] + '-' + tid + '" class="' + arr[ i ] + '" title="' + arr[ i ] + '"><span class="ui-icon"></span></button>';
                    tmp += '</div>';
                    $('#table-' + tid).parent().append( tmp );
                }
            } else if ( 'object' === typeof gNode.tblAction ) {
                tmp = '<div class="tblAction">';
                var arr = gNode.tblAction[ pid ].split(' ');
                for (var i=0; i<arr.length; i++) 
                    tmp += '<button id="' + arr[ i ] + '-' + pid + '" class="' + arr[ i ] + '" title="' + arr[ i ] + '"><span class="ui-icon"></span></button>';
                tmp += '</div>';
                $('#table-' + pid).parent().append( tmp );
            } else {
                tmp = '<div class="tblAction">';
                var arr = gNode.tblAction.split(' ');
                for (var i=0; i<arr.length; i++) 
                    tmp += '<button id="' + arr[ i ] + '-' + pid + '" class="' + arr[ i ] + '" title="' + arr[ i ] + '"><span class="ui-icon"></span></button>';
                tmp += '</div>';
                $('#table-' + pid).parent().append( tmp );
            }
        }
    }
    
    function helpPop() {
        if ( gRef.docs[ gNode.id ] ) {
            gY.Cookie.setSub(gCook.main, 'node', gNode.id);
            gHelp = window.open("onlineHelpK.html", "gHelp", "width=800,height=600,top=200,left=300");
        }
    }

    function ipv4Compare( startIp, endIp ) {
        var sArr = startIp.split('.');
        var eArr = endIp.split('.');
        var s = parseInt( sArr[0] ) * 256 * 256 * 256 + parseInt( sArr[1] ) * 256 * 256 + parseInt( sArr[2] ) * 256 + parseInt( sArr[3] );
        var e = parseInt( eArr[0] ) * 256 * 256 * 256 + parseInt( eArr[1] ) * 256 * 256 + parseInt( eArr[2] ) * 256 + parseInt( eArr[3] );

        return e > s;
    }

    function captureStatus() {
        if ('packet_caputre' == gNode.tab) {
            $.ajax({
                url: 'cgi-bin/advancedDebug.cgi',
                dataType: 'json',
                success: function(data) {
                }
            });
        } else {
            $.ajax({
                url: 'cgi-bin/packetCapture.cgi',
                dataType: 'json',
                success: function(data) {
                    
                }
            });
        }
    }

    function loadingToggle( flag ) {
        if (flag) {
            $('#divSec').hide();
            $('body').addClass('loadingClass');
        } else {
            if (gIf.reboot) {
                document.location.reload(true);
                gIf.reboot = false;
            } else if ( gIf.shutdown ) {
                $('.titleA').html( gTerm[ gObj.lang ].wait + ' ' + gTerm[ gObj.lang ].for );
                $('.titleB').html( gTerm[ gObj.lang ].seconds );
                $('#divSec').hide();
                errorAlert( 'shudown done' );
            } else {
                $('body').removeClass('loadingClass');
            }
        } 
    }
    
    function getCgiList( id ) {
        gCache.list      = {};
        gCache.wans      = {};
        gCache.ports     = {};
        gCache.zone      = {};
        gCache.if        = {};
        gCache.wanAlias  = {};
        gData            = {};
        gCache.ipAlias   = {};
        gCache.uniq      = {};
        gCache.loadline  = [];
        gCache.loadCount = 0;
        gCache.address[ 0 ] = gTerm[ gObj.lang ].Any;
        gCache.service[ 0 ] = gTerm[ gObj.lang ].Any;
        gCache.name[ 0 ] = gTerm[ gObj.lang ].Any;
    
        switch(id)
        {
        case 'lan':
            gCache.uniq[ id ] = {};
            gCache.loadline.push('common_portIf_list', 'common_vlanIf_list', 'common_zoneIf_list', 'common_addr_list', 'common_if_list', 'arpTable');
            break;
        case 'ports':
            gCache.loadline.push('common_zoneIf_list', 'common_addr_list', 'common_if_list', 'arpTable');
            break;
        case 'vlan_interfaces':
            gCache.uniq[ id ] = {};
            gCache.loadline.push('common_portIf_list', 'common_lanIf_list', 'common_vlanIf_list', 'common_zoneIf_list', 'common_addr_list', 'common_portIf_list', 'common_if_list', 'arpTable');
            break;
        case 'wan':
            gCache.loadline.push('common_portIf_list', 'common_addr_list', 'common_vlanIf_list', 'common_zoneIf_list', 'common_addr_list', 'common_if_list', 'arpTable');
            break;
        case 'zone':
            gCache.uniq[ id ] = {};
            gCache.loadline.push('common_addr_list', 'common_if_list', 'common_portIf_list', 'common_wanIf_list', 'common_vlanIf_list', 'common_lanIf_list');
            break;
        case 'static_routing':
            gCache.uniq[ id ] = {};
            gCache.loadline.push('common_portIf_list', 'common_wanIf_list', 'common_vlanIf_list', 'common_lanIf_list', 'common_addr_list', 'arpTable');
            break;
        case 'ipsec_policies':
            gCache.uniq[ id ] = {};
            gCache.loadline.push('common_wanIf_list', 'common_addr_list', 'common_gAddr_list', 'common_zoneIf_list', 'ipsecike', 'ipsectransform', 'arpTable');
            break;
        case 'rules':
            gCache.uniq[ id ] = {};
            gCache.loadline.push('common_zoneIf_list', 'common_addr_list', 'common_gAddr_list', 'common_service_list', 'common_gService_list', 'common_time_list', 'arpTable');
            break;
        case 'advanced_nat':
            gCache.uniq[ id ] = {};
            gCache.loadline.push('common_wanIf_list', 'common_portIf_list', 'common_lanIf_list', 'common_vlanIf_list', 'common_addr_list', 'common_service_list', 'common_gService_list', 'arpTable');
            break;
        case 'port_forwarding':
        case 'dynamic_pat':
        case 'static_nat':
        case 'port_trigger':
            gCache.uniq[ id ] = {};
            gCache.loadline.push('common_addr_list', 'common_service_list', "common_ip_list", "common_if_list", 'arpTable');
            break;
        case 'addressObj':
            gCache.loadline.push('common_addr_list', 'common_gAddr_list', 'arpTable');
            break;
        case 'serviceObj':
            gCache.loadline.push('common_service_list', 'common_gService_list');
            break;
        case 'antivirus':
            gCache.loadline.push('common_addr_list', 'common_gAddr_list', 'common_zoneIf_list', 'arpTable');
            break;
        case 'packet_capture':
        case 'advanced_debug':
            gCache.loadline.push('common_if_list');
            break;
        case 'management_settings':
            gCache.loadline.push('common_portIf_list', 'common_lanIf_list', 'common_vlanIf_list', 'common_wanIf_list', 'common_addr_list', 'common_gAddr_list', 'arpTable');
            break;
        }

        gIf.getSessInfo = true;
        
        if (gCache.loadline.length > 0) {
            for (var i=0, len=gCache.loadline.length; i<len; i++)
                getCgi(gCache.loadline[ i ], id);
        }else {
            switch(id)
            {
            // dashboard 
            case 'system_dashboard':
            case 'network_dashboard':
            case 'security_dashboard':
                genDashboard(id);
                break;
            // reports 
            case 'show_arp_table':
            case 'show_routing_table':
            case 'dhcp_bindings':
            case 'status_summary':
            case 'traffic_statistics':
            case 'wan_bandwidth_report':
            case 'resource_utilization':
            case 'nat_status':
            case 'active_users':
            case 'active_sessions':
            case 'ipsec_vpn_statistics':
            case 'traffic_direction':
            case 'source_report':
            case 'destination_report':
            case 'file_extension':
            case 'blocked_host':
            case 'affected_host':
            case 'antivirus_report':
                genReports(id);
                break;
            // networkings 
            case 'ike_policy':
            case 'transform_policy':
            case 'routing':
            case 'dns_forwarder':
                genNetworking(id);
                break;
            // firewall 
            case 'session_settings':
            case 'attack_protection':
            case 'alg':
            case 'vpn_passthrough':
                genFirewall(id);
                break;
            // security
            case 'ip_mac_binding':
                genSecurity(id);
                break;
            // users 
            case 'users_and_groups':
                genUsers(id);
                break; 
            // object
            case 'scheduleObj':
                genObject(id);
                break;
            // device 
            case 'license':
            case 'properties':
            case 'reboot_reset_shutdown':
            case 'administrator_settings':
            case 'backup_restore':
            case 'firmware':
            case 'date_and_time':
            case 'email_alert':
            case 'loggings':
            case 'proxy':
            case 'dns_lookup':
            case 'ping':
            case 'traceroute':
                genDevice(id);
                break;
            }
        }
    }
    
    function getCgi(cgiID, id, val) {
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                gCache.list[ cgiID ] = data;
                // parseInt with gid for futher compare if
                var cgiT; 
                var cgiTNum;
             
                switch(cgiID)
                {
                case "common_addr_list":
                    gData.address = data;
                    gCache.uniq[ cgiID ] = {};
                    cgiT = 'guiAddrT';
                    break;
                case "common_gAddr_list":
                    gData.group_address = data;
                    gCache.uniq[ cgiID ] = {};
                    cgiT = 'guiGAddrT';
                    break;
                case "common_service_list":
                    gData.service = data;
                    gCache.uniq[ cgiID ] = {};
                    cgiT = 'guiServiceT';
                    break;
                case "common_gService_list":
                    gData.group_service = data;
                    gCache.uniq[ cgiID ] = {};
                    cgiT = 'guiGServiceT';
                    break;
                case "common_time_list":
                    gData.schedule = data;
                    gCache.uniq[ cgiID ] = {};
                    cgiT = 'guiTimeT';
                    break;
                case "common_portIf_list":
                    cgiT = 'guiPortIfT';
                    break;
                case "common_zoneIf_list":
                    cgiT = 'guiZoneIfT';
                    break;
                case "common_lanIf_list":
                    cgiT = 'guiLanIfT';
                    break;
                case "common_wanIf_list":
                    cgiT = 'guiWanIfT';
                    break;
                case "common_vlanIf_list":
                    cgiT = 'guiVlanIfT';
                    break;
                case 'common_if_list':
                    cgiT = 'guiIfT';
                    break;
                case 'common_ip_list':
                    cgiT = 'guiIpT';
                    break;
                }
                cgiTNum = cgiT + 'Num';
                for (var i=0, len=parseInt(gCache.list[ cgiID ][ cgiTNum ]); i<len; i++)
                {
                    gCache.list[ cgiID ][ cgiT ][ i ].gid = parseInt( gCache.list[ cgiID ][ cgiT ][ i ].gid );
                    switch( cgiID )
                    {
                    case 'common_addr_list':
                        gCache.ipAlias[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].startIp;
                        gCache.address[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        gCache.uniq[ cgiID ][ gCache.list[ cgiID ][ cgiT ][ i ].name ] = true;
                        break;
                    case 'common_gAddr_list':
                        gCache.ipAlias[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].startIp;
                        gCache.address[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        break;
                    case 'common_service_list':
                        gCache.type[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].type;
                        gCache.service[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        gCache.uniq[ cgiID ][ gCache.list[ cgiID ][ cgiT ][ i ].name ] = true;
                        break;
                    case 'common_gService_list':
                        gCache.service[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        gCache.uniq[ cgiID ][ gCache.list[ cgiID ][ cgiT ][ i ].name ] = true;
                        break;
                    case "common_time_list":
                        gCache.schedule[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        gCache.uniq[ cgiID ][ gCache.list[ cgiID ][ cgiT ][ i ].name ] = true;
                        break;
                    case 'common_if_list':
                        gCache.if[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].ipIdList;
                        if ( gReg.isWan.test( gCache.list[ cgiID ][ cgiT ][ i ].name ) ) 
                            gCache.wanAlias[ gCache.list[ cgiID ][ cgiT ][ i ].name ] = gCache.list[ cgiID ][ cgiT ][ i ].gid;
                        break;
                    case 'common_ip_list':
                        gCache.ipAlias[ gCache.list[ cgiID ].guiIpT[ i ].gid ] = gCache.list[ cgiID ].guiIpT[ i ].startIp;
                        gCache.ipName[ gCache.list[ cgiID ].guiIpT[ i ].gid ] = gCache.list[ cgiID ].guiIpT[ i ].name;
                        break;
                    case 'common_portIf_list':
                        gCache.name[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        gCache.ports[ gCache.list[ cgiID ][ cgiT ][ i ].name ] = parseInt(gCache.list[ cgiID ][ cgiT ][ i ].type);
                        gCache.zone[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        break;
                    case 'common_zoneIf_list':
                    case 'common_lanIf_list':
                        gCache.name[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        if (gCache.list[ cgiID ][ cgiT ][ i ].name == 'WAN') {
                            gCache.wanId = gCache.list[ cgiID ][ cgiT ][ i ].gid;
                        }
                        break;
                    case 'common_wanIf_list':
                        gCache.name[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        gCache.wans[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        break;
                    case 'common_vlanIf_list':
                        gCache.name[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        gCache.zone[ gCache.list[ cgiID ][ cgiT ][ i ].gid ] = gCache.list[ cgiID ][ cgiT ][ i ].name;
                        break;
                    }
                }
                gCache.loadCount++;
                if (gCache.loadCount == gCache.loadline.length) {
                    switch( id ) 
                    {
                    case 'antivirus':
                        genSecurity(id);
                        break;
                    case 'ipsec_policies':
                    case 'static_routing':
                        genNetworking(id);
                        break;
                    case 'advanced_debug':
                    case 'packet_capture':
                    case 'management_settings':
                        genDevice(id);
                        break;
                    case 'rules':
                    case 'dynamic_pat':
                    case 'static_nat':
                    case 'port_forwarding':
                    case 'port_trigger':
                    case 'advanced_nat':
                        genFirewall(id);
                        break;
                    case 'vlan_interfaces':
                    case 'zone':
                    case 'lan':
                    case 'ports':
                    case 'wan':
                        genInterface(id);
                        break;
                    case 'addressObj':
                    case 'serviceObj':
                        genObject(id);
                        break;
                    }
                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                switch(parseInt( gGet[ cgiID ] ))
                {
                case 'NaN':
                    gGet[ cgiID ] = 0;
                case 1:
                case 2:
                    gGet[ cgiID ]++;
                    break;
                case 3:
                    delete gGet[ cgiID ];
                    break;
                }
            }
        });
    }
    
    function cgiGet(cgiID, id) {
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                gData[ cgiID ] = data;
                gData[ id ] = data;
            }
        });
    }
    
    function cgiPost(cgiPostID, json, func, id, cgiGetID) {
        $.post( 'cgi-bin/' + cgiPostID + '.cgi', json, function(poster) {
            switch(func)
            {
            case 'cgiSelectOption':
                $.ajax({
                    url: 'cgi-bin/' + cgiGetID + '.cgi',
                    dataType: 'json',
                    success: function(getter) {
                        var cgiT;
                        var cgiTNum;
                        var type = 0;
                        gCache.list[ cgiGetID ] = getter;
                        gCache.uniq[ cgiGetID ] = {};
                        switch( cgiGetID )
                        {
                        case 'common_addr_list' :
                            cgiT = 'guiAddrT';
                            cgiTNum = 'guiAddrTNum';
                            getCgi( 'common_ip_list' );
                            break;
                        case 'common_gAddr_list' :
                            cgiT = 'guiGAddrT';
                            cgiTNum = 'guiGAddrTNum';
                            break;
                        case 'common_service_list' :
                            cgiT = 'guiServiceT';
                            cgiTNum = 'guiServiceTNum';
                            break;
                        case 'common_gService_list' :
                            cgiT = 'guiGServiceT';
                            cgiTNum = 'guiGServiceTNum';
                            break;
                        case 'common_time_list' :
                            cgiT = 'guiTimeT';
                            cgiTNum = 'guiTimeTNum';
                            break;
                        }    
     
                        gPop.popMore.dialog("close");
    
                        for (var i=0, len=parseInt(gCache.list[ cgiGetID ][ cgiTNum ]); i<len; i++)
                        {
                            gCache.list[ cgiGetID ][ cgiT ][ i ].gid = parseInt( gCache.list[ cgiGetID ][ cgiT ][ i ].gid );
                            gCache.uniq[ cgiGetID ][ gCache.list[ cgiGetID ][ cgiT ][ i ].name ] = true;
                            switch(cgiGetID)
                            {
                            case 'common_service_list':
                                gCache.type[ gCache.list[ cgiGetID ][ cgiT ][ i ].gid ] = gCache.list[ cgiGetID ][ cgiT ][ i ].type;
                            case 'common_gService_list':
                                gCache.service[ gCache.list[ cgiGetID ][ cgiT ][ i ].gid ] = gCache.list[ cgiGetID ][ cgiT ][ i ].name;
                                break;
                            case 'common_addr_list':
                            case 'common_gAddr_list':
                                gCache.ipAlias[ gCache.list[ cgiGetID ][ cgiT ][ i ].gid ] = gCache.list[ cgiGetID ][ cgiT ][ i ].startIp;
                                gCache.address[ gCache.list[ cgiGetID ][ cgiT ][ i ].gid ] = gCache.list[ cgiGetID ][ cgiT ][ i ].name;
                                break;
                            case 'common_time_list':
                                gCache.schedule[ gCache.list[ cgiGetID ][ cgiT ][ i ].gid ] = gCache.list[ cgiGetID ][ cgiT ][ i ].name;
                                break;
                            }
                        }
                    }   
                }).done( function() {
                    cgiSelectOption(id, poster.gid);
                    var rid;
                    switch(id) 
                    {
                    case 'Editor-nhIpId':
                        rid = 'Editor-dstIpId';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-dstIpId':
                        rid = 'Editor-nhIpId';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'multiple_wan_settings-netDetectPingIpId':
                        rid = 'multiple_wan_settings-netDetectDnsIpId';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'multiple_wan_settings-netDetectDnsIpId':
                        rid = 'multiple_wan_settings-netDetectPingIpId';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-sourceAddress':
                        rid = 'Editor-destinationAddress';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-destinationAddress':
                        rid = 'Editor-sourceAddress';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'basic_settings-localNetworkId':
                        rid = 'basic_settings-remoteNetworkId';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'basic_settings-remoteNetworkId':
                        rid = 'basic_settings-localNetworkId';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-sAddrId':
                        rid = 'Editor-dAddrId';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-dAddrId':
                        rid = 'Editor-sAddrId';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-originalSrc':
                        rid = 'Editor-originalDst';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        rid = 'Editor-translatedSrc';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        rid = 'Editor-translatedDst';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-originalDst':
                        rid = 'Editor-originalSrc';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        rid = 'Editor-translatedSrc';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        rid = 'Editor-translatedDst';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-translatedSrc':
                        rid = 'Editor-originalDst';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        rid = 'Editor-originalSrc';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        rid = 'Editor-translatedDst';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-triggerService':
                        rid = 'Editor-openedService';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-openedService':
                        rid = 'Editor-triggerService';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-translatedDst':
                        rid = 'Editor-originalDst';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        rid = 'Editor-translatedSrc';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        rid = 'Editor-originalSrc';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-originalService':
                        rid = 'Editor-translatedService';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    case 'Editor-translatedService':
                        rid = 'Editor-originalService';
                        cgiSelectOption( rid, $('#' + rid).val() );
                        break;
                    }
                });
                break;
            case 'cgiGet':
                switch(id) 
                {
                case 'schedule':
                case 'address':
                case 'group_address':
                case 'service':
                case 'group_service':
                    cgiGet(cgiGetID, id);
                    break;
                }
                break;
            }
        });
    }


    $.ajax({
        url:'lang/login.txt',
        dataType:'json',
        success:function(data) {
            gLogin = data;
            for (var i=0, len=gLang.length; i<len; i++)
            {
                $.ajax({
                    url:'lang/' + gLang[ i ] + '-term.txt',
                    dataType:'json',
                    success:function(data) {
                        // prepare query terms
                        gTerm[ data.lang ] = data.term;
                    }
                });

                $.ajax({
                    url:'lang/' + gLang[ i ] + '-error.txt',
                    dataType:'json',
                    success:function(data) {
                        // prepare error message
                        gError[ data.lang ] = data.error;
                    }
                });
            }
        }
    }).done( function() {
        ifLogin();
    });

});

</script>
</head>
<body>
    <div id="loginDiv">
      <div id="login_top"></div>   
      <div id="login_mark"></div>  
      <div id="login_label"></div> 
      <table >
        <tr>
          <th id="userNameLabel"></th>
          <td><input type="text" id="userName" /></td>
        </tr>
        <tr>
          <th id="userPassLabel"></th>
          <td><input type="password" id="userPass" /></td>
        </tr>
        <tr>
          <th id="userLangLabel"></th>
          <td>
            <select id="userLang">
              <option value="en">English</option>
            </select>
          </td>
        </tr>
        <tr>
          <th></th>
          <td><button id="loginButton"></button></td>
        </tr>
      </table>
      <div id="popBase">
      
      </div>
    </div>
</body>
</html>

