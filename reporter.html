<html>
  <head>
    <title>TitanWALL web report</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Expires" content="0">
<!--[if IE 8]>
    <meta http-equiv="X-UA-Compatible" content="IE=7">
<![endif]-->
<!-- css -->
    <link rel="stylesheet" type="text/css" href="css/reset.css" />
    <link rel="stylesheet" type="text/css" href="css/console.css" />
    <link rel="stylesheet" type="text/css" href="css/cssbutton-min.css" />
    <link rel="stylesheet" type="text/css" href="css/datatable-base.css" />
    <link rel="stylesheet" type="text/css" href="css/datatable-sort.css" />
    <link rel="stylesheet" type="text/css" href="css/panel.css" />
    <link rel="stylesheet" type="text/css" href="css/portal.css" />
    <link rel="stylesheet" type="text/css" href="css/screen.css" />
    <link rel="stylesheet" type="text/css" href="css/widget-base.css" />
    <link rel="stylesheet" type="text/css" href="css/widget-stack.css" />
    <link rel="stylesheet" type="text/css" href="css/widget-modality.css" />
<!-- yui -->
    <script type="text/javascript" src="js/yui-min.js"></script>
    <script type="text/javascript" src="js/yuiCombo1.js"></script>
    <script type="text/javascript" src="js/yuiCombo2.js"></script>
    <script type="text/javascript" src="js/yuiCombo3.js"></script>
    <script type="text/javascript" src="js/yuiCombo4.js"></script>
    <script type="text/javascript" src="js/yuiCombo5.js"></script>
    <script type="text/javascript" src="js/yuiCombo6.js"></script>
    <script type="text/javascript" src="js/yuiCombo7.js"></script>
    <script type="text/javascript" src="js/yuiCombo8.js"></script>
    <script type="text/javascript" src="js/yuiCombo9.js"></script>
    <script type="text/javascript" src="js/widget-base-ie.js"></script>
<!-- jquery -->
    <link rel="stylesheet" type="text/css" href="css/jquery-ui-1.9.2.custom.css" />
    <script type="text/javascript" src="js/jquery-1.8.3.js"></script>
    <script type="text/javascript" src="js/jquery.bgiframe.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.9.2.custom.js"></script>
<!-- chart js -->
    <script type="text/javascript" src="js/Chart.js"></script>
<!-- jspdf -->
    <script type="text/javascript" src="assets/jspdf/jspdf.js"></script>
    <script type="text/javascript" src="assets/jspdf/jspdf.plugin.addimage.js"></script>
    <script type="text/javascript" src="assets/jspdf/jspdf.plugin.cell.js"></script>
    <script type="text/javascript" src="assets/jspdf/jspdf.plugin.from_html.js"></script>
    <script type="text/javascript" src="assets/jspdf/jspdf.plugin.ie_below_9_shim.js"></script>
    <script type="text/javascript" src="assets/jspdf/jspdf.plugin.javascript.js"></script>
    <script type="text/javascript" src="assets/jspdf/jspdf.plugin.sillysvgrenderer.js"></script>
    <script type="text/javascript" src="assets/jspdf/jspdf.plugin.split_text_to_size.js"></script>
    <script type="text/javascript" src="assets/jspdf/jspdf.plugin.standard_fonts_metrics.js"></script>
    <script type="text/javascript" src="assets/jspdf/jspdf.plugin.table.js"></script>
    <script type="text/javascript" src="assets/jspdf/adler32cs.js"></script>
    <script type="text/javascript" src="assets/jspdf/FileSaver.js"></script>
    <script type="text/javascript" src="assets/jspdf/BlobBuilder.js"></script>
    <script type="text/javascript" src="assets/jspdf/basic.js"></script>
<!-- custom CSS -->
    <link rel="stylesheet" type="text/css" href="css/reporter.css" />

    <script>

$.extend({
  getUrlVars: function(){
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
      hash = hashes[i].split('=');
      vars.push(hash[0]);
      vars[hash[0]] = hash[1];
    }
    return vars;
  },
  getUrlVar: function(name){
    return $.getUrlVars()[name];
  }
});

$(document).ready(function () {
    // define func
    jQuery.fn.exists = function() {
        return this.length > 0;
    }

    // yui instance
    var gY = YUI({filter:"raw", defaultGraphicEngine: "canvas"}).use('anim', 'charts', 'charts-legend', 'console', 'cookie', 'datasource', 'datasource-get', 'datasource-io', 'datasource-jsonschema', 'datatable-base', 'datatable-sort', 'datatable-datasource', 'dd', 'dd-plugin', 'dump', 'event', 'get', 'io-base', 'io-upload-iframe', 'json', 'json-parse', 'json-stringify', 'node', 'panel', 'uploader', 'yui');

    // define vars
    var gVersion = {
        0 : {
            version: "Tech Titan",
            aka: '',
            title: 'TitanWALL Web Manager',
            copyright: 'Copyright &copy; 2014 Tech Titan',
            multi: true
        },
        1: {
            version: "Kaspersky",
            aka: 'K',
            title: 'TitanWALL Web Manager',
            copyright: 'Copyright &copy; 2014 Titan ARC Corp.',
            multi: true
        },
        2 : {
            version: "泰腾恩",
            aka: 'CN',
            title: 'TitanWALL Web Manager',
            copyright: 'Copyright &copy; 2014 Tech Titan',
            multi: true
        }
    }


    var gCooker = 'TitanWALL';
    var gLang   = 'en';

    if ( gY.Cookie.getSub( gCooker, 'lang' ) )
        gLang = gY.Cookie.getSub( gCooker, 'lang');

    var gData  = {};
    var gQue   = {};
    var gTabs  = [];
    var gProto = {};
    var gChart = {};
    var gCache = {};
    var gColor = [
            "#525A6B",
            "#BD2110",
            "#E7BD10",
            "#639429",
            "#9C52AD",

            "#CEC6C6",
            "#A58484",
            "#B5B5B5",
            "#313131",
            "#085A9C"
        ];
    var gRgbs  = [
            {r:82, g:90, b:107},
            {r:189, g:33, b:16},
            {r:231, g:189, b:16},
            {r:99, g:148, b:41},
            {r:156, g:82, b:173},

            {r:206, g:198, b:198},
            {r:165, g:132, b:132},
            {r:181, g:181, b:181},
            {r:49, g:49, b:49},
            {r:8, g:90, b:156}
        ];
    var gDoc   = new jsPDF('p', 'pt', 'a4');

    var gDocNo = { '#nv': function( element, render ) { return true; } };
    var gImg;

    var gTitle = {
        "en" : {
            "Move2Firt" : "Move to First Page",
            "Move2Prev" : "Move to Previous Page",
            "Move2Next" : "Move to Next Page",
            "Move2Last" : "Move to Last Page",
            "ExportPDF" : "Export as PDF"
        },
        "cn" : {
            "Move2Firt" : "Move to First Page",
            "Move2Prev" : "Move to Previous Page",
            "Move2Next" : "Move to Next Page",
            "Move2Last" : "Move to Last Page",
            "ExportPDF" : "Export as PDF"
        },
        "tw" : {
            "Move2Firt" : "Move to First Page",
            "Move2Prev" : "Move to Previous Page",
            "Move2Next" : "Move to Next Page",
            "Move2Last" : "Move to Last Page",
            "ExportPDF" : "Export as PDF"
        }
    }

    var gObj = {
        "traffic_direction" : {
            "title" : {
                "en" : "Traffic Direction",
                "cn" : "Traffic Direction",
                "tw" : "Traffic Direction"
            },
            "tabs" : {
                "en" : {
                    "0": "Traffic Log",
                    "1": "By Address",
                    "2": "By Source IP",
                    "3": "By Destination IP",
                    "4": "By Protocol",
                    "5": "By Destination Port",
                    "6": "By Zone"
                },
                "cn" : {
                    "0": "Traffic Log",
                    "1": "By Address",
                    "2": "By Source IP",
                    "3": "By Destination IP",
                    "4": "By Protocol",
                    "5": "By Destination Port",
                    "6": "By Zone"
                },
                "tw" : {
                    "0": "Traffic Log",
                    "1": "By Address",
                    "2": "By Source IP",
                    "3": "By Destination IP",
                    "4": "By Protocol",
                    "5": "By Destination Port",
                    "6": "By Zone"
                }
            },
            "table" : {
                "en" : {
                    "0" : {
                        "id" : "ID",
                        "srcIp" : "Source Address",
                        "dstIp" : "Destination Address",
                        "protocol" : "Protocol",
                        "srcPort" : "Source Port",
                        "dstPort" : "Destination Port",
                        "fromZone" : "From Zone",
                        "toZone" : "To Zone",
                        "txBytes" : "Tx Bytes",
                        "rxBytes" : "Rx Bytes",
                        "totalBytes" : "Total Bytes",
                        "startDatetime" : "Start Datetime",
                        "endDatetime" : "End Datetime"
                    },
                    "1" : {
                        "id" : "ID",
                        "address" : "Address",
                        "txBytes" : "Tx Bytes",
                        "rxBytes" : "Rx Bytes",
                        "totalBytes" : "Total Bytes",
                        "sessions" : "Sessions"
                    },
                    "2" : {
                        "id" : "ID",
                        "srcIp" : "Source Address",
                        "txBytes" : "Tx Bytes",
                        "rxBytes" : "Rx Bytes",
                        "totalBytes" : "Total Bytes",
                        "sessions" : "Sessions"
                    },
                    "3" : {
                        "id" : "ID",
                        "dstIp" : "Destination Address",
                        "txBytes" : "Tx Bytes",
                        "rxBytes" : "Rx Bytes",
                        "totalBytes" : "Total Bytes",
                        "sessions" : "Sessions"
                    },
                    "4" : {
                        "id" : "ID",
                        "protocol" : "Protocol",
                        "txBytes" : "Tx Bytes",
                        "rxBytes" : "Rx Bytes",
                        "totalBytes" : "Total Bytes",
                        "sessions" : "Sessions"
                    },
                    "5" : {
                        "id" : "ID",
                        "dstPort" : "Destination Port",
                        "txBytes" : "Tx Bytes",
                        "rxBytes" : "Rx Bytes",
                        "totalBytes" : "Total Bytes",
                        "sessions" : "Sessions"
                    },
                    "6" : {
                        "id" : "ID",
                        "zone" : "Zone",
                        "txBytes" : "Tx Bytes",
                        "rxBytes" : "Rx Bytes",
                        "totalBytes" : "Total Bytes",
                        "sessions" : "Sessions"
                    }
                }
            },
            "chart" : {
                "en" : {
                    "1" : {
                        type : 'bar',
                        catKey : 'address',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            address : {
                                keys:["address"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "2" : {
                        type : 'bar',
                        catKey : 'srcIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            srcIp : {
                                keys:["srcIp"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "3" : {
                        type : 'bar',
                        catKey : 'dstIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            dstIp : {
                                keys:["dstIp"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "4" : {
                        type : "pie",
                        catKey : 'protocol',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        serKey : ['totalBytes'],
                        legend : {
                            position: "left",
                            width: 300,
                            height: 300,
                            styles: {
                                hAlign: "center",
                                hSpacing: 10
                            }
                        },
                        serCol : [
                          {
                            categoryKey: "protocol",
                            valueKey: "totalBytes",
                            styles: { fill: { colors: gColor } }
                          }
                        ]
                    },
                    "5" : {
                        type : "bar",
                        catKey : 'dstPort',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            dstPort : {
                                keys:["dstPort"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "6" : {
                        type : "bar",
                        catKey : 'zone',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            zone : {
                                keys:["zone"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                },
                "cn" : {
                    "1" : {
                        type : 'bar',
                        catKey : 'address',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            address : {
                                keys:["address"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "2" : {
                        type : 'bar',
                        catKey : 'srcIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            srcIp : {
                                keys:["srcIp"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "3" : {
                        type : 'bar',
                        catKey : 'dstIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            dstIp : {
                                keys:["dstIp"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "4" : {
                        type : "pie",
                        catKey : 'protocol',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        serKey : ['totalBytes'],
                        legend : {
                            position: "left",           
                            width: 300,                 
                            height: 300,                
                            styles: {                   
                                hAlign: "center",           
                                hSpacing: 10                 
                            }                          
                        },  
                        serCol : [
                          {
                            categoryKey: "protocol",
                            valueKey: "totalBytes",
                            styles: { fill: { colors: gColor } }
                          }
                        ]
                    },
                    "5" : {
                        type : "bar",
                        catKey : 'dstPort',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            dstPort : {
                                keys:["dstPort"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "6" : {
                        type : "bar",
                        catKey : 'zone',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            zone : {
                                keys:["zone"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                },
                "tw" : {
                    "1" : {
                        type : 'bar',
                        catKey : 'address',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            address : {
                                keys:["address"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "2" : {
                        type : 'bar',
                        catKey : 'srcIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            srcIp : {
                                keys:["srcIp"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "3" : {
                        type : 'bar',
                        catKey : 'dstIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            dstIp : {
                                keys:["dstIp"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "4" : {
                        type : "pie",
                        catKey : 'protocol',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        serKey : ['totalBytes'],
                        legend : {
                            position: "left",
                            width: 300,
                            height: 300,
                            styles: {
                                hAlign: "center",
                                hSpacing: 10
                            }
                        },
                        serCol : [
                          {
                            categoryKey: "protocol",
                            valueKey: "totalBytes",
                            styles: { fill: { colors: gColor } }
                          }
                        ]
                    },
                    "5" : {
                        type : "bar",
                        catKey : 'dstPort',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            dstPort : {
                                keys:["dstPort"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "6" : {
                        type : "bar",
                        catKey : 'zone',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value]) + " MB"));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            zone : {
                                keys:["zone"],
                                position:"left"
                            },
                            totalBytes : {
                                keys:["totalBytes"],
                                title:"MB",
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                totalBytes: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                }
            }
        },
        "file_extension" : {
            "title" : {
                "en" : "Viurs File Extension",
                "cn" : "Virus File Extension",
                "tw" : "Virus File Extension"
            },
            "tabs" : {
                "en" : {
                    "0": "Virus File Extension Log",
                    "1": "By Virus File Extension"
                 },
                 "cn" : {
                    "0": "Virus File Extension Log",
                    "1": "By Virus File Extension"
                 },
                 "tw" : {
                    "0": "Virus File Extension Log",
                    "1": "By Virus File Extension"
                 }
            },
            "table" : {
                "en" : {
                    "0" : {
                        "id" : "ID",
                        "extension" : "Extension",
                        "accessCount" : "Access Count",
                        "datetime" : "Datetime"
                    },
                    "1" : {
                        "id" : "ID",
                        "extension" : "Extension",
                        "accessCount" : "Access Count"
                    }
                },
                "cn" : {
                    "0" : {
                        "id" : "ID",
                        "extension" : "Extension",
                        "accessCount" : "Access Count",
                        "datetime" : "Datetime"
                    },
                    "1" : {
                        "id" : "ID",
                        "extension" : "Extension",
                        "accessCount" : "Access Count"
                    }
                },
                "tw" : {
                    "0" : {
                        "id" : "ID",
                        "extension" : "Extension",
                        "accessCount" : "Access Count",
                        "datetime" : "Datetime"
                    },
                    "1" : {
                        "id" : "ID",
                        "extension" : "Extension",
                        "accessCount" : "Access Count"
                    }
                }
            },
            "chart" : {
                "en" : {
                    "1" : {
                        type : "bar",
                        catKey : 'extension',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },   
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg; 
                            }    
                        },
                        axes : {
                            extension : {
                                keys:["extension"],
                                position:"left"
                            },
                            accessCount : {
                                keys:["accessCount"],
                                position:"bottom",
                                type:"numeric",
                                labelFunction: function(label) {
                                    return label.toFixed(2);
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                accessCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                },
                "cn" : {
                    "1" : {
                        type : "bar",
                        catKey : 'extension',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            extension : {
                                keys:["extension"],
                                position:"left"
                            },
                            accessCount : {
                                keys:["accessCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                accessCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                },
                "tw" : {
                    "1" : {
                        type : "bar",
                        catKey : 'extension',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            extension : {
                                keys:["extension"],
                                position:"left"
                            },
                            accessCount : {
                                keys:["accessCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                accessCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                }
            }
        },
        "blocked_host" : {
            "title" : {
                "en" : "Bloceck Host",
                "cn" : "Bloceck Host",
                "tw" : "Bloceck Host"
            },
            "tabs" : {
                "en" : {
                    "0": "Blocked Host Log",
                    "1": "By Blocked Host"
                },
                "cn" : {
                    "0": "Blocked Host Log",
                    "1": "By Blocked Host"
                },
                "tw" : {
                    "0": "Blocked Host Log",
                    "1": "By Blocked Host"
                }
            },
            "table" : {
                "en" : {
                    "0" : {
                        "id" : "ID",
                        "ip" : "IP",
                        "virusCount" : "Virus Count",
                        "firewallCount" : "Firewall Count",
                        "datetime" : "Datetime"
                    },
                    "1" : {
                        "id" : "ID",
                        "ip" : "IP",
                        "virusCount" : "Virus Count",
                        "firewallCount" : "Firewall Count"
                    }
                }
            },
            "chart" : {
                "en" : {
                    "1" : {
                        type : "bar",
                        catKey : 'ip',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            ip : {
                                keys:["ip"],
                                position:"left"
                            },
                            count : {
                                keys:["virusCount", "firewallCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                firewallCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                },
                                virusCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                },
                "cn" : {
                    "1" : {
                        type : "bar",
                        catKey : 'ip',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            ip : {
                                keys:["ip"],
                                position:"left"
                            },
                            count : {
                                keys:["virusCount", "firewallCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                firewallCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                },
                                virusCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                },
                "tw" : {
                    "1" : {
                        type : "bar",
                        catKey : 'ip',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            ip : {
                                keys:["ip"],
                                position:"left"
                            },
                            count : {
                                keys:["virusCount", "firewallCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                firewallCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                },
                                virusCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                }
            }
        },
        "affected_host" : {
            "title" : {
                "en" : "Affected Host",
                "cn" : "Affected Host",
                "tw" : "Affected Host"
            },
            "tabs" : {
                "en" : {
                    "0": "Affected Host Log",
                    "1": "By Affected Host"
                },
                "cn" : {
                    "0": "Affected Host Log",
                    "1": "By Affected Host"
                },
                "tw" : {
                    "0": "Affected Host Log",
                    "1": "By Affected Host"
                }
            },
            "table" : {
                "en" : {
                    "0" : {
                        "id" : "ID",
                        "ip" : "IP",
                        "virusHitCount" : "Virus Hit Count",
                        "sigHitCount" : "Sig Hit Count",
                        "datetime" : "Datetime"
                    },
                    "1" : {
                        "id" : "ID",
                        "ip" : "IP",
                        "virusHitCount" : "Virus Hit Count",
                        "sigHitCount" : "Sig Hit Count"
                    }
                },
                "cn" : {
                    "0" : {
                        "id" : "ID",
                        "ip" : "IP",
                        "virusHitCount" : "Virus Hit Count",
                        "sigHitCount" : "Sig Hit Count",
                        "datetime" : "Datetime"
                    },
                    "1" : {
                        "id" : "ID",
                        "ip" : "IP",
                        "virusHitCount" : "Virus Hit Count",
                        "sigHitCount" : "Sig Hit Count"
                    }
                },
                "tw" : {
                    "0" : {
                        "id" : "ID",
                        "ip" : "IP",
                        "virusHitCount" : "Virus Hit Count",
                        "sigHitCount" : "Sig Hit Count",
                        "datetime" : "Datetime"
                    },
                    "1" : {
                        "id" : "ID",
                        "ip" : "IP",
                        "virusHitCount" : "Virus Hit Count",
                        "sigHitCount" : "Sig Hit Count"
                    }
                }
            },
            "chart" : {
                "en" : {
                    "1" : {
                        type : "bar",
                        catKey : 'ip',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            ip : {
                                keys:["ip"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["sigHitCount", "virusHitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                sigHitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                },
                                virusHitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                },
                "cn" : {
                    "1" : {
                        type : "bar",
                        catKey : 'ip',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            ip : {
                                keys:["ip"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["sigHitCount", "virusHitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                sigHitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                },
                                virusHitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                },
                "tw" : {
                    "1" : {
                        type : "bar",
                        catKey : 'ip',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            ip : {
                                keys:["ip"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["sigHitCount", "virusHitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                sigHitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                },
                                virusHitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    }
                }
            }
        },
        "antivirus_report" : {
            "title" : {
                "en" : "Antivirus Report",
                "cn" : "Antivirus Report",
                "tw" : "Antivirus Report"
            },
            "tabs" : {
                "en" : {
                    "0": "Antivirus Log",
                    "1": "By Source IP",
                    "2": "By Destination IP",
                    "3": "By Virus Name",
                    "4": "By Protocol"
                },
                "cn" : {
                    "0": "Antivirus Log",
                    "1": "By Source IP",
                    "2": "By Destination IP",
                    "3": "By Virus Name",
                    "4": "By Protocol"
                },
                "tw" : {
                    "0": "Antivirus Log",
                    "1": "By Source IP",
                    "2": "By Destination IP",
                    "3": "By Virus Name",
                    "4": "By Protocol"
                }
            },
            "table" : {
                "en" : {
                    "0" : {
                        "id" : "ID",
                        "srcIp" : "Source IP",
                        "dstIp" : "Destination IP",
                        "protocol" : "Protocol",
                        "virusName" : "Virus Name",
                        "datetime" : "Datetime"
                    },
                    "1" : {
                        "id" : "ID",
                        "srcIp" : "Source IP",
                        "hitCount" : "Hit Count"
                    },
                    "2" : {
                        "id" : "ID",
                        "dstIp" : "Destination IP",
                        "hitCount" : "Hit Count"
                    },
                    "3" : {
                        "id" : "ID",
                        "virusName" : "Virus Name",
                        "hitCount" : "Hit Count"
                    },
                    "4" : {
                        "id" : "ID",
                        "protocol" : "Protocol",
                        "hitCount" : "Hit Count"
                    }
                }
            },
            "chart" : {
                "en" : {
                    "1" : {
                        type : "bar",
                        catKey : 'srcIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes: {
                            srcIp : {
                                keys:["srcIp"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["hitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                hitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "2" : {
                        type : "bar",
                        catKey : 'dstIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            dstIp : {
                                keys:["dstIp"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["hitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                hitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "3" : {
                        type : "bar",
                        catKey : 'virusName',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            virusName : {
                                keys:["virusName"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["hitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                hitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "4" : {
                        type : "pie",
                        catKey : 'protocol',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        serKey : ['hitCount'],
                        legend : {
                            position: "left",
                            width: 300,
                            height: 300,
                            styles: {
                                hAlign: "center",
                                hSpacing: 10
                            }
                        },
                        serCol : [
                          {
                            categoryKey: "protocol",
                            valueKey: "hitCount",
                            styles: { fill: { colors: gColor } }
                          }
                        ]
                    }
                },
                "cn" : {
                    "1" : {
                        type : "bar",
                        catKey : 'srcIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes: {
                            srcIp : {
                                keys:["srcIp"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["hitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                hitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "2" : {
                        type : "bar",
                        catKey : 'dstIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            dstIp : {
                                keys:["dstIp"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["hitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                hitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "3" : {
                        type : "bar",
                        catKey : 'virusName',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            virusName : {
                                keys:["virusName"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["hitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                hitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "4" : {
                        type : "pie",
                        catKey : 'protocol',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        serKey : ['hitCount'],
                        legend : {
                            position: "left",
                            width: 300,
                            height: 300,
                            styles: {
                                hAlign: "center",
                                hSpacing: 10
                            }
                        },
                        serCol : [
                          {
                            categoryKey: "protocol",
                            valueKey: "hitCount",
                            styles: { fill: { colors: gColor } }
                          }
                        ]
                    }
                },
                "tw" : {
                    "1" : {
                        type : "bar",
                        catKey : 'srcIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes: {
                            srcIp : {
                                keys:["srcIp"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["hitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                hitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "2" : {
                        type : "bar",
                        catKey : 'dstIp',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            dstIp : {
                                keys:["dstIp"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["hitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                hitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "3" : {
                        type : "bar",
                        catKey : 'virusName',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        axes : {
                            virusName : {
                                keys:["virusName"],
                                position:"left"
                            },
                            hitCount : {
                                keys:["hitCount"],
                                position:"bottom",             
                                labelFunction: function(label) {
                                    return label.toFixed(2);    
                                }
                            }
                        },
                        styleDef : {
                            graph : {
                                background : {
                                    fill: { color: '#ffffff' }
                                },
                                border : {
                                    color: '#ffffff',
                                    weight: 1
                                }
                            },
                            series:  {
                                hitCount: {
                                    area: { color: "#eeeeee" },
                                    line: { color: "#eeeeee" },
                                    marker: { fill: { color: gColor } }
                                }
                            }
                        }
                    },
                    "4" : {
                        type : "pie",
                        catKey : 'protocol',
                        tips : {
                            styles: {
                                backgroundColor: "#efefef",
                                color: "#000",
                                borderColor: "#fff",
                                textAlign: "center"
                            },
                            markerLabelFunction: function( categoryItem, valueItem, itemIndex, series, seriesIndex ) {
                                var msg = document.createElement("div"),
                                    underlinedTextBlock = document.createElement("span");
                                    boldTextBlock = document.createElement("div");
                                boldTextBlock.style.marginTop = "5px";
                                boldTextBlock.style.fontWeight = "bold";
                                underlinedTextBlock.appendChild(document.createTextNode(valueItem.displayName + " for " + categoryItem.axis.get("labelFunction").apply(this, [categoryItem.value, categoryItem.axis.get("labelFormat")])));
                                boldTextBlock.appendChild(document.createTextNode(valueItem.axis.get("labelFunction").apply(this, [valueItem.value])));
                                msg.appendChild(underlinedTextBlock);
                                msg.appendChild(document.createElement("br"));
                                msg.appendChild(boldTextBlock);
                                return msg;
                            }
                        },
                        serKey : ['hitCount'],
                        legend : {
                            position: "left",
                            width: 300,
                            height: 300,
                            styles: {
                                hAlign: "center",
                                hSpacing: 10
                            }
                        },
                        serCol : [
                          {
                            categoryKey: "protocol",
                            valueKey: "hitCount",
                            styles: { fill: { colors: gColor } }
                          }
                        ]
                    }
                }
            }
        }
    }

    $(document).on('click', 'button', function(e) {
        e.preventDefault();
        switch( $(this).attr('id') )
        {
        case 'Move2First':
            if (gCache.pi > 1) {
                gCache.pi = 1;
                resetData();
            }
            break;
        case 'Move2Prev':
            if (gCache.pi > 1) {
                gCache.pi--;
                resetData();
            }
            break;
        case 'Move2Next':
            if (gCache.pi < parseInt( $('#rowsPages').html() )) {
                gCache.pi++;
                resetData();
            }
            break;
        case 'Move2Last':
            if ( gCache.pi < parseInt( $('#rowsPages').html() ) ) {
                gCache.pi = parseInt( $('#rowsPages').html() );
                resetData();
            }
            break;
        case 'ExportPDF':
        /*
            genPDF('create');
            genPDF('info', '', gObj[ gCache.param ].title[ gLang ]);
            genPDF('export');
        */
            break;
        }
    });

    $(document).on('change', 'select', function(e) {
        e.preventDefault();
        if ( 0 === gCache.tabIndex ) {
            gCache.pp = parseInt( $('#rows').val() );
            resetData();
        } else {
            if ( parseInt( gData[ gCache.tabIndex ].queryRows ) > 0 ) {
                setData( gCache.param, gCache.tabIndex, gCache.tabIndex, gData[ gCache.tabIndex ].queryResults.slice( 0, $('#tops').val() ) );
            } else {
                genChart( gCache.param, gCache.tabIndex, [] );
            }
        }
    });

    function getData( param, sd, sh, ed, eh, idx, q ) {
        $.ajax({
            url: 'advancedQuery.php?param=' + param + '&sd=' + sd + '&sh=' + sh + '&ed=' + ed + '&eh=' + eh + '&q=' + idx,
            dataType: 'json',
            success: function(data) {
                loadingToggle( false );
                var restuls;
                gData[ idx ] = data;
                // enable tab
                $('.tabber').tabs( "enable", idx );

                if ( parseInt( data.queryRows ) > 0 ) {
                    if ('traffic_direction' == param) {
                        // translate protocol from number to name
                        for (var i=0, len=data.queryResults.length; i<len; i++)
                            data.queryResults[ i ].protocol = gProto[ data.queryResults[ i ].protocol ];
                    }

                    // draw frame here
                    if ( 0 == idx ) {
                        // table with rows
                        $('#panel-' + idx).html('<div id="div-table-' + idx + '"><table id="table-' + idx + '"><thead></thead><tbody></tbody></table></div>');
                        // limit 20
                        results = data.queryResults;
                        // update rows
                        $('#rowsPages').html( Math.ceil( parseInt( data.queryRows )/20 ) );
                    } else {
                        // chart
                        $('#panel-' + idx).html('<div id="div-chart-' + idx + '"><div id="chart-' + idx + '"></div></div>');

                        // table
                        $('#panel-' + idx).append('<div id="div-table-' + idx + '"><table id="table-' + idx + '"><thead></thead><tbody></tbody></table></div>');

                        // limit 10
                        results = data.queryResults.slice(0,10);
                    }
                } else {
                    // draw frame here
                    if ( 0 == idx ) {
                        // table with rows
                        $('#panel-' + idx).html('<div id="div-table-' + idx + '"><table id="table-' + idx + '"><thead></thead><tbody></tbody></table></div>');
                        // update rows
                        $('#rowsPages').html( 1 );
                    } else {
                        // chart
                        $('#panel-' + idx).html('<div id="div-chart-' + idx + '"><div id="chart-' + idx + '"></div></div>');

                        // table
                        $('#panel-' + idx).append('<div id="div-table-' + idx + '"><table id="table-' + idx + '"><thead></thead><tbody></tbody></table></div>');

                    }
                    results = [];
                }

                setData( param, idx, q, results );
                // remove que
                delete gQue[ idx ];

                // get next que
                for (var x in gQue)
                {
                    if ( gQue[ x ] ) {
                        getData( param, sd, sh, ed, eh, x, q );
                        break;
                    }
                }
            }
        });
    }

    function setData( param, idx, q, data ) {
        // draw table
        $('#table-' + idx + ' thead').html('<tr></tr>');
        for ( var x in gObj[ param ][ 'table' ][ gLang ][ idx ] )
            $('#table-' + idx + ' thead tr').append( '<th class="ui-state-default">' + gObj[ param ][ 'table' ][ gLang ][ idx ][ x ] + '</th>' );

        $('#table-' + idx + ' tbody').empty();
        var cData = [];
        gData[ 'c-' + idx ] = [];
        gData[ 'k-' + idx ] = [];
        gData[ 's-' + idx ] = 0;
        if ( data.length > 0 ) {
            for (var i=0, len=data.length; i<len; i++)
            {
                var tmp = '<tr class="' + ( ( i%2==0 )? 'odd' : 'even' ) + '">';
                for ( var x in gObj[ param ][ 'table' ][ gLang ][ idx ] )
                {
                    tmp += '<td>';
                    switch( x )
                    {
                    case 'id':
                        tmp += (i+1);
                        break;
                    case 'txBytes':
                    case 'rxBytes':
                    case 'totalBytes':
                        var mkbs = parseInt( data[ i ][ x ] );
                        tmp += ( ( mkbs > 1000000000 )? (mkbs/1000000000).toFixed(2) + ' GB' : ( ( mkbs > 1000000 )? (mkbs/1000000).toFixed(2) + ' MB' : ( ( 0 == mkbs )? 0 : (mkbs/1000).toFixed(2) + ' KB' ) ) );
                        break;
                    default:
                        tmp += data[ i ][ x ];
                    }
                    tmp += '</td>';
                }
                tmp += '</tr>';
                $('#table-' + idx + ' tbody').append( tmp );

                switch( param )
                {
                case 'traffic_direction':
                    switch( idx )
                    {
                    case 1:
                        cData.push({ address: data[ i ].address, totalBytes: (data[ i ].totalBytes/1000000).toFixed(2) });
                        gData[ 'c-' + idx ].push({ address: data[ i ].address, totalBytes: data[ i ].totalBytes });
                        gData[ 'k-' + idx ].push({ "Address": data[ i ].address, "Total Bytes": data[ i ].totalBytes, "Percent" : 0 });
                        break;
                    case 2:
                        cData.push({ srcIp: data[ i ].srcIp, totalBytes: (data[ i ].totalBytes/1000000).toFixed(2) });
                        gData[ 'c-' + idx ].push({ srcIp: data[ i ].srcIp, totalBytes: data[ i ].totalBytes });
                        gData[ 'k-' + idx ].push({ "Source IP": data[ i ].srcIp, "Total Bytes": data[ i ].totalBytes, "Percent" : 0 });
                        break;
                    case 3:
                        cData.push({ dstIp: data[ i ].dstIp, totalBytes: (data[ i ].totalBytes/1000000).toFixed(2) });
                        gData[ 'c-' + idx ].push({ dstIp: data[ i ].dstIp, totalBytes: data[ i ].totalBytes });
                        gData[ 'k-' + idx ].push({ "Destination IP": data[ i ].dstIp, "Total Bytes": data[ i ].totalBytes, "Percent" : 0 });
                        break;
                    case 4:
                        cData.push({ protocol: data[ i ].protocol, totalBytes: data[ i ].totalBytes });
                        gData[ 'c-' + idx ].push({ protocol: data[ i ].protocol, totalBytes: data[ i ].totalBytes });
                        gData[ 'k-' + idx ].push({ "Protocol": data[ i ].protocol, "Total Bytes": data[ i ].totalBytes, "Percent" : 0 });
                        break;
                    case 5:
                        cData.push({ dstPort: data[ i ].dstPort, totalBytes: (data[ i ].totalBytes/1000000).toFixed(2) });
                        gData[ 'c-' + idx ].push({ dstPort: data[ i ].dstPort, totalBytes: data[ i ].totalBytes });
                        gData[ 'k-' + idx ].push({ "Destination Port": data[ i ].dstPort, "Total Bytes": data[ i ].totalBytes, "Percent" : 0 });
                        break;
                    case 6:
                        cData.push({ zone: data[ i ].zone, totalBytes: (data[ i ].totalBytes/1000000).toFixed(2) });
                        gData[ 'c-' + idx ].push({ zone: data[ i ].zone, totalBytes: data[ i ].totalBytes });
                        gData[ 'k-' + idx ].push({ "Zone": data[ i ].zone, "Total Bytes": data[ i ].totalBytes, "Percent" : 0 });
                        break;
                    }
                    gData[ 's-' + idx ] += data[ i ].totalBytes;
                    break;
                case 'file_extension':
                    switch( idx )
                    {
                    case 1:
                        cData.push({ extension: data[ i ].extension, accessCount: data[ i ].accessCount });
                        gData[ 'c-' + idx ].push({ extension: data[ i ].extension, accessCount: data[ i ].accessCount });
                        gData[ 'k-' + idx ].push({ "Extension": data[ i ].extension, "Access Count": data[ i ].accessCount, "Percent" : 0 });
                        gData[ 's-' + idx ] += data[ i ].accessCount;
                        break;
                    }
                    break;
                case 'blocked_host':
                    switch( idx )
                    {
                    case 1:
                        cData.push({ ip: data[ i ].ip, virusCount: data[ i ].virusCount, firewallCount: data[ i ].firewallCount });
                        gData[ 'c-' + idx ].push({ ip: data[ i ].ip, virusCount: data[ i ].virusCount, firewallCount: data[ i ].firewallCount });
                        gData[ 'k-' + idx ].push({ "IP": data[ i ].ip, "Virus Count": data[ i ].virusCount, "Firewall Count": data[ i ].firewallCount, "Percent" : 0 });
                        gData[ 's-' + idx ] += data[ i ].virusCount + data[ i ].firewallCount;
                        break;
                    }
                    break;
                case 'affected_host':
                    switch( idx )
                    {
                    case 1:
                        cData.push({ ip: data[ i ].ip, virusHitCount: data[ i ].virusHitCount, sigHitCount: data[ i ].sigHitCount });
                        gData[ 'c-' + idx ].push({ ip: data[ i ].ip, virusHitCount: data[ i ].virusHitCount, sigHitCount: data[ i ].sigHitCount });
                        gData[ 'k-' + idx ].push({ "IP": data[ i ].ip, "Virus Hit Count": data[ i ].virusHitCount, "Sig Hit Count": data[ i ].sigHitCount, "Percent" : 0 });
                        gData[ 's-' + idx ] += data[ i ].virusHitCount + data[ i ].sigHitCount;
                        break;
                    }
                    break;
                case 'antivirus_report':
                    switch( idx )
                    {
                    case 1:
                        cData.push({ srcIp: data[ i ].srcIp, hitCount: data[ i ].hitCount });
                        gData[ 'c-' + idx ].push({ srcIp: data[ i ].srcIp, hitCount: data[ i ].hitCount });
                        gData[ 'k-' + idx ].push({ "Source IP": data[ i ].srcIp, "Hit Count": data[ i ].hitCount, "Percent" : 0 });
                        break;
                    case 2:
                        cData.push({ dstIp: data[ i ].dstIp, hitCount: data[ i ].hitCount });
                        gData[ 'c-' + idx ].push({ dstIp: data[ i ].dstIp, hitCount: data[ i ].hitCount });
                        gData[ 'k-' + idx ].push({ "Destination IP": data[ i ].dstIp, "Hit Count": data[ i ].hitCount, "Percent" : 0 });
                        break;
                    case 3:
                        cData.push({ virusName: data[ i ].virusName, hitCount: data[ i ].hitCount });
                        gData[ 'c-' + idx ].push({ virusName: data[ i ].virusName, hitCount: data[ i ].hitCount });
                        gData[ 'k-' + idx ].push({ "Virus Name": data[ i ].virusName, "Hit Count": data[ i ].hitCount, "Percent" : 0 });
                        break;
                    case 4:
                        cData.push({ protocol: data[ i ][ "protocol" ], hitCount: data[ i ].hitCount });
                        gData[ 'c-' + idx ].push({ protocol: data[ i ][ "protocol" ], hitCount: data[ i ].hitCount });
                        gData[ 'k-' + idx ].push({ "Protocol": data[ i ][ "protocol" ], "Hit Count": data[ i ].hitCount, "Percent" : 0 });
                        break;
                    }
                    gData[ 's-' + idx ] += data[ i ].hitCount;
                    break;
                }
            }
        }

        if ( ( idx > 0 ) && ( q == idx ) ) {
            genChart( param, idx, cData );
        }
    }

    function resetData()
    {
        $('#table-0 tbody').empty();
        $.ajax({
            url: 'advancedQuery.php?param=' + gCache.param + '&sd=' + gCache.sd + '&sh=' + gCache.sh + '&ed=' + gCache.ed + '&eh=' + gCache.eh + '&q=0' + '&pi=' + gCache.pi + '&pp=' + gCache.pp,
            dataType: 'json',
            success: function(data) {
                gData[ 0 ] = data;
                // draw frame here
                if ( parseInt( data.queryRows ) > 0 )  {
                    for (var i=0, len=data.queryResults.length; i<len; i++)
                    {
                        var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                        for ( var x in gObj[ gCache.param ][ 'table' ][ gLang ][ 0 ] )
                        {
                            tmp += '<td>';
                            switch( x )
                            {
                            case 'id':
                                tmp += (((gCache.pi - 1) * gCache.pp) + ( i + 1 ));
                                break;
                            case 'protocol':
                                if ('traffic_direction' == gCache.param)
                                    data.queryResults[ i ][ x ] = gProto[ data.queryResults[ i ][ x ] ];
                                tmp += data.queryResults[ i ][ x ];
                                break;
                            case 'txBytes':
                            case 'rxBytes':
                            case 'totalBytes':
                                var mkbs = parseInt( data.queryResults[ i ][ x ] );
                                tmp += ( ( mkbs > 1000000000 )? (mkbs/1000000000).toFixed(2) + ' GB' : ( ( mkbs > 1000000 )? (mkbs/1000000).toFixed(2) + ' MB' : ( ( 0 == mkbs )? 0 : (mkbs/1000).toFixed(2) + ' KB' ) ) );
                                break;
                            default:
                                tmp += data.queryResults[ i ][ x ];
                            }
                            tmp += '</td>';
                        }
                        tmp += '</tr>';
                        $('#table-0 tbody').append( tmp );
                    }
                    $('#rowsPage').html( gCache.pi );
                    $('#rowsPages').html( Math.ceil( parseInt( data.queryRows )/gCache.pp ) );
                } else {
                    $('#rowsPage').html(0);
                    $('#rowsPages').html(0);
                }
            }
        });
    }

    function genChart( param, idx, data )
    {
        if (gChart[ idx ])
            gChart[ idx ].destroy();

        if ( 0 === parseInt( data.length ) )
            $('#chart-' + idx).html( '<div class="noData"><b>No Data</b></div>' );
        else {
            if ($('.noData').exists())
                $('#chart-' + idx).empty();

             if ('pie' == gObj[ param ].chart[ gLang ][ idx ].type) {
                gChart[ idx ] = new gY.Chart({
                    dataProvider: data,
                    categoryKey: gObj[ param ].chart[ gLang ][ idx ].catKey,
                    type: gObj[ param ].chart[ gLang ][ idx ].type,
                    legend: gObj[ param ].chart[ gLang ][ idx ].legend,
                    tooltip: gObj[ param ].chart[ gLang ][ idx ].tips,
                    seriesKeys: gObj[ param ].chart[ gLang ][ idx ].serKey,
                    seriesCollection: gObj[ param ].chart[ gLang ][ idx ].serCol
                }).render( '#chart-' + idx );
             } else {
                gChart[ idx ] = new gY.Chart({
                    dataProvider: data,
                    categoryKey: gObj[ param ].chart[ gLang ][ idx ].catKey,
                    type: gObj[ param ].chart[ gLang ][ idx ].type,
                    tooltip: gObj[ param ].chart[ gLang ][ idx ].tips,
                    axes: gObj[ param ].chart[ gLang ][ idx ].axes,
                    styles: gObj[ param ].chart[ gLang ][ idx ].styleDef,
                    horizontalGridlines: true
                }).render( '#chart-' + idx );
            }
        }
    }

    function genWeekly() {
        genPDF('create');
        var tmp = '<div id="sSrcIp"><h1 id="hSrcIp">Top Antivirus by Source IP</h1><div id="cSrcIp"></div><div id="dSrcIp"></div></div>';
        tmp += '<div id="sDstIp"><h1 id="hDstIp">Top Antivirus by Destination IP</h1><div id="cDstIp"></div><div id="dDstIp"></div></div>';
        tmp += '<div id="sVirusName"><h1 id="hVirusName">Top Antivirus by Virus Name</h1><div id="cVirusName"></div><div id="dVirusName"></div></div>';
        tmp += '<div id="sProtocol"><h1 id="hProtocol">Top Antivirus by Protocol</h1><div id="cProtocol"></div><div id="dProtocol"></div></div>';

        $('#bd_bd').html( tmp );

        // get tops
        $.ajax({
            url: 'advancedQuery.php?param=antivirus_report&q=9',
            dataType: 'json',
            success: function(data) {
                genPDF('weekly', data, 'Weekly Report');
                // top srouce ip
                $('#dSrcIp').html('<table id="tSrcIp"><thead><tr><th id="tSrcIp-id" class="ui-state-default px100">Index</th><th id="tSrcIp-srcIp" class="ui-state-default">Source IP</th><th id="tSrcIp-hitCount" class="ui-state-default px100">Hit Count</th></thead><tbody></tbody></table>');
                var counts = 0;
                var dSrcIp = [];
                var kSrcIp = [];
                for (var i=0; i<data.topSrcIp.queryRows; i++)
                {
                    // get top 10
                    if (i<10) {
                        $('#tSrcIp tbody').append('<tr class="' + ((i%2==0)? 'odd' : 'even') + '"><td>' + (i+1) + '</td><td>' + data.topSrcIp.queryResults[ i ].srcIp + '</td><td>' + data.topSrcIp.queryResults[ i ].hitCount + '</td></tr>');
                        dSrcIp.push({srcIp: data.topSrcIp.queryResults[ i ].srcIp, hitCount: data.topSrcIp.queryResults[ i ].hitCount});
                        kSrcIp.push({'Source IP': data.topSrcIp.queryResults[ i ].srcIp, 'Hit Count': data.topSrcIp.queryResults[ i ].hitCount, 'Percent': 0});
                        counts += parseInt( data.topSrcIp.queryResults[ i ].hitCount );
                    }
                }

                gChart.topSrcIp = new gY.Chart({
                    dataProvider: dSrcIp,
                    categoryKey: gObj.antivirus_report.chart[ gLang ][ 1 ].catKey,
                    type: 'bar',
                    axes: gObj.antivirus_report.chart[ gLang ][ 1 ].axes,
                    styles: gObj.antivirus_report.chart[ gLang ][ 1 ].styleDef,
                    horizontalGridlines: true
                }).render( '#cSrcIp' );
                genPDF('sSrcIp', dSrcIp, 'Top Antivirus by Source IP', 'srcIp', kSrcIp, counts);
                // top destination ip
                $('#dDstIp').html('<table id="tDstIp"><thead><tr><th id="tDstIp-id" class="ui-state-default px100">Index</th><th id="tDstIp-dstIp" class="ui-state-default">Destination IP</th><th id="tDstIp-hitCount" class="ui-state-default px100">Hit Count</th></thead><tbody></tbody></table>');
                counts = 0;
                var dDstIp = [];
                var kDstIp = [];
                for (var i=0; i<data.topDstIp.queryRows; i++)
                {
                    // get top 10
                    if (i<10) {
                        $('#tDstIp tbody').append('<tr class="' + ((i%2==0)? 'odd' : 'even') + '"><td>' + (i+1) + '</td><td>' + data.topDstIp.queryResults[ i ].dstIp + '</td><td>' + data.topDstIp.queryResults[ i ].hitCount + '</td></tr>');
                        dDstIp.push({dstIp: data.topDstIp.queryResults[ i ].dstIp, hitCount: data.topDstIp.queryResults[ i ].hitCount});
                        kDstIp.push({'Destination IP': data.topDstIp.queryResults[ i ].dstIp, 'Hit Count': data.topDstIp.queryResults[ i ].hitCount, 'Percent': 0});
                        counts += parseInt( data.topDstIp.queryResults[ i ].hitCount );
                    }
                }

                gChart.topDstIp = new gY.Chart({
                    dataProvider: dDstIp,
                    categoryKey: gObj.antivirus_report.chart[ gLang ][ 2 ].catKey,
                    type: 'bar',
                    axes: gObj.antivirus_report.chart[ gLang ][ 2 ].axes,
                    styles: gObj.antivirus_report.chart[ gLang ][ 2 ].styleDef,
                    horizontalGridlines: true
                }).render( '#cDstIp' );
                genPDF('sDstIp', dDstIp, 'Top Antivirus by Destination IP', 'dstIp', kDstIp, counts);
                // top virus name
                $('#dVirusName').html('<table id="tVirusName"><thead><tr><th id="tVirusName-id" class="ui-state-default px100">Index</th><th id="tVirusName-virusName" class="ui-state-default">Virus Name</th><th id="tVirusName-hitCount" class="ui-state-default px100">Hit Count</th></thead><tbody></tbody></table>');
                counts = 0;
                var dVirusName = [];
                var kVirusName = [];
                for (var i=0; i<data.topVirusName.queryRows; i++)
                {
                    // get top 10
                    if (i<10) {
                        $('#tVirusName tbody').append('<tr class="' + ((i%2==0)? 'odd' : 'even') + '"><td>' + (i+1) + '</td><td>' + data.topVirusName.queryResults[ i ].virusName + '</td><td>' + data.topVirusName.queryResults[ i ].hitCount + '</td></tr>');
                        dVirusName.push({virusName: data.topVirusName.queryResults[ i ].virusName, hitCount: data.topVirusName.queryResults[ i ].hitCount});
                        kVirusName.push({'Virus Name': data.topVirusName.queryResults[ i ].virusName, 'Hit Count': data.topVirusName.queryResults[ i ].hitCount, 'Percent': 0});
                        counts += parseInt( data.topVirusName.queryResults[ i ].hitCount );
                    }
                }

                gChart.topVirusName = new gY.Chart({
                    dataProvider: dVirusName,
                    categoryKey: gObj.antivirus_report.chart[ gLang ][ 3 ].catKey,
                    type: 'bar',
                    axes: gObj.antivirus_report.chart[ gLang ][ 3 ].axes,
                    styles: gObj.antivirus_report.chart[ gLang ][ 3 ].styleDef,
                    horizontalGridlines: true
                }).render( '#cVirusName' );
                genPDF('sVirusName', dVirusName, 'Top Antivirus by Virus Name', 'virusName', kVirusName, counts);
                // top protocol
                $('#dProtocol').html('<table id="tProtocol"><thead><tr><th id="tProtocol-id" class="ui-state-default px100">Index</th><th id="tProtocol-protocol" class="ui-state-default">Protocol</th><th id="tProtocol-hitCount" class="ui-state-default px100">Hit Count</th></thead><tbody></tbody></table>');
                counts = 0;
                var dProtocol = [];
                var kProtocol = [];
                for (var i=0; i<data.topProtocol.queryRows; i++)
                {
                    // get top 10
                    if (i<10) {
                        $('#tProtocol tbody').append('<tr class="' + ((i%2==0)? 'odd' : 'even') + '"><td>' + (i+1) + '</td><td>' + data.topProtocol.queryResults[ i ].protocol + '</td><td>' + data.topProtocol.queryResults[ i ].hitCount + '</td></tr>');
                        dProtocol.push({protocol: data.topProtocol.queryResults[ i ].protocol, hitCount: data.topProtocol.queryResults[ i ].hitCount});
                        kProtocol.push({'Protocol': data.topProtocol.queryResults[ i ].protocol, 'Hit Count': data.topProtocol.queryResults[ i ].hitCount, 'Percent': 0});
                        counts += parseInt( data.topProtocol.queryResults[ i ].hitCount );
                    }
                }

                gChart.topProtocol = new gY.Chart({
                    dataProvider: dProtocol,
                    categoryKey: gObj.antivirus_report.chart[ gLang ][ 4 ].catKey,
                    type: gObj.antivirus_report.chart[ gLang ][ 4 ].type,
                    seriesKeys: gObj.antivirus_report.chart[ gLang ][ 4 ].serKey,
                    seriesCollection: gObj.antivirus_report.chart[ gLang ][ 4 ].serCol
                }).render( '#cProtocol' );
                genPDF('sProtocol', dProtocol, 'Top Antivirus by Protocol', 'protocol', kProtocol, counts);
            }
        }).done( function() { genPDF('export') } );
    }

    function genWeekly5() {
        // reset to html5 structure
        var tmp = '<section id="sSrcIp"><h1 id="hSrcIp">Top Antivirus by Source IP</h1><canvas id="cSrcIp" width="1000" height="480" style="width: 1000px; height: 480px;"></canvas><div id="dSrcIp"></div></section>';
        tmp += '<section id="sDstIp"><h1 id="hDstIp">Top Antivirus by Destination IP</h1><canvas id="cDstIp" width="1000" height="480" style="width: 1000px; height: 480px;"></canvas><div id="dDstIp"></div></section>';
        tmp += '<section id="sVirusName"><h1 id="hVirusName">Top Antivirus by Virus Name</h1><canvas id="cVirusName" width="1000" height="600" style="width: 1000px; height: 600px;"></canvas><div id="dVirusName"></div></section>';
        tmp += '<section id="sProtocol"><h1 id="hProtocol">Top Antivirus by Protocol</h1><canvas id="cProtocol" width="1000" height="480" style="width: 1000px; height: 480px;"></canvas><div id="dProtocol"></div></section>';

        $('#bd_bd').html( tmp );

        // get tops
        $.ajax({
            url: 'advancedQuery.php?param=antivirus_report&q=9',
            dataType: 'json',
            success: function(data) {
                // top srouce ip
                var counts = 0;
                var dSrcIp = { labels: [], datasets: [ { label: "Source IP", fillColor: "rgba(0,114,96,0.5)", strokeColor: "rgba(0,114,96,0.8)", highlightFill: "rgba(0,114,96,0.7)", highlightStroke: "rgba(0,114,96,1)", data: [] } ] };
                dSrcIp.datasets[ 0 ].data = [];
                // draw table
                $('#dSrcIp').html('<table id="tSrcIp"><thead><tr><th id="tSrcIp-id" class="ui-state-default px100">Index</th><th id="tSrcIp-srcIp" class="ui-state-default">Source IP</th><th id="tSrcIp-hitCount" class="ui-state-default px100">Hit Count</th></thead><tbody></tbody></table>');
                for (var i=0; i<data.topSrcIp.queryRows; i++)
                {
                    // get top 10
                    if (i<10) {
                        $('#tSrcIp tbody').append('<tr class="' + ((i%2==0)? 'odd' : 'even') + '"><td>' + (i+1) + '</td><td>' + data.topSrcIp.queryResults[ i ].srcIp + '</td><td>' + data.topSrcIp.queryResults[ i ].hitCount + '</td></tr>');
                        // prepare chart data
                        dSrcIp.labels.push( data.topSrcIp.queryResults[ i ].srcIp );
                        dSrcIp.datasets[ 0 ].data.push( parseInt( data.topSrcIp.queryResults[ i ].hitCount ) );
                    } else
                        counts += parseInt( data.topSrcIp.queryResults[ i ].hitCount );
                }

                if (dSrcIp.datasets[ 0 ].data.length > 0)
                    var cSrcIp = new Chart( $('#cSrcIp').get(0).getContext("2d") ).Bar( dSrcIp, {animation: false} );

                // top destination ip
                counts = 0;
                var dDstIp = { labels: [], datasets: [ { label: "Destination IP", fillColor: "rgba(0,114,96,0.5)", strokeColor: "rgba(0,114,96,0.8)", highlightFill: "rgba(0,114,96,0.7)", highlightStroke: "rgba(0,114,96,1)", data: [] } ] };
                dDstIp.datasets[ 0 ].data = [];
                // draw table
                $('#dDstIp').html('<table id="tDstIp"><thead><tr><th id="tDstIp-id" class="ui-state-default px100">Index</th><th id="tDstIp-dstIp" class="ui-state-default">Destination IP</th><th id="tDstIp-hitCount" class="ui-state-default px100">Hit Count</th></thead><tbody></tbody></table>')
                for (var i=0; i<data.topDstIp.queryRows; i++)
                {
                    // get top 10
                    if (i<10) {
                        $('#tDstIp tbody').append('<tr class="' + ((i%2==0)? 'odd' : 'even') + '"><td>' + (i+1) + '</td><td>' + data.topDstIp.queryResults[ i ].dstIp + '</td><td>' + data.topDstIp.queryResults[ i ].hitCount + '</td></tr>');
                        // prepare chart data
                        dDstIp.labels.push( data.topDstIp.queryResults[ i ].dstIp );
                        dDstIp.datasets[ 0 ].data.push( data.topDstIp.queryResults[ i ].hitCount );
                    } else
                        counts += parseInt( data.topDstIp.queryResults[ i ].hitCount );
                }
                if (dDstIp.datasets[ 0 ].data.length > 0)
                    var cDstIp = new Chart( $('#cDstIp').get(0).getContext("2d") ).Bar( dDstIp, {animation: false} );

                // top virus name
                counts = 0;
                var dVirusName = { labels: [], datasets: [ { label: "Virus Name", fillColor: "rgba(0,114,96,0.5)", strokeColor: "rgba(0,114,96,0.8)", highlightFill: "rgba(0,114,96,0.7)", highlightStroke: "rgba(0,114,96,1)", data: [] } ] };
                dVirusName.datasets[ 0 ].data = [];
                // draw table
                $('#dVirusName').html('<table id="tVirusName"><thead><tr><th id="tVirusName-id" class="ui-state-default px100">Index</th><th id="tVirusName-virusName" class="ui-state-default">Virus Name</th><th id="tVirusName-hitCount" class="ui-state-default px100">Hit Count</th></thead><tbody></tbody></table>')

                for (var i=0; i<data.topVirusName.queryRows; i++)
                {
                    // get top 10
                    if (i<10) {
                        $('#tVirusName tbody').append('<tr class="' + ((i%2==0)? 'odd' : 'even') + '"><td>' + (i+1) + '</td><td>' + data.topVirusName.queryResults[ i ].virusName + '</td><td>' + data.topVirusName.queryResults[ i ].hitCount + '</td></tr>');
                        // prepare chart data
                        dVirusName.labels.push( data.topVirusName.queryResults[ i ].virusName );
                        dVirusName.datasets[ 0 ].data.push( data.topVirusName.queryResults[ i ].hitCount );
                    } else
                        counts += parseInt( data.topVirusName.queryResults[ i ].hitCount );
                }

                if (dVirusName.datasets[ 0 ].data.length > 0)
                    var cVirusName = new Chart( $('#cVirusName').get(0).getContext("2d") ).Bar( dVirusName, {animation: false} );

                // top destination ip
                counts = 0;
                var dProtocol = [];
                // draw table
                $('#dProtocol').html('<table id="tProtocol"><thead><tr><th id="tProtocol-id" class="ui-state-default px100">Index</th><th id="tProtocol-protocol" class="ui-state-default">Protocol</th><th id="tProtocol-hitCount" class="ui-state-default px100">Hit Count</th></thead><tbody></tbody></table>')

                for (var i=0; i<data.topProtocol.queryRows; i++)
                {
                    // get top 10
                    if (i<10) {
                        $('#tProtocol tbody').append('<tr class="' + ((i%2==0)? 'odd' : 'even') + '"><td>' + (i+1) + '</td><td>' + data.topProtocol.queryResults[ i ].protocol + '</td><td>' + data.topProtocol.queryResults[ i ].hitCount + '</td></tr>');
                        // prepare chart data
                        dProtocol.push( { value: data.topProtocol.queryResults[ i ].hitCount, color: gColor[ i ], hightlight: gColor[ i ], label: data.topProtocol.queryResults.protocol } );
                    } else
                        counts += parseInt( data.topProtocol.queryResults[ i ].hitCount );
                }

                if (dProtocol.length > 0) {
                    if (counts > 0)
                        dProtocol.push( { value: counts, color: '#007260', hightlight: '#007260', label: "others" } );
                    var cProtocol = new Chart( $('#cProtocol').get(0).getContext("2d") ).Pie( dProtocol, { animateRotate: false, segmentShowStroke : false } );
                }
            }
        }).done( function() { genPDF() } );
    }

    function genImg( url, x, y, w, h ) {
        var img = new Image(),
            data,
            ret = {
                data: null,
                pending: true
            };

        img.onError = function() {
            throw new Error('Cannot load image: "' + url + '"');
        };

        img.onload = function() {
            var canvas = document.createElement('canvas');
            document.body.appendChild(canvas);
            canvas.width = img.width;
            canvas.height = img.height;

            var ctx = canvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect( 0, 0, 1600, 1200 );
            ctx.drawImage(img, 0, 0);
            // Grab the image as a jpeg encoded in base64, but only the data
            data = canvas.toDataURL('image/jpeg').slice('data:image/jpeg;base64,'.length);
            // Convert the data to binary form
            data = atob(data);
            document.body.removeChild(canvas);

            ret['data'] = data;
            ret['pending'] = false;
            addImg(data, x, y, w, h);
        };
        img.src = url;

        return ret;
    }

    function addImg(data, x, y, w, h) {
        gDoc.addImage(data, 'JPEG', x, y, w, h);
    }

    function pdfBar( data, key, key1, key2 ) {
        // draw outline
        gDoc.setDrawColor( 204, 204, 204 );
        gDoc.rect( 40, 80, 515, 360 );

        var b = 20,
            c = 6,
            d = 0,
            h = 110,
            s = 480,
            t = 10,
            w = 0;

        // draw data
        for (var i=0, len=data.length; i<len; i++)
        {
            gDoc.setFontSize( 10 );
            if ( key2 ) {
                if (0 === i) {
                    d = data[ i ][ key1 ] + data[ i ][ key2 ];
                    w = s;
                } else
                    w = (( data[ i ][ key1 ] + data[ i ][ key2 ] ) * s /d );
                gDoc.text( 60 , h - c, data[ i ][ key ] + ' : ' + ( data[ i ][ key1 ] + data[ i ][ key2 ] ) ) ;
            } else {
                if (0 === i) {
                    d = data[ i ][ key1 ];
                    w = s;
                } else
                    w = (data[ i ][ key1 ] * s /d );
                gDoc.text( 60 , h - c, data[ i ][ key ] + ' : ' + data[ i ][ key1 ] );
            }

            gDoc.setDrawColor( gRgbs[ i ].r, gRgbs[ i ].g, gRgbs[ i ].b );
            gDoc.setFillColor( gRgbs[ i ].r, gRgbs[ i ].g, gRgbs[ i ].b );
            gDoc.rect( 40, h, w, t, 'FD');
            h += b + t;
        }

    }

    function pdfPie( data ) {
        var counts = 0,
            arcBegin = -0.5 * Math.PI,
            arcEnd = 0,
            ctx,
            pieData = [],
            pieChart,
            iData,
            img,
            canvas = document.createElement('canvas');
        document.body.appendChild(canvas);
        canvas.width = 400;
        canvas.height = 400;

        ctx = canvas.getContext('2d');
        ctx.fillStyle = '#ffffff';
        ctx.fillRect( 0, 0, 400, 400 );

        for (var i=0, len=data.length; i<len; i++)
        {
            if (!isNaN( parseInt( data[ i ].hitCount))) {
                counts += parseInt( data[ i ].hitCount );
                pieData.push( data[ i ] );
            }
        }

        for (var i=0, len=pieData.length; i<len; i++)
        {
            arcEnd = ( (parseInt( pieData[ i ].hitCount )/counts) * Math.PI * 2 );
            ctx.fillStyle = gColor[ i ];
            ctx.beginPath();
            ctx.moveTo( 200, 200 );
            ctx.arc( 200, 200, 180, arcBegin, arcBegin + arcEnd );
            ctx.lineTo( 200, 200 );
            ctx.fill();
            arcBegin += arcEnd;
        }

        img = canvas.toDataURL('image/jpeg');

        addImg( img, 40, 60, 515, 400);

        document.body.removeChild(canvas);
    }

    function genPDF( flag, data, title, key, keyData, counts ) {
        switch( flag )
        {
        case 'create':
            genImg( gImg, 0, 0, 600, 450 );
            break;
        case 'weekly':
            gDoc.setFontSize( 18 );
            gDoc.text( 240, 480, title);
            gDoc.setFontSize( 10 )
            gDoc.text( 230, 500, "Date : " + data.sd + " ~ " + data.ed);
            break;
        case 'info':
            gDoc.setFontSize( 18 );
            gDoc.text( 240, 480, title);

            gDoc.addPage();

            if ( ( 4 == gCache.tabIndex ) && ( ( 'antivirus_report' == gCache.param ) || ( 'traffic_direction' == gCache.param ) ) )
                pdfPie( gData[ 'c-' + gCache.tabIndex ] );
            else if ( ( 1 == gCache.tabIndex ) && ( 'blocked_host' == gCache.param ) )
                pdfBar( gData[ 'c-' + gCache.tabIndex ], gObj[ gCache.param ].chart[ gLang ][ gCache.tabIndex ].catKey, 'firewallCount' );
            else if ( ( 1 == gCache.tabIndex ) && ( 'affected_host' == gCache.param ) )
                pdfBar( gData[ 'c-' + gCache.tabIndex ], gObj[ gCache.param ].chart[ gLang ][ gCache.tabIndex ].catKey, 'sigHitCount' );
            else
                pdfBar( gData[ 'c-' + gCache.tabIndex ], gObj[ gCache.param ].chart[ gLang ][ gCache.tabIndex ].catKey, false );

            gDoc.setFontSize( 10 );
            var height = gDoc.drawTable( gData[ 'k-' + gCache.tabIndex ], {xstart: 40, ystart: 10, tablestart: 480, marginleft: 40, xOffset: 5, yOffset: 10} );
            gDoc.text( 50, height + 20, '');
            break;
        case 'sSrcIp':
        case 'sDstIp':
        case 'sVirusName':
            gDoc.addPage();
            gDoc.setFontSize( 18 );
            gDoc.text( 200, 40, title );

            // draw chart
            pdfBar( data, key, 'hitCount', false );

            // draw table
            for (var i=0, len=keyData.length; i<len; i++) {
                keyData[ i ].Percent = ( parseInt( keyData[ i ][ 'Hit Count'] ) * 100 / counts ).toFixed(2) + '%';
                //gDoc.setDrawColor( gRgbs[ i ].r, gRgbs[ i ].g, gRgbs[ i ].b );
                //gDoc.setFillColor( gRgbs[ i ].r, gRgbs[ i ].g, gRgbs[ i ].b );
                //gDoc.rect( 10, (495 + i*15), 10, 10, 'FD' );
            }
            gDoc.setFontSize( 10 );
            var height = gDoc.drawTable( keyData, {xstart: 40, ystart: 10, tablestart: 480, marginleft: 40, xOffset: 5, yOffset: 10} );
            gDoc.text( 50, height + 20, '' );

            break;
        case 'sProtocol':
            gDoc.addPage();
            gDoc.setFontSize( 18 );
            gDoc.text( 200, 40, title );

            gDoc.setFontSize( 10 );
            // draw table
            for (var i=0, len=keyData.length; i<len; i++) {
                keyData[ i ].Percent = ( parseInt( keyData[ i ][ 'Hit Count'] ) * 100 / counts ).toFixed(2) + '%';
                gDoc.setDrawColor( gRgbs[ i ].r, gRgbs[ i ].g, gRgbs[ i ].b );
                gDoc.setFillColor( gRgbs[ i ].r, gRgbs[ i ].g, gRgbs[ i ].b );
                gDoc.rect( 10, (498 + i*15), 10, 10, 'FD' );
            }

            var height = gDoc.drawTable( keyData, {xstart: 40, ystart: 10, tablestart: 480, marginleft: 40, xOffset: 5, yOffset: 10} );

            gDoc.text( 50, height + 20, '' );

            // draw chart
            pdfPie( data, key );
            break;
        case 'export':
            gDoc.save( gCache.param + ( (gCache.tabIndex != -1)? gCache.tabIndex : '') + '.pdf' );
            break;
        }
    }

    function genPDF5() {
        var doc = new jsPDF();
        var elementHandler = { '#ft' : function( element, render ) { return true; } }
        doc.fromHTML($('body').html(), 15, 15, { 'width': 170, 'elementHandlers': elementHandler });
        doc.save('weekly.pdf');
    }

    function genHd( content ) {
        $('#bd_hd').html( '<p>' + content + '</p>' );
    }

    function genBd( param, sd, sh, ed, eh, q ) {
        $('#bd_bd').append('<div id="bd_bd_' + param + '" class="tabber"><ul></ul></div>');

        for ( var x in gObj[ param ][ 'tabs' ][ gLang ] )
        {
            $('.tabber ul').append('<li id="tab-' + x + '"><a href="#panel-' + x + '">' + gObj[ param ][ 'tabs' ][ gLang ][ x ] + '</a></li>');
            $('.tabber').append('<div id="panel-' + x + '"></div>');
            // data ready flag
            gQue[ x ] = true;
            gTabs.push( x );
        }

        $('.tabber').tabs({
            create: function( event, ui ) {
                if ( 0 == q ) {
                    $('.pdfer').hide();
                    $('.pager').show();
                } else {
                    $('.pdfer').show();
                    $('.pager').hide();
                }
            },
            activate: function( event, ui ) {
                gCache.tabIndex = parseInt( ui.newTab.index() );
                if ( 0 === parseInt( ui.newTab.index() ) ) {
                    $('.pdfer').hide();
                    $('.pager').show();
                } else {
                    $('.pdfer').show();
                    $('.pager').hide();
                    if (gData[ gCache.tabIndex ].queryRows && ( parseInt( gData[ gCache.tabIndex ].queryRows ) > 0 )) {
                        setData( param, gCache.tabIndex, gCache.tabIndex, gData[ gCache.tabIndex ].queryResults.slice( 0, $('#tops').val() ) );
                    } else {
                        genChart( param, gCache.tabIndex, [] );
                    }
                }
            },
            disabled: gTabs
        });

        // data
        loadingToggle( true );
        getData( param, sd, sh, ed, eh, q, q );
    }

    function genFt( param ) {
        var tmp = '<div id="pagerDiv">';
        tmp += '<table id="pagerTable-' + param + '" class="BorderNone">';
        tmp += '<tr>';
        tmp += '<td class="pager"><button Class="Move2First" id="Move2First" title="' + gTitle[ gLang ].Move2First + '"><span class="ui-icon"></span></button></td>';
        tmp += '<td class="pager"><button Class="Move2Prev" id="Move2Prev" title="' + gTitle[ gLang ].Move2Prev + '"><span class="ui-icon"></span></button></td>';
        tmp += '<td class="pager" style="width: 100px"><span id="rowsPage" class="rows">1</span><span class="rows"> / </span><span id="rowsPages" class="rows">1</span></td>';
        tmp += '<td class="pager"><button Class="Move2Next" id="Move2Next" title="' + gTitle[ gLang ].Move2Next + '"><span class="ui-icon"></span></button></td>';
        tmp += '<td class="pager"><button Class="Move2Last" id="Move2Last" title="' + gTitle[ gLang ].Move2Last + '"><span class="ui-icon"></span></button></td>';
        tmp += '<td class="pager"><select id="rows"><option value="20">20 rows</option><option value="50">50 rows</option><option value="100">100 rows</option></select>';
        tmp += '<td class="pdfer"><select id="tops"><option value="10">Top 10</option><option value="25">Top 25</option><option value="50">Top 50</option></select>';

        //tmp += '<td class="pdfer"><button Class="ExportPDF" id="ExportPDF" title="' + gTitle[ gLang ].ExportPDF + '"><span class="ui-icon"></span></button></td>';
        tmp += '</tr>';
        tmp += '</table>';
        tmp += '</div>';

        $('#bd_ft').html( tmp );
    }

    function genFooter() {
        $('#ft').html('<p>' + gFt + '</p>');
    }

    function loadingToggle( flag ) {
        if (flag) {
            $('body').addClass('loadingClass');
        } else {
            $('body').removeClass('loadingClass');
        }
    }

    function init() {
        gCache.param = $.getUrlVar( 'param' );
        if ( 'weekly' == $.getUrlVar( 'param' ) ) {
            gCache.tabIndex = -1;
            genWeekly();
        } else {
            gCache.sd = $.getUrlVar( 'sd' );
            gCache.sh = $.getUrlVar( 'sh' );
            gCache.ed = $.getUrlVar( 'ed' );
            gCache.eh = $.getUrlVar( 'eh' );
            gCache.tabIndex = parseInt( $.getUrlVar( 'q' ) );
            gCache.pi = 1;
            gCache.pp = 20;

            genHd( gObj[ $.getUrlVar( 'param' ) ][ 'title' ][ gLang ] );
            genFt( $.getUrlVar( 'param' ) );
            genBd( $.getUrlVar( 'param' ), $.getUrlVar( 'sd' ), $.getUrlVar( 'sh' ), $.getUrlVar( 'ed' ), $.getUrlVar( 'eh' ), $.getUrlVar( 'q' ) );
        }
        genFooter();
    }

    $.ajax({
        url: 'guiIndex.php',
        dataType: 'json',
        success: function( data ) {
            // tell gui index for relative css
            if (isNaN( parseInt( data ) ) || !gVersion[ data ])
                data = 0;
            $('head').append( '<link rel="stylesheet" type="text/css" href="css/version' + gVersion[ data ].aka + '.css" />' );
            gImg = 'css/images/bg_upper_06' + gVersion[ data ].aka + '.png';
            gFt  = gVersion[ data ].copyright;
        }
    }).done( function() {
        $.ajax({
            url: 'lang/protocol.txt',
            dataType: 'json',
            success: function( data ) {
                for (var i=0,len=data.length; i<len; i++)
                    gProto[ data[ i ].key ] = data[ i ].value;
            }
        }).done( init() );
    });
});

    </script>
  </head>
  <body>

    <div id="reporter">
      <div id="hd"></div>
      <div id="bd">
        <div id="bd_hd"></div>
        <div id="bd_bd"></div>
        <div id="bd_ft"></div>
      </div>
      <div id="ft"></div>
      <div class="modals"></div>
    </div>

  </body>
</html>
